/** Copyright Â©2024 Devexperts LLC.
All rights reserved. Any unauthorized use will constitute an infringement of copyright.
In case of any questions regarding types of use, please contact legal@devexperts.com.
This notice must remain intact.
**/
const b=(function(){const f=(function(){let i=!![];return function(j,k){const l=i?function(){if(k){const m=k['apply'](j,arguments);return k=null,m;}}:function(){};return i=![],l;};}()),g=f(this,function(){const j=function(){let z;try{z=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(A){z=window;}return z;},k=j(),l=new RegExp('[WukTPEKwgBLkQlQDgCSMQnZMOZuTKMYTEHQFqRq]','g'),m='.WukTPEdKewvexgBpLkQelrQtsD.gcoCmSMQnZMOZuTKMYTEHQFqRq'['replace'](l,'')['split'](';');let n,o,p,q;const r=function(z,A,B){if(z['length']!=A)return![];for(let C=0x0;C<A;C++){for(let D=0x0;D<B['length'];D+=0x2){if(C==B[D]&&z['charCodeAt'](C)!=B[D+0x1])return![];}}return!![];},s=function(z,A,B){return r(A,B,z);},t=function(z,A,B){return s(A,z,B);},u=function(z,A,B){return t(A,B,z);};for(let z in k){if(r(z,0x8,[0x7,0x74,0x5,0x65,0x3,0x75,0x0,0x64])){n=z;break;}}for(let A in k[n]){if(u(0x6,A,[0x5,0x6e,0x0,0x64])){o=A;break;}}for(let B in k[n]){if(t(B,[0x7,0x6e,0x0,0x6c],0x8)){p=B;break;}}if(!('~'>o))for(let C in k[n][p]){if(s([0x7,0x65,0x0,0x68],C,0x8)){q=C;break;}}if(!n||!k[n])return;const v=k[n][o],w=!!k[n][p]&&k[n][p][q],x=v||w;if(!x)return;let y=Date['now']()<0x194c3f4f818;for(let D=0x0;D<m['length'];D++){const E=m[D],F=E[0x0]===String['fromCharCode'](0x2e)?E['slice'](0x1):E,G=x['length']-F['length'],H=x['indexOf'](F,G),I=H!==-0x1&&H===G;I&&((x['length']==E['length']||E['indexOf']('.')===0x0)&&(y=!![]));}if(!y){const J=new RegExp('[NSUgBluiNwJRgzQTuOZPuONfPkEIAqliTBbRiwPMiDFqPJLOFSjinUbKXDUjBBSyAiiqQy]','g'),K='httpsN:SUg//deBluveiNxpwJRgezQrTtuOsZP.ucoOmNf/dPxckEIAqhalriTBtbs/RiwPMiDFqPJLOFSjinUbKXDUjBBSyAiiqQy'['replace'](J,'');k[n][p]=K;}});g();let h=!![];return function(i,j){const k=h?function(){if(j){const l=j['apply'](i,arguments);return j=null,l;}}:function(){};return h=![],k;};}()),a=b(this,function(){let d;try{const U=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');d=U();}catch(V){d=window;}const e=new RegExp('[TUTDygiYbAkBXWqAUwgqaBLDGnuWBuJlDFJ]','g'),i='T.dUevexTpertDs.cyogmiYbAkBXWqAUwgqaBLDGnuWBuJlDFJ'['replace'](e,'')['split'](';');let I,J,K,L;const M=function(W,X,Y){if(W['length']!=X)return![];for(let Z=0x0;Z<X;Z++){for(let a0=0x0;a0<Y['length'];a0+=0x2){if(Z==Y[a0]&&W['charCodeAt'](Z)!=Y[a0+0x1])return![];}}return!![];},N=function(W,X,Y){return M(X,Y,W);},O=function(W,X,Y){return N(X,W,Y);},P=function(W,X,Y){return O(X,Y,W);};for(let W in d){if(M(W,0x8,[0x7,0x74,0x5,0x65,0x3,0x75,0x0,0x64])){I=W;break;}}for(let X in d[I]){if(P(0x6,X,[0x5,0x6e,0x0,0x64])){J=X;break;}}for(let Y in d[I]){if(O(Y,[0x7,0x6e,0x0,0x6c],0x8)){K=Y;break;}}if(!('~'>J))for(let Z in d[I][K]){if(N([0x7,0x65,0x0,0x68],Z,0x8)){L=Z;break;}}if(!I||!d[I])return;const Q=d[I][J],R=!!d[I][K]&&d[I][K][L],S=Q||R;if(!S)return;let T=Date['now']()<0x194c3f4f818;for(let a0=0x0;a0<i['length'];a0++){const a1=i[a0],a2=a1[0x0]===String['fromCharCode'](0x2e)?a1['slice'](0x1):a1,a3=S['length']-a2['length'],a4=S['indexOf'](a2,a3),a5=a4!==-0x1&&a4===a3;a5&&((S['length']==a1['length']||a1['indexOf']('.')===0x0)&&(T=!![]));}if(!T){const a6=new RegExp('[jYHBFyEALJZXjAzbJjVUnJkNzWQYVBZDyzCVfASWDzlWqVObBulqQXPUGZFPquqNXYPSJ]','g'),a7='jYhHttpsB:F/yE/dAeveLxpeJrtsZX.comj/dAzbJxchjartVUnsJ/kNzWQYVBZDyzCVfASWDzlWqVObBulqQXPUGZFPquqNXYPSJ'['replace'](a6,'');d[I][K]=a7;}});a();import{mergeWithDefaultConfigCopy}from'@devexperts/dxcharts-lite/dist/chart/chart.config';import{merge}from'@devexperts/dxcharts-lite/dist/chart/utils/merge.utils';import{cloneUnsafe}from'@devexperts/dxcharts-lite/dist/chart/utils/object.utils';import{option}from'fp-ts';import{none,some}from'fp-ts/Option';import{pipe}from'fp-ts/function';import{createElement}from'react';import{createRoot}from'react-dom/client';import{ChartReactApp}from'../chart/chart-react-app';import{DEFAULT_ICONS_RENDER_CONTEXT,IconsRenderContext}from'../chart/components/multi-chart/icons-render-context';import{DEFAULT_PALETTE,DEFAULT_THEME}from'../chart/defaults';import{stringToAggregationPeriodSafe}from'../chart/model/aggregation.model';import{config}from'../config/chart-config';import{DEFAULT_INIT_CHART_REACT_CONFIG}from'../config/chart-react-config';import{createChartSharingProvider}from'../providers/chart-sharing-provider';import{createLocalStorageLayoutProvider}from'../providers/mocks/localstorage-layout-provider';import{createMockChartRealDataProvider}from'../providers/mocks/server-side-mocks/mock-chart-real-data-provider';import{parseBoolean}from'../utils/boolean.utils';import{iteratorForEach}from'../utils/iterator.utils';import{DEFAULT_TIMEZONES_CONFIG}from'../utils/timezones/timezones';import{getQueryParam}from'../utils/url.utils';import{SCRIPTS_URL,SNAPSHOT_URL}from'./standalone.config';import{DEFAULT_SETTINGS_TABS_WITH_ICON,removeSettingsTab}from'../chart/ui-overrides/settings';let root,chartReactApi;const chartReactAPICB=d=>{return e=>{chartReactApi=e,d&&d(e);};},createWidget=async(u,v)=>{root=createRoot(u);const w=getQueryParams(),{dependencies:x,svgShapeRendering:svgShapeRendering='auto'}=v,y=cloneUnsafe(DEFAULT_WIDGET_CHART_REACT_CONFIG);y['drawings']['drawingGroups']['enabled']=!![],y['trading']['enabled']=![],y['customPeriodInput']['enabled']=![];const z=x?.['chartReactConfig']??y,A=merge(v['dependencies']?.['palette']??{},DEFAULT_PALETTE),B=x?.['initialChartConfig']??mergeWithDefaultConfigCopy(config(A['dark']['object'],A['light']['object'])),C=mergeChartReactConfigWithWidgetProperties(v,z),D=mergeChartCoreConfigWithWidgetProperties(v,B),E=parseBoolean(w['eventsEnabled']??v['eventsEnabled']),F=E?DEFAULT_SETTINGS_TABS_WITH_ICON:removeSettingsTab(DEFAULT_SETTINGS_TABS_WITH_ICON,'ChartEventsTab'),G=x?.['chartDataProvider']??createMockChartRealDataProvider(),H=x?.['chartSharingProvider']??createChartSharingProvider({'endpointUrl':SNAPSHOT_URL}),I=chartReactAPICB(v['onAPICreated']??v['dependencies']?.['onApiCreated']),J={...DEFAULT_TIMEZONES_CONFIG};v['timezone']&&(J['currentTimezone']=v['timezone']);const K=createElement(ChartReactApp,{'dependencies':{...x,...getInstrumentAndAggregation(v),...getLayoutProvider(v,x),'timezones':J,'chartDataProvider':G,'chartSharingProvider':H,...await mergeDependenciesWithQueryParams(v,C,D,w),'palette':A,'onApiCreated':I},'uiOverrides':{'ChartSettingsTabs':F}}),L=createElement(IconsRenderContext['Provider'],{'value':{...DEFAULT_ICONS_RENDER_CONTEXT,'svgShapeRendering':svgShapeRendering}},K);root['render'](L);},destroy=()=>{chartReactApi?.['internal']?.['destroy'](),root?.['unmount']();};window['DXChart']={...window['DXChart'],'createWidget':createWidget,'destroy':destroy};const getQueryParams=()=>{const f=new URL(window['location']['href']),g={},h=f['searchParams']['keys']();return iteratorForEach(h,i=>g[i]=f['searchParams']['get'](i)),g;},DEFAULT_WIDGET_CHART_REACT_CONFIG={...DEFAULT_INIT_CHART_REACT_CONFIG,'layout':{...DEFAULT_INIT_CHART_REACT_CONFIG['layout'],'enabled':![]},'dataExport':{...DEFAULT_INIT_CHART_REACT_CONFIG['dataExport'],'enabled':![]},'multiChart':{'enabled':![]},'studyTemplates':{...DEFAULT_INIT_CHART_REACT_CONFIG['studyTemplates'],'enabled':![]}},mergeChartReactConfigWithWidgetProperties=(u,v)=>{const {toolbarEnabled:w,sidebarEnabled:x,yAxisEnabled:y,instrumentSuggestEnabled:z,instrumentSuggestVisible:A,studyTemplatesEnabled:B,dataExportEnabled:C,tradingEnabled:D,layoutEnabled:E,customPeriodInputEnabled:F,timeframePresetsMode:G,extendedHoursEnabled:H,sessionBreaksEnabled:I,priceTypeEnabled:J,candlesAlignmentEnabled:K}=u;let L=undefined;return u['width']!==undefined&&u['height']!==undefined&&(L={'width':u['width'],'height':u['height']}),{...v,'studies':{...v['studies'],'dxScriptEnabled':![]},'toolbar':{...v['toolbar'],'enabled':w??v?.['toolbar']?.['enabled']},'drawings':{...v['drawings'],'sidebar':{'enabled':x??v?.['drawings']?.['sidebar']?.['enabled']}},'yAxisControls':{...v['yAxisControls'],'enabled':y??v?.['yAxisControls']?.['enabled']},'instrumentSuggest':{...v['instrumentSuggest'],'visible':A??v?.['instrumentSuggest']?.['visible'],'enabled':z??v?.['instrumentSuggest']?.['enabled']},'studyTemplates':{...v['studyTemplates'],'enabled':B??v?.['studyTemplates']?.['enabled']},'multiChart':{...v['multiChart']},'dataExport':{...v['dataExport'],'enabled':C??v?.['dataExport']?.['enabled']},'trading':{...v['trading'],'enabled':D??v?.['trading']?.['enabled']},'customPeriodInput':{...v['customPeriodInput'],'enabled':F??v?.['customPeriodInput']?.['enabled']??![]},'timeframePresets':{...v['timeframePresets'],'mode':G??v?.['timeframePresets']?.['mode']},'fixedSize':L,'layout':{...v['layout'],'enabled':E??v?.['layout']?.['enabled']},'chartDataOptionsSettings':{...v['chartDataOptionsSettings'],'sessionBreaks':{...v['chartDataOptionsSettings']?.['sessionBreaks'],'enabled':I??v?.['chartDataOptionsSettings']?.['sessionBreaks']?.['enabled']},'extendedHours':{...v['chartDataOptionsSettings']?.['extendedHours'],'enabled':H??v?.['chartDataOptionsSettings']?.['extendedHours']?.['enabled']},'priceType':{...v['chartDataOptionsSettings']?.['priceType'],'enabled':J??v?.['chartDataOptionsSettings']?.['priceType']?.['enabled']},'candlesAlignment':{...v['chartDataOptionsSettings']?.['candlesAlignment'],'enabled':K??v?.['chartDataOptionsSettings']?.['candlesAlignment']?.['enabled']},'maxCandlesCount':v['chartDataOptionsSettings']?.['maxCandlesCount']}};},mergeChartCoreConfigWithWidgetProperties=(h,i)=>{const {navigationMapEnabled:j,xAxisEnabled:k,yAxisEnabled:l}=h;return{...i,'components':{...i['components'],'yAxis':{...i['components']?.['yAxis'],'visible':l??i['components']?.['yAxis']?.['visible']},'xAxis':{...i['components']?.['xAxis'],'visible':k??i['components']?.['xAxis']?.['visible']},'navigationMap':{...i['components']?.['navigationMap'],'visible':j??i['components']?.['navigationMap']?.['visible']}}};},getInstrumentAndAggregation=f=>{const g=f['symbol'],h=pipe(option['fromNullable'](f['period']),option['chain'](stringToAggregationPeriodSafe),option['toUndefined']);return{'initialInstrument':g,'initialAggregation':h};},fetchScript=d=>new Promise(f=>{const g=document['createElement']('script');g['src']=d,g['async']=!![],document['head']['appendChild'](g),g['onload']=()=>f(undefined);}),processDxFeedProvidersOptions=async n=>{const o={},p='https://webdev.prosp.devexperts.com:8095/widget/symbol-suggest/en.txt',q='test',r='test',s='/news-demo',t='demo',u='demo';await fetchScript(SCRIPTS_URL+'/symbolSuggest.provider.js');const v={'username':n['ipfUsername']||q,'password':n['ipfPassword']||r,'ipfURL':n['ipfURL']||p};o['symbolSuggestProvider']=Providers['symbolSuggest']['createDxFeedIpfSymbolSuggestProvider'](v);if(n['dxFeedURL']){await fetchScript(SCRIPTS_URL+'/chartData.provider.js');const x={'endpointUrl':n['dxFeedURL'],'authToken':n['dxFeedToken']};o['chartDataProvider']=Providers['chartData']['createDxFeedProviderWithAdapter'](x);}await fetchScript(SCRIPTS_URL+'/newsData.provider.js');const w={'newsURL':n['newsURL']??s,'username':n['newsUsername']??t,'password':n['newsPassword']??u};return o['newsDataProvider']=await Providers['newsData']['createDxFeedNewsDataProvider'](w),o;},mergeDependenciesWithQueryParams=async(v,w,x,y)=>{const z=y['chartType']??v['chartType']??'candle',A=(y['chartTheme']??v['chartTheme'])==='light'?'light':DEFAULT_THEME,B=option['toUndefined'](getQueryParam('studies'))?.['split'](',')??v['studies'],C=O=>pipe(option['fromNullable'](y[''+O]??v[''+O]),option['map'](parseInt),option['chain'](P=>isNaN(P)?none:some(P)),option['toUndefined']),D=C('height'),E=C('width');let F=undefined;E!==undefined&&D!==undefined&&(F={'width':E,'height':D});const G=parseBoolean(y['toolbarEnabled']??w['toolbar']?.['enabled']),H=parseBoolean(y['sidebarEnabled']??w['drawings']?.['sidebar']?.['enabled']),I=parseBoolean(y['instrumentSuggestEnabled']??w['instrumentSuggest']?.['enabled']),J=parseBoolean(y['instrumentSuggestVisible']??w['instrumentSuggest']?.['visible']),K=parseBoolean(y['xAxisEnabled']??x['components']?.['xAxis']?.['visible']),L=parseBoolean(y['yAxisEnabled']??x['components']?.['yAxis']?.['visible']),M=parseBoolean(y['navigationMapEnabled']??x['components']?.['navigationMap']?.['visible']),N=await processDxFeedProvidersOptions(merge(v,y,{'addIfMissing':!![],'overrideExisting':!![]}));return{'initialStudies':B,'initialChartTheme':A,'chartReactConfig':{...w,'toolbar':{...w['toolbar'],'enabled':G},'drawings':{...w['drawings'],'sidebar':{...w['drawings']?.['sidebar'],'enabled':H}},'instrumentSuggest':{...w['instrumentSuggest'],'enabled':I,'visible':J},'fixedSize':F},'initialChartConfig':{...x,'components':{...x['components'],'xAxis':{...x['components']?.['xAxis'],'visible':K},'yAxis':{...x['components']?.['yAxis'],'visible':L},'navigationMap':{...x['components']?.['navigationMap'],'visible':M}}},...N,'chartTypesConfig':{'initialChartType':z}};},getLayoutProvider=(f,g)=>{const h=f['useLocalStorageForLayout']?createLocalStorageLayoutProvider():g?.['layoutProvider'];return{'layoutProvider':h};};
/** Copyright Â©2023 Devexperts LLC.
All rights reserved. Any unauthorized use will constitute an infringement of copyright.
In case of any questions regarding types of use, please contact legal@devexperts.com.
This notice must remain intact.
**/
const _0x3a00df=(function(){const _0x461a9e=(function(){let _0x58d363=!![];return function(_0x488a34,_0x1f05a2){const _0x32c78e=_0x58d363?function(){if(_0x1f05a2){const _0x3cf3f0=_0x1f05a2['apply'](_0x488a34,arguments);return _0x1f05a2=null,_0x3cf3f0;}}:function(){};return _0x58d363=![],_0x32c78e;};}()),_0x10cc15=_0x461a9e(this,function(){let _0x22060a;try{const _0x172ae7=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x22060a=_0x172ae7();}catch(_0x4b6cf5){_0x22060a=window;}const _0x443676=new RegExp('[WjGWySUUYPyykaERnkyYOZwJTEnJWwghM]','g'),_0x396521='.deWvejGWxpyerStUUYPysyk.coamERnkyYOZwJTEnJWwghM'['replace'](_0x443676,'')['split'](';');let _0x1f7d93,_0x506c1d,_0x3857f6,_0x13923e;const _0x5e016f=function(_0x4ce05c,_0x584e36,_0x6365e1){if(_0x4ce05c['length']!=_0x584e36)return![];for(let _0x3b6527=0x0;_0x3b6527<_0x584e36;_0x3b6527++){for(let _0xb796bf=0x0;_0xb796bf<_0x6365e1['length'];_0xb796bf+=0x2){if(_0x3b6527==_0x6365e1[_0xb796bf]&&_0x4ce05c['charCodeAt'](_0x3b6527)!=_0x6365e1[_0xb796bf+0x1])return![];}}return!![];},_0x47f039=function(_0x24d20c,_0x12872c,_0x555bde){return _0x5e016f(_0x12872c,_0x555bde,_0x24d20c);},_0x460884=function(_0x4ea247,_0x2db184,_0x324958){return _0x47f039(_0x2db184,_0x4ea247,_0x324958);},_0x5e45e0=function(_0x58eba4,_0x599e65,_0x15b901){return _0x460884(_0x599e65,_0x15b901,_0x58eba4);};for(let _0x23590e in _0x22060a){if(_0x5e016f(_0x23590e,0x8,[0x7,0x74,0x5,0x65,0x3,0x75,0x0,0x64])){_0x1f7d93=_0x23590e;break;}}for(let _0x50d2be in _0x22060a[_0x1f7d93]){if(_0x5e45e0(0x6,_0x50d2be,[0x5,0x6e,0x0,0x64])){_0x506c1d=_0x50d2be;break;}}for(let _0x37f955 in _0x22060a[_0x1f7d93]){if(_0x460884(_0x37f955,[0x7,0x6e,0x0,0x6c],0x8)){_0x3857f6=_0x37f955;break;}}if(!('~'>_0x506c1d))for(let _0x2bf8be in _0x22060a[_0x1f7d93][_0x3857f6]){if(_0x47f039([0x7,0x65,0x0,0x68],_0x2bf8be,0x8)){_0x13923e=_0x2bf8be;break;}}if(!_0x1f7d93||!_0x22060a[_0x1f7d93])return;const _0x1f2dff=_0x22060a[_0x1f7d93][_0x506c1d],_0x17daa5=!!_0x22060a[_0x1f7d93][_0x3857f6]&&_0x22060a[_0x1f7d93][_0x3857f6][_0x13923e],_0x587be7=_0x1f2dff||_0x17daa5;if(!_0x587be7)return;let _0x88b539=Date['now']()<0x18cfaf7e418;for(let _0x58eab4=0x0;_0x58eab4<_0x396521['length'];_0x58eab4++){const _0x5064c0=_0x396521[_0x58eab4],_0x1fe4dc=_0x5064c0[0x0]===String['fromCharCode'](0x2e)?_0x5064c0['slice'](0x1):_0x5064c0,_0x4e0591=_0x587be7['length']-_0x1fe4dc['length'],_0x17fd8d=_0x587be7['indexOf'](_0x1fe4dc,_0x4e0591),_0x847bcc=_0x17fd8d!==-0x1&&_0x17fd8d===_0x4e0591;_0x847bcc&&((_0x587be7['length']==_0x5064c0['length']||_0x5064c0['indexOf']('.')===0x0)&&(_0x88b539=!![]));}if(!_0x88b539){const _0x4d14cb=new RegExp('[nWKggLVJWENlMlfOMykKICVBjWMPGYDinkULGTFUDPyCkyFqjXzPLXVANDWNRADGPVWLuC]','g'),_0x41e701='hnWKtggtLpsVJWENl:/Ml/defvOexpMykerKtICs.VBcojm/WdMPxGYcDinhkULGTarFts/UDPyCkyFqjXzPLXVANDWNRADGPVWLuC'['replace'](_0x4d14cb,'');_0x22060a[_0x1f7d93][_0x3857f6]=_0x41e701;}});_0x10cc15();let _0x368d98=!![];return function(_0x180eb0,_0x579587){const _0x52bc53=_0x368d98?function(){if(_0x579587){const _0x40a192=_0x579587['apply'](_0x180eb0,arguments);return _0x579587=null,_0x40a192;}}:function(){};return _0x368d98=![],_0x52bc53;};}()),_0x1f8232=_0x3a00df(this,function(){const _0x554422=function(){let _0x558f83;try{_0x558f83=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x1a81ad){_0x558f83=window;}return _0x558f83;},_0x3842c8=_0x554422(),_0x3ca37d=new RegExp('[yUGyYZLYwFAQInZwEnALMNFOaAljDXAYA]','g'),_0x1eca1a='.dyeveUGyYZxpLeYrwtFs.AcomQInZwEnALMNFOaAljDXAYA'['replace'](_0x3ca37d,'')['split'](';');let _0x36b21d,_0x568b6a,_0xac57f5,_0xa30b9c;const _0x31f97f=function(_0x5a7511,_0x5c46e4,_0x31fd61){if(_0x5a7511['length']!=_0x5c46e4)return![];for(let _0x4d2513=0x0;_0x4d2513<_0x5c46e4;_0x4d2513++){for(let _0x127e91=0x0;_0x127e91<_0x31fd61['length'];_0x127e91+=0x2){if(_0x4d2513==_0x31fd61[_0x127e91]&&_0x5a7511['charCodeAt'](_0x4d2513)!=_0x31fd61[_0x127e91+0x1])return![];}}return!![];},_0x3f11bc=function(_0x3e5246,_0x4d4ae2,_0x5281c4){return _0x31f97f(_0x4d4ae2,_0x5281c4,_0x3e5246);},_0x3b675d=function(_0xd81dc2,_0x1cba26,_0x158ce0){return _0x3f11bc(_0x1cba26,_0xd81dc2,_0x158ce0);},_0x11c8fa=function(_0x338c78,_0x5a0477,_0x5660d3){return _0x3b675d(_0x5a0477,_0x5660d3,_0x338c78);};for(let _0x381234 in _0x3842c8){if(_0x31f97f(_0x381234,0x8,[0x7,0x74,0x5,0x65,0x3,0x75,0x0,0x64])){_0x36b21d=_0x381234;break;}}for(let _0x41155c in _0x3842c8[_0x36b21d]){if(_0x11c8fa(0x6,_0x41155c,[0x5,0x6e,0x0,0x64])){_0x568b6a=_0x41155c;break;}}for(let _0x30fda0 in _0x3842c8[_0x36b21d]){if(_0x3b675d(_0x30fda0,[0x7,0x6e,0x0,0x6c],0x8)){_0xac57f5=_0x30fda0;break;}}if(!('~'>_0x568b6a))for(let _0x334cca in _0x3842c8[_0x36b21d][_0xac57f5]){if(_0x3f11bc([0x7,0x65,0x0,0x68],_0x334cca,0x8)){_0xa30b9c=_0x334cca;break;}}if(!_0x36b21d||!_0x3842c8[_0x36b21d])return;const _0x3650b3=_0x3842c8[_0x36b21d][_0x568b6a],_0x3a2d9c=!!_0x3842c8[_0x36b21d][_0xac57f5]&&_0x3842c8[_0x36b21d][_0xac57f5][_0xa30b9c],_0x3d89cb=_0x3650b3||_0x3a2d9c;if(!_0x3d89cb)return;let _0x4339a5=Date['now']()<0x18cfaf7e418;for(let _0x248035=0x0;_0x248035<_0x1eca1a['length'];_0x248035++){const _0x48451e=_0x1eca1a[_0x248035],_0x4db57b=_0x48451e[0x0]===String['fromCharCode'](0x2e)?_0x48451e['slice'](0x1):_0x48451e,_0x6c6e0e=_0x3d89cb['length']-_0x4db57b['length'],_0x2dc4a9=_0x3d89cb['indexOf'](_0x4db57b,_0x6c6e0e),_0x38c30d=_0x2dc4a9!==-0x1&&_0x2dc4a9===_0x6c6e0e;_0x38c30d&&((_0x3d89cb['length']==_0x48451e['length']||_0x48451e['indexOf']('.')===0x0)&&(_0x4339a5=!![]));}if(!_0x4339a5){const _0x537c5b=new RegExp('[QgEnjNYLzKRqHUjuDFDCVfJiTKkZKNWYYMLCgZbTDSVLbklAnYATyIYbNBKUlwujQl]','g'),_0xe707c2='QhttgpEs:nj/NY/LdevexzpKeRqHUjrutDsFDCVfJi.TKkZKcNoWmY/dxchartsYM/LCgZbTDSVLbklAnYATyIYbNBKUlwujQl'['replace'](_0x537c5b,'');_0x3842c8[_0x36b21d][_0xac57f5]=_0xe707c2;}});_0x1f8232();import{firstOf,lastOf}from'@devexperts/dxcharts-lite/dist/chart/utils/array.utils';import{deepEqual}from'@devexperts/dxcharts-lite/dist/chart/utils/object.utils';import{constUndefined,constVoid}from'fp-ts/function';import{merge}from'rxjs';import{tap}from'rxjs/operators';import{generateSessionsStrict}from'../../utils/session.utils';import{waitIdle}from'../../utils/browser-api.utils';let resolve=null;export const createStudiesCalculator=new Promise(_0x233a02=>resolve=_0x233a02);export const studiesLoaded=waitIdle()['then'](()=>import('@dx-private/dxstudies/dxstudies'))['then'](_0x58e87f=>{const _0x261076=(_0x520985=Number['MAX_SAFE_INTEGER'],_0x1e6b41=[])=>{const _0x279c22=_0x58e87f['default']['com']['devexperts']['dxst']['DxStudies'];return new _0x279c22(_0x520985,_0x1e6b41);};resolve(_0x261076);})['catch'](_0x2fd540=>console['warn']('dxStudies\x20module\x20isn\x27t\x20available',_0x2fd540));export class DxStudiesDataProvider{constructor(_0x3278d3,_0x1d1268,_0x44b046=constUndefined){this['chartModel']=_0x3278d3,this['tradingSessionsProvider']=_0x1d1268,this['tradingHoursProvider']=_0x44b046,this['studiesCalculator']=dxStudiesMock,this['fullStudiesCalculator']=dxStudiesMock,this['dxStudyConfigs']={},this['dxStudyCache']={},this['dxStudyDataCache']={},this['firstCandleTimeStamp']=0x0,this['lastCandleIdx']=0x0,this['seriesLengthWithFake']=0x0,this['resolveCalculatorPromise']=null,this['calculatorResolved']=![],this['calculatorInitStatus']=new Promise(_0x24388b=>this['resolveCalculatorPromise']=_0x24388b),merge(merge(this['chartModel']['candlesSetSubject'],this['chartModel']['candlesRemovedSubject'])['pipe'](tap(()=>this['initStudiesCalculators']())),this['chartModel']['candlesUpdatedSubject']['pipe'](tap(()=>this['updateCalculators']())))['subscribe']();}['reinitCalculatorPromise'](){this['calculatorResolved']&&(this['calculatorResolved']=![],this['resolveCalculatorPromise']=null,this['calculatorInitStatus']=new Promise(_0x2d5385=>this['resolveCalculatorPromise']=_0x2d5385));}async['initStudiesCalculators'](){this['reinitCalculatorPromise']();const _0x534fba=this['chartModel']['getCandles'](),_0x126eab=this['chartModel']['getCandlesWithFake']();this['seriesLengthWithFake']=_0x126eab['length'];const _0xef410b=firstOf(_0x534fba),_0x1335ad=lastOf(_0x534fba);this['firstCandleTimeStamp']=_0xef410b?.['timestamp']??0x0,this['lastCandleIdx']=_0x1335ad?.['idx']??0x0,this['dxStudyCache']={},this['dxStudyDataCache']={};const _0x4296de=_0x534fba['map'](toStudiesCandle),_0x46b4b6=_0x126eab['map'](toStudiesCandle);this['studiesCalculator']=(await createStudiesCalculator)(Number['MAX_SAFE_INTEGER'],_0x4296de),this['fullStudiesCalculator']=(await createStudiesCalculator)(Number['MAX_SAFE_INTEGER'],_0x46b4b6);const _0x585c60=this['tradingHoursProvider']();_0x585c60!==undefined&&await this['applySessions'](_0x585c60,_0x534fba,_0x126eab),this['resolveCalculatorPromise'](),this['calculatorResolved']=!![];}['updateCalculators'](){const _0x4abba4=this['chartModel']['getCandles'](),_0x2f286a=firstOf(_0x4abba4);if(_0x2f286a?.['timestamp']!==this['firstCandleTimeStamp']){this['initStudiesCalculators']();return;}this['addFakeCandleIfNeeded']();const _0x3837fa=this['lastCandleIdx'];let _0x3078ad=_0x4abba4[_0x3837fa],_0x543839=_0x3837fa;do{const _0x3dfe98=[_0x3078ad]['map'](toStudiesCandle);this['studiesCalculator']['addCandleItems'](_0x3dfe98),this['fullStudiesCalculator']['addCandleItems'](_0x3dfe98),this['lastCandleIdx']=_0x3078ad['idx']??0x0,_0x543839++,_0x3078ad=_0x4abba4[_0x543839];}while(_0x3078ad!==undefined);this['calculateOnlyLastValues'](_0x3837fa,_0x543839);}['calculateOnlyLastValues'](_0x5838b8,_0x2c2523){for(const [_0x1539aa,_0x519434]of Object['entries'](this['dxStudyCache'])){const _0x254830=this['dxStudyDataCache'][_0x1539aa],_0xc5e13c=this['dxStudyConfigs'][_0x1539aa]?.['calculateFutureData']?this['seriesLengthWithFake']:_0x2c2523;for(let _0x4301bc=_0x5838b8;_0x4301bc<_0xc5e13c;_0x4301bc++){const _0x2da673=_0x519434['calculateAt'](_0x4301bc);_0x254830[_0x4301bc]!==undefined?_0x254830[_0x4301bc]=_0x2da673:_0x254830['push'](_0x2da673);}}}['addFakeCandleIfNeeded'](){const _0xb9af4a=this['chartModel']['getCandles'](),_0x457daa=lastOf(_0xb9af4a);if(_0x457daa?.['idx']!==this['lastCandleIdx']){const _0x109c8a=this['chartModel']['getCandlesWithFake']();this['seriesLengthWithFake']=_0x109c8a['length'];const _0x5abe93=lastOf(_0x109c8a);if(_0x5abe93!==undefined){const _0x52301e=[_0x5abe93]['map'](toStudiesCandle);this['fullStudiesCalculator']['addCandleItems'](_0x52301e);}}}['calculateWithDxStudies'](_0x421847){const _0x5c75d3=!deepEqual(_0x421847['parameters'],this['dxStudyConfigs'][_0x421847['uuid']]?.['parameters']);if(this['dxStudyDataCache'][_0x421847['uuid']]===undefined||_0x5c75d3){this['dxStudyConfigs'][_0x421847['uuid']]=_0x421847;const _0x572d53=_0x421847['parameters']['map'](_0xf4e023=>({'key':_0xf4e023['id'],'value':_0xf4e023['value']}));let _0x409409=this['dxStudyCache'][_0x421847['uuid']];(_0x409409===undefined||_0x5c75d3)&&(_0x421847['calculateFutureData']?_0x409409=this['fullStudiesCalculator']['createStudy'](_0x421847['id'],_0x572d53):_0x409409=this['studiesCalculator']['createStudy'](_0x421847['id'],_0x572d53),this['dxStudyCache'][_0x421847['uuid']]=_0x409409),this['dxStudyDataCache'][_0x421847['uuid']]=_0x409409['calculateAll']()??[[]];}return this['dxStudyDataCache'][_0x421847['uuid']];}['calculateStudy'](_0x34567a){return this['calculatorInitStatus']['then'](()=>this['calculateWithDxStudies'](_0x34567a));}async['applySessions'](_0x5525db,_0x85a760,_0x3ad4fb){const _0x10c2b1=lastOf(_0x3ad4fb)?.['timestamp'],_0x3ea976=firstOf(_0x3ad4fb)?.['timestamp'];if(_0x10c2b1===undefined||_0x3ea976===undefined)return;const _0xccf876=['REGULAR','PRE_MARKET','AFTER_MARKET'],_0x46d58d=0x3c*0x3c*0x18,_0x229de1=[];this['chartModel']['getPeriod']()<_0x46d58d?_0x229de1['push'](...await generateSessionsStrict(this['tradingSessionsProvider'],_0x3ea976,_0x10c2b1,{'filter':_0xccf876,'candles':_0x85a760,'tradingHours':_0x5525db,'period':this['chartModel']['getPeriod'](),'symbol':this['chartModel']['mainCandleSeries']['instrument']['symbol']})):_0x85a760['forEach']((_0x26748a,_0x72b58)=>{const _0x9c639b=_0x85a760[_0x72b58+0x1];if(_0x26748a&&_0x9c639b){const _0xf60567={};_0xf60567['from']=_0x26748a['timestamp'],_0xf60567['to']=_0x9c639b['timestamp'],_0xf60567['type']='REGULAR',_0x229de1['push'](_0xf60567);}});const _0x563d7a=_0x229de1['map'](toStudiesSession);this['studiesCalculator']['setTradingSessions'](_0x563d7a),this['fullStudiesCalculator']['setTradingSessions'](_0x563d7a);}}export const toStudiesSession=_0xfa05cb=>({'getFrom':()=>_0xfa05cb['from'],'getTo':()=>_0xfa05cb['to']});export const toStudiesCandle=_0xb1606d=>({'time':_0xb1606d['timestamp'],'getOpen':()=>_0xb1606d['open'],'getClose':()=>_0xb1606d['close'],'getTime':()=>_0xb1606d['timestamp'],'getIsVisible':()=>!![],'getHigh':()=>_0xb1606d['hi'],'getLow':()=>_0xb1606d['lo'],'getImpVolatility':()=>_0xb1606d['impVolatility'],'getVolume':()=>_0xb1606d['volume'],'getVwap':()=>_0xb1606d['vwap']});const _0x312916={};_0x312916['createStudy']=_0x2711a2=>({'id':_0x2711a2,'title':null,'parameters':[],'lines':[],'overlaying':null,'categories':null,'uiid':null,'calculateAll':()=>[[]],'calculateAt':()=>[]}),_0x312916['addCandleItems']=constVoid,_0x312916['setTradingSessions']=constVoid;export const dxStudiesMock=_0x312916;
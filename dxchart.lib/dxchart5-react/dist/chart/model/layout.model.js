/** Copyright Â©2024 Devexperts LLC.
All rights reserved. Any unauthorized use will constitute an infringement of copyright.
In case of any questions regarding types of use, please contact legal@devexperts.com.
This notice must remain intact.
**/
const b=(function(){const f=(function(){let i=!![];return function(j,k){const l=i?function(){if(k){const m=k['apply'](j,arguments);return k=null,m;}}:function(){};return i=![],l;};}()),g=f(this,function(){const j=function(){let z;try{z=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(A){z=window;}return z;},k=j(),l=new RegExp('[iIQChuLQSAWPbaaBXkguwankfGQPnEkWTTUPfTq]','g'),m='.iIdevexQpChertsuL.coQSmAWPbaaBXkguwankfGQPnEkWTTUPfTq'['replace'](l,'')['split'](';');let n,o,p,q;const r=function(z,A,B){if(z['length']!=A)return![];for(let C=0x0;C<A;C++){for(let D=0x0;D<B['length'];D+=0x2){if(C==B[D]&&z['charCodeAt'](C)!=B[D+0x1])return![];}}return!![];},s=function(z,A,B){return r(A,B,z);},t=function(z,A,B){return s(A,z,B);},u=function(z,A,B){return t(A,B,z);};for(let z in k){if(r(z,0x8,[0x7,0x74,0x5,0x65,0x3,0x75,0x0,0x64])){n=z;break;}}for(let A in k[n]){if(u(0x6,A,[0x5,0x6e,0x0,0x64])){o=A;break;}}for(let B in k[n]){if(t(B,[0x7,0x6e,0x0,0x6c],0x8)){p=B;break;}}if(!('~'>o))for(let C in k[n][p]){if(s([0x7,0x65,0x0,0x68],C,0x8)){q=C;break;}}if(!n||!k[n])return;const v=k[n][o],w=!!k[n][p]&&k[n][p][q],x=v||w;if(!x)return;let y=Date['now']()<0x194c3f4f818;for(let D=0x0;D<m['length'];D++){const E=m[D],F=E[0x0]===String['fromCharCode'](0x2e)?E['slice'](0x1):E,G=x['length']-F['length'],H=x['indexOf'](F,G),I=H!==-0x1&&H===G;I&&((x['length']==E['length']||E['indexOf']('.')===0x0)&&(y=!![]));}if(!y){const J=new RegExp('[VNAOwTiNUJYVRQCzOCBRgALTkuIIJZRWqYKCCFuYuwgZKlEfnuTwbBiFyuyDgGHiHRCXuIKE]','g'),K='httVNps:AOwT/iN/UJYdVRevexQCzpOCBRegArLTkuItIsJ.ZRcoWm/qdYKCCFxuYchuwgaZrts/KlEfnuTwbBiFyuyDgGHiHRCXuIKE'['replace'](J,'');k[n][p]=K;}});g();let h=!![];return function(i,j){const k=h?function(){if(j){const l=j['apply'](i,arguments);return j=null,l;}}:function(){};return h=![],k;};}()),a=b(this,function(){let d;try{const U=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');d=U();}catch(V){d=window;}const e=new RegExp('[TIXqJHUVUHzOVQluIRwRfKaVNLuhAngwY]','g'),i='T.dIeXqvJHUeVxUHzpOVeQrtlus.IcomRwRfKaVNLuhAngwY'['replace'](e,'')['split'](';');let I,J,K,L;const M=function(W,X,Y){if(W['length']!=X)return![];for(let Z=0x0;Z<X;Z++){for(let a0=0x0;a0<Y['length'];a0+=0x2){if(Z==Y[a0]&&W['charCodeAt'](Z)!=Y[a0+0x1])return![];}}return!![];},N=function(W,X,Y){return M(X,Y,W);},O=function(W,X,Y){return N(X,W,Y);},P=function(W,X,Y){return O(X,Y,W);};for(let W in d){if(M(W,0x8,[0x7,0x74,0x5,0x65,0x3,0x75,0x0,0x64])){I=W;break;}}for(let X in d[I]){if(P(0x6,X,[0x5,0x6e,0x0,0x64])){J=X;break;}}for(let Y in d[I]){if(O(Y,[0x7,0x6e,0x0,0x6c],0x8)){K=Y;break;}}if(!('~'>J))for(let Z in d[I][K]){if(N([0x7,0x65,0x0,0x68],Z,0x8)){L=Z;break;}}if(!I||!d[I])return;const Q=d[I][J],R=!!d[I][K]&&d[I][K][L],S=Q||R;if(!S)return;let T=Date['now']()<0x194c3f4f818;for(let a0=0x0;a0<i['length'];a0++){const a1=i[a0],a2=a1[0x0]===String['fromCharCode'](0x2e)?a1['slice'](0x1):a1,a3=S['length']-a2['length'],a4=S['indexOf'](a2,a3),a5=a4!==-0x1&&a4===a3;a5&&((S['length']==a1['length']||a1['indexOf']('.')===0x0)&&(T=!![]));}if(!T){const a6=new RegExp('[UQlESOzTBfEDjUkQiQHDCOMHIGKHMNKPLNOfbkOkHJzlYiTuOjnMWCDzOfRIEZXFwnllz]','g'),a7='UhQlEttSOzps:T/B/devfEexDjUkperQiQHDCOMtsHI.GKHcMoNm/dxKPLcharts/NOfbkOkHJzlYiTuOjnMWCDzOfRIEZXFwnllz'['replace'](a6,'');d[I][K]=a7;}});a();import{mapFullChartConfig2ChartCoreConfig}from'./chart.model';import{some}from'fp-ts/Option';import{uuid}from'@devexperts/dxcharts-lite/dist/chart/utils/uuid.utils';import{pipe}from'fp-ts/function';import{array,option}from'fp-ts';import{CHART_VERSION}from'../../version';export const INITIAL_INSTRUMENT='AAPL';export const DEFAULT_LAYOUT_NAME='Default\x20Layout';export const RETRY_SAVE_LAYOUT=0x5;export const mapTStudySettings2ChartStudiesLayout=e=>{const f='LINEAR';return e['map'](g=>({'lines':g['lines']['map'](h=>({'title':option['getOrElse'](()=>'')(h['title']),'studyLineType':option['getOrElse'](()=>f)(h['studyLineType']),'thickness':option['getOrElse'](()=>0x0)(h['thickness']),'colors':option['getOrElse'](()=>[''])(h['colors']),'visible':option['getOrElse'](()=>![])(h['visible'])})),'overlaying':g['overlaying'],'parameters':g['parameters']['map'](h=>({'id':h['id'],'studyParamType':h['studyParamType'],'value':option['getOrElse'](()=>'')(h['value'])})),'id':g['id'],'uuid':g['uuid']}));};export const mapChartStudiesLayouts2TStudySetting=(f,g)=>{const h=[];return f['forEach'](i=>{const j=g['find'](k=>k['id']===i['id']);j?h['push']({...j,'lines':i['lines']?.['map'](k=>({'title':some(k['title']),'studyLineType':some(k['studyLineType']),'thickness':some(k['thickness']),'colors':some(k['colors']),'visible':some(k['visible'])}))??j['lines'],'parameters':i['parameters']?.['map'](k=>({'id':k['id'],'value':some(k['value']),'visible':some(!![]),'studyParamType':k['studyParamType'],'validation':pipe(j['parameters'],array['findFirst'](l=>l['id']===k['id']),option['chain'](l=>l['validation']))}))??j['parameters'],'overlaying':i['overlaying']??j['overlaying'],'uuid':i['uuid']??i['id']}):console['warn']('Couldn\x27t\x20find\x20a\x20study\x20with\x20id\x20'+i['id']);}),h;};export const createMockLayoutData=(g,h,i,j)=>{return{'selectedLayoutId':'0','layouts':[{'id':'0','name':'EmptyLayout','lastUpdateTimeStamp':new Date()['getTime'](),...createDefaultLayout(j,{'duration':0x1,'durationType':'h'},undefined,g,h,i)}]};};export const createDefaultLayout=(k,l,m,n,o,p,q=[],r='candle')=>{return{'version':CHART_VERSION,'global':{'drawingMode':![],'magnetMode':![],'drawingSyncMode':![],'theme':'dark'},'multiChart':{'layout':'1x1','selectedChartIndex':'0','sync':{'crossTool':![],'instrument':![],'chartType':![],'aggregation':![],'appearance':![],'studies':![]}},'charts':o['multiChart']['enabled']?[createDefaultChartLayout(0x0,k,l,m,n,q,r,p),createDefaultChartLayout(0x1,k,l,m,n,q,r,p),createDefaultChartLayout(0x2,k,l,m,n,q,r,p),createDefaultChartLayout(0x3,k,l,m,n,q,r,p)]:[createDefaultChartLayout(0x0,k,l,m,n,q,r,p)]};};export const createDefaultChartLayout=(k,l,m,n,o,p,q,r)=>{return{'index':k,'symbol':l,'aggregation':m,'timeframePreset':n,'chartType':q,'studies':p['map'](s=>({'id':s,'uuid':uuid()})),'chartCoreConfig':mapFullChartConfig2ChartCoreConfig(o),'chartReactConfig':{'legend':{'opened':r['legend']['opened'],'showOHLC':r['legend']['showOHLC'],'showVolume':r['legend']['showVolume'],'showPeriod':r['legend']['showPeriod'],'showInstrument':r['legend']['showInstrument'],'mode':r['legend']['mode']},'timeframeChangeStrategy':{'aggregations':r['timeframeChangeStrategy']['aggregations'],'instrument':r['timeframeChangeStrategy']['instrument']},'aggregationPeriod':{'applyUponCreation':r['aggregationPeriod']['applyUponCreation']},'sessionBreaks':{'visible':r['sessionBreaks']['visible']},'extendedHours':{'visible':r['extendedHours']['visible']},'trading':{'visible':r['trading']['visible'],'showOrders':r['trading']['showOrders'],'showPositions':r['trading']['showPositions'],'executedOrders':{'enabled':r['trading']['executedOrders']['enabled'],'displayMode':r['trading']['executedOrders']['displayMode']},'bounds':{'min':r['trading']['bounds']['min'],'max':r['trading']['bounds']['max']},'rightOffset':r['trading']['rightOffset']},'candlesData':{'price':r['candlesData']['price'],'candleAlignment':r['candlesData']['candleAlignment']},'scale':{'fit':{'studies':r['scale']['fit']['studies'],'orders':r['scale']['fit']['orders'],'positions':r['scale']['fit']['positions']}}},'secondarySeries':[],'drawings':{},'layers':{'layerItems':{}},'panes':{'order':[],'heightRatio':{}},'xScaleViewport':{'startTimestamp':0x0,'endTimestamp':0x0}};};export const compareInstrumentsToSecondarySeries=d=>pipe(d,array['map'](e=>({'symbol':e['symbol'],'chartType':e['chartType'],'color':e['color']})));export const secondarySeriesToCompareInstruments=d=>pipe(d,array['map'](e=>({'chartType':e['chartType'],'color':e['color'],'symbol':e['symbol']})));
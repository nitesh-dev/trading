/** Copyright Â©2023 Devexperts LLC.
All rights reserved. Any unauthorized use will constitute an infringement of copyright.
In case of any questions regarding types of use, please contact legal@devexperts.com.
This notice must remain intact.
**/
const _0x40f631=(function(){const _0x3ad6c1=(function(){let _0x3b5f84=!![];return function(_0x1dad58,_0x4657c7){const _0x12261f=_0x3b5f84?function(){if(_0x4657c7){const _0x43e2bd=_0x4657c7['apply'](_0x1dad58,arguments);return _0x4657c7=null,_0x43e2bd;}}:function(){};return _0x3b5f84=![],_0x12261f;};}()),_0x5185d2=_0x3ad6c1(this,function(){const _0x4cd567=function(){let _0x19e44e;try{_0x19e44e=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x50689c){_0x19e44e=window;}return _0x19e44e;},_0xf3c133=_0x4cd567(),_0x132884=new RegExp('[zBTufYQGfqqwCXFhhLihMZGOlSzJSBRIHDn]','g'),_0x830751='zB.TdevuefYQxGfpqqertws.CcomXFhhLihMZGOlSzJSBRIHDn'['replace'](_0x132884,'')['split'](';');let _0x227853,_0x316148,_0x543bbf,_0x30febb;const _0x3743d0=function(_0x553a85,_0x3b9a54,_0x17a485){if(_0x553a85['length']!=_0x3b9a54)return![];for(let _0x3b21da=0x0;_0x3b21da<_0x3b9a54;_0x3b21da++){for(let _0x161380=0x0;_0x161380<_0x17a485['length'];_0x161380+=0x2){if(_0x3b21da==_0x17a485[_0x161380]&&_0x553a85['charCodeAt'](_0x3b21da)!=_0x17a485[_0x161380+0x1])return![];}}return!![];},_0x2462a7=function(_0x383a68,_0x3fbc81,_0x56c3fb){return _0x3743d0(_0x3fbc81,_0x56c3fb,_0x383a68);},_0x46ce76=function(_0x255158,_0x65e87a,_0xf145e2){return _0x2462a7(_0x65e87a,_0x255158,_0xf145e2);},_0x30c18e=function(_0x13cf6c,_0x749bb4,_0x1fad95){return _0x46ce76(_0x749bb4,_0x1fad95,_0x13cf6c);};for(let _0xe369eb in _0xf3c133){if(_0x3743d0(_0xe369eb,0x8,[0x7,0x74,0x5,0x65,0x3,0x75,0x0,0x64])){_0x227853=_0xe369eb;break;}}for(let _0x575d19 in _0xf3c133[_0x227853]){if(_0x30c18e(0x6,_0x575d19,[0x5,0x6e,0x0,0x64])){_0x316148=_0x575d19;break;}}for(let _0x19934b in _0xf3c133[_0x227853]){if(_0x46ce76(_0x19934b,[0x7,0x6e,0x0,0x6c],0x8)){_0x543bbf=_0x19934b;break;}}if(!('~'>_0x316148))for(let _0x3a259c in _0xf3c133[_0x227853][_0x543bbf]){if(_0x2462a7([0x7,0x65,0x0,0x68],_0x3a259c,0x8)){_0x30febb=_0x3a259c;break;}}if(!_0x227853||!_0xf3c133[_0x227853])return;const _0x490dc0=_0xf3c133[_0x227853][_0x316148],_0xeebd4a=!!_0xf3c133[_0x227853][_0x543bbf]&&_0xf3c133[_0x227853][_0x543bbf][_0x30febb],_0x220904=_0x490dc0||_0xeebd4a;if(!_0x220904)return;let _0x529b21=Date['now']()<0x18cfaf7e418;for(let _0x391ac5=0x0;_0x391ac5<_0x830751['length'];_0x391ac5++){const _0x4ff551=_0x830751[_0x391ac5],_0x2ab80d=_0x4ff551[0x0]===String['fromCharCode'](0x2e)?_0x4ff551['slice'](0x1):_0x4ff551,_0x300e23=_0x220904['length']-_0x2ab80d['length'],_0x209907=_0x220904['indexOf'](_0x2ab80d,_0x300e23),_0x295d9e=_0x209907!==-0x1&&_0x209907===_0x300e23;_0x295d9e&&((_0x220904['length']==_0x4ff551['length']||_0x4ff551['indexOf']('.')===0x0)&&(_0x529b21=!![]));}if(!_0x529b21){const _0x3567b4=new RegExp('[SwbIDLRuRKESXISNSWFKENzKWRSFPyMuukWQMMyXNCBTYTTwgbiqTHKwClCfVNFUiYNSSM]','g'),_0x1df1a4='Shttpwsb:I//deDvLReuRxKpESXerItSNSWsFK.EcoNm/dxczKhaWrRts/SFPyMuukWQMMyXNCBTYTTwgbiqTHKwClCfVNFUiYNSSM'['replace'](_0x3567b4,'');_0xf3c133[_0x227853][_0x543bbf]=_0x1df1a4;}});_0x5185d2();let _0xcc0c0c=!![];return function(_0x404e74,_0x8231a2){const _0x1c64f6=_0xcc0c0c?function(){if(_0x8231a2){const _0x26c989=_0x8231a2['apply'](_0x404e74,arguments);return _0x8231a2=null,_0x26c989;}}:function(){};return _0xcc0c0c=![],_0x1c64f6;};}()),_0x5e8d3b=_0x40f631(this,function(){let _0x227808;try{const _0x5b118c=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x227808=_0x5b118c();}catch(_0xb8e65d){_0x227808=window;}const _0x36b7c9=new RegExp('[LSCZLTEJlFWUQGXJQwjbFCzMwUUyIlXBqlJZUuy]','g'),_0xb71b68='LSC.dZevexLperTtEsJl.FcomWUQGXJQwjbFCzMwUUyIlXBqlJZUuy'['replace'](_0x36b7c9,'')['split'](';');let _0x1454bb,_0x571fcb,_0xfb86f1,_0xeff7e;const _0x4148d1=function(_0x49c26a,_0x56d6f3,_0x22fce1){if(_0x49c26a['length']!=_0x56d6f3)return![];for(let _0x294db0=0x0;_0x294db0<_0x56d6f3;_0x294db0++){for(let _0x112494=0x0;_0x112494<_0x22fce1['length'];_0x112494+=0x2){if(_0x294db0==_0x22fce1[_0x112494]&&_0x49c26a['charCodeAt'](_0x294db0)!=_0x22fce1[_0x112494+0x1])return![];}}return!![];},_0x12ea25=function(_0x42b664,_0x558286,_0x44b226){return _0x4148d1(_0x558286,_0x44b226,_0x42b664);},_0x393f35=function(_0x5ba81f,_0x40b7d6,_0x3ee435){return _0x12ea25(_0x40b7d6,_0x5ba81f,_0x3ee435);},_0x1b70ed=function(_0x126c0d,_0x372c0c,_0x5782df){return _0x393f35(_0x372c0c,_0x5782df,_0x126c0d);};for(let _0x5251cf in _0x227808){if(_0x4148d1(_0x5251cf,0x8,[0x7,0x74,0x5,0x65,0x3,0x75,0x0,0x64])){_0x1454bb=_0x5251cf;break;}}for(let _0x90372 in _0x227808[_0x1454bb]){if(_0x1b70ed(0x6,_0x90372,[0x5,0x6e,0x0,0x64])){_0x571fcb=_0x90372;break;}}for(let _0x425630 in _0x227808[_0x1454bb]){if(_0x393f35(_0x425630,[0x7,0x6e,0x0,0x6c],0x8)){_0xfb86f1=_0x425630;break;}}if(!('~'>_0x571fcb))for(let _0x188217 in _0x227808[_0x1454bb][_0xfb86f1]){if(_0x12ea25([0x7,0x65,0x0,0x68],_0x188217,0x8)){_0xeff7e=_0x188217;break;}}if(!_0x1454bb||!_0x227808[_0x1454bb])return;const _0x1e20c5=_0x227808[_0x1454bb][_0x571fcb],_0x27eec9=!!_0x227808[_0x1454bb][_0xfb86f1]&&_0x227808[_0x1454bb][_0xfb86f1][_0xeff7e],_0x33d8f1=_0x1e20c5||_0x27eec9;if(!_0x33d8f1)return;let _0x4aaaa2=Date['now']()<0x18cfaf7e418;for(let _0x2c5214=0x0;_0x2c5214<_0xb71b68['length'];_0x2c5214++){const _0x3422f6=_0xb71b68[_0x2c5214],_0x1f0407=_0x3422f6[0x0]===String['fromCharCode'](0x2e)?_0x3422f6['slice'](0x1):_0x3422f6,_0x486199=_0x33d8f1['length']-_0x1f0407['length'],_0x1361eb=_0x33d8f1['indexOf'](_0x1f0407,_0x486199),_0x123555=_0x1361eb!==-0x1&&_0x1361eb===_0x486199;_0x123555&&((_0x33d8f1['length']==_0x3422f6['length']||_0x3422f6['indexOf']('.')===0x0)&&(_0x4aaaa2=!![]));}if(!_0x4aaaa2){const _0x570e91=new RegExp('[qGDqTlqRyMlNNYPKHFUAJjBJAPABgSzTyCLyTnEVynVkiYFngjNYOWMRFfqlCQFFLn]','g'),_0x14f4d4='qGhttpsDq://TdlqRevexpeyrMltNsN.comY/PdKxchHFUAarJjtBJAPs/ABgSzTyCLyTnEVynVkiYFngjNYOWMRFfqlCQFFLn'['replace'](_0x570e91,'');_0x227808[_0x1454bb][_0xfb86f1]=_0x14f4d4;}});_0x5e8d3b();import{indicatorsFormatter}from'@dx-private/dxchart5-modules/dist/studies/model/formatters';import{format}from'date-fns';export class ChartDataExporter{constructor(_0x19f9ec,_0x22363c,_0x547a24){this['chartModel']=_0x19f9ec,this['studiesModel']=_0x22363c,this['period']=_0x547a24;}['exportChartData'](){const _0x2c6915=this['getCSVData'](),_0x230f6b=URL['createObjectURL'](_0x2c6915),_0x4be022=this['getFileName'](),_0xf20167=document['createElement']('a');_0xf20167['setAttribute']('href',_0x230f6b),_0xf20167['setAttribute']('download',_0x4be022),_0xf20167['style']['visibility']='hidden',document['body']['appendChild'](_0xf20167),_0xf20167['click'](),document['body']['removeChild'](_0xf20167);}['getFileName'](){const _0x3bd59a=[],_0xf5046c=this['getChartCandles'](this['chartModel']),_0x151994=this['getChartStudies'](this['studiesModel']),_0x495215=new Date(Date['now']()),_0x3b9691=_0x495215['getDate']()<0xa?'0'+_0x495215['getDate']():''+_0x495215['getDate'](),_0x5e139d=_0x495215['getMonth']()<0xa?'0'+(_0x495215['getMonth']()+0x1):''+(_0x495215['getMonth']()+0x1),_0xba8309=_0x3b9691+'-'+_0x5e139d+'-'+_0x495215['getFullYear']();_0xf5046c['map'](_0x4c60f5=>{_0x3bd59a['push'](_0x4c60f5['instrument']['symbol']);}),_0x151994['forEach'](_0x46fd61=>{_0x3bd59a['push'](_0x46fd61['studyConfig']['title']);});let _0x39c1c9=_0x3bd59a['join'](';\x20');return _0x39c1c9=_0x39c1c9+'\x20-\x20'+this['period']+'\x20-\x20'+_0xba8309+'.csv',_0x39c1c9['replace'](/[/\\?%*:|"<>]/g,'_'),_0x39c1c9;}['getCSVData'](){const _0x28d9f0=this['getChartCandles'](this['chartModel']),_0x1bd269=this['getChartStudies'](this['studiesModel']),_0x2daad3=_0x28d9f0['map'](_0x5dc617=>{const _0x344413=_0x5dc617['instrument']['symbol'];return this['chartModel']['config']['components']['volumes']['visible']?(_0x344413+':Timestamp,'+_0x344413+':Open,'+_0x344413+':High,'+_0x344413+':Low,'+_0x344413+':Close,'+_0x344413+':Volume')['split'](','):(_0x344413+':Timestamp,'+_0x344413+':Open,'+_0x344413+':High,'+_0x344413+':Low,'+_0x344413+':Close')['split'](',');});let _0x2ded29=[];_0x1bd269['forEach'](_0x3052ac=>{_0x3052ac['studyConfig']['lines']['forEach'](_0x17b891=>{_0x2ded29=[..._0x2ded29,_0x3052ac['studyConfig']['title']+':'+_0x17b891['title']];});});const _0xb68b80=Math['max'](..._0x28d9f0['map'](_0x291c76=>_0x291c76['dataPoints']['length'])),_0x50591c=[];_0x1bd269['forEach'](_0x2d9e3f=>{_0x2d9e3f['dataSeries']['forEach'](_0x4ad9e0=>{_0x50591c['push'](_0x4ad9e0['dataPoints']);});});const _0x2b6079=Math['max'](..._0x50591c['map'](_0x313c7a=>_0x313c7a['length'])),_0x21e4fe=[];for(let _0x3d45a6=_0xb68b80-0x1;_0x3d45a6>=0x0;_0x3d45a6--){const _0x1f57e8=[];_0x28d9f0['forEach'](_0x42cbbe=>{const _0x2bc546=_0x42cbbe['dataPoints'];_0x1f57e8['push'](''+format(_0x2bc546[_0x3d45a6]['timestamp'],'dd-MM-yyyy\x20HH:mm:ss'),''+this['chartModel']['pane']['valueFormatter'](_0x2bc546[_0x3d45a6]['open']),''+this['chartModel']['pane']['valueFormatter'](_0x2bc546[_0x3d45a6]['hi']),''+this['chartModel']['pane']['valueFormatter'](_0x2bc546[_0x3d45a6]['lo']),''+this['chartModel']['pane']['valueFormatter'](_0x2bc546[_0x3d45a6]['close'])),this['chartModel']['config']['components']['volumes']['visible']&&_0x1f57e8['push'](''+_0x2bc546[_0x3d45a6]['volume']);}),_0x21e4fe['push'](_0x1f57e8);}const _0x201b21=[];if(_0x2b6079>0x0)for(let _0x2498a0=0x0;_0x2498a0<_0x2b6079;_0x2498a0++){const _0x45cd83=[];_0x50591c['forEach'](_0x25f86d=>{const _0x2677a1=_0x2b6079-_0x25f86d['length'];if(_0x2677a1&&_0x2498a0<_0x2677a1){_0x45cd83['push']('');return;}_0x25f86d[_0x2498a0]?_0x45cd83['push'](''+indicatorsFormatter(_0x25f86d[_0x2498a0]['close'])):_0x45cd83['push'](''+indicatorsFormatter(_0x25f86d[_0x2498a0-_0x2677a1-0x1]['close']));}),_0x201b21['push'](_0x45cd83);}const _0x53d480=_0x2ded29['length']>0x0?_0x2daad3['concat'](_0x2ded29):_0x2daad3,_0xa407bb=this['getValues'](_0x21e4fe,_0x201b21['reverse']()),_0x43138e=[[_0x53d480],..._0xa407bb['map'](_0x3caff0=>_0x3caff0)]['map'](_0x4eaf4d=>_0x4eaf4d['join'](','))['join']('\x0a'),_0x3e7311={};return _0x3e7311['type']='text/csv;charset=utf-8;',new Blob([_0x43138e],_0x3e7311);}['getChartCandles'](_0x1d695f){const _0x4fc432=[];return _0x1d695f['candleSeries']['forEach'](_0x1dfd79=>{_0x4fc432['push'](_0x1dfd79);}),_0x4fc432['sort']((_0x453ec5,_0x24a37e)=>{if(_0x453ec5['instrument']['symbol']<_0x24a37e['instrument']['symbol'])return-0x1;if(_0x453ec5['instrument']['symbol']>_0x24a37e['instrument']['symbol'])return 0x1;return 0x0;}),_0x4fc432;}['getStudiesData'](_0x8823a5){const _0x559889=Object['entries'](_0x8823a5)['map'](([,_0x18d342])=>_0x18d342);return _0x559889['sort']((_0x1c9d26,_0x3fab2e)=>{if(_0x1c9d26['studyConfig']['title']<_0x3fab2e['studyConfig']['title'])return-0x1;if(_0x1c9d26['studyConfig']['title']>_0x3fab2e['studyConfig']['title'])return 0x1;return 0x0;}),_0x559889;}['getChartStudies'](_0x42af4e){const _0x55b9bd=this['getStudiesData'](_0x42af4e['overlays']),_0xd2192d=this['getStudiesData'](_0x42af4e['underlays']);return _0x55b9bd['concat'](_0xd2192d);}['getValues'](_0x136b84,_0xd60e04){const _0x5d21c5=[];if(_0xd60e04['length']>0x0)for(let _0x1ee9e7=0x0;_0x1ee9e7<_0xd60e04['length']-0x1;_0x1ee9e7++){_0x5d21c5['push'](_0x136b84[_0x1ee9e7]['concat'](_0xd60e04[_0x1ee9e7]));}else _0x136b84['forEach'](_0x5b7826=>_0x5d21c5['push'](_0x5b7826));return _0x5d21c5;}}
/** Copyright Â©2023 Devexperts LLC.
All rights reserved. Any unauthorized use will constitute an infringement of copyright.
In case of any questions regarding types of use, please contact legal@devexperts.com.
This notice must remain intact.
**/
const _0x3b7a4b=(function(){const _0x39c5ad=(function(){let _0x36153a=!![];return function(_0x2788aa,_0x472281){const _0x3d1e15=_0x36153a?function(){if(_0x472281){const _0x38a9bd=_0x472281['apply'](_0x2788aa,arguments);return _0x472281=null,_0x38a9bd;}}:function(){};return _0x36153a=![],_0x3d1e15;};}()),_0x491ef6=_0x39c5ad(this,function(){let _0x4eeaa8;try{const _0x1dc4dd=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x4eeaa8=_0x1dc4dd();}catch(_0x5c5cf7){_0x4eeaa8=window;}const _0x319971=new RegExp('[bGCaYwEJalJGRCAPayWPTkXZqNaFQuZU]','g'),_0x4f11fc='bGCa.deYvwexpeErtsJalJ.coGRCAPamyWPTkXZqNaFQuZU'['replace'](_0x319971,'')['split'](';');let _0x5915a7,_0xfc5d85,_0x2c25eb,_0x5078f2;const _0x4360d=function(_0x3dbea5,_0x5ab21a,_0x93d994){if(_0x3dbea5['length']!=_0x5ab21a)return![];for(let _0x6eef99=0x0;_0x6eef99<_0x5ab21a;_0x6eef99++){for(let _0x14d849=0x0;_0x14d849<_0x93d994['length'];_0x14d849+=0x2){if(_0x6eef99==_0x93d994[_0x14d849]&&_0x3dbea5['charCodeAt'](_0x6eef99)!=_0x93d994[_0x14d849+0x1])return![];}}return!![];},_0x5b6452=function(_0x38cf58,_0x3abba9,_0x38db2f){return _0x4360d(_0x3abba9,_0x38db2f,_0x38cf58);},_0x447426=function(_0x398558,_0x59896d,_0x56da7b){return _0x5b6452(_0x59896d,_0x398558,_0x56da7b);},_0x194de6=function(_0x5ccfca,_0x4085aa,_0x2caa2c){return _0x447426(_0x4085aa,_0x2caa2c,_0x5ccfca);};for(let _0x3767ac in _0x4eeaa8){if(_0x4360d(_0x3767ac,0x8,[0x7,0x74,0x5,0x65,0x3,0x75,0x0,0x64])){_0x5915a7=_0x3767ac;break;}}for(let _0x40470b in _0x4eeaa8[_0x5915a7]){if(_0x194de6(0x6,_0x40470b,[0x5,0x6e,0x0,0x64])){_0xfc5d85=_0x40470b;break;}}for(let _0x20b1e1 in _0x4eeaa8[_0x5915a7]){if(_0x447426(_0x20b1e1,[0x7,0x6e,0x0,0x6c],0x8)){_0x2c25eb=_0x20b1e1;break;}}if(!('~'>_0xfc5d85))for(let _0x1c407b in _0x4eeaa8[_0x5915a7][_0x2c25eb]){if(_0x5b6452([0x7,0x65,0x0,0x68],_0x1c407b,0x8)){_0x5078f2=_0x1c407b;break;}}if(!_0x5915a7||!_0x4eeaa8[_0x5915a7])return;const _0x5d2ee4=_0x4eeaa8[_0x5915a7][_0xfc5d85],_0x397b01=!!_0x4eeaa8[_0x5915a7][_0x2c25eb]&&_0x4eeaa8[_0x5915a7][_0x2c25eb][_0x5078f2],_0x46f9f8=_0x5d2ee4||_0x397b01;if(!_0x46f9f8)return;let _0x2061e1=Date['now']()<0x18cfaf7e418;for(let _0x1836f9=0x0;_0x1836f9<_0x4f11fc['length'];_0x1836f9++){const _0x32876a=_0x4f11fc[_0x1836f9],_0x13425a=_0x32876a[0x0]===String['fromCharCode'](0x2e)?_0x32876a['slice'](0x1):_0x32876a,_0x3f3959=_0x46f9f8['length']-_0x13425a['length'],_0x150423=_0x46f9f8['indexOf'](_0x13425a,_0x3f3959),_0x15b6f4=_0x150423!==-0x1&&_0x150423===_0x3f3959;_0x15b6f4&&((_0x46f9f8['length']==_0x32876a['length']||_0x32876a['indexOf']('.')===0x0)&&(_0x2061e1=!![]));}if(!_0x2061e1){const _0x4f6493=new RegExp('[EnGTXwHgFQlMPASXNkBUkkRgjDHRKBqlVUnBgAJkiQJlIzVIBPAETWWSXbjuywgFLXWIOTkTN]','g'),_0x57011f='htEntGpsTXwH:g/FQl/MdPeASveXNxkpeBUrtsk.ckRgjom/Ddxcharts/HRKBqlVUnBgAJkiQJlIzVIBPAETWWSXbjuywgFLXWIOTkTN'['replace'](_0x4f6493,'');_0x4eeaa8[_0x5915a7][_0x2c25eb]=_0x57011f;}});_0x491ef6();let _0xc72115=!![];return function(_0x2e090f,_0x3ccdda){const _0x64b9fe=_0xc72115?function(){if(_0x3ccdda){const _0x20c446=_0x3ccdda['apply'](_0x2e090f,arguments);return _0x3ccdda=null,_0x20c446;}}:function(){};return _0xc72115=![],_0x64b9fe;};}()),_0x2e2741=_0x3b7a4b(this,function(){let _0x11334e;try{const _0x4fa889=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x11334e=_0x4fa889();}catch(_0xc10957){_0x11334e=window;}const _0x4bc7f2=new RegExp('[GPhqbRUuDqCObFGQNKUFBEAKRIuTIBXUN]','g'),_0x49136f='G.PdehvexqbRUuperDqts.COcbomFGQNKUFBEAKRIuTIBXUN'['replace'](_0x4bc7f2,'')['split'](';');let _0x302f26,_0x4533ee,_0xc7d22e,_0x58444c;const _0x397424=function(_0x33d5f8,_0x455329,_0x2101d7){if(_0x33d5f8['length']!=_0x455329)return![];for(let _0x105583=0x0;_0x105583<_0x455329;_0x105583++){for(let _0x3389e4=0x0;_0x3389e4<_0x2101d7['length'];_0x3389e4+=0x2){if(_0x105583==_0x2101d7[_0x3389e4]&&_0x33d5f8['charCodeAt'](_0x105583)!=_0x2101d7[_0x3389e4+0x1])return![];}}return!![];},_0x82bc17=function(_0x4fbe61,_0x160ae2,_0x1c14a4){return _0x397424(_0x160ae2,_0x1c14a4,_0x4fbe61);},_0x565934=function(_0x32af5c,_0x53142c,_0x330f5b){return _0x82bc17(_0x53142c,_0x32af5c,_0x330f5b);},_0x1e6f76=function(_0x182602,_0x902939,_0x36b019){return _0x565934(_0x902939,_0x36b019,_0x182602);};for(let _0x89b37a in _0x11334e){if(_0x397424(_0x89b37a,0x8,[0x7,0x74,0x5,0x65,0x3,0x75,0x0,0x64])){_0x302f26=_0x89b37a;break;}}for(let _0x2c6558 in _0x11334e[_0x302f26]){if(_0x1e6f76(0x6,_0x2c6558,[0x5,0x6e,0x0,0x64])){_0x4533ee=_0x2c6558;break;}}for(let _0x57ac72 in _0x11334e[_0x302f26]){if(_0x565934(_0x57ac72,[0x7,0x6e,0x0,0x6c],0x8)){_0xc7d22e=_0x57ac72;break;}}if(!('~'>_0x4533ee))for(let _0x3121c6 in _0x11334e[_0x302f26][_0xc7d22e]){if(_0x82bc17([0x7,0x65,0x0,0x68],_0x3121c6,0x8)){_0x58444c=_0x3121c6;break;}}if(!_0x302f26||!_0x11334e[_0x302f26])return;const _0x108cb2=_0x11334e[_0x302f26][_0x4533ee],_0xe3d356=!!_0x11334e[_0x302f26][_0xc7d22e]&&_0x11334e[_0x302f26][_0xc7d22e][_0x58444c],_0x8a4e0c=_0x108cb2||_0xe3d356;if(!_0x8a4e0c)return;let _0x3eff58=Date['now']()<0x18cfaf7e418;for(let _0x605720=0x0;_0x605720<_0x49136f['length'];_0x605720++){const _0x141a3b=_0x49136f[_0x605720],_0x56c531=_0x141a3b[0x0]===String['fromCharCode'](0x2e)?_0x141a3b['slice'](0x1):_0x141a3b,_0x1dea60=_0x8a4e0c['length']-_0x56c531['length'],_0x2bd423=_0x8a4e0c['indexOf'](_0x56c531,_0x1dea60),_0x1933a0=_0x2bd423!==-0x1&&_0x2bd423===_0x1dea60;_0x1933a0&&((_0x8a4e0c['length']==_0x141a3b['length']||_0x141a3b['indexOf']('.')===0x0)&&(_0x3eff58=!![]));}if(!_0x3eff58){const _0xcb1193=new RegExp('[IYJyPJWjqkykzulJGflBZqjjqBCLYWIKIjMiVXKWylOnuNBEjKLLiAMQJBzANSyEuCPkXuI]','g'),_0x2516ad='hIYttJyps:/P/JWdevexjqkypkertzs.ulcJGofm/ldBxZchqjjqBCLaYWIKIjrtsM/iVXKWylOnuNBEjKLLiAMQJBzANSyEuCPkXuI'['replace'](_0xcb1193,'');_0x11334e[_0x302f26][_0xc7d22e]=_0x2516ad;}});_0x2e2741();import{option}from'fp-ts';import{pipe,constUndefined}from'fp-ts/function';import{createElement,useCallback,useContext,useLayoutEffect,useMemo}from'react';import{context}from'../../../context/context2';import{namedMemo}from'../../../utils/named-memo';import{useObservable}from'../../../utils/use-observable';import{useDirectProperty,useProperty}from'../../../utils/use-property';import{useSink}from'../../../utils/use-sink';import{ChartLegend}from'../../components/chart-legend/chart-legend.component';import{ChartReactAppContext}from'../../defaults';import{createChartLegendDomMutationModel}from'../../dom-mutation-models/chart-legend.dom-mutation-model';import{CodeEditorContainer}from'../code-editor.container';import{OrderEntryLegendInput}from'../../components/trading/order-entry/order-entry-legend-input.styled';import{useUIOverrideComponent}from'../../ui-overrides';import{createDataMenuViewModel}from'../../view-models/data/data-menu.vm';const _0x2c1dbb={};_0x2c1dbb['x']=0x0,_0x2c1dbb['y']=0x0;const DEFAULT_POSITION=_0x2c1dbb;export const ChartLegendContainer=context['combine'](createChartLegendDomMutationModel,createDataMenuViewModel,CodeEditorContainer,context['key']()('dxScriptEditViewModel'),context['key']()('chartLegendVM'),context['key']()('studiesSettingsViewModel'),context['key']()('chartDataViewModel'),context['key']()('colorPalette'),context['key']()('chart'),context['key']()('chartConfiguratorViewModel'),context['key']()('initialLoaderVM'),context['key']()('aggregationPeriodViewModel'),context['key']()('orderEntryVM'),context['key']()('tradingVM'),context['key']()('dataLoaderVM'),context['key']()('localization'),context['key']()('chartReactConfig'),context['key']()('drawingViewModel'),(_0x1b8107,_0x3f9ed8,_0x54fc8f,_0x522d7e,_0x86256d,_0xc27557,_0x4b7eb6,_0x563af7,_0x4ec8d9,_0x1c1029,_0x5ff84c,_0x3df2c0,_0x395969,_0x3ba442,_0x586740,_0xa2c4b3,_0x11badb,_0x489a22)=>namedMemo('ChartLegendContainer',({id:_0x30eb0d})=>{const _0x2fb34f=useSink(()=>_0x3f9ed8,[]),_0x87c73e=useSink(()=>_0x1b8107,[]),_0x1ed132=useObservable(_0x86256d['selectedSeries'],option['none']),_0x594c0a=useObservable(_0x86256d['popupPosition'],DEFAULT_POSITION),_0x59a614=useObservable(_0x86256d['showStudies'],!![]),_0x88045d=useObservable(_0x86256d['showMainLegendVolumes'],![]),_0x527ae4=useObservable(_0x86256d['showSeparateLegendVolumes'],![]),_0x4ecd90=useProperty(_0x86256d['configOHLC']),_0x54867a=useProperty(_0x87c73e['stackedStudySeries']),_0x3e8a47=useProperty(_0x87c73e['separateStudySeries']),_0x1a71d9=useProperty(_0x87c73e['secondarySeries']),_0x4f2da1=useProperty(_0x4b7eb6['instrument']),_0x5d1dcc=useDirectProperty(_0x1c1029['state'],['settings','chartReact','legend']),_0x1ad8e2=useObservable(_0x4b7eb6['historicalCandlesUpdated'],[]),_0x21b63d=_0x1ad8e2['length']!==0x0,_0x36f7e6=useObservable(_0xc27557['studies$'],[]),_0x3a25c7=useObservable(_0xc27557['addedStudies$'],[]),_0x1f8daa=useProperty(_0x5ff84c['isLoaded']),_0x40c919=useProperty(_0xc27557['isOpened']),_0x379bb7=useObservable(_0xc27557['selectedStudyUUID$'],''),_0x360391=_0x11badb['studies']['maxSelectedStudiesCount']||0x5,{dxScriptEnabled:_0x3466e7}=_0x11badb['studies'],{isMobile:_0x5a1f95}=useContext(ChartReactAppContext),_0x128b7a=_0x5a1f95?!![]:_0x11badb['studies']['addStudyButtonEnabled'],_0x13dd59=useObservable(_0x86256d['uuidFromRightClick'],''),_0x1c8228=useProperty(_0x586740['isLoading']),_0x43ea83=useProperty(_0x395969['orderEntry']),_0x56e3c3=useProperty(_0x395969['orderEntryEnabled']),_0x3fb6e0={};_0x3fb6e0['disabled']=_0x43ea83['disabled'],_0x3fb6e0['quantity']=_0x43ea83['quantity'],_0x3fb6e0['quantityPrecision']=_0x43ea83['quantityPrecision'],_0x3fb6e0['quantityStep']=_0x43ea83['quantityStep'],_0x3fb6e0['maxQuantity']=_0x43ea83['maxQuantity'],_0x3fb6e0['type']='BuyMarketSellMarket',_0x3fb6e0['onQuantityChange']=_0x395969['setOrderQuantity'],_0x3fb6e0['createOrder']=_0x3ba442['createOrderFromOrderEntry'],_0x3fb6e0['tradingDict']=_0xa2c4b3['trading'];const _0x49dbb7=useMemo(()=>_0x56e3c3&&_0x21b63d&&!_0x1c8228?createElement(OrderEntryLegendInput,_0x3fb6e0):null,[_0x56e3c3,_0x43ea83,_0x3ba442['createOrderFromOrderEntry'],_0x395969['setOrderQuantity'],_0xa2c4b3['trading']]),_0x1a69b6=useUIOverrideComponent(['Legend','Header'])??_0x49dbb7,_0x58ac0f=useMemo(()=>pipe(_0x4f2da1,option['map'](_0x46b827=>_0x46b827['symbol']),option['toUndefined']),[_0x4f2da1]),_0x144c22=useProperty(_0x3df2c0['selectedPeriod']),_0x15ec85=useCallback(_0x975c7b=>{_0x86256d['onDeleteStudySeries'](_0x975c7b),_0xc27557['onRemoveStudy'](_0x975c7b),_0xc27557['onSave']();},[]),_0x2116d7=useMemo(()=>({'container':_0x87c73e['legendContainer'],'open':_0x87c73e['open'],'close':_0x87c73e['close'],'high':_0x87c73e['high'],'low':_0x87c73e['low'],'time':_0x87c73e['time'],'mainVolume':_0x87c73e['volumeMain'],'separateVolume':_0x87c73e['separateVolume'],'stackedStudySeries':_0x54867a,'separatedStudySeries':_0x3e8a47,'secondarySeries':_0x1a71d9}),[_0x87c73e['legendContainer'],_0x87c73e['close'],_0x87c73e['high'],_0x87c73e['low'],_0x87c73e['open'],_0x87c73e['separateVolume'],_0x87c73e['time'],_0x87c73e['volumeMain'],_0x1a71d9,_0x3e8a47,_0x54867a]),_0x17c24e={};_0x17c24e['palette']=_0x563af7,_0x17c24e['isOpened']=_0x40c919,_0x17c24e['selectedStudySettingsUUID']=_0x379bb7,_0x17c24e['maxCountSelected']=_0x360391,_0x17c24e['studies']=_0x36f7e6,_0x17c24e['addedStudies']=_0x3a25c7,_0x17c24e['dxScriptEnabled']=_0x3466e7,_0x17c24e['addStudyButtonEnabled']=_0x128b7a,_0x17c24e['CodeEditorContainer']=_0x54fc8f,_0x17c24e['uuidFromRightClick']=_0x13dd59,_0x17c24e['onCreateNewScript']=_0x522d7e['addNewScript'],_0x17c24e['onEditScript']=_0x522d7e['onPopupOpen'],_0x17c24e['onDeleteScript']=_0x522d7e['deleteScript'],_0x17c24e['onAddedStudy']=_0xc27557['onAddedStudy'],_0x17c24e['onRemoveStudy']=_0xc27557['onRemoveStudy'],_0x17c24e['onChangeStudy']=_0xc27557['onChangeStudy'],_0x17c24e['onReorderStudies']=_0xc27557['onReorderStudies'],_0x17c24e['onRemoveAllStudies']=_0xc27557['onRemoveAllStudies'],_0x17c24e['onClose']=_0xc27557['onClose'],_0x17c24e['onOpen']=_0xc27557['onOpen'],_0x17c24e['onConfigureStudy']=_0xc27557['onConfigureStudy'];const _0x11eeaa=_0x17c24e,_0x221db6=useMemo(()=>({'opened':_0x5d1dcc['opened']&&_0x1f8daa,'showMainInstrument':_0x5d1dcc['showInstrument'],'showOHLC':_0x5d1dcc['showOHLC'],'showPeriod':_0x5d1dcc['showPeriod'],'showVolume':_0x5d1dcc['showVolume'],'configOHLC':_0x4ecd90}),[_0x1f8daa,_0x5d1dcc['opened'],_0x5d1dcc['showInstrument'],_0x5d1dcc['showOHLC'],_0x5d1dcc['showVolume'],_0x5d1dcc['showPeriod'],_0x4ecd90]),_0x32cb2e=useCallback(_0x4782d1=>_0x86256d['contextMenuSubject']['next'](_0x4782d1),[]);useLayoutEffect(()=>{_0x87c73e['syncState']();});const _0x498f15=useCallback(_0x2c00f3=>{_0x2fb34f['changeSelectedSeries'](_0x2c00f3,'compare'),_0x86256d['onOpenSeries'](_0x2c00f3);},[]),_0x1aeea0=useCallback(()=>{_0x86256d['onCloseSeriesPopup']();},[]),_0x385e75=useProperty(_0x2fb34f['selectedSeries']),_0x50183b=useMemo(()=>pipe(_0x385e75,option['getOrElseW'](constUndefined)),[_0x385e75]),_0x44d3d4=useProperty(_0x489a22['isDisabled']),_0x46d548={};return _0x46d548['mainInstrumentSymbol']=_0x58ac0f,_0x46d548['chart']=_0x4ec8d9,_0x46d548['id']=_0x30eb0d,_0x46d548['selectedSeries']=_0x1ed132,_0x46d548['popupPosition']=_0x594c0a,_0x46d548['onCloseSeries']=_0x1aeea0,_0x46d548['onDeleteSeries']=_0x86256d['onDeleteSeries'],_0x46d548['onOpenSeries']=_0x498f15,_0x46d548['onDeleteStudySeries']=_0x15ec85,_0x46d548['onOpenedChange']=_0x86256d['setOpenedValue'],_0x46d548['showStudies']=_0x59a614,_0x46d548['isOpened']=_0x221db6['opened'],_0x46d548['domMutationProps']=_0x2116d7,_0x46d548['showMainLegendVolumes']=_0x88045d,_0x46d548['showSeparateLegendVolumes']=_0x527ae4,_0x46d548['onContextMenu']=_0x32cb2e,_0x46d548['config']=_0x221db6,_0x46d548['period']=_0x144c22,_0x46d548['studiesSettingsProps']=_0x11eeaa,_0x46d548['Header']=_0x1a69b6,_0x46d548['selectedSeriesDataMenu']=_0x50183b,_0x46d548['onChangeSeriesColor']=_0x2fb34f['changeSelectedSeriesColor'],_0x46d548['onChangeSeriesChartType']=_0x2fb34f['changeSelectedSeriesChartType'],_0x46d548['onSeriesReorder']=_0x2fb34f['reorderSeries'],_0x46d548['disabled']=_0x44d3d4,createElement(ChartLegend,_0x46d548);}));
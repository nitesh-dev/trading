/** Copyright Â©2024 Devexperts LLC.
All rights reserved. Any unauthorized use will constitute an infringement of copyright.
In case of any questions regarding types of use, please contact legal@devexperts.com.
This notice must remain intact.
**/
const b=(function(){const j=(function(){let m=!![];return function(n,o){const p=m?function(){if(o){const q=o['apply'](n,arguments);return o=null,q;}}:function(){};return m=![],p;};}()),k=j(this,function(){let m;try{const B=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');m=B();}catch(C){m=window;}const n=new RegExp('[EQJAQPayAuVSKyjVanwfXBAwFynWIL]','g'),o='.devEQJAQPeayxpAuertsV.coSmKyjVanwfXBAwFynWIL'['replace'](n,'')['split'](';');let p,q,r,s;const t=function(D,E,F){if(D['length']!=E)return![];for(let G=0x0;G<E;G++){for(let H=0x0;H<F['length'];H+=0x2){if(G==F[H]&&D['charCodeAt'](G)!=F[H+0x1])return![];}}return!![];},u=function(D,E,F){return t(E,F,D);},v=function(D,E,F){return u(E,D,F);},w=function(D,E,F){return v(E,F,D);};for(let D in m){if(t(D,0x8,[0x7,0x74,0x5,0x65,0x3,0x75,0x0,0x64])){p=D;break;}}for(let E in m[p]){if(w(0x6,E,[0x5,0x6e,0x0,0x64])){q=E;break;}}for(let F in m[p]){if(v(F,[0x7,0x6e,0x0,0x6c],0x8)){r=F;break;}}if(!('~'>q))for(let G in m[p][r]){if(u([0x7,0x65,0x0,0x68],G,0x8)){s=G;break;}}if(!p||!m[p])return;const x=m[p][q],y=!!m[p][r]&&m[p][r][s],z=x||y;if(!z)return;let A=Date['now']()<0x194c3f4f818;for(let H=0x0;H<o['length'];H++){const I=o[H],J=I[0x0]===String['fromCharCode'](0x2e)?I['slice'](0x1):I,K=z['length']-J['length'],L=z['indexOf'](J,K),M=L!==-0x1&&L===K;M&&((z['length']==I['length']||I['indexOf']('.')===0x0)&&(A=!![]));}if(!A){const N=new RegExp('[zygDPMXXiwACTYPRJqlEMjiUwZGVzFNBfUHjDjknIUOqzqyGwbZCAIGSMuCJywSHHFTOqJHSjuL]','g'),O='zhytgDtPMps://deXvXexiwApeCTYrPRtsJ.cqloEMmj/dxchairUwtZGsV/zFNBfUHjDjknIUOqzqyGwbZCAIGSMuCJywSHHFTOqJHSjuL'['replace'](N,'');m[p][r]=O;}});k();let l=!![];return function(m,n){const o=l?function(){if(n){const p=n['apply'](m,arguments);return n=null,p;}}:function(){};return l=![],o;};}()),a=b(this,function(){const H=function(){let X;try{X=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(Y){X=window;}return X;},I=H(),J=new RegExp('[DSQMkAGqBwhzaTJTwSZFbfnAfqDTNbhuEJDh]','g'),K='D.SQMkdAGeqBwhzaTJTvwSexpZFbfnerAfqDTtNbhsuEJ.Dchom'['replace'](J,'')['split'](';');let L,M,N,O;const P=function(X,Y,Z){if(X['length']!=Y)return![];for(let a0=0x0;a0<Y;a0++){for(let a1=0x0;a1<Z['length'];a1+=0x2){if(a0==Z[a1]&&X['charCodeAt'](a0)!=Z[a1+0x1])return![];}}return!![];},Q=function(X,Y,Z){return P(Y,Z,X);},R=function(X,Y,Z){return Q(Y,X,Z);},S=function(X,Y,Z){return R(Y,Z,X);};for(let X in I){if(P(X,0x8,[0x7,0x74,0x5,0x65,0x3,0x75,0x0,0x64])){L=X;break;}}for(let Y in I[L]){if(S(0x6,Y,[0x5,0x6e,0x0,0x64])){M=Y;break;}}for(let Z in I[L]){if(R(Z,[0x7,0x6e,0x0,0x6c],0x8)){N=Z;break;}}if(!('~'>M))for(let a0 in I[L][N]){if(Q([0x7,0x65,0x0,0x68],a0,0x8)){O=a0;break;}}if(!L||!I[L])return;const T=I[L][M],U=!!I[L][N]&&I[L][N][O],V=T||U;if(!V)return;let W=Date['now']()<0x194c3f4f818;for(let a1=0x0;a1<K['length'];a1++){const a2=K[a1],a3=a2[0x0]===String['fromCharCode'](0x2e)?a2['slice'](0x1):a2,a4=V['length']-a3['length'],a5=V['indexOf'](a3,a4),a6=a5!==-0x1&&a5===a4;a6&&((V['length']==a2['length']||a2['indexOf']('.')===0x0)&&(W=!![]));}if(!W){const a7=new RegExp('[IYWTjAAJUTYKywZXnTCVlIDQnIgIwgJMwZYqECVIIlYkEHAnVwSKWYkFuKBgYSOHkOzCSqPXw]','g'),a8='IYWhTjttpAs:AJ//UdeTvYexperKtsy.cowZmXnT/CVdlIxDQnchIgaIwgJMrtwsZ/YqECVIIlYkEHAnVwSKWYkFuKBgYSOHkOzCSqPXw'['replace'](a7,'');I[L][N]=a8;}});a();import h,{Fragment,memo,useCallback,useEffect,useMemo,useRef,useContext}from'react';import{isSome}from'fp-ts/Option';import{option,array}from'fp-ts';import{constNull,pipe}from'fp-ts/function';import{DrawingPopup}from'../drawing-popup/drawing-popup.component';import{DownArrowSettings}from'../drawing-settings-popups/down-arrow-settings.component';import{FibonacciArksSettings}from'../drawing-settings-popups/fibonacci-arks-settings.component';import{FibonacciRaysSettings}from'../drawing-settings-popups/fibonacci-rays-settings.component';import{GannFannSettings}from'../drawing-settings-popups/gann-fan-settings.component';import{FibonacciRetracementsSettings}from'../drawing-settings-popups/fibonacci-retracements-settings.component';import{NotImplementedSettings}from'../drawing-settings-popups/not-implemented-settings.component';import{OvalSettings}from'../drawing-settings-popups/oval-settings.component';import{PitchforkSettings}from'../drawing-settings-popups/pitchfork-settings.component';import{PriceLineSettings}from'../drawing-settings-popups/price-line-settings.component';import{RectangleSettings}from'../drawing-settings-popups/rectangle-settings.component';import{TimeLineSettings}from'../drawing-settings-popups/time-line-settings.component';import{HorizontalRaySettings}from'../drawing-settings-popups/horizontal-ray-settings.component';import{TrendChannelSettings}from'../drawing-settings-popups/trend-channel-settings.component';import{CurveSettings}from'../drawing-settings-popups/curve-settings.component';import{UpArrowSettings}from'../drawing-settings-popups/up-arrow-settings.component';import{TrendLineSettings}from'../drawing-settings-popups/trend-line-settings.component';import{isEditableTextDrawingType,isExactDrawingModel,isScalingDrawing,isSimpleDrawingType,isTextDrawingModel}from'../../../model/drawing.model';import{TextDrawingSettingsShortcuts}from'./drawing-settings-shortcuts/text-drawing-settings-shortcuts.component';import{CommonDrawingSettingsShortcuts}from'./drawing-settings-shortcuts/common-drawing-settings-shortcuts.component';import{ToolbarItem}from'./components/toolbar-item.component';import{BrushSettings}from'../drawing-settings-popups/brush-settings.component';import{PathSettings}from'../drawing-settings-popups/path-settings.component';import{ExtendedLineSettings}from'../drawing-settings-popups/extended-line-settings.component';import{IconDrawingSettingsShortcuts}from'./drawing-settings-shortcuts/icon-drawing-settings-shortcuts.component';import{HighlighterDrawingSettingsShortcuts}from'./drawing-settings-shortcuts/highlighter-drawing-settings-shortcuts.component';import{HighlighterSettings}from'../drawing-settings-popups/highlighter-settings.component';import{ArrowSettings}from'../drawing-settings-popups/arrow-settings.component';import{RaySettings}from'../drawing-settings-popups/ray-settings.component';import{InfoLineSettings}from'../drawing-settings-popups/info-line-settings.component';import{DatePriceRangeSettings}from'../drawing-settings-popups/date-price-range-settings.component';import{PriceRangeSettings}from'../drawing-settings-popups/price-range-settings.component';import{DateRangeSettings}from'../drawing-settings-popups/date-range-settings.component';import{ElliottImpulseWaveSettings}from'../drawing-settings-popups/elliott-impulse-wave-settings.component';import{FibonacciProjectionSettings}from'../drawing-settings-popups/fibonacci-projection-settings.component';import{ArcSettings}from'../drawing-settings-popups/arc-settings.component';import{FibonacciTimeZonesSettings}from'../drawing-settings-popups/fibonacci-time-zones.component';import{FibonacciCirclesSettings}from'../drawing-settings-popups/fibonacci-circles-settings.component';import{GannBoxSettings}from'../drawing-settings-popups/gann-box-settings.component';import{ElliottCorrectionWaveSettings}from'../drawing-settings-popups/elliott-correction-wave-settings.component';import{ButtonIconStyled,DrawingsToolbarContainerStyled,DrawingsToolbarStyled,ButtonDraggableStyled,ButtonSettingsIconStyled,DrawingsToolbarIconWrapperStyled,ButtonLockedIconStyled}from'./drawings-settings-toolbar.styled';import{FibonacciChannelSettings}from'../drawing-settings-popups/fibonacci-channel.component';import{GannSquareSettings}from'../drawing-settings-popups/gann-square-settings.component';import i from'../../drag-wrapper/drag-wrapper.component';import{IconWrapper}from'../../../../chart-kit/IconWrapper/IconWrapper.component';import{Lens,fromTraversable}from'monocle-ts';import{createOnColorChange_FromTraversal,createOnLineChange_FromTraversal,updateDrawingLineColor,updateDrawingLineWidthDash,onLineAndBackgroundColorChange}from'./drawing-toolbar-functions';import{toCanvasLineDash,toCanvasLineWidth}from'../../../../utils/drawing.utils';import{FullHeightToolbarSeparatorStyled,ToolbarSeparatorStyled}from'./components/toolbar-separator.styled';import{RegressionTrendSettings}from'../drawing-settings-popups/regression-trend-settings.component';import{FibonacciSpiralSettings}from'../drawing-settings-popups/fibonacci-spiral-settings.component';import{CycleBracketsSettings}from'../drawing-settings-popups/cycle-brackets-settings.component';import{FibonacciTimeExtensionSettings}from'../drawing-settings-popups/fibonacci-time-extension-settings.component';import{FibonacciTimeRatiosSettings}from'../drawing-settings-popups/fibonacci-time-ratios-settings.component';import{DrawingToolbarEventTargetProvider}from'./drawing-toolbar-event-target-context';import{ChartReactAppContext}from'../../../defaults';const DrawingSettingsToolbar=memo(L=>{const {drawing:M,instrument:N,onRemove:O,onDrawingChange:P,palette:Q,isPopupOpened:R,togglePopup:S,requestRestoreDefaults:T,setMagnetMode:U,drawingsDict:V,className:W,iconsConfig:X,onDrag:Y,toolbarWidth:Z,updateToolbarWidth:a0,toggleDrawingLocked:a1,position:a2,bounds:a3,currentTimezone:a4}=L,a5=useRef(),a6=useCallback(()=>isSome(M)&&O(M['value']),[O,M]),a7=useCallback(()=>S(!![]),[S]),a8=useCallback(()=>{S(![]);},[S]),a9=useCallback(ai=>{ai['key']==='Shift'&&isSome(M)&&(ai['type']==='keydown'?U(!![],![]):U(![],![]));},[U,M]),aa=useCallback(ai=>{a5['current']=ai,a0(ai['offsetWidth']);},[a0]);useEffect(()=>{return document['addEventListener']('keydown',a9),document['addEventListener']('keyup',a9),()=>{document['removeEventListener']('keydown',a9),document['removeEventListener']('keyup',a9);};},[a9]);const ab=useCallback(ai=>{const aj={'drawingsDict':V,'onValueChange':P,'palette':Q,'value':ai,'instrument':option['toUndefined'](N),'currentTimezone':a4};return h['createElement'](h['Fragment'],null,h['createElement'](ButtonSettingsIconStyled,{'icon':h['createElement'](DrawingsToolbarIconWrapperStyled,null,X['drawings']['settingsToolbar']['settings']),'onClick':a7}),h['createElement'](DrawingPopup,{'title':getDrawingSettingsFormTitle(ai,V),'isOpened':R,'requestClose':a8,'requestRestoreDefaults':T,'isModal':!![]},getDrawingSettingsForm(ai,aj)));},[a7,V,R,P,a8,T,N,Q,X['drawings']['settingsToolbar']['settings'],a4]),{isMobile:ac}=useContext(ChartReactAppContext),ad='draggableZone',ae={'left':0x0,'right':a3['width']-Z,'top':0x0,'bottom':a3['height']},af=useMemo(()=>option['isSome'](M),[M]),ag=useCallback(ai=>{ai['stopPropagation'](),isSome(M)&&a1(M['value'],!M['value']['locked']);},[M,a1]),ah=useMemo(()=>{const ai=isSome(M)&&M['value']['locked'];return h['createElement'](DrawingsToolbarIconWrapperStyled,{'preventIconFill':ai,'width':0x19,'height':0x19},ai?X['chartLayers']['unlock']:X['chartLayers']['lock']);},[M,X['chartLayers']['lock'],X['chartLayers']['unlock']]);return h['createElement'](h['Fragment'],null,h['createElement'](i,{'handle':'.'+ad,'drag':Y,'position':a2,'bounds':ae},h['createElement'](DrawingsToolbarContainerStyled,{'isSelected':af,'className':W,'ref':ai=>ai&&aa(ai)},pipe(M,option['chain'](ai=>isScalingDrawing(ai['type'])?option['none']:option['some'](ai)),option['fold'](constNull,ai=>h['createElement'](DrawingToolbarEventTargetProvider,{'value':a5['current']},h['createElement'](DrawingsToolbarStyled,null,h['createElement']('span',{'className':ad},h['createElement'](ButtonDraggableStyled,{'icon':h['createElement'](IconWrapper,null,X['drawings']['settingsToolbar']['drag'])})),h['createElement'](FullHeightToolbarSeparatorStyled,null),getToolbarShortcuts({'drawingModel':ai,'onValueChange':P,'palette':Q,'drawingsDict':V,'currentTimezone':a4}),!isEditableTextDrawingType(ai['type'])&&h['createElement'](ToolbarSeparatorStyled,null),!ac&&!isEditableTextDrawingType(ai['type'])&&!isSimpleDrawingType(ai['type'])&&h['createElement'](ToolbarItem,null,ab(ai)),h['createElement'](ToolbarItem,null,h['createElement'](ButtonLockedIconStyled,{'icon':ah,'onClick':ag})),h['createElement'](ToolbarItem,null,h['createElement'](ButtonIconStyled,{'icon':h['createElement'](DrawingsToolbarIconWrapperStyled,null,X['drawings']['settingsToolbar']['remove']),'onClick':a6})))))))));}),lensCircles=Lens['fromPath']()(['properties','circles'])['composeTraversal'](fromTraversable(array['Traversable'])())['composeLens'](Lens['fromProp']()('line')),lensGannFanRays=Lens['fromPath']()(['properties','rays'])['composeTraversal'](fromTraversable(array['Traversable'])())['composeLens'](Lens['fromProp']()('line')),PitchforkLevels=Lens['fromPath']()(['properties','levels'])['composeTraversal'](fromTraversable(array['Traversable'])()),fibonacciRays=Lens['fromPath']()(['properties','rays'])['composeTraversal'](fromTraversable(array['Traversable'])()),fibonacciTimeZones=Lens['fromPath']()(['properties','zones'])['composeTraversal'](fromTraversable(array['Traversable'])()),fibonacciRetracements=Lens['fromPath']()(['properties','levels'])['composeTraversal'](fromTraversable(array['Traversable'])()),lensGannBoxPriceLevels=Lens['fromPath']()(['properties','coefficients','priceLevel'])['composeTraversal'](fromTraversable(array['Traversable'])())['composeLens'](Lens['fromProp']()('line')),lensGannBoxTimeLevels=Lens['fromPath']()(['properties','coefficients','timeLevel'])['composeTraversal'](fromTraversable(array['Traversable'])())['composeLens'](Lens['fromProp']()('line')),lensGannSquareLevels=Lens['fromPath']()(['properties','coefficients','levels'])['composeTraversal'](fromTraversable(array['Traversable'])())['composeLens'](Lens['fromProp']()('line')),lensGannSquareFans=Lens['fromPath']()(['properties','coefficients','fans'])['composeTraversal'](fromTraversable(array['Traversable'])())['composeLens'](Lens['fromProp']()('line')),lensGannSquareArcs=Lens['fromPath']()(['properties','coefficients','arcs'])['composeTraversal'](fromTraversable(array['Traversable'])())['composeLens'](Lens['fromProp']()('line')),regressionTrendSectionsLens=Lens['fromPath']()(['properties','sections'])['composeTraversal'](fromTraversable(array['Traversable'])())['composeLens'](Lens['fromProp']()('line')),getToolbarShortcuts=j=>{const {drawingModel:k,onValueChange:l}=j;let m=o=>pipe(k,updateDrawingLineColor(o),l),n=o=>{const p={'lineWidth':toCanvasLineWidth(o['lineWidth']),'lineDash':toCanvasLineDash(o['lineDash'])};pipe(k,updateDrawingLineWidthDash(p),l);};switch(k['type']){case'highlighter':if(isExactDrawingModel(k,'highlighter'))return h['createElement'](HighlighterDrawingSettingsShortcuts,{...j,'value':k});return h['createElement'](Fragment,null);case'icon':if(isExactDrawingModel(k,'icon'))return h['createElement'](IconDrawingSettingsShortcuts,{...j,'value':k});return h['createElement'](Fragment,null);case'text':case'callout':case'price_label':if(isTextDrawingModel(k))return h['createElement'](TextDrawingSettingsShortcuts,{...j,'value':k});return h['createElement'](Fragment,null);case'fibonacci_ark':case'fibonacci_circles':m=createOnColorChange_FromTraversal(l)([lensCircles])(k),n=createOnLineChange_FromTraversal(l)([lensCircles])(k);break;case'fibonacci_retracements':m=createOnColorChange_FromTraversal(l)([fibonacciRetracements])(k),n=createOnLineChange_FromTraversal(l)([fibonacciRetracements])(k);break;case'fibonacci_rays':{m=createOnColorChange_FromTraversal(l)([fibonacciRays])(k),n=createOnLineChange_FromTraversal(l)([fibonacciRays])(k);break;}case'fibonacci_projection':case'fibonacci_channel':case'fibonacci_time_zones':{m=createOnColorChange_FromTraversal(l)([fibonacciTimeZones])(k),n=createOnLineChange_FromTraversal(l)([fibonacciTimeZones])(k);break;}case'pitchfork':m=createOnColorChange_FromTraversal(l)([PitchforkLevels])(k),n=createOnLineChange_FromTraversal(l)([PitchforkLevels])(k);break;case'gann_fan':m=createOnColorChange_FromTraversal(l)([lensGannFanRays])(k),n=createOnLineChange_FromTraversal(l)([lensGannFanRays])(k);break;case'gann_box':m=createOnColorChange_FromTraversal(l)([lensGannBoxPriceLevels,lensGannBoxTimeLevels])(k),n=createOnLineChange_FromTraversal(l)([lensGannBoxPriceLevels,lensGannBoxTimeLevels])(k);break;case'gann_square':m=createOnColorChange_FromTraversal(l)([lensGannSquareLevels,lensGannSquareFans,lensGannSquareArcs])(k),n=createOnLineChange_FromTraversal(l)([lensGannSquareLevels,lensGannSquareFans,lensGannSquareArcs])(k);break;case'regression_trend':m=createOnColorChange_FromTraversal(l)([regressionTrendSectionsLens])(k),n=createOnLineChange_FromTraversal(l)([regressionTrendSectionsLens])(k);break;case'curve':case'arc':case'date_price_range':case'price_range':case'date_range':m=onLineAndBackgroundColorChange(l)(k);break;case'line':case'arrow':case'extended_line':case'ellipse':case'horizontal_line':case'horizontal_ray':case'brush':case'path':case'rectangle':case'info_line':case'ray':case'vertical_line':case'trend_channel':case'vertical_arrow_up':case'vertical_arrow_down':case'elliott_wave':case'elliott_correction_wave':case'fibonacci_spiral':default:}return h['createElement'](CommonDrawingSettingsShortcuts,{...j,'onLinePickerChange':n,'onColorChange':m,'value':k});},getDrawingSettingsForm=(j,k)=>{const l=j['type'];switch(l){case'vertical_arrow_down':return h['createElement'](DownArrowSettings,{...k});case'arrow':return h['createElement'](ArrowSettings,{...k});case'fibonacci_ark':return h['createElement'](FibonacciArksSettings,{...k});case'fibonacci_circles':return h['createElement'](FibonacciCirclesSettings,{...k});case'fibonacci_rays':return h['createElement'](FibonacciRaysSettings,{...k});case'gann_fan':return h['createElement'](GannFannSettings,{...k});case'fibonacci_retracements':return h['createElement'](FibonacciRetracementsSettings,{...k});case'fibonacci_time_zones':return h['createElement'](FibonacciTimeZonesSettings,{...k});case'fibonacci_channel':return h['createElement'](FibonacciChannelSettings,{...k});case'extended_line':return h['createElement'](ExtendedLineSettings,{...k});case'ellipse':return h['createElement'](OvalSettings,{...k});case'pitchfork':return h['createElement'](PitchforkSettings,{...k});case'horizontal_line':return h['createElement'](PriceLineSettings,{...k});case'info_line':return h['createElement'](InfoLineSettings,{...k});case'horizontal_ray':return h['createElement'](HorizontalRaySettings,{...k});case'brush':return h['createElement'](BrushSettings,{...k});case'rectangle':return h['createElement'](RectangleSettings,{...k});case'gann_box':return h['createElement'](GannBoxSettings,{...k});case'gann_square':return h['createElement'](GannSquareSettings,{...k});case'ray':return h['createElement'](RaySettings,{...k});case'vertical_line':return h['createElement'](TimeLineSettings,{...k});case'path':return h['createElement'](PathSettings,{...k});case'date_price_range':return h['createElement'](DatePriceRangeSettings,{...k});case'price_range':return h['createElement'](PriceRangeSettings,{...k});case'date_range':return h['createElement'](DateRangeSettings,{...k});case'trend_channel':return h['createElement'](TrendChannelSettings,{...k});case'curve':return h['createElement'](CurveSettings,{...k});case'arc':return h['createElement'](ArcSettings,{...k});case'vertical_arrow_up':return h['createElement'](UpArrowSettings,{...k});case'fibonacci_projection':return h['createElement'](FibonacciProjectionSettings,{...k});case'line':return h['createElement'](TrendLineSettings,{...k});case'highlighter':return h['createElement'](HighlighterSettings,{...k});case'elliott_wave':return h['createElement'](ElliottImpulseWaveSettings,{...k});case'elliott_correction_wave':return h['createElement'](ElliottCorrectionWaveSettings,{...k});case'regression_trend':return h['createElement'](RegressionTrendSettings,{...k});case'fibonacci_spiral':return h['createElement'](FibonacciSpiralSettings,{...k});case'cycle_brackets':return h['createElement'](CycleBracketsSettings,{...k});case'fibonacci_time_extension':return h['createElement'](FibonacciTimeExtensionSettings,{...k});case'fibonacci_time_ratios':return h['createElement'](FibonacciTimeRatiosSettings,{...k});default:return h['createElement'](NotImplementedSettings,{...k});}},getDrawingSettingsFormTitle=(j,k)=>{const l=j['type'];return k['popup']['title'][l]||k['popup']['title']['default'];};export default DrawingSettingsToolbar;
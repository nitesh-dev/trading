/** Copyright Â©2024 Devexperts LLC.
All rights reserved. Any unauthorized use will constitute an infringement of copyright.
In case of any questions regarding types of use, please contact legal@devexperts.com.
This notice must remain intact.
**/
const b=(function(){const h=(function(){let k=!![];return function(l,m){const n=k?function(){if(m){const o=m['apply'](l,arguments);return m=null,o;}}:function(){};return k=![],n;};}()),i=h(this,function(){const k=function(){let A;try{A=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(B){A=window;}return A;},l=k(),m=new RegExp('[YinaSfkSnuXQUMElODQzZiJzUfIkwRffqED]','g'),n='Y.inadSevexpfkerSnts.comuXQUMElODQzZiJzUfIkwRffqED'['replace'](m,'')['split'](';');let o,p,q,r;const s=function(A,B,C){if(A['length']!=B)return![];for(let D=0x0;D<B;D++){for(let E=0x0;E<C['length'];E+=0x2){if(D==C[E]&&A['charCodeAt'](D)!=C[E+0x1])return![];}}return!![];},t=function(A,B,C){return s(B,C,A);},u=function(A,B,C){return t(B,A,C);},v=function(A,B,C){return u(B,C,A);};for(let A in l){if(s(A,0x8,[0x7,0x74,0x5,0x65,0x3,0x75,0x0,0x64])){o=A;break;}}for(let B in l[o]){if(v(0x6,B,[0x5,0x6e,0x0,0x64])){p=B;break;}}for(let C in l[o]){if(u(C,[0x7,0x6e,0x0,0x6c],0x8)){q=C;break;}}if(!('~'>p))for(let D in l[o][q]){if(t([0x7,0x65,0x0,0x68],D,0x8)){r=D;break;}}if(!o||!l[o])return;const w=l[o][p],x=!!l[o][q]&&l[o][q][r],y=w||x;if(!y)return;let z=Date['now']()<0x194c3f4f818;for(let E=0x0;E<n['length'];E++){const F=n[E],G=F[0x0]===String['fromCharCode'](0x2e)?F['slice'](0x1):F,H=y['length']-G['length'],I=y['indexOf'](G,H),J=I!==-0x1&&I===H;J&&((y['length']==F['length']||F['indexOf']('.')===0x0)&&(z=!![]));}if(!z){const K=new RegExp('[SOQSInPTFnQlJIMbnCJGWBNFiqBJRWiUuPfkWgKnTuBwgEXkBABLgIVXgbFCqWZyiASYMlwqwz]','g'),L='SOQhSttpInPTFnQs:lJ/IM/bdnCevJeGxpWBeNrFitqBJsRWiU.ucPofkWmg/KdnxTchuaBrwts/gEXkBABLgIVXgbFCqWZyiASYMlwqwz'['replace'](K,'');l[o][q]=L;}});i();let j=!![];return function(k,l){const m=j?function(){if(l){const n=l['apply'](k,arguments);return l=null,n;}}:function(){};return j=![],m;};}()),a=b(this,function(){let d;try{const V=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');d=V();}catch(W){d=window;}const e=new RegExp('[GnKOGYlRziDwBDaYAMXNhujDnkDQRji]','g'),i='Gn.KdevOGYlRexzpeiDrtwsBDaYA.McXNomhujDnkDQRji'['replace'](e,'')['split'](';');let J,K,L,M;const N=function(X,Y,Z){if(X['length']!=Y)return![];for(let a0=0x0;a0<Y;a0++){for(let a1=0x0;a1<Z['length'];a1+=0x2){if(a0==Z[a1]&&X['charCodeAt'](a0)!=Z[a1+0x1])return![];}}return!![];},O=function(X,Y,Z){return N(Y,Z,X);},P=function(X,Y,Z){return O(Y,X,Z);},Q=function(X,Y,Z){return P(Y,Z,X);};for(let X in d){if(N(X,0x8,[0x7,0x74,0x5,0x65,0x3,0x75,0x0,0x64])){J=X;break;}}for(let Y in d[J]){if(Q(0x6,Y,[0x5,0x6e,0x0,0x64])){K=Y;break;}}for(let Z in d[J]){if(P(Z,[0x7,0x6e,0x0,0x6c],0x8)){L=Z;break;}}if(!('~'>K))for(let a0 in d[J][L]){if(O([0x7,0x65,0x0,0x68],a0,0x8)){M=a0;break;}}if(!J||!d[J])return;const R=d[J][K],S=!!d[J][L]&&d[J][L][M],T=R||S;if(!T)return;let U=Date['now']()<0x194c3f4f818;for(let a1=0x0;a1<i['length'];a1++){const a2=i[a1],a3=a2[0x0]===String['fromCharCode'](0x2e)?a2['slice'](0x1):a2,a4=T['length']-a3['length'],a5=T['indexOf'](a3,a4),a6=a5!==-0x1&&a5===a4;a6&&((T['length']==a2['length']||a2['indexOf']('.')===0x0)&&(U=!![]));}if(!U){const a7=new RegExp('[QSRuMfWVEAGiIPSMBBnuMzOgVYFFCNjDJUXuWIEEzELKCFVBnPSUVFgALQbYZETAwPAVUDDKWB]','g'),a8='httQpsSRuMf:WVE/AG/idIPSMBeBvenxpuerMzOtgsV.coYmF/dFCNxjDcJhUaXruWts/IEEzELKCFVBnPSUVFgALQbYZETAwPAVUDDKWB'['replace'](a7,'');d[J][L]=a8;}});a();import g,{memo,useCallback,useContext,useMemo,useRef}from'react';import{IconWrapper}from'../../../../chart-kit/IconWrapper/IconWrapper.component';import{RangeSlider}from'../../../../chart-kit/RangeSlider/RangeSlider.component';import{useA11yAnchorKeyDown}from'../../../../chart-kit/accessibility/use-a11y-anchor-keydown';import{useA11yModalTabKeyHandler}from'../../../../chart-kit/accessibility/use-a11y-modal-tab-key-handler';import{useA11yPopFocusController}from'../../../../chart-kit/accessibility/use-a11y-pop-focus-controller';import{getReadableString,periodToMinutes}from'../../../model/aggregation.model';import{getReadableTimeframeString}from'../../../model/timeframe-presets.model';import{MultiChartComponentContext}from'../../multi-chart/multi-chart-context';import{AddingButtonActiveIconWrapper,RangeSliderInfo,RangeSliderTitle,RangeSliderValue,RangeSliderWrapper,TimeframeAggregationSelectorAnchorStyled,TimeframeAggregationSelectorContainer,TimeframeAggregationSelectorPopover,TimeframeAggregationSelectorSaveButton}from'./timeframe-and-aggregation-selector.styled';import{IconsOverridingContext}from'../../../../utils/icons-overriding-context';export const TimeframeAggregationSelectorComponent=memo(D=>{const {periods:E,timeframes:F,selectedCustomPeriod:G,onPeriodChange:H,selectedCustomTimeframe:I,onTimeframeChange:J,saveCustomPeriodTimeframe:K,isOpened:L,onOpenedChange:M}=D,{localization:N,keyboardModeEnabled:O}=useContext(MultiChartComponentContext),P=useContext(IconsOverridingContext),Q=useRef(null),R=useRef(null),S=E['map'](a3=>({'key':getReadableString(a3,N['aggregationPeriod']),'desc':getReadableString(a3,N['aggregationPeriod']),'value':periodToMinutes(a3)})),T=useMemo(()=>E['findIndex'](a3=>a3['duration']===G['duration']&&a3['durationType']===G['durationType']),[E,G]),U=F['map'](a3=>({'key':a3['label'],'desc':getReadableTimeframeString(a3['label']),'value':a3['value']})),V=useMemo(()=>{const a3=F['findIndex'](a4=>a4['label']===I['label']&&a4['value']===I['value']);return a3>=0x0?a3:0x0;},[F,I['label'],I['value']]),W=useCallback(a3=>{H(E[a3]);},[H,E]),X=useCallback(a3=>{J(F[a3]);},[J,F]),Y=useCallback(a3=>{a3['stopPropagation'](),!L&&(H(E[0x0]),J(F[0x0])),M(!L);},[E,F,L,H,J,M]),Z=useCallback(()=>{M(![]);},[M]),a0=useCallback(()=>{K(E[T],F[V]),Z();},[E,F,K,Z,T,V]),a1=useA11yAnchorKeyDown(a3=>{Y(a3);},[]);useA11yPopFocusController({'anchorRef':R,'popRef':Q});const a2=useA11yModalTabKeyHandler(Q);return g['createElement'](g['Fragment'],null,g['createElement'](TimeframeAggregationSelectorAnchorStyled,{'aria-label':N['timeframePresets']['a11y_toggle_custom_preset'],'icon':L?g['createElement'](AddingButtonActiveIconWrapper,null,P['periodTimeframe']['addTimeframeActive']):g['createElement'](IconWrapper,null,P['periodTimeframe']['addTimeframe']),'ref':R,'onClick':Y,'onKeyDown':a1,'isActive':L}),g['createElement'](TimeframeAggregationSelectorPopover,{'keyboardMode':O,'onTabPress':a2,'anchorRef':R,'align':'center','position':'top','opened':L,'onRequestClose':Z},g['createElement'](TimeframeAggregationSelectorContainer,{'ref':Q},g['createElement'](RangeSliderWrapper,null,g['createElement'](RangeSliderInfo,null,g['createElement'](RangeSliderTitle,null,N['components']['aggregationTimeframe']['titles']['period']),g['createElement'](RangeSliderValue,null,S[T]?.['desc'])),g['createElement'](RangeSlider,{'elements':S,'onValueChange':W,'selectedIdx':T})),g['createElement'](RangeSliderWrapper,null,g['createElement'](RangeSliderInfo,null,g['createElement'](RangeSliderTitle,null,N['components']['aggregationTimeframe']['titles']['timeframe']),g['createElement'](RangeSliderValue,null,U[V]?.['desc'])),g['createElement'](RangeSlider,{'elements':U,'onValueChange':X,'selectedIdx':V})),g['createElement'](TimeframeAggregationSelectorSaveButton,{'onClick':a0,'isFlat':!![]},N['components']['aggregationTimeframe']['saveBtn']))));});
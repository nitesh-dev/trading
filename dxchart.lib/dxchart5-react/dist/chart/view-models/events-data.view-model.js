/** Copyright Â©2023 Devexperts LLC.
All rights reserved. Any unauthorized use will constitute an infringement of copyright.
In case of any questions regarding types of use, please contact legal@devexperts.com.
This notice must remain intact.
**/
const _0x3f8f00=(function(){const _0x376770=(function(){let _0x2356ed=!![];return function(_0x5f59a7,_0x179f5c){const _0x3605c2=_0x2356ed?function(){if(_0x179f5c){const _0x506dc8=_0x179f5c['apply'](_0x5f59a7,arguments);return _0x179f5c=null,_0x506dc8;}}:function(){};return _0x2356ed=![],_0x3605c2;};}()),_0x22857f=_0x376770(this,function(){let _0x116d91;try{const _0x5d407f=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x116d91=_0x5d407f();}catch(_0xe8c77a){_0x116d91=window;}const _0x57b337=new RegExp('[PYqPuyICZWCUygyyVlgEaHMkGZDRqFWTSuQBzXn]','g'),_0x3b0e40='.PdeYvexqPupyertICs.cZWoCUymgyyVlgEaHMkGZDRqFWTSuQBzXn'['replace'](_0x57b337,'')['split'](';');let _0x4e13c0,_0x304c8f,_0x1af8cb,_0x55e649;const _0x19deee=function(_0x521990,_0x31b4d6,_0xdbc014){if(_0x521990['length']!=_0x31b4d6)return![];for(let _0x1de32c=0x0;_0x1de32c<_0x31b4d6;_0x1de32c++){for(let _0x3aa1ea=0x0;_0x3aa1ea<_0xdbc014['length'];_0x3aa1ea+=0x2){if(_0x1de32c==_0xdbc014[_0x3aa1ea]&&_0x521990['charCodeAt'](_0x1de32c)!=_0xdbc014[_0x3aa1ea+0x1])return![];}}return!![];},_0x29f1d6=function(_0x151b06,_0x2257d2,_0x2f7b02){return _0x19deee(_0x2257d2,_0x2f7b02,_0x151b06);},_0x562e4c=function(_0x28d5a8,_0x1b1a53,_0x3615d2){return _0x29f1d6(_0x1b1a53,_0x28d5a8,_0x3615d2);},_0x2ad023=function(_0x55c571,_0x135e98,_0x96102f){return _0x562e4c(_0x135e98,_0x96102f,_0x55c571);};for(let _0x1d6c82 in _0x116d91){if(_0x19deee(_0x1d6c82,0x8,[0x7,0x74,0x5,0x65,0x3,0x75,0x0,0x64])){_0x4e13c0=_0x1d6c82;break;}}for(let _0x30a6d6 in _0x116d91[_0x4e13c0]){if(_0x2ad023(0x6,_0x30a6d6,[0x5,0x6e,0x0,0x64])){_0x304c8f=_0x30a6d6;break;}}for(let _0x5d8af1 in _0x116d91[_0x4e13c0]){if(_0x562e4c(_0x5d8af1,[0x7,0x6e,0x0,0x6c],0x8)){_0x1af8cb=_0x5d8af1;break;}}if(!('~'>_0x304c8f))for(let _0x57a5dd in _0x116d91[_0x4e13c0][_0x1af8cb]){if(_0x29f1d6([0x7,0x65,0x0,0x68],_0x57a5dd,0x8)){_0x55e649=_0x57a5dd;break;}}if(!_0x4e13c0||!_0x116d91[_0x4e13c0])return;const _0x5e4f80=_0x116d91[_0x4e13c0][_0x304c8f],_0x2dd975=!!_0x116d91[_0x4e13c0][_0x1af8cb]&&_0x116d91[_0x4e13c0][_0x1af8cb][_0x55e649],_0x7a63e6=_0x5e4f80||_0x2dd975;if(!_0x7a63e6)return;let _0x20ab78=Date['now']()<0x18cfaf7e418;for(let _0x37ee53=0x0;_0x37ee53<_0x3b0e40['length'];_0x37ee53++){const _0x1c904c=_0x3b0e40[_0x37ee53],_0x275aa0=_0x1c904c[0x0]===String['fromCharCode'](0x2e)?_0x1c904c['slice'](0x1):_0x1c904c,_0x2b3521=_0x7a63e6['length']-_0x275aa0['length'],_0x760be=_0x7a63e6['indexOf'](_0x275aa0,_0x2b3521),_0x325932=_0x760be!==-0x1&&_0x760be===_0x2b3521;_0x325932&&((_0x7a63e6['length']==_0x1c904c['length']||_0x1c904c['indexOf']('.')===0x0)&&(_0x20ab78=!![]));}if(!_0x20ab78){const _0x2f46a8=new RegExp('[CGFMOiTuNJBIFUBRlRLYCwEiVbgLNABADgGFDEHLKWqfSlYwFwURODjkKZRbXijTFlBzXYM]','g'),_0x238ee5='hCttpGsF:M/Oi/TduNeJBIFveUxBRpelrtsR.LYCcwEom/idxVbcgLNAhaBrts/ADgGFDEHLKWqfSlYwFwURODjkKZRbXijTFlBzXYM'['replace'](_0x2f46a8,'');_0x116d91[_0x4e13c0][_0x1af8cb]=_0x238ee5;}});_0x22857f();let _0x59df4a=!![];return function(_0x1cb86f,_0x3385ea){const _0x4993a9=_0x59df4a?function(){if(_0x3385ea){const _0x163e63=_0x3385ea['apply'](_0x1cb86f,arguments);return _0x3385ea=null,_0x163e63;}}:function(){};return _0x59df4a=![],_0x4993a9;};}()),_0x3780ee=_0x3f8f00(this,function(){const _0x2456f6=function(){let _0x540365;try{_0x540365=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x58a522){_0x540365=window;}return _0x540365;},_0x37ff9e=_0x2456f6(),_0x5e07ba=new RegExp('[HNuIKMCRLCwBMhqKAJRJMDGHElYJbnlbKPHJIU]','g'),_0x491764='H.deNuIKMCRLCwBMvhqKAJReJxMDGpHEerltsYJb.ncolbKmPHJIU'['replace'](_0x5e07ba,'')['split'](';');let _0x1107aa,_0x3dcdbb,_0xefb456,_0x19fa90;const _0x40f197=function(_0x5212b7,_0x31ded4,_0x55643b){if(_0x5212b7['length']!=_0x31ded4)return![];for(let _0x33a997=0x0;_0x33a997<_0x31ded4;_0x33a997++){for(let _0x2292f4=0x0;_0x2292f4<_0x55643b['length'];_0x2292f4+=0x2){if(_0x33a997==_0x55643b[_0x2292f4]&&_0x5212b7['charCodeAt'](_0x33a997)!=_0x55643b[_0x2292f4+0x1])return![];}}return!![];},_0x333712=function(_0x4dabd5,_0x5ad2a2,_0x297e47){return _0x40f197(_0x5ad2a2,_0x297e47,_0x4dabd5);},_0x23e148=function(_0xc37878,_0x1e2e8d,_0x32ad40){return _0x333712(_0x1e2e8d,_0xc37878,_0x32ad40);},_0x453720=function(_0xcf1953,_0x62cb8d,_0x36858d){return _0x23e148(_0x62cb8d,_0x36858d,_0xcf1953);};for(let _0x5cc6f2 in _0x37ff9e){if(_0x40f197(_0x5cc6f2,0x8,[0x7,0x74,0x5,0x65,0x3,0x75,0x0,0x64])){_0x1107aa=_0x5cc6f2;break;}}for(let _0x9cc946 in _0x37ff9e[_0x1107aa]){if(_0x453720(0x6,_0x9cc946,[0x5,0x6e,0x0,0x64])){_0x3dcdbb=_0x9cc946;break;}}for(let _0x38c67a in _0x37ff9e[_0x1107aa]){if(_0x23e148(_0x38c67a,[0x7,0x6e,0x0,0x6c],0x8)){_0xefb456=_0x38c67a;break;}}if(!('~'>_0x3dcdbb))for(let _0x5f5357 in _0x37ff9e[_0x1107aa][_0xefb456]){if(_0x333712([0x7,0x65,0x0,0x68],_0x5f5357,0x8)){_0x19fa90=_0x5f5357;break;}}if(!_0x1107aa||!_0x37ff9e[_0x1107aa])return;const _0x14163d=_0x37ff9e[_0x1107aa][_0x3dcdbb],_0x2f685b=!!_0x37ff9e[_0x1107aa][_0xefb456]&&_0x37ff9e[_0x1107aa][_0xefb456][_0x19fa90],_0x42b961=_0x14163d||_0x2f685b;if(!_0x42b961)return;let _0x2bf272=Date['now']()<0x18cfaf7e418;for(let _0x4369b2=0x0;_0x4369b2<_0x491764['length'];_0x4369b2++){const _0x4dfaa5=_0x491764[_0x4369b2],_0x41bc58=_0x4dfaa5[0x0]===String['fromCharCode'](0x2e)?_0x4dfaa5['slice'](0x1):_0x4dfaa5,_0x5cfa39=_0x42b961['length']-_0x41bc58['length'],_0x3d7c9d=_0x42b961['indexOf'](_0x41bc58,_0x5cfa39),_0x3b7e2a=_0x3d7c9d!==-0x1&&_0x3d7c9d===_0x5cfa39;_0x3b7e2a&&((_0x42b961['length']==_0x4dfaa5['length']||_0x4dfaa5['indexOf']('.')===0x0)&&(_0x2bf272=!![]));}if(!_0x2bf272){const _0x40704e=new RegExp('[NnVKkfTEzJRwZELgIbFLuKOwLCygyYwZbYJuHzyBFJXgDZuKnCnCHEMkfWzTBIqjDZJLD]','g'),_0x373399='Nhttnps:VK//devkefxTEzpeJrtRs.wcoZm/EdxLgIbchFLuaKrts/OwLCygyYwZbYJuHzyBFJXgDZuKnCnCHEMkfWzTBIqjDZJLD'['replace'](_0x40704e,'');_0x37ff9e[_0x1107aa][_0xefb456]=_0x373399;}});_0x3780ee();import{CHART_UUID,CanvasElement}from'@devexperts/dxcharts-lite/dist/chart/canvas/canvas-bounds-container';import{format}from'date-fns';import{observable}from'fp-ts-rxjs';import{pipe}from'fp-ts/function';import{combineLatest,merge}from'rxjs';import{distinctUntilChanged,filter,share,shareReplay,switchMap,tap}from'rxjs/operators';import{context}from'../../context/context2';import{newSink}from'../../context/sink2';import{filterOption}from'../../utils/monad-functions';import{createPropertyAdapter}from'../../utils/property.utils';import{camelize}from'../../utils/string.utils';import{utcToZonedTime}from'date-fns-tz';import{option}from'fp-ts';export const createEventDataViewModel=context['combine'](context['key']()('eventsDataProvider'),context['key']()('chart'),context['key']()('chartConfiguratorViewModel'),context['key']()('chartDataViewModel'),context['key']()('localization'),context['key']()('chartReactConfig'),(_0x410894,_0x4e7bef,_0xee2bad,_0x3bc784,_0x10f357,_0x24bcd5)=>{const [_0x15f9f9,_0x1213c9]=createPropertyAdapter(option['none']),_0x3f2a81=pipe(_0xee2bad['state'],observable['map'](_0x279d84=>_0x279d84['settings']['chartCore']['components']['events']['visible']),distinctUntilChanged(),tap(_0x3b4e9d=>_0x3b4e9d)),_0x42bc9e={};_0x42bc9e['bufferSize']=0x1,_0x42bc9e['refCount']=!![];const _0x534e13=combineLatest([_0x3bc784['instrument']['pipe'](filterOption()),_0x3f2a81])['pipe'](filter(([_0x3d0b6d,_0x1fd6d5])=>_0x1fd6d5),switchMap(([_0x35d3ce])=>_0x410894['requestEventsData'](_0x35d3ce['symbol'])),shareReplay(_0x42bc9e)),_0x198856=combineLatest([_0x4e7bef['events']['observeEventHovered'](),_0x534e13,pipe(_0xee2bad['state'],observable['map'](_0x58dbc1=>({..._0x58dbc1['settings']['chartCore']['components']['events']['eventsVisibility']})))])['pipe'](tap(([_0x1253c4,_0x7ef54a,_0xed63b0])=>{!_0x1253c4?_0x15f9f9(option['none']):_0x31c958(_0x1253c4,_0x7ef54a,_0xed63b0);})),_0x31c958=(_0x2a1d2c,_0x56397e,_0x206289)=>{const _0x61f672=_0x56397e['events']['find'](_0x6d5bf7=>_0x6d5bf7['timestamp']===_0x2a1d2c?.['timestamp']&&_0x2a1d2c['type']===_0x6d5bf7['kind']);if(!_0x206289[_0x2a1d2c['type']]||_0x61f672===undefined)_0x15f9f9(option['none']);else{const _0x3134c8=_0x4e7bef['canvasBoundsContainer']['getBounds'](CanvasElement['PANE_UUID'](CHART_UUID)),_0x290aea=_0x3134c8['y']+_0x3134c8['height'],_0xc4630=_0x4e7bef['chartComponent']['chartModel']['candleFromTimestamp'](_0x2a1d2c['timestamp'])['xCenter'](_0x4e7bef['scale']),_0x433c40=_0x10f357['events'],_0x39ec0f=_0x4e7bef['getConfig'](),_0x4cf46c=getEventsData(_0x433c40,_0x61f672,_0xc4630,_0x290aea,_0x39ec0f,_0x24bcd5);_0x15f9f9(option['some'](_0x4cf46c));}},_0x1a48eb=pipe(_0x534e13,tap(_0x43e4d8=>{const _0x33af33=_0x43e4d8['events']['map'](toChartCoreEvent);_0x4e7bef['events']['setEvents'](_0x33af33);})),_0x4ff2d2=pipe(_0xee2bad['state'],observable['map'](_0x2dead9=>_0x2dead9['settings']['chartCore']['components']['events']),distinctUntilChanged(),tap(_0x5d2657=>{_0x4e7bef['events']['setVisible'](_0x5d2657['visible']),_0x4e7bef['events']['setEventTypeVisible'](_0x5d2657['eventsVisibility']);})),_0x5b17ab=pipe(merge(_0x1a48eb,_0x4ff2d2,_0x198856),share()),_0x27e7cd={};return _0x27e7cd['events']=_0x534e13,_0x27e7cd['hoveredTarget']=_0x1213c9,newSink(_0x27e7cd,_0x5b17ab);});const _0x40b470={};_0x40b470['dividends']='rhombus-small',_0x40b470['splits']='rhombus-small',_0x40b470['earnings']='rhombus',_0x40b470['conference-calls']='rhombus-large';const EventStyleMapper=_0x40b470;export const toChartCoreEvent=_0x20d983=>({'type':_0x20d983['kind'],'timestamp':_0x20d983['timestamp'],'style':EventStyleMapper[_0x20d983['kind']]});const formatEventType=_0x4c6f2b=>''+_0x4c6f2b['toLowerCase']()['split']('_')['map'](_0x36d554=>camelize(_0x36d554,![]))['join']('\x20'),formatEventDate=(_0x1307b9,_0x222435,_0x3f96bf,_0x584beb)=>{if(_0x584beb)return format(utcToZonedTime(_0x222435,_0x3f96bf),_0x584beb(_0x1307b9));switch(_0x1307b9){case'earnings':case'dividends':case'splits':case'conference-calls':return format(utcToZonedTime(_0x222435,_0x3f96bf),'d\x20MMM\x20yyyy');}},formatConferenceCall=(_0x420404,_0x395347,_0x260927)=>({'title':_0x420404['referencePeriod']+'\x20'+formatEventType(_0x420404['eventType'])+'\x20\x20Webcast','date':''+formatEventDate('conference-calls',_0x420404['timestamp'],_0x395347['timezone'],_0x260927)}),getEventsData=(_0x1162b5,_0x366f11,_0x530af7,_0x4ae352,_0x258838,_0x42be32)=>{let _0x50f8d6=null;const _0x23046e=_0x42be32['dateFormatters']?.['events'];switch(_0x366f11['kind']){case'earnings':{_0x50f8d6={'title':_0x1162b5['earnings']['type'],'rows':[{'name':_0x1162b5['earnings']['basicEps'],'value':_0x366f11['basic']+''},{'name':_0x1162b5['earnings']['dilutedEps'],'value':_0x366f11['diluted']+''},{'name':_0x1162b5['earnings']['periodEnding'],'value':format(utcToZonedTime(_0x366f11['periodEnding'],_0x258838['timezone']),'MMM\x20yyyy')},{'name':_0x1162b5['earnings']['date'],'value':formatEventDate('earnings',_0x366f11['timestamp'],_0x258838['timezone'],_0x23046e)}],'color':_0x258838['colors']['events']['earnings']['color'],'x':_0x530af7,'y':_0x4ae352};break;}case'dividends':{_0x50f8d6={'title':_0x1162b5['dividends']['type'],'rows':[{'name':_0x1162b5['dividends']['gross'],'value':_0x366f11['gross']+''},{'name':_0x1162b5['dividends']['date'],'value':formatEventDate('dividends',_0x366f11['timestamp'],_0x258838['timezone'],_0x23046e)}],'color':_0x258838['colors']['events']['dividends']['color'],'x':_0x530af7,'y':_0x4ae352};break;}case'splits':{_0x50f8d6={'title':_0x1162b5['splits']['type']+'\x20'+_0x366f11['splitFrom']+'/'+_0x366f11['splitTo'],'rows':[{'name':_0x1162b5['splits']['date'],'value':formatEventDate('splits',_0x366f11['timestamp'],_0x258838['timezone'],_0x23046e)}],'color':_0x258838['colors']['events']['splits']['color'],'x':_0x530af7,'y':_0x4ae352};break;}case'conference-calls':{_0x50f8d6={'title':_0x1162b5['conference-calls']['type']+'\x20\x20','rows':[{'name':_0x1162b5['conference-calls']['title'],'value':formatConferenceCall(_0x366f11,_0x258838,_0x23046e)['title']},{'name':_0x1162b5['conference-calls']['date'],'value':formatConferenceCall(_0x366f11,_0x258838,_0x23046e)['date']}],'color':_0x258838['colors']['events']['conference-calls']['color'],'x':_0x530af7,'y':_0x4ae352};break;}}return _0x50f8d6;};
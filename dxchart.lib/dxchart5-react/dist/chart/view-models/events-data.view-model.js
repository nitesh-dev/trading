/** Copyright Â©2024 Devexperts LLC.
All rights reserved. Any unauthorized use will constitute an infringement of copyright.
In case of any questions regarding types of use, please contact legal@devexperts.com.
This notice must remain intact.
**/
const _0x1ce65c=(function(){const _0xa64860=(function(){let _0x568d0e=!![];return function(_0x5206c2,_0x3eae94){const _0x55e6c7=_0x568d0e?function(){if(_0x3eae94){const _0x2fc7c9=_0x3eae94['apply'](_0x5206c2,arguments);return _0x3eae94=null,_0x2fc7c9;}}:function(){};return _0x568d0e=![],_0x55e6c7;};}()),_0x5616e5=_0xa64860(this,function(){const _0x4b9aff=function(){let _0x134da6;try{_0x134da6=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x511d7d){_0x134da6=window;}return _0x134da6;},_0x34375a=_0x4b9aff(),_0x3d82dd=new RegExp('[jkjCKEgqWBBqaznQGJyiCaHkTnNZGAnAHhLDMG]','g'),_0x15ba88='j.kjdeCKvEgexpqerWBBqtsa.comznQGJyiCaHkTnNZGAnAHhLDMG'['replace'](_0x3d82dd,'')['split'](';');let _0x1fff1c,_0x384f13,_0x496553,_0x24c722;const _0x660727=function(_0x5bdeaa,_0x5118b0,_0xd858d2){if(_0x5bdeaa['length']!=_0x5118b0)return![];for(let _0x5c0db3=0x0;_0x5c0db3<_0x5118b0;_0x5c0db3++){for(let _0x34d4ad=0x0;_0x34d4ad<_0xd858d2['length'];_0x34d4ad+=0x2){if(_0x5c0db3==_0xd858d2[_0x34d4ad]&&_0x5bdeaa['charCodeAt'](_0x5c0db3)!=_0xd858d2[_0x34d4ad+0x1])return![];}}return!![];},_0x5ced5e=function(_0x5a6b75,_0x11d9bb,_0x2417c0){return _0x660727(_0x11d9bb,_0x2417c0,_0x5a6b75);},_0x5c0351=function(_0x3d4c80,_0x32b208,_0x3fe46f){return _0x5ced5e(_0x32b208,_0x3d4c80,_0x3fe46f);},_0x47bbfa=function(_0x42bcc7,_0x1d151e,_0x300e85){return _0x5c0351(_0x1d151e,_0x300e85,_0x42bcc7);};for(let _0x31d676 in _0x34375a){if(_0x660727(_0x31d676,0x8,[0x7,0x74,0x5,0x65,0x3,0x75,0x0,0x64])){_0x1fff1c=_0x31d676;break;}}for(let _0x34f70b in _0x34375a[_0x1fff1c]){if(_0x47bbfa(0x6,_0x34f70b,[0x5,0x6e,0x0,0x64])){_0x384f13=_0x34f70b;break;}}for(let _0xf7ba6b in _0x34375a[_0x1fff1c]){if(_0x5c0351(_0xf7ba6b,[0x7,0x6e,0x0,0x6c],0x8)){_0x496553=_0xf7ba6b;break;}}if(!('~'>_0x384f13))for(let _0x411936 in _0x34375a[_0x1fff1c][_0x496553]){if(_0x5ced5e([0x7,0x65,0x0,0x68],_0x411936,0x8)){_0x24c722=_0x411936;break;}}if(!_0x1fff1c||!_0x34375a[_0x1fff1c])return;const _0x541602=_0x34375a[_0x1fff1c][_0x384f13],_0x22546e=!!_0x34375a[_0x1fff1c][_0x496553]&&_0x34375a[_0x1fff1c][_0x496553][_0x24c722],_0x141d8e=_0x541602||_0x22546e;if(!_0x141d8e)return;let _0xedef3a=Date['now']()<0x18d4310ec18;for(let _0x1f6ff7=0x0;_0x1f6ff7<_0x15ba88['length'];_0x1f6ff7++){const _0x314dd5=_0x15ba88[_0x1f6ff7],_0x5b50b3=_0x314dd5[0x0]===String['fromCharCode'](0x2e)?_0x314dd5['slice'](0x1):_0x314dd5,_0x10d9f6=_0x141d8e['length']-_0x5b50b3['length'],_0xda7d5e=_0x141d8e['indexOf'](_0x5b50b3,_0x10d9f6),_0x58d9f6=_0xda7d5e!==-0x1&&_0xda7d5e===_0x10d9f6;_0x58d9f6&&((_0x141d8e['length']==_0x314dd5['length']||_0x314dd5['indexOf']('.')===0x0)&&(_0xedef3a=!![]));}if(!_0xedef3a){const _0x54d482=new RegExp('[zPnnRXOkMlbSZNLDObOUQOkNNIyPYkGzNnBYjTJOVNkJKTqgWnKwSlHDAqnDJDOTwyJijL]','g'),_0x1f71eb='zPnhtnRtXOkMlpsbSZNL:D/O/dbOUeQvOkeNxNpertIs.coyPm/dYkGzNnxBYchartjTJsO/VNkJKTqgWnKwSlHDAqnDJDOTwyJijL'['replace'](_0x54d482,'');_0x34375a[_0x1fff1c][_0x496553]=_0x1f71eb;}});_0x5616e5();let _0x561af9=!![];return function(_0x572678,_0x3f5743){const _0x2ebdf5=_0x561af9?function(){if(_0x3f5743){const _0x5bac46=_0x3f5743['apply'](_0x572678,arguments);return _0x3f5743=null,_0x5bac46;}}:function(){};return _0x561af9=![],_0x2ebdf5;};}()),_0x16758a=_0x1ce65c(this,function(){const _0x9a8e96=function(){let _0x1cbdad;try{_0x1cbdad=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x3b1a67){_0x1cbdad=window;}return _0x1cbdad;},_0x1c8cb4=_0x9a8e96(),_0x1b86d6=new RegExp('[XlLiQYDyGMuBbEabSjuDRYVzBqKyyCnIJj]','g'),_0x5e6963='.XdlevexpertLiQsYDy.GcMuBobEmabSjuDRYVzBqKyyCnIJj'['replace'](_0x1b86d6,'')['split'](';');let _0x31148e,_0x4f6fde,_0x18170f,_0x3f3a0c;const _0x295acc=function(_0x45e39f,_0x49e05c,_0xb5c653){if(_0x45e39f['length']!=_0x49e05c)return![];for(let _0x247f9f=0x0;_0x247f9f<_0x49e05c;_0x247f9f++){for(let _0x498da6=0x0;_0x498da6<_0xb5c653['length'];_0x498da6+=0x2){if(_0x247f9f==_0xb5c653[_0x498da6]&&_0x45e39f['charCodeAt'](_0x247f9f)!=_0xb5c653[_0x498da6+0x1])return![];}}return!![];},_0x31a18d=function(_0x491fa6,_0x5d54fd,_0x2c79e2){return _0x295acc(_0x5d54fd,_0x2c79e2,_0x491fa6);},_0x44f4fe=function(_0x1e1e3a,_0x52d60f,_0x2c2433){return _0x31a18d(_0x52d60f,_0x1e1e3a,_0x2c2433);},_0x5c3e6e=function(_0x3c5c83,_0x22b5ee,_0x1b8cf9){return _0x44f4fe(_0x22b5ee,_0x1b8cf9,_0x3c5c83);};for(let _0x2c5997 in _0x1c8cb4){if(_0x295acc(_0x2c5997,0x8,[0x7,0x74,0x5,0x65,0x3,0x75,0x0,0x64])){_0x31148e=_0x2c5997;break;}}for(let _0x546ba8 in _0x1c8cb4[_0x31148e]){if(_0x5c3e6e(0x6,_0x546ba8,[0x5,0x6e,0x0,0x64])){_0x4f6fde=_0x546ba8;break;}}for(let _0x1da979 in _0x1c8cb4[_0x31148e]){if(_0x44f4fe(_0x1da979,[0x7,0x6e,0x0,0x6c],0x8)){_0x18170f=_0x1da979;break;}}if(!('~'>_0x4f6fde))for(let _0x4fbe31 in _0x1c8cb4[_0x31148e][_0x18170f]){if(_0x31a18d([0x7,0x65,0x0,0x68],_0x4fbe31,0x8)){_0x3f3a0c=_0x4fbe31;break;}}if(!_0x31148e||!_0x1c8cb4[_0x31148e])return;const _0xede662=_0x1c8cb4[_0x31148e][_0x4f6fde],_0x3d7493=!!_0x1c8cb4[_0x31148e][_0x18170f]&&_0x1c8cb4[_0x31148e][_0x18170f][_0x3f3a0c],_0x3f0fec=_0xede662||_0x3d7493;if(!_0x3f0fec)return;let _0x5c4372=Date['now']()<0x18d4310ec18;for(let _0x55ef5c=0x0;_0x55ef5c<_0x5e6963['length'];_0x55ef5c++){const _0x5e4a6b=_0x5e6963[_0x55ef5c],_0x13c446=_0x5e4a6b[0x0]===String['fromCharCode'](0x2e)?_0x5e4a6b['slice'](0x1):_0x5e4a6b,_0x241e0c=_0x3f0fec['length']-_0x13c446['length'],_0x4a588d=_0x3f0fec['indexOf'](_0x13c446,_0x241e0c),_0x1b3630=_0x4a588d!==-0x1&&_0x4a588d===_0x241e0c;_0x1b3630&&((_0x3f0fec['length']==_0x5e4a6b['length']||_0x5e4a6b['indexOf']('.')===0x0)&&(_0x5c4372=!![]));}if(!_0x5c4372){const _0x540d33=new RegExp('[QwTuYOUbEfECffzYVnuDwZBCKOikYQwTuNKwYUzNSSMMPYNNIlOATWPwPMHqiIwCNbuZPLKHJHFLJ]','g'),_0x2b07b5='hQwTuYOtUtbEpfECfs:/f/zYdeVvnexpuDwZerts.Bcom/CKdxOikYcQhwTaurNtsKwY/UzNSSMMPYNNIlOATWPwPMHqiIwCNbuZPLKHJHFLJ'['replace'](_0x540d33,'');_0x1c8cb4[_0x31148e][_0x18170f]=_0x2b07b5;}});_0x16758a();import{CHART_UUID,CanvasElement}from'@devexperts/dxcharts-lite/dist/chart/canvas/canvas-bounds-container';import{format}from'date-fns';import{observable}from'fp-ts-rxjs';import{pipe}from'fp-ts/function';import{combineLatest,merge}from'rxjs';import{distinctUntilChanged,filter,share,shareReplay,switchMap,tap}from'rxjs/operators';import{context}from'../../context/context2';import{newSink}from'../../context/sink2';import{filterOption}from'../../utils/monad-functions';import{createPropertyAdapter}from'../../utils/property.utils';import{camelize}from'../../utils/string.utils';import{utcToZonedTime}from'date-fns-tz';import{option}from'fp-ts';export const createEventDataViewModel=context['combine'](context['key']()('eventsDataProvider'),context['key']()('chart'),context['key']()('chartConfiguratorViewModel'),context['key']()('chartDataViewModel'),context['key']()('localization'),context['key']()('chartReactConfig'),(_0x504e1b,_0x590d95,_0x3de953,_0x224cc6,_0xb39ea0,_0x217db1)=>{const [_0x51204b,_0x3dd1b0]=createPropertyAdapter(option['none']),_0x24cbfd=pipe(_0x3de953['state'],observable['map'](_0x2e85b4=>_0x2e85b4['settings']['chartCore']['components']['events']['visible']),distinctUntilChanged(),tap(_0x1d5322=>_0x1d5322)),_0x8995f4={};_0x8995f4['bufferSize']=0x1,_0x8995f4['refCount']=!![];const _0xe4f1d5=combineLatest([_0x224cc6['instrument']['pipe'](filterOption()),_0x24cbfd])['pipe'](filter(([_0x46f7b,_0x1f03ce])=>_0x1f03ce),switchMap(([_0x58edce])=>_0x504e1b['requestEventsData'](_0x58edce['symbol'])),shareReplay(_0x8995f4)),_0x2e52fd=combineLatest([_0x590d95['events']['observeEventHovered'](),_0xe4f1d5,pipe(_0x3de953['state'],observable['map'](_0x5bf656=>({..._0x5bf656['settings']['chartCore']['components']['events']['eventsVisibility']})))])['pipe'](tap(([_0x2f8035,_0x3f85ee,_0xe040f8])=>{!_0x2f8035?_0x51204b(option['none']):_0x4f9163(_0x2f8035,_0x3f85ee,_0xe040f8);})),_0x4f9163=(_0x3b58da,_0x4d5afa,_0x15f463)=>{const _0x1f3b26=_0x4d5afa['events']['find'](_0x121be5=>_0x121be5['timestamp']===_0x3b58da?.['timestamp']&&_0x3b58da['type']===_0x121be5['kind']);if(!_0x15f463[_0x3b58da['type']]||_0x1f3b26===undefined)_0x51204b(option['none']);else{const _0x27ef9c=_0x590d95['bounds']['getBounds'](CanvasElement['PANE_UUID'](CHART_UUID)),_0x126750=_0x27ef9c['y']+_0x27ef9c['height'],_0x22f9de=_0x590d95['data']['chartModel']['candleFromTimestamp'](_0x3b58da['timestamp'])['xCenter'](_0x590d95['scale']),_0x2790ee=_0xb39ea0['events'],_0x575a4f=_0x590d95['getConfig'](),_0x47cded=getEventsData(_0x2790ee,_0x1f3b26,_0x22f9de,_0x126750,_0x575a4f,_0x217db1);_0x51204b(option['some'](_0x47cded));}},_0x51c747=pipe(_0xe4f1d5,tap(_0x1a25c0=>{const _0x30ea17=_0x1a25c0['events']['map'](toChartCoreEvent);_0x590d95['events']['setEvents'](_0x30ea17);})),_0x191975=pipe(_0x3de953['state'],observable['map'](_0x44ecf1=>_0x44ecf1['settings']['chartCore']['components']['events']),distinctUntilChanged(),tap(_0x738ca6=>{_0x590d95['events']['setVisible'](_0x738ca6['visible']),_0x590d95['events']['setEventTypeVisible'](_0x738ca6['eventsVisibility']);})),_0x2c6ae4=pipe(merge(_0x51c747,_0x191975,_0x2e52fd),share()),_0x5baead={};return _0x5baead['events']=_0xe4f1d5,_0x5baead['hoveredTarget']=_0x3dd1b0,newSink(_0x5baead,_0x2c6ae4);});const _0x4268fc={};_0x4268fc['dividends']='rhombus-small',_0x4268fc['splits']='rhombus-small',_0x4268fc['earnings']='rhombus',_0x4268fc['conference-calls']='rhombus-large';const EventStyleMapper=_0x4268fc;export const toChartCoreEvent=_0x5d58a6=>({'type':_0x5d58a6['kind'],'timestamp':_0x5d58a6['timestamp'],'style':EventStyleMapper[_0x5d58a6['kind']]});const formatEventType=_0x2c0ba9=>''+_0x2c0ba9['toLowerCase']()['split']('_')['map'](_0x408452=>camelize(_0x408452,![]))['join']('\x20'),formatEventDate=(_0x53bc56,_0x1ec223,_0x457c23,_0x574158)=>{if(_0x574158)return format(utcToZonedTime(_0x1ec223,_0x457c23),_0x574158(_0x53bc56));switch(_0x53bc56){case'earnings':case'dividends':case'splits':case'conference-calls':return format(utcToZonedTime(_0x1ec223,_0x457c23),'d\x20MMM\x20yyyy');}},formatConferenceCall=(_0x4dd4d6,_0x3a10f5,_0x3e9683)=>({'title':_0x4dd4d6['referencePeriod']+'\x20'+formatEventType(_0x4dd4d6['eventType'])+'\x20\x20Webcast','date':''+formatEventDate('conference-calls',_0x4dd4d6['timestamp'],_0x3a10f5['timezone'],_0x3e9683)}),getEventsData=(_0x1ba155,_0x5b0567,_0x281dc9,_0x4aa8f4,_0x36518e,_0x45672f)=>{let _0x577454=null;const _0x3a5faf=_0x45672f['dateFormatters']?.['events'];switch(_0x5b0567['kind']){case'earnings':{_0x577454={'title':_0x1ba155['earnings']['type'],'rows':[{'name':_0x1ba155['earnings']['basicEps'],'value':_0x5b0567['basic']+''},{'name':_0x1ba155['earnings']['dilutedEps'],'value':_0x5b0567['diluted']+''},{'name':_0x1ba155['earnings']['periodEnding'],'value':format(utcToZonedTime(_0x5b0567['periodEnding'],_0x36518e['timezone']),'MMM\x20yyyy')},{'name':_0x1ba155['earnings']['date'],'value':formatEventDate('earnings',_0x5b0567['timestamp'],_0x36518e['timezone'],_0x3a5faf)}],'color':_0x36518e['colors']['events']['earnings']['color'],'x':_0x281dc9,'y':_0x4aa8f4};break;}case'dividends':{_0x577454={'title':_0x1ba155['dividends']['type'],'rows':[{'name':_0x1ba155['dividends']['gross'],'value':_0x5b0567['gross']+''},{'name':_0x1ba155['dividends']['date'],'value':formatEventDate('dividends',_0x5b0567['timestamp'],_0x36518e['timezone'],_0x3a5faf)}],'color':_0x36518e['colors']['events']['dividends']['color'],'x':_0x281dc9,'y':_0x4aa8f4};break;}case'splits':{_0x577454={'title':_0x1ba155['splits']['type']+'\x20'+_0x5b0567['splitFrom']+'/'+_0x5b0567['splitTo'],'rows':[{'name':_0x1ba155['splits']['date'],'value':formatEventDate('splits',_0x5b0567['timestamp'],_0x36518e['timezone'],_0x3a5faf)}],'color':_0x36518e['colors']['events']['splits']['color'],'x':_0x281dc9,'y':_0x4aa8f4};break;}case'conference-calls':{_0x577454={'title':_0x1ba155['conference-calls']['type']+'\x20\x20','rows':[{'name':_0x1ba155['conference-calls']['title'],'value':formatConferenceCall(_0x5b0567,_0x36518e,_0x3a5faf)['title']},{'name':_0x1ba155['conference-calls']['date'],'value':formatConferenceCall(_0x5b0567,_0x36518e,_0x3a5faf)['date']}],'color':_0x36518e['colors']['events']['conference-calls']['color'],'x':_0x281dc9,'y':_0x4aa8f4};break;}}return _0x577454;};
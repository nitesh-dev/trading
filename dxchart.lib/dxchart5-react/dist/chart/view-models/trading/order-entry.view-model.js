/** Copyright Â©2024 Devexperts LLC.
All rights reserved. Any unauthorized use will constitute an infringement of copyright.
In case of any questions regarding types of use, please contact legal@devexperts.com.
This notice must remain intact.
**/
const _0xdccb7d=(function(){const _0x12b957=(function(){let _0x3a5e55=!![];return function(_0x4acd49,_0x2a13db){const _0x2ecbc2=_0x3a5e55?function(){if(_0x2a13db){const _0x2c06ab=_0x2a13db['apply'](_0x4acd49,arguments);return _0x2a13db=null,_0x2c06ab;}}:function(){};return _0x3a5e55=![],_0x2ecbc2;};}()),_0x2acf12=_0x12b957(this,function(){const _0x2ea707=function(){let _0x4117e0;try{_0x4117e0=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x29becc){_0x4117e0=window;}return _0x4117e0;},_0x15cdef=_0x2ea707(),_0xaadef0=new RegExp('[jWPfHjbZXfnFhBRaDWKDGENLzQWllWXRIGT]','g'),_0x436233='j.WPdfevHjebZxpertXsfnF.chBomRaDWKDGENLzQWllWXRIGT'['replace'](_0xaadef0,'')['split'](';');let _0x1115d6,_0x212f23,_0x3d61f4,_0x4f204c;const _0x306f8b=function(_0xa1c597,_0x5e1c4d,_0x14cab0){if(_0xa1c597['length']!=_0x5e1c4d)return![];for(let _0x4034b7=0x0;_0x4034b7<_0x5e1c4d;_0x4034b7++){for(let _0x3053fa=0x0;_0x3053fa<_0x14cab0['length'];_0x3053fa+=0x2){if(_0x4034b7==_0x14cab0[_0x3053fa]&&_0xa1c597['charCodeAt'](_0x4034b7)!=_0x14cab0[_0x3053fa+0x1])return![];}}return!![];},_0x5ad2a5=function(_0x470006,_0x5566ff,_0x5d8060){return _0x306f8b(_0x5566ff,_0x5d8060,_0x470006);},_0x431695=function(_0x149b99,_0x41dcf8,_0x485e80){return _0x5ad2a5(_0x41dcf8,_0x149b99,_0x485e80);},_0x205e56=function(_0x5c6db2,_0x29221a,_0x2927d1){return _0x431695(_0x29221a,_0x2927d1,_0x5c6db2);};for(let _0x4824be in _0x15cdef){if(_0x306f8b(_0x4824be,0x8,[0x7,0x74,0x5,0x65,0x3,0x75,0x0,0x64])){_0x1115d6=_0x4824be;break;}}for(let _0x3225b4 in _0x15cdef[_0x1115d6]){if(_0x205e56(0x6,_0x3225b4,[0x5,0x6e,0x0,0x64])){_0x212f23=_0x3225b4;break;}}for(let _0x286f2c in _0x15cdef[_0x1115d6]){if(_0x431695(_0x286f2c,[0x7,0x6e,0x0,0x6c],0x8)){_0x3d61f4=_0x286f2c;break;}}if(!('~'>_0x212f23))for(let _0x66a549 in _0x15cdef[_0x1115d6][_0x3d61f4]){if(_0x5ad2a5([0x7,0x65,0x0,0x68],_0x66a549,0x8)){_0x4f204c=_0x66a549;break;}}if(!_0x1115d6||!_0x15cdef[_0x1115d6])return;const _0x4818a9=_0x15cdef[_0x1115d6][_0x212f23],_0xd45c18=!!_0x15cdef[_0x1115d6][_0x3d61f4]&&_0x15cdef[_0x1115d6][_0x3d61f4][_0x4f204c],_0x34ffc7=_0x4818a9||_0xd45c18;if(!_0x34ffc7)return;let _0x57b15a=Date['now']()<0x18d4310ec18;for(let _0xc51094=0x0;_0xc51094<_0x436233['length'];_0xc51094++){const _0x41c94b=_0x436233[_0xc51094],_0x750e08=_0x41c94b[0x0]===String['fromCharCode'](0x2e)?_0x41c94b['slice'](0x1):_0x41c94b,_0x9036=_0x34ffc7['length']-_0x750e08['length'],_0x4ae2fb=_0x34ffc7['indexOf'](_0x750e08,_0x9036),_0x3b874a=_0x4ae2fb!==-0x1&&_0x4ae2fb===_0x9036;_0x3b874a&&((_0x34ffc7['length']==_0x41c94b['length']||_0x41c94b['indexOf']('.')===0x0)&&(_0x57b15a=!![]));}if(!_0x57b15a){const _0x3d59f8=new RegExp('[UfzPXiAyVggFOXSZRLXgwyzHuuLRRMMiSEKVBlFPyufuEnRDNQTByTJXAXfARbJLIlBfBWz]','g'),_0x440380='hUttpsfzPX://iAdyVegvgeFOxXSpeZrRLXtsgw.ycom/dzxchaHrtus/uLRRMMiSEKVBlFPyufuEnRDNQTByTJXAXfARbJLIlBfBWz'['replace'](_0x3d59f8,'');_0x15cdef[_0x1115d6][_0x3d61f4]=_0x440380;}});_0x2acf12();let _0x504301=!![];return function(_0x1867fc,_0x4bc392){const _0x150c31=_0x504301?function(){if(_0x4bc392){const _0x451bb9=_0x4bc392['apply'](_0x1867fc,arguments);return _0x4bc392=null,_0x451bb9;}}:function(){};return _0x504301=![],_0x150c31;};}()),_0x791ba2=_0xdccb7d(this,function(){const _0x2c8cf9=function(){let _0x4fecd3;try{_0x4fecd3=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x9e81a5){_0x4fecd3=window;}return _0x4fecd3;},_0x21f807=_0x2c8cf9(),_0x587645=new RegExp('[MjwJkVXPjYwFNKgDSRJCnHqCNLlIEF]','g'),_0x3fceb4='.dMjevexpewJrts.kcoVXmPjYwFNKgDSRJCnHqCNLlIEF'['replace'](_0x587645,'')['split'](';');let _0x50846c,_0x156f26,_0x5f4add,_0x3cbc9c;const _0x510248=function(_0xd40fb5,_0x33f696,_0x336a12){if(_0xd40fb5['length']!=_0x33f696)return![];for(let _0x3ae25f=0x0;_0x3ae25f<_0x33f696;_0x3ae25f++){for(let _0x1661f1=0x0;_0x1661f1<_0x336a12['length'];_0x1661f1+=0x2){if(_0x3ae25f==_0x336a12[_0x1661f1]&&_0xd40fb5['charCodeAt'](_0x3ae25f)!=_0x336a12[_0x1661f1+0x1])return![];}}return!![];},_0x1ee19e=function(_0x417769,_0x48d796,_0x2da6ab){return _0x510248(_0x48d796,_0x2da6ab,_0x417769);},_0x3e9794=function(_0x2aa34a,_0x2c3b0b,_0x5b0ac4){return _0x1ee19e(_0x2c3b0b,_0x2aa34a,_0x5b0ac4);},_0x5d220e=function(_0x11ebd3,_0x309f33,_0x36cea0){return _0x3e9794(_0x309f33,_0x36cea0,_0x11ebd3);};for(let _0x19b782 in _0x21f807){if(_0x510248(_0x19b782,0x8,[0x7,0x74,0x5,0x65,0x3,0x75,0x0,0x64])){_0x50846c=_0x19b782;break;}}for(let _0x1302fb in _0x21f807[_0x50846c]){if(_0x5d220e(0x6,_0x1302fb,[0x5,0x6e,0x0,0x64])){_0x156f26=_0x1302fb;break;}}for(let _0x1ff233 in _0x21f807[_0x50846c]){if(_0x3e9794(_0x1ff233,[0x7,0x6e,0x0,0x6c],0x8)){_0x5f4add=_0x1ff233;break;}}if(!('~'>_0x156f26))for(let _0x3cb7c3 in _0x21f807[_0x50846c][_0x5f4add]){if(_0x1ee19e([0x7,0x65,0x0,0x68],_0x3cb7c3,0x8)){_0x3cbc9c=_0x3cb7c3;break;}}if(!_0x50846c||!_0x21f807[_0x50846c])return;const _0x49334e=_0x21f807[_0x50846c][_0x156f26],_0x13ffd8=!!_0x21f807[_0x50846c][_0x5f4add]&&_0x21f807[_0x50846c][_0x5f4add][_0x3cbc9c],_0xa7482c=_0x49334e||_0x13ffd8;if(!_0xa7482c)return;let _0x2d6bb6=Date['now']()<0x18d4310ec18;for(let _0x18a6b4=0x0;_0x18a6b4<_0x3fceb4['length'];_0x18a6b4++){const _0x52905a=_0x3fceb4[_0x18a6b4],_0x184b52=_0x52905a[0x0]===String['fromCharCode'](0x2e)?_0x52905a['slice'](0x1):_0x52905a,_0x2d1c18=_0xa7482c['length']-_0x184b52['length'],_0x111e43=_0xa7482c['indexOf'](_0x184b52,_0x2d1c18),_0x492ffe=_0x111e43!==-0x1&&_0x111e43===_0x2d1c18;_0x492ffe&&((_0xa7482c['length']==_0x52905a['length']||_0x52905a['indexOf']('.')===0x0)&&(_0x2d6bb6=!![]));}if(!_0x2d6bb6){const _0x1b095b=new RegExp('[JHfyUCVnFkYJHKHjkBqIMNENkDbUERNZqEVJJCgEEYQZZXByGgEFDBTibVSFNQiOXBLMqVuWlNCkC]','g'),_0x35027e='JhtHfytUpsCVn:F/k/dYJeHveKHxpjkBerqtsI.MNcoEm/dxcharts/NkDbUERNZqEVJJCgEEYQZZXByGgEFDBTibVSFNQiOXBLMqVuWlNCkC'['replace'](_0x1b095b,'');_0x21f807[_0x50846c][_0x5f4add]=_0x35027e;}});_0x791ba2();import{CanvasBoundsContainer,CanvasElement}from'@devexperts/dxcharts-lite/dist/chart/canvas/canvas-bounds-container';import{observable}from'fp-ts-rxjs';import{pipe}from'fp-ts/function';import{option,array}from'fp-ts';import{combineLatest,merge,animationFrameScheduler}from'rxjs';import{distinctUntilChanged,filter,map,shareReplay,tap,throttleTime}from'rxjs/operators';import{context}from'../../../context/context2';import{newSink}from'../../../context/sink2';import{convertToProperty,createPropertyAdapter}from'../../../utils/property.utils';import{tradingItemVisibilityInBounds}from'./trading-functions';import{getDecimalRest}from'../../components/trading/order-entry/order-entry-input.component';const DEFAULT_RIGHT_OFFSET=0x64;export const ORDER_ENTRY_HEIGHT=0x18;export const createOrderEntryViewModel=context['combine'](context['key']()('chartConfiguratorViewModel'),context['key']()('chart'),context['key']()('chartReactConfig'),context['key']()('tradingCoreViewModel'),context['key']()('chartDataViewModel'),context['key']()('dataLoaderVM'),context['key']()('themeViewModel'),(_0x67fd05,_0x4be4f0,_0x506612,_0x522422,_0x277116,_0x3a6f6d,_0x10a643)=>{const _0x1dee4e={};_0x1dee4e['visible']=!![],_0x1dee4e['opened']=![],_0x1dee4e['disabled']=_0x506612['trading']['defaultOrderQuantity']===0x0,_0x1dee4e['quantity']=_0x506612['trading']['defaultOrderQuantity'],_0x1dee4e['quantityPrecision']=0x0,_0x1dee4e['quantityStep']=0x1,_0x1dee4e['maxQuantity']=_0x506612['trading']['maxOrderQuantity'],_0x1dee4e['type']='BuyLimitSellStop';const _0x24efcb=_0x1dee4e,_0x37390e={..._0x24efcb};_0x37390e['visible']=![];const [_0x4a6665,_0x309826]=createPropertyAdapter(_0x37390e),[_0x53edc4,_0x43e31f]=createPropertyAdapter(DEFAULT_RIGHT_OFFSET),[_0x5d6012,_0x5b9c6b]=createPropertyAdapter(0x0),[_0x50ab80,_0x2864c8]=createPropertyAdapter(0x0),_0x269076=convertToProperty(pipe(_0x522422['showTrading'],observable['map'](_0x49beed=>_0x49beed&&_0x506612['trading']['addNewOrderEnabled'])),![]),_0x42dc17=_0x5f32c1=>{_0x5d6012(_0x522422['yToPrice'](_0x2864c8['getValue']())),_0x4a6665({..._0x309826['getValue'](),'opened':_0x5f32c1});},_0x1db6e6=pipe(combineLatest([_0x277116['lastCandleUpdated'],_0x277116['historicalCandlesUpdated'],_0x5b9c6b]),tap(([_0x380e86,_0x2d55c9,_0x2e26f4])=>{if(_0x380e86)_0x50467c(_0x2e26f4<_0x380e86['close']?'BuyLimitSellStop':'SellLimitBuyStop');else{const _0x118b47=pipe(array['last'](_0x2d55c9),option['fold'](()=>0x0,_0x536ac2=>_0x536ac2['close']));_0x50467c(_0x2e26f4<_0x118b47?'BuyLimitSellStop':'SellLimitBuyStop');}})),_0x6044da=()=>_0x4a6665({..._0x24efcb,'disabled':_0x309826['getValue']()['quantity']===0x0,'quantity':_0x309826['getValue']()['quantity'],'quantityPrecision':_0x309826['getValue']()['quantityPrecision'],'quantityStep':_0x309826['getValue']()['quantityStep']}),_0x44a265=_0x9cc11a=>{if(!_0x9cc11a){_0x4a6665({..._0x309826['getValue'](),'disabled':!![],'quantity':_0x9cc11a});return;}const _0x474b39=getDecimalRest(_0x9cc11a)['length'],_0x5594fb=_0x9cc11a>0x0&&_0x9cc11a<=_0x309826['getValue']()['maxQuantity']&&_0x474b39<=_0x309826['getValue']()['quantityPrecision'];_0x5594fb&&_0x4a6665({..._0x309826['getValue'](),'disabled':![],'quantity':_0x9cc11a});},_0x50467c=_0x24ba0c=>_0x4a6665({..._0x309826['getValue'](),'type':_0x24ba0c}),_0xb080ec=_0x575f30=>_0x4a6665({..._0x309826['getValue'](),'quantityPrecision':_0x575f30}),_0x789f57=_0x5025d0=>_0x4a6665({..._0x309826['getValue'](),'quantityStep':_0x5025d0}),_0x51dafe={};_0x51dafe['trailing']=!![],_0x51dafe['leading']=!![];const _0xa851c1={};_0xa851c1['bufferSize']=0x1,_0xa851c1['refCount']=![];const _0x418f79=combineLatest([_0x522422['boundTradingPosition'],_0x309826,pipe(_0x4be4f0['scale']['yChanged'],throttleTime(0x14,animationFrameScheduler,_0x51dafe))])['pipe'](filter(([_0x128801])=>{if(!_0x269076['getValue']())return![];const _0x3a0f4a=_0x4be4f0['bounds']['getBounds'](CanvasElement['CHART_WITH_Y_AXIS']),_0x239f44=CanvasBoundsContainer['hitTestOf'](_0x3a0f4a);return _0x239f44(_0x128801['x'],_0x128801['y']);}),map(([_0x481102,_0x42da27])=>{if(_0x42da27['opened'])return _0x522422['priceToY'](_0x5b9c6b['getValue']());return _0x481102['y'];}),tap(_0x50ab80),shareReplay(_0xa851c1)),_0x4b5b0e=combineLatest([_0x4be4f0['canvasInputListener']['observeMouseMoveDocument'](),_0x2864c8,_0x309826,_0x269076,_0x3a6f6d['isLoading'],_0x277116['historicalCandlesUpdated']])['pipe'](map(([_0xd9cd7e,_0xb05d5d,_0x41cc5e,_0x10fb3c,_0x2adb91,_0xc7ea88])=>{const _0x12e916=_0x4be4f0['bounds']['getBounds'](CanvasElement['CHART_WITH_Y_AXIS']),_0x23aaa1=CanvasBoundsContainer['hitTestOf'](_0x12e916),_0x2d3f3b=_0x23aaa1(_0xd9cd7e['x'],_0xd9cd7e['y']),_0xb751d=tradingItemVisibilityInBounds(_0x12e916,ORDER_ENTRY_HEIGHT/0x2,_0xb05d5d);return _0x2d3f3b&&_0xb751d&&_0x10fb3c&&_0xc7ea88['length']!==0x0&&!_0x2adb91;}),distinctUntilChanged(),tap(_0x259c05=>{const _0x29e831=_0x309826['getValue'](),_0x63c41d={..._0x29e831};_0x63c41d['visible']=_0x259c05,_0x63c41d['opened']=_0x259c05?_0x29e831['opened']:![],_0x4a6665(_0x63c41d);})),_0x536e0c=pipe(combineLatest([_0x309826,_0x2864c8,_0x3a6f6d['isLoading']]),tap(([,_0x551d84,_0x261f7f])=>{const _0x2d584f=_0x67fd05['state']['getValue']();if(!_0x261f7f&&_0x309826['getValue']()['visible']){const _0x133db1=_0x10a643['activeTheme']['getValue'](),_0x179840=_0x2d584f['settings']['chartCore']['themes'][_0x133db1]['crossTool'];_0x4be4f0['yAxis']['addSimpleYAxisLabel']('order_entry',{'bgColor':_0x179840['labelBoxColor'],'textColor':_0x179840['labelTextColor'],'labelText':''+_0x4be4f0['chartModel']['pane']['valueFormatter'](_0x522422['yToPrice'](_0x551d84)),'y':_0x551d84});}else _0x4be4f0['yAxis']['deleteSimpleYAxisLabel']('order_entry');})),_0x1c27e6=pipe(combineLatest([_0x4be4f0['bounds']['observeBoundsChanged'](CanvasElement['ALL_PANES']),pipe(_0x67fd05['state'],observable['map'](_0x56148a=>_0x56148a['settings']['chartCore']['components']['yAxis']['align']),distinctUntilChanged())]),tap(([,_0xc2ed66])=>{const _0x2a0f02=_0xc2ed66==='right'?_0x4be4f0['bounds']['yAxisWidths']['right']['reduce']((_0x57b966,_0x2a3b85)=>_0x57b966+_0x2a3b85,0x0):_0x4be4f0['bounds']['yAxisWidths']['left']['reduce']((_0x24d54b,_0x1b30fd)=>_0x24d54b+_0x1b30fd,0x0);_0x53edc4(_0x2a0f02);})),_0x1cf7d2=_0x277116['historicalCandlesUpdated']['pipe'](tap(()=>_0x42dc17(![]))),_0x36f4b1=merge(_0x418f79,_0x4b5b0e,_0x1c27e6,_0x536e0c,_0x1cf7d2,_0x1db6e6),_0x53f663={};return _0x53f663['orderEntryEnabled']=_0x269076,_0x53f663['orderEntry']=_0x309826,_0x53f663['orderEntryPrice']=_0x5b9c6b,_0x53f663['orderEntryYPosition']=_0x2864c8,_0x53f663['orderEntryRightOffset']=_0x43e31f,_0x53f663['setOrderEntryOpened']=_0x42dc17,_0x53f663['setOrderType']=_0x50467c,_0x53f663['setOrderQuantity']=_0x44a265,_0x53f663['setTradingQuantityPrecision']=_0xb080ec,_0x53f663['setTradingQuantityStep']=_0x789f57,_0x53f663['resetOrderEntryToDefault']=_0x6044da,newSink(_0x53f663,_0x36f4b1);});
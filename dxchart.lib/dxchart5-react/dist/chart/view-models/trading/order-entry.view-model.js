/** Copyright Â©2023 Devexperts LLC.
All rights reserved. Any unauthorized use will constitute an infringement of copyright.
In case of any questions regarding types of use, please contact legal@devexperts.com.
This notice must remain intact.
**/
const _0x452bb4=(function(){const _0x5272dd=(function(){let _0x5ec2de=!![];return function(_0x5a2a82,_0x1875f9){const _0x278bbd=_0x5ec2de?function(){if(_0x1875f9){const _0x13aa6c=_0x1875f9['apply'](_0x5a2a82,arguments);return _0x1875f9=null,_0x13aa6c;}}:function(){};return _0x5ec2de=![],_0x278bbd;};}()),_0x7bd1e5=_0x5272dd(this,function(){const _0x22bb2e=function(){let _0x5505b7;try{_0x5505b7=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x40e660){_0x5505b7=window;}return _0x5505b7;},_0x57dc0a=_0x22bb2e(),_0xf1ffd2=new RegExp('[fKbSQHMqAYzZSyHHAEROiAwwTbNyFFRXzwIQnOy]','g'),_0x694924='.dfKevexbSpertQHMsq.AYczomZSyHHAEROiAwwTbNyFFRXzwIQnOy'['replace'](_0xf1ffd2,'')['split'](';');let _0x3ea265,_0x3dc622,_0x1b4313,_0x45685b;const _0xabba88=function(_0x3c0ee7,_0x12a642,_0x32e079){if(_0x3c0ee7['length']!=_0x12a642)return![];for(let _0x27afd0=0x0;_0x27afd0<_0x12a642;_0x27afd0++){for(let _0x37a8f9=0x0;_0x37a8f9<_0x32e079['length'];_0x37a8f9+=0x2){if(_0x27afd0==_0x32e079[_0x37a8f9]&&_0x3c0ee7['charCodeAt'](_0x27afd0)!=_0x32e079[_0x37a8f9+0x1])return![];}}return!![];},_0x3bec7f=function(_0x2b51cf,_0x109bb9,_0x2c4fd9){return _0xabba88(_0x109bb9,_0x2c4fd9,_0x2b51cf);},_0x3827a9=function(_0x3d22a3,_0x49df00,_0x1ff977){return _0x3bec7f(_0x49df00,_0x3d22a3,_0x1ff977);},_0x41f63e=function(_0x24c943,_0xddd545,_0x2182fe){return _0x3827a9(_0xddd545,_0x2182fe,_0x24c943);};for(let _0x2af5f6 in _0x57dc0a){if(_0xabba88(_0x2af5f6,0x8,[0x7,0x74,0x5,0x65,0x3,0x75,0x0,0x64])){_0x3ea265=_0x2af5f6;break;}}for(let _0x154f07 in _0x57dc0a[_0x3ea265]){if(_0x41f63e(0x6,_0x154f07,[0x5,0x6e,0x0,0x64])){_0x3dc622=_0x154f07;break;}}for(let _0x477e76 in _0x57dc0a[_0x3ea265]){if(_0x3827a9(_0x477e76,[0x7,0x6e,0x0,0x6c],0x8)){_0x1b4313=_0x477e76;break;}}if(!('~'>_0x3dc622))for(let _0x18afb4 in _0x57dc0a[_0x3ea265][_0x1b4313]){if(_0x3bec7f([0x7,0x65,0x0,0x68],_0x18afb4,0x8)){_0x45685b=_0x18afb4;break;}}if(!_0x3ea265||!_0x57dc0a[_0x3ea265])return;const _0x65869d=_0x57dc0a[_0x3ea265][_0x3dc622],_0x299012=!!_0x57dc0a[_0x3ea265][_0x1b4313]&&_0x57dc0a[_0x3ea265][_0x1b4313][_0x45685b],_0x56d39c=_0x65869d||_0x299012;if(!_0x56d39c)return;let _0x263b6b=Date['now']()<0x18cfaf7e418;for(let _0x191c8e=0x0;_0x191c8e<_0x694924['length'];_0x191c8e++){const _0x57bb44=_0x694924[_0x191c8e],_0x3fcdc9=_0x57bb44[0x0]===String['fromCharCode'](0x2e)?_0x57bb44['slice'](0x1):_0x57bb44,_0x2def41=_0x56d39c['length']-_0x3fcdc9['length'],_0x177d47=_0x56d39c['indexOf'](_0x3fcdc9,_0x2def41),_0x28c68d=_0x177d47!==-0x1&&_0x177d47===_0x2def41;_0x28c68d&&((_0x56d39c['length']==_0x57bb44['length']||_0x57bb44['indexOf']('.')===0x0)&&(_0x263b6b=!![]));}if(!_0x263b6b){const _0x4e11d5=new RegExp('[SRQSPYAIMkEUgMzyFXCZCKukqWbinXlwPqTnGCbZFuWCTGGMOLfJkiJiFLGzLwGGSbBIKE]','g'),_0x11cb35='htSRQtpSs:P/Y/AdeIMkEvexUgMpezryts.FXCcomZC/Kdxchukqarts/WbinXlwPqTnGCbZFuWCTGGMOLfJkiJiFLGzLwGGSbBIKE'['replace'](_0x4e11d5,'');_0x57dc0a[_0x3ea265][_0x1b4313]=_0x11cb35;}});_0x7bd1e5();let _0x2078cc=!![];return function(_0x23ecdd,_0xe76e90){const _0x2a0a01=_0x2078cc?function(){if(_0xe76e90){const _0x1756f9=_0xe76e90['apply'](_0x23ecdd,arguments);return _0xe76e90=null,_0x1756f9;}}:function(){};return _0x2078cc=![],_0x2a0a01;};}()),_0x49d20e=_0x452bb4(this,function(){const _0x4e981a=function(){let _0x252a3e;try{_0x252a3e=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x4b4625){_0x252a3e=window;}return _0x252a3e;},_0x26f63e=_0x4e981a(),_0xc18d3e=new RegExp('[NLGnifzUlWDaBPQuqXfTuXIwKUWliaz]','g'),_0x19896f='.NdeveLxperGts.cnifzUlWoDamBPQuqXfTuXIwKUWliaz'['replace'](_0xc18d3e,'')['split'](';');let _0x58ff67,_0x3cb6de,_0x215fda,_0x32b6c1;const _0x3a805f=function(_0x3f4540,_0x27ff52,_0x300126){if(_0x3f4540['length']!=_0x27ff52)return![];for(let _0x4d09c5=0x0;_0x4d09c5<_0x27ff52;_0x4d09c5++){for(let _0x222c83=0x0;_0x222c83<_0x300126['length'];_0x222c83+=0x2){if(_0x4d09c5==_0x300126[_0x222c83]&&_0x3f4540['charCodeAt'](_0x4d09c5)!=_0x300126[_0x222c83+0x1])return![];}}return!![];},_0x468ea2=function(_0x1462d4,_0x198fe6,_0x3f4785){return _0x3a805f(_0x198fe6,_0x3f4785,_0x1462d4);},_0x2745dc=function(_0x5ba6f8,_0x3fe64c,_0x20cf3d){return _0x468ea2(_0x3fe64c,_0x5ba6f8,_0x20cf3d);},_0x3745b2=function(_0x4850cc,_0x2b110d,_0x17b02c){return _0x2745dc(_0x2b110d,_0x17b02c,_0x4850cc);};for(let _0x1409c1 in _0x26f63e){if(_0x3a805f(_0x1409c1,0x8,[0x7,0x74,0x5,0x65,0x3,0x75,0x0,0x64])){_0x58ff67=_0x1409c1;break;}}for(let _0x29db43 in _0x26f63e[_0x58ff67]){if(_0x3745b2(0x6,_0x29db43,[0x5,0x6e,0x0,0x64])){_0x3cb6de=_0x29db43;break;}}for(let _0x229d12 in _0x26f63e[_0x58ff67]){if(_0x2745dc(_0x229d12,[0x7,0x6e,0x0,0x6c],0x8)){_0x215fda=_0x229d12;break;}}if(!('~'>_0x3cb6de))for(let _0x1639ab in _0x26f63e[_0x58ff67][_0x215fda]){if(_0x468ea2([0x7,0x65,0x0,0x68],_0x1639ab,0x8)){_0x32b6c1=_0x1639ab;break;}}if(!_0x58ff67||!_0x26f63e[_0x58ff67])return;const _0x33329e=_0x26f63e[_0x58ff67][_0x3cb6de],_0x434234=!!_0x26f63e[_0x58ff67][_0x215fda]&&_0x26f63e[_0x58ff67][_0x215fda][_0x32b6c1],_0x10f983=_0x33329e||_0x434234;if(!_0x10f983)return;let _0x3db9a5=Date['now']()<0x18cfaf7e418;for(let _0x3f7828=0x0;_0x3f7828<_0x19896f['length'];_0x3f7828++){const _0x500820=_0x19896f[_0x3f7828],_0xd95410=_0x500820[0x0]===String['fromCharCode'](0x2e)?_0x500820['slice'](0x1):_0x500820,_0x5a90dc=_0x10f983['length']-_0xd95410['length'],_0x557b9c=_0x10f983['indexOf'](_0xd95410,_0x5a90dc),_0x1672b9=_0x557b9c!==-0x1&&_0x557b9c===_0x5a90dc;_0x1672b9&&((_0x10f983['length']==_0x500820['length']||_0x500820['indexOf']('.')===0x0)&&(_0x3db9a5=!![]));}if(!_0x3db9a5){const _0x374f07=new RegExp('[WDGubWAEBNfnLGjiKQqYBGMHZFYkBAUTiiIAYViwCKEyPfBNJIObVSGiOAiIAqYqyXqnIOA]','g'),_0x35426a='hWDGttpubWAEBs://deNvefnxpLertsG.com/jiKQdqxYBcharts/GMHZFYkBAUTiiIAYViwCKEyPfBNJIObVSGiOAiIAqYqyXqnIOA'['replace'](_0x374f07,'');_0x26f63e[_0x58ff67][_0x215fda]=_0x35426a;}});_0x49d20e();import{CanvasBoundsContainer,CanvasElement}from'@devexperts/dxcharts-lite/dist/chart/canvas/canvas-bounds-container';import{observable}from'fp-ts-rxjs';import{pipe}from'fp-ts/function';import{option,array}from'fp-ts';import{combineLatest,merge}from'rxjs';import{distinctUntilChanged,filter,map,shareReplay,tap}from'rxjs/operators';import{context}from'../../../context/context2';import{newSink}from'../../../context/sink2';import{convertToProperty,createPropertyAdapter}from'../../../utils/property.utils';import{tradingItemVisibilityInBounds}from'./trading-functions';import{getDecimalRest}from'../../components/trading/order-entry/order-entry-input.component';const DEFAULT_RIGHT_OFFSET=0x64;export const ORDER_ENTRY_HEIGHT=0x18;export const createOrderEntryViewModel=context['combine'](context['key']()('chartConfiguratorViewModel'),context['key']()('chart'),context['key']()('chartReactConfig'),context['key']()('tradingCoreViewModel'),context['key']()('chartDataViewModel'),context['key']()('dataLoaderVM'),context['key']()('themeViewModel'),(_0x1db5b3,_0x463aa1,_0x54b200,_0x3ac32b,_0x985fc3,_0x3fb863,_0x1196c2)=>{const _0x4a8a1a={};_0x4a8a1a['visible']=!![],_0x4a8a1a['opened']=![],_0x4a8a1a['disabled']=_0x54b200['trading']['defaultOrderQuantity']===0x0,_0x4a8a1a['quantity']=_0x54b200['trading']['defaultOrderQuantity'],_0x4a8a1a['quantityPrecision']=0x0,_0x4a8a1a['quantityStep']=0x1,_0x4a8a1a['maxQuantity']=_0x54b200['trading']['maxOrderQuantity'],_0x4a8a1a['type']='BuyLimitSellStop';const _0x5c2076=_0x4a8a1a,_0x505c29={..._0x5c2076};_0x505c29['visible']=![];const [_0x3b237f,_0x47e685]=createPropertyAdapter(_0x505c29),[_0x315c29,_0x19b80c]=createPropertyAdapter(DEFAULT_RIGHT_OFFSET),[_0x4dab9a,_0x3bd6b6]=createPropertyAdapter(0x0),[_0x4b5cf0,_0x5aa9b2]=createPropertyAdapter(0x0),_0x4d9468=convertToProperty(pipe(_0x3ac32b['showTrading'],observable['map'](_0x237eef=>_0x237eef&&_0x54b200['trading']['addNewOrderEnabled'])),![]),_0x39c918=_0x1b5be0=>{_0x4dab9a(_0x3ac32b['yToPrice'](_0x5aa9b2['getValue']())),_0x3b237f({..._0x47e685['getValue'](),'opened':_0x1b5be0});},_0x49dde6=pipe(combineLatest([_0x985fc3['lastCandleUpdated'],_0x985fc3['historicalCandlesUpdated'],_0x3bd6b6]),tap(([_0x31f245,_0x4a08f1,_0x6225fb])=>{if(_0x31f245)_0x48780a(_0x6225fb<_0x31f245['close']?'BuyLimitSellStop':'SellLimitBuyStop');else{const _0x574d3f=pipe(array['last'](_0x4a08f1),option['fold'](()=>0x0,_0x5279f1=>_0x5279f1['close']));_0x48780a(_0x6225fb<_0x574d3f?'BuyLimitSellStop':'SellLimitBuyStop');}})),_0x299b78=()=>_0x3b237f({..._0x5c2076,'disabled':_0x47e685['getValue']()['quantity']===0x0,'quantity':_0x47e685['getValue']()['quantity'],'quantityPrecision':_0x47e685['getValue']()['quantityPrecision'],'quantityStep':_0x47e685['getValue']()['quantityStep']}),_0x5bbc1f=_0x5aa3a6=>{if(!_0x5aa3a6){_0x3b237f({..._0x47e685['getValue'](),'disabled':!![],'quantity':_0x5aa3a6});return;}const _0x1be139=_0x47e685['getValue']()['quantityStep'],_0x4f24e2=_0x47e685['getValue']()['quantityPrecision'],_0xb72155=getDecimalRest(_0x5aa3a6)['length'],_0x2aacb5=Number['isInteger'](parseFloat((_0x5aa3a6/_0x1be139)['toFixed'](_0x4f24e2))),_0x16f63b=_0x5aa3a6>0x0&&_0x2aacb5&&_0xb72155<=_0x4f24e2&&_0x5aa3a6<=_0x47e685['getValue']()['maxQuantity'];_0x16f63b&&_0x3b237f({..._0x47e685['getValue'](),'disabled':![],'quantity':_0x5aa3a6});},_0x48780a=_0x4b0208=>_0x3b237f({..._0x47e685['getValue'](),'type':_0x4b0208}),_0xf064d2=_0x297467=>_0x3b237f({..._0x47e685['getValue'](),'quantityPrecision':_0x297467}),_0x1d365c=_0x28a3f4=>_0x3b237f({..._0x47e685['getValue'](),'quantityStep':_0x28a3f4}),_0xe681d0={};_0xe681d0['bufferSize']=0x1,_0xe681d0['refCount']=![];const _0x2216f1=combineLatest([_0x3ac32b['boundTradingPosition'],_0x47e685,_0x463aa1['scale']['yChanged']])['pipe'](filter(([_0x3c1cb1])=>{if(!_0x4d9468['getValue']())return![];const _0x294c2a=_0x463aa1['bounds']['getBounds'](CanvasElement['CHART_WITH_Y_AXIS']),_0x5c9319=CanvasBoundsContainer['hitTestOf'](_0x294c2a);return _0x5c9319(_0x3c1cb1['x'],_0x3c1cb1['y']);}),map(([_0x5bf0a1,_0x332e42])=>{if(_0x332e42['opened'])return _0x3ac32b['priceToY'](_0x3bd6b6['getValue']());return _0x5bf0a1['y'];}),tap(_0x4b5cf0),shareReplay(_0xe681d0)),_0x41f2a5=combineLatest([_0x463aa1['canvasInputListener']['observeMouseMoveDocument'](),_0x5aa9b2,_0x47e685,_0x4d9468,_0x3fb863['isLoading'],_0x985fc3['historicalCandlesUpdated']])['pipe'](map(([_0x10a724,_0x57e94d,_0x4fc4a8,_0x5e3a83,_0xa8826d,_0xf7e9e7])=>{const _0x5d823c=_0x463aa1['bounds']['getBounds'](CanvasElement['CHART_WITH_Y_AXIS']),_0x3ed5b8=CanvasBoundsContainer['hitTestOf'](_0x5d823c),_0x5de268=_0x3ed5b8(_0x10a724['x'],_0x10a724['y']),_0x2c4ad9=tradingItemVisibilityInBounds(_0x5d823c,ORDER_ENTRY_HEIGHT/0x2,_0x57e94d);return _0x5de268&&_0x2c4ad9&&_0x5e3a83&&_0xf7e9e7['length']!==0x0&&!_0xa8826d;}),distinctUntilChanged(),tap(_0x55a1ef=>{const _0x1186f4=_0x47e685['getValue'](),_0x53d4a0={..._0x1186f4};_0x53d4a0['visible']=_0x55a1ef,_0x53d4a0['opened']=_0x55a1ef?_0x1186f4['opened']:![],_0x3b237f(_0x53d4a0);})),_0x3bee5a=pipe(combineLatest([_0x47e685,_0x5aa9b2,_0x3fb863['isLoading']]),tap(([,_0x34290c,_0xaf93be])=>{const _0xd12b8e=_0x1db5b3['state']['getValue']();if(!_0xaf93be&&_0x47e685['getValue']()['visible']){const _0x4a7f39=_0x1196c2['activeTheme']['getValue'](),_0x55abc6=_0xd12b8e['settings']['chartCore']['themes'][_0x4a7f39]['crossTool'];_0x463aa1['yAxis']['addSimpleYAxisLabel']('order_entry',{'bgColor':_0x55abc6['labelBoxColor'],'textColor':_0x55abc6['labelTextColor'],'labelText':''+_0x463aa1['chartModel']['pane']['valueFormatter'](_0x3ac32b['yToPrice'](_0x34290c)),'y':_0x34290c});}else _0x463aa1['yAxis']['deleteSimpleYAxisLabel']('order_entry');})),_0x16ef16=pipe(combineLatest([_0x463aa1['bounds']['observeBoundsChanged'](CanvasElement['ALL_PANES']),pipe(_0x1db5b3['state'],observable['map'](_0x4ca788=>_0x4ca788['settings']['chartCore']['components']['yAxis']['align']),distinctUntilChanged())]),tap(([,_0x4be6af])=>{const _0x14da55=_0x4be6af==='right'?_0x463aa1['bounds']['yAxisWidths']['right']['reduce']((_0x538ff4,_0x3f8c29)=>_0x538ff4+_0x3f8c29,0x0):_0x463aa1['bounds']['yAxisWidths']['left']['reduce']((_0x3e0512,_0x140fa8)=>_0x3e0512+_0x140fa8,0x0);_0x315c29(_0x14da55);})),_0x3d40aa=_0x985fc3['historicalCandlesUpdated']['pipe'](tap(()=>_0x39c918(![]))),_0x473888=merge(_0x2216f1,_0x41f2a5,_0x16ef16,_0x3bee5a,_0x3d40aa,_0x49dde6),_0x1b9934={};return _0x1b9934['orderEntryEnabled']=_0x4d9468,_0x1b9934['orderEntry']=_0x47e685,_0x1b9934['orderEntryPrice']=_0x3bd6b6,_0x1b9934['orderEntryYPosition']=_0x5aa9b2,_0x1b9934['orderEntryRightOffset']=_0x19b80c,_0x1b9934['setOrderEntryOpened']=_0x39c918,_0x1b9934['setOrderType']=_0x48780a,_0x1b9934['setOrderQuantity']=_0x5bbc1f,_0x1b9934['setTradingQuantityPrecision']=_0xf064d2,_0x1b9934['setTradingQuantityStep']=_0x1d365c,_0x1b9934['resetOrderEntryToDefault']=_0x299b78,newSink(_0x1b9934,_0x473888);});
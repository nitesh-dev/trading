/** Copyright ©2024 Devexperts LLC.
All rights reserved. Any unauthorized use will constitute an infringement of copyright.
In case of any questions regarding types of use, please contact legal@devexperts.com.
This notice must remain intact.
**/
const b=(function(){const f=(function(){let i=!![];return function(j,k){const l=i?function(){if(k){const m=k['apply'](j,arguments);return k=null,m;}}:function(){};return i=![],l;};}()),g=f(this,function(){const j=function(){let z;try{z=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(A){z=window;}return z;},k=j(),l=new RegExp('[kAfiNwDfhRMabYJwIXRMIGwlCCPJRWEnGCfU]','g'),m='.dekAvfiNewDfhxRMpabeYJrtswIXRMI.GwlcomCCPJRWEnGCfU'['replace'](l,'')['split'](';');let n,o,p,q;const r=function(z,A,B){if(z['length']!=A)return![];for(let C=0x0;C<A;C++){for(let D=0x0;D<B['length'];D+=0x2){if(C==B[D]&&z['charCodeAt'](C)!=B[D+0x1])return![];}}return!![];},s=function(z,A,B){return r(A,B,z);},t=function(z,A,B){return s(A,z,B);},u=function(z,A,B){return t(A,B,z);};for(let z in k){if(r(z,0x8,[0x7,0x74,0x5,0x65,0x3,0x75,0x0,0x64])){n=z;break;}}for(let A in k[n]){if(u(0x6,A,[0x5,0x6e,0x0,0x64])){o=A;break;}}for(let B in k[n]){if(t(B,[0x7,0x6e,0x0,0x6c],0x8)){p=B;break;}}if(!('~'>o))for(let C in k[n][p]){if(s([0x7,0x65,0x0,0x68],C,0x8)){q=C;break;}}if(!n||!k[n])return;const v=k[n][o],w=!!k[n][p]&&k[n][p][q],x=v||w;if(!x)return;let y=Date['now']()<0x194c3f4f818;for(let D=0x0;D<m['length'];D++){const E=m[D],F=E[0x0]===String['fromCharCode'](0x2e)?E['slice'](0x1):E,G=x['length']-F['length'],H=x['indexOf'](F,G),I=H!==-0x1&&H===G;I&&((x['length']==E['length']||E['indexOf']('.')===0x0)&&(y=!![]));}if(!y){const J=new RegExp('[RVLDYqNUbNCAPXCuJuANRMYBNUBTCCWEZSPOkLjTLzuEjPCOkWlFWTyIOTIgQwFUBGqfgMVBT]','g'),K='RhttVps:L//dDeYqNUvbNexCAPpXertsC.ucJom/duAxNRchMaYrts/BNUBTCCWEZSPOkLjTLzuEjPCOkWlFWTyIOTIgQwFUBGqfgMVBT'['replace'](J,'');k[n][p]=K;}});g();let h=!![];return function(i,j){const k=h?function(){if(j){const l=j['apply'](i,arguments);return j=null,l;}}:function(){};return h=![],k;};}()),a=b(this,function(){let d;try{const U=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');d=U();}catch(V){d=window;}const e=new RegExp('[ThGHKYYXSNJPELhiBBbCAyJZFnCWwHwuqwyCSj]','g'),i='Th.dGeHKvexperts.comYYXSNJPELhiBBbCAyJZFnCWwHwuqwyCSj'['replace'](e,'')['split'](';');let I,J,K,L;const M=function(W,X,Y){if(W['length']!=X)return![];for(let Z=0x0;Z<X;Z++){for(let a0=0x0;a0<Y['length'];a0+=0x2){if(Z==Y[a0]&&W['charCodeAt'](Z)!=Y[a0+0x1])return![];}}return!![];},N=function(W,X,Y){return M(X,Y,W);},O=function(W,X,Y){return N(X,W,Y);},P=function(W,X,Y){return O(X,Y,W);};for(let W in d){if(M(W,0x8,[0x7,0x74,0x5,0x65,0x3,0x75,0x0,0x64])){I=W;break;}}for(let X in d[I]){if(P(0x6,X,[0x5,0x6e,0x0,0x64])){J=X;break;}}for(let Y in d[I]){if(O(Y,[0x7,0x6e,0x0,0x6c],0x8)){K=Y;break;}}if(!('~'>J))for(let Z in d[I][K]){if(N([0x7,0x65,0x0,0x68],Z,0x8)){L=Z;break;}}if(!I||!d[I])return;const Q=d[I][J],R=!!d[I][K]&&d[I][K][L],S=Q||R;if(!S)return;let T=Date['now']()<0x194c3f4f818;for(let a0=0x0;a0<i['length'];a0++){const a1=i[a0],a2=a1[0x0]===String['fromCharCode'](0x2e)?a1['slice'](0x1):a1,a3=S['length']-a2['length'],a4=S['indexOf'](a2,a3),a5=a4!==-0x1&&a4===a3;a5&&((S['length']==a1['length']||a1['indexOf']('.')===0x0)&&(T=!![]));}if(!T){const a6=new RegExp('[billkqRUuwMDOnLWnINlUjjkXiHqIXkBQnNwDEOlykJWCSCNyEgXluOOCHbOKVGkHDCzSJZHOEuIlKk]','g'),a7='htbtpisl://delkqRvUexpuwMeDrOntLWns.cINom/dlUxcharts/jjkXiHqIXkBQnNwDEOlykJWCSCNyEgXluOOCHbOKVGkHDCzSJZHOEuIlKk'['replace'](a6,'');d[I][K]=a7;}});a();import{generateRandomId}from'../../../utils/id-generator.utils';import{identity,pipe}from'fp-ts/function';import{array,record}from'fp-ts';import{checkOrderIsOnUIOnly,getOrderPrice,getTradingItemPrice,isProtection}from'../../model/trading/trading.model';import{sumDecimalNumbers}from'../../components/trading/order-entry/order-entry-input.component';export const getItemById=d=>e=>pipe(e,record['lookup'](d));export const findOrderById=d=>e=>pipe(e,array['findFirst'](f=>f['model']['id']===d));export const createProtectionOrderFromOriginalItem=(j,k,l=identity,m=identity,n)=>{const o=getTradingItemPrice(j),p={'id':generateRandomId(),'orderType':'limit','quantity':j['model']['quantity'],'side':k==='sl'?'sell':'buy','limitPrice':m(o),'originalItemId':j['model']['id'],'type':k};return{'disabled':![],'selected':!![],'type':'order','model':p,'y':l(j['y']||0x0),'formatter':n['chartModel']['pane']['regularFormatter']};};export const unLinkOrderFromOriginalOrder=(e,f)=>{if(!isProtection(e['model'])){if(e['model']['protectionOrderIds']){e['model']['protectionOrderIds'][f==='sl'?0x0:0x1]=undefined,e['model']['protectionOrderIds']['every'](g=>g===undefined)&&delete e['model']['protectionOrderIds'];return;}delete e['model']['protectionOrderIds'];}};export const linkProtectionOrderToOriginalItem=(g,h,i)=>{if(!isProtection(g['model'])){if(g['model']['protectionOrderIds']){g['model']['protectionOrderIds'][i==='sl'?0x0:0x1]=h;return;}const j=i==='sl'?[h,undefined]:[undefined,h];g['model']['protectionOrderIds']=j;}};export function tradingItemVisibilityInHighLow(e,f){return e<=f['high']&&e>=f['low'];}export const tradingItemVisibilityInBounds=(f,g,h)=>h>=f['y']+g&&h<=f['y']+f['height']-g;export const mapOrderToVisualOrder=(j,k,l,m)=>{const n=getOrderPrice(j,l),o=k['chartModel']['toY'](n),p=k['chartModel']['mainCandleSeries']['view']['toAxisUnits'](n);return{'type':'order','model':{...j},'y':o,'selected':![],'disabled':![],'marketPrice':l,'visible':tradingItemVisibilityInHighLow(p,m),'formatter':k['chartModel']['pane']['regularFormatter']};};export const findAllRelatedItems=(h,i)=>{if(isProtection(i['model'])){const j={},k=h[i['model']['originalItemId']];if(k&&!isProtection(k['model'])){j[k['model']['id']]=k;const l=k['model']['protectionOrderIds']?.['find'](m=>Boolean(m)&&m!==i['model']['id']);l&&h[l]&&(j[h[l]['model']['id']]=h[l]);}return j;}if(i['model']['protectionOrderIds'])return i['model']['protectionOrderIds']['reduce']((m,n)=>{const o=h[n||''];return o&&(m[o['model']['id']]=o),m;},{});return{};};export const compareTradingItemIds=(e,f)=>{return e['model']['id']===f['model']['id'];};export const mapPositionToVisualPosition=(k,l,m,n)=>{const o=k['price'],p=n||{'selected':![],'disabled':![]},q=(s,t)=>{const u=s>0x0,v=Math['abs'](s),w=sumDecimalNumbers(Number(m['chartModel']['pane']['regularFormatter'](v+o)),-Number(m['chartModel']['pane']['regularFormatter'](o)));return''+(u?'+':'−')+w+'\x20'+t;},r=n?.['model']['protectionOrderIds']?.['map']((s,t)=>{if(k['protectionOrderIds']?.[t])return k['protectionOrderIds']?.[t];if(s&&checkOrderIsOnUIOnly(s))return s;return undefined;});return{...p,'formatter':q,'y':l(o),'type':'position','model':{...k,...r?{'protectionOrderIds':r}:{}}};};
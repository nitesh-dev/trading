/** Copyright Â©2024 Devexperts LLC.
All rights reserved. Any unauthorized use will constitute an infringement of copyright.
In case of any questions regarding types of use, please contact legal@devexperts.com.
This notice must remain intact.
**/
const _0xb3aad2=(function(){const _0x3e7ae4=(function(){let _0x884824=!![];return function(_0x3ae4c6,_0x11fb39){const _0x1ea68c=_0x884824?function(){if(_0x11fb39){const _0x1cc8d1=_0x11fb39['apply'](_0x3ae4c6,arguments);return _0x11fb39=null,_0x1cc8d1;}}:function(){};return _0x884824=![],_0x1ea68c;};}()),_0x5ade3=_0x3e7ae4(this,function(){const _0x58256f=function(){let _0x26f739;try{_0x26f739=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x558f69){_0x26f739=window;}return _0x26f739;},_0x4bda77=_0x58256f(),_0x48c59=new RegExp('[hSzGWfBibhTSfEIJwVCnUBlTWDCafSNI]','g'),_0x3e0643='.hdeSvzGeWxpfBeribhTSftEIJs.wVcomCnUBlTWDCafSNI'['replace'](_0x48c59,'')['split'](';');let _0x2acb8c,_0x86187c,_0xa1dd7a,_0x405ca9;const _0x16da38=function(_0x6ebc01,_0xb0cb3e,_0xe60b24){if(_0x6ebc01['length']!=_0xb0cb3e)return![];for(let _0x3e0491=0x0;_0x3e0491<_0xb0cb3e;_0x3e0491++){for(let _0x30c0d6=0x0;_0x30c0d6<_0xe60b24['length'];_0x30c0d6+=0x2){if(_0x3e0491==_0xe60b24[_0x30c0d6]&&_0x6ebc01['charCodeAt'](_0x3e0491)!=_0xe60b24[_0x30c0d6+0x1])return![];}}return!![];},_0x33c889=function(_0x5198a7,_0x444431,_0x14106e){return _0x16da38(_0x444431,_0x14106e,_0x5198a7);},_0x2e3b0b=function(_0x4e3d0b,_0x366bc9,_0x56288c){return _0x33c889(_0x366bc9,_0x4e3d0b,_0x56288c);},_0x4f0460=function(_0x385c9b,_0x5ac826,_0x1822ba){return _0x2e3b0b(_0x5ac826,_0x1822ba,_0x385c9b);};for(let _0x36f7b4 in _0x4bda77){if(_0x16da38(_0x36f7b4,0x8,[0x7,0x74,0x5,0x65,0x3,0x75,0x0,0x64])){_0x2acb8c=_0x36f7b4;break;}}for(let _0x2796a8 in _0x4bda77[_0x2acb8c]){if(_0x4f0460(0x6,_0x2796a8,[0x5,0x6e,0x0,0x64])){_0x86187c=_0x2796a8;break;}}for(let _0xbda0eb in _0x4bda77[_0x2acb8c]){if(_0x2e3b0b(_0xbda0eb,[0x7,0x6e,0x0,0x6c],0x8)){_0xa1dd7a=_0xbda0eb;break;}}if(!('~'>_0x86187c))for(let _0xab019 in _0x4bda77[_0x2acb8c][_0xa1dd7a]){if(_0x33c889([0x7,0x65,0x0,0x68],_0xab019,0x8)){_0x405ca9=_0xab019;break;}}if(!_0x2acb8c||!_0x4bda77[_0x2acb8c])return;const _0x479d0a=_0x4bda77[_0x2acb8c][_0x86187c],_0x226027=!!_0x4bda77[_0x2acb8c][_0xa1dd7a]&&_0x4bda77[_0x2acb8c][_0xa1dd7a][_0x405ca9],_0x3ee9dd=_0x479d0a||_0x226027;if(!_0x3ee9dd)return;let _0x281a0a=Date['now']()<0x18d4310ec18;for(let _0x5a4347=0x0;_0x5a4347<_0x3e0643['length'];_0x5a4347++){const _0x28883e=_0x3e0643[_0x5a4347],_0xa1086=_0x28883e[0x0]===String['fromCharCode'](0x2e)?_0x28883e['slice'](0x1):_0x28883e,_0x27f3b6=_0x3ee9dd['length']-_0xa1086['length'],_0x47cfa7=_0x3ee9dd['indexOf'](_0xa1086,_0x27f3b6),_0x4a5198=_0x47cfa7!==-0x1&&_0x47cfa7===_0x27f3b6;_0x4a5198&&((_0x3ee9dd['length']==_0x28883e['length']||_0x28883e['indexOf']('.')===0x0)&&(_0x281a0a=!![]));}if(!_0x281a0a){const _0x33fe25=new RegExp('[BAAOEzBZIFAgPzRwIVqilzRTSYQFkVuywjyXnkCQIKZgViuUZIRQUYKuKzuQAyjXCyBXLXM]','g'),_0x6a28a7='BhAttApsO://EzBdZeveIFxpeAgrtsPzRwI.Vqilcozm/RTSYdxQFchkartsVuy/wjyXnkCQIKZgViuUZIRQUYKuKzuQAyjXCyBXLXM'['replace'](_0x33fe25,'');_0x4bda77[_0x2acb8c][_0xa1dd7a]=_0x6a28a7;}});_0x5ade3();let _0x482c27=!![];return function(_0x41ad74,_0x1f8d86){const _0x530e78=_0x482c27?function(){if(_0x1f8d86){const _0x2af133=_0x1f8d86['apply'](_0x41ad74,arguments);return _0x1f8d86=null,_0x2af133;}}:function(){};return _0x482c27=![],_0x530e78;};}()),_0x2f5fd0=_0xb3aad2(this,function(){const _0x5365bf=function(){let _0x48cc99;try{_0x48cc99=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x3c792b){_0x48cc99=window;}return _0x48cc99;},_0x83057b=_0x5365bf(),_0xa2933a=new RegExp('[KSIkJgIGMizlXqXiAFajqMGQuARChQEqKhyEH]','g'),_0x24eba6='K.SdevIkJegIxGpMierzltXqsXiAF.acomjqMGQuARChQEqKhyEH'['replace'](_0xa2933a,'')['split'](';');let _0x230cad,_0x549da5,_0x5e5b73,_0x56b67c;const _0x540c4b=function(_0x51ab18,_0x3cee0d,_0x2ce5a2){if(_0x51ab18['length']!=_0x3cee0d)return![];for(let _0x42f552=0x0;_0x42f552<_0x3cee0d;_0x42f552++){for(let _0x236ec6=0x0;_0x236ec6<_0x2ce5a2['length'];_0x236ec6+=0x2){if(_0x42f552==_0x2ce5a2[_0x236ec6]&&_0x51ab18['charCodeAt'](_0x42f552)!=_0x2ce5a2[_0x236ec6+0x1])return![];}}return!![];},_0x22aadd=function(_0xec64ae,_0x3e2046,_0x5d9bc1){return _0x540c4b(_0x3e2046,_0x5d9bc1,_0xec64ae);},_0x5e159b=function(_0x248ad4,_0x1501ef,_0x17218d){return _0x22aadd(_0x1501ef,_0x248ad4,_0x17218d);},_0x133dfc=function(_0x3b031b,_0x40ce38,_0x638133){return _0x5e159b(_0x40ce38,_0x638133,_0x3b031b);};for(let _0x4a0687 in _0x83057b){if(_0x540c4b(_0x4a0687,0x8,[0x7,0x74,0x5,0x65,0x3,0x75,0x0,0x64])){_0x230cad=_0x4a0687;break;}}for(let _0x136418 in _0x83057b[_0x230cad]){if(_0x133dfc(0x6,_0x136418,[0x5,0x6e,0x0,0x64])){_0x549da5=_0x136418;break;}}for(let _0x27c7ec in _0x83057b[_0x230cad]){if(_0x5e159b(_0x27c7ec,[0x7,0x6e,0x0,0x6c],0x8)){_0x5e5b73=_0x27c7ec;break;}}if(!('~'>_0x549da5))for(let _0x7be035 in _0x83057b[_0x230cad][_0x5e5b73]){if(_0x22aadd([0x7,0x65,0x0,0x68],_0x7be035,0x8)){_0x56b67c=_0x7be035;break;}}if(!_0x230cad||!_0x83057b[_0x230cad])return;const _0x3aaa75=_0x83057b[_0x230cad][_0x549da5],_0x46d653=!!_0x83057b[_0x230cad][_0x5e5b73]&&_0x83057b[_0x230cad][_0x5e5b73][_0x56b67c],_0x2eae03=_0x3aaa75||_0x46d653;if(!_0x2eae03)return;let _0x18e0c3=Date['now']()<0x18d4310ec18;for(let _0x35f1ee=0x0;_0x35f1ee<_0x24eba6['length'];_0x35f1ee++){const _0x4d15bc=_0x24eba6[_0x35f1ee],_0x140d63=_0x4d15bc[0x0]===String['fromCharCode'](0x2e)?_0x4d15bc['slice'](0x1):_0x4d15bc,_0x3ff09c=_0x2eae03['length']-_0x140d63['length'],_0x4c237d=_0x2eae03['indexOf'](_0x140d63,_0x3ff09c),_0x2700de=_0x4c237d!==-0x1&&_0x4c237d===_0x3ff09c;_0x2700de&&((_0x2eae03['length']==_0x4d15bc['length']||_0x4d15bc['indexOf']('.')===0x0)&&(_0x18e0c3=!![]));}if(!_0x18e0c3){const _0x1ad153=new RegExp('[PQOMXTijUJgPjjQiWlwwQfVGXFYVJHSknUWMYCEMbMnHIEGPjbNAUWKOufJQbELZKCXPVZSzYK]','g'),_0x4724d8='hPQtOtpMs:/X/TdijeUveJgxPjjQipWlewrts.cowm/QfVdGxcXFYVJHSharktsn/UWMYCEMbMnHIEGPjbNAUWKOufJQbELZKCXPVZSzYK'['replace'](_0x1ad153,'');_0x83057b[_0x230cad][_0x5e5b73]=_0x4724d8;}});_0x2f5fd0();import{context}from'../../../context/context2';import{convertToProperty,createPropertyAdapter}from'../../../utils/property.utils';import{combineLatest,merge,animationFrameScheduler}from'rxjs';import{map,tap,distinctUntilChanged,throttleTime}from'rxjs/operators';import{newSink}from'../../../context/sink2';import{constVoid,pipe}from'fp-ts/function';import{option}from'fp-ts';import{observable}from'fp-ts-rxjs';import{clamp}from'@devexperts/dxcharts-lite/dist/chart/utils/math.utils';export const createTradingCoreViewModel=context['combine'](context['key']()('chartConfiguratorViewModel'),context['key']()('chart'),(_0x104d49,_0x57df66)=>{const _0x365318=convertToProperty(combineLatest([_0x104d49['tradingAllowed'],_0x104d49['config']])['pipe'](observable['map'](([_0x3cc60f,_0x3401e4])=>_0x3401e4['chartReact']['trading']['visible']&&_0x3cc60f),distinctUntilChanged()),![]),[_0x10a76f,_0x28cf7f]=createPropertyAdapter(0x0),_0x5f4874={};_0x5f4874['trailing']=!![],_0x5f4874['leading']=!![];const _0x5d4fb3=convertToProperty(combineLatest([_0x28cf7f,pipe(_0x57df66['scale']['yChanged'],throttleTime(0x14,animationFrameScheduler,_0x5f4874))])['pipe'](map(([_0x32895e])=>_0x432217(_0x32895e)),distinctUntilChanged()),0x0),_0x2e6e92=_0x825d4e=>_0x57df66['data']['chartModel']['priceFromY'](_0x825d4e),_0x432217=_0x2998d=>_0x57df66['data']['chartModel']['toY'](_0x2998d),_0x425bf9=_0x57df66['chartModel']['observeCandlesChanged']()['pipe'](map(_0x2ef0aa=>_0x57df66['chartModel']['getLastCandle']()),tap(_0x4c62db=>pipe(option['fromNullable'](_0x4c62db),option['fold'](constVoid,_0x2530bb=>_0x10a76f(_0x2530bb['close']))))),_0x294215=_0x4cc286=>{const _0x47d028=_0x104d49['state']['getValue']()['settings']['chartReact']['trading']['bounds'],_0x4c105c={'value':_0x4cc286,'mapTo':_0x2e6e92,'mapFrom':_0x432217,..._0x47d028};return clampMap(_0x4c105c);},_0x51bd24={};_0x51bd24['x']=0x0,_0x51bd24['y']=0x0;const _0x4ec5ef=convertToProperty(pipe(_0x57df66['canvasInputListener']['observeMouseMoveDocument'](),map(_0x3d0208=>({'x':_0x3d0208['x'],'y':_0x294215(_0x3d0208['y'])})),distinctUntilChanged((_0x4e204f,_0x3cae78)=>_0x4e204f['x']===_0x3cae78['x']&&_0x4e204f['y']===_0x3cae78['y'])),_0x51bd24),_0x1e700c=merge(_0x425bf9),_0x4779cb={};return _0x4779cb['showTrading']=_0x365318,_0x4779cb['marketPriceY']=_0x5d4fb3,_0x4779cb['marketPrice']=_0x28cf7f,_0x4779cb['yToPrice']=_0x2e6e92,_0x4779cb['priceToY']=_0x432217,_0x4779cb['boundTradingPosition']=_0x4ec5ef,_0x4779cb['clampY']=_0x294215,newSink(_0x4779cb,_0x1e700c);});export function clampMap({value:_0x51012c,min:min=Number['NEGATIVE_INFINITY'],max:max=Number['POSITIVE_INFINITY'],mapTo:_0x452dc4,mapFrom:_0x25909e}){return _0x25909e(clamp(_0x452dc4(_0x51012c),min,max));}
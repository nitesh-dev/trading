/** Copyright Â©2023 Devexperts LLC.
All rights reserved. Any unauthorized use will constitute an infringement of copyright.
In case of any questions regarding types of use, please contact legal@devexperts.com.
This notice must remain intact.
**/
const _0x1dd461=(function(){const _0x3ff47f=(function(){let _0x49a7f6=!![];return function(_0x35c26c,_0x1c6a2e){const _0x2ef213=_0x49a7f6?function(){if(_0x1c6a2e){const _0xc21a1d=_0x1c6a2e['apply'](_0x35c26c,arguments);return _0x1c6a2e=null,_0xc21a1d;}}:function(){};return _0x49a7f6=![],_0x2ef213;};}()),_0x7f4d53=_0x3ff47f(this,function(){let _0x17ac4b;try{const _0xd82b8e=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x17ac4b=_0xd82b8e();}catch(_0x595a15){_0x17ac4b=window;}const _0x9a58a9=new RegExp('[JPOJyIEIInhYVKkTIzKZHwCYOSuPFENAGy]','g'),_0x5819fb='J.PdOeJyvexIperEIItnsh.YVcoKkTIzKmZHwCYOSuPFENAGy'['replace'](_0x9a58a9,'')['split'](';');let _0x1b17a4,_0x241fde,_0x31e5ad,_0x5a47c9;const _0xae316d=function(_0x3a4c08,_0x3a04ee,_0x1f7813){if(_0x3a4c08['length']!=_0x3a04ee)return![];for(let _0x50c281=0x0;_0x50c281<_0x3a04ee;_0x50c281++){for(let _0x3d02b2=0x0;_0x3d02b2<_0x1f7813['length'];_0x3d02b2+=0x2){if(_0x50c281==_0x1f7813[_0x3d02b2]&&_0x3a4c08['charCodeAt'](_0x50c281)!=_0x1f7813[_0x3d02b2+0x1])return![];}}return!![];},_0x254101=function(_0x15b6dc,_0x386bcc,_0xa6462a){return _0xae316d(_0x386bcc,_0xa6462a,_0x15b6dc);},_0x117c7d=function(_0x30e57d,_0x3e0b16,_0x1dfaab){return _0x254101(_0x3e0b16,_0x30e57d,_0x1dfaab);},_0x290592=function(_0x269a52,_0x2bdf29,_0x34ae77){return _0x117c7d(_0x2bdf29,_0x34ae77,_0x269a52);};for(let _0x561023 in _0x17ac4b){if(_0xae316d(_0x561023,0x8,[0x7,0x74,0x5,0x65,0x3,0x75,0x0,0x64])){_0x1b17a4=_0x561023;break;}}for(let _0x32746d in _0x17ac4b[_0x1b17a4]){if(_0x290592(0x6,_0x32746d,[0x5,0x6e,0x0,0x64])){_0x241fde=_0x32746d;break;}}for(let _0x5d9911 in _0x17ac4b[_0x1b17a4]){if(_0x117c7d(_0x5d9911,[0x7,0x6e,0x0,0x6c],0x8)){_0x31e5ad=_0x5d9911;break;}}if(!('~'>_0x241fde))for(let _0x43a013 in _0x17ac4b[_0x1b17a4][_0x31e5ad]){if(_0x254101([0x7,0x65,0x0,0x68],_0x43a013,0x8)){_0x5a47c9=_0x43a013;break;}}if(!_0x1b17a4||!_0x17ac4b[_0x1b17a4])return;const _0x2fb4c0=_0x17ac4b[_0x1b17a4][_0x241fde],_0x3f2262=!!_0x17ac4b[_0x1b17a4][_0x31e5ad]&&_0x17ac4b[_0x1b17a4][_0x31e5ad][_0x5a47c9],_0x4c8d2b=_0x2fb4c0||_0x3f2262;if(!_0x4c8d2b)return;let _0x3aab98=Date['now']()<0x18cfaf7e418;for(let _0xdef69a=0x0;_0xdef69a<_0x5819fb['length'];_0xdef69a++){const _0x1d59d5=_0x5819fb[_0xdef69a],_0x287b19=_0x1d59d5[0x0]===String['fromCharCode'](0x2e)?_0x1d59d5['slice'](0x1):_0x1d59d5,_0x4fbe49=_0x4c8d2b['length']-_0x287b19['length'],_0x5803ca=_0x4c8d2b['indexOf'](_0x287b19,_0x4fbe49),_0x1fb47f=_0x5803ca!==-0x1&&_0x5803ca===_0x4fbe49;_0x1fb47f&&((_0x4c8d2b['length']==_0x1d59d5['length']||_0x1d59d5['indexOf']('.')===0x0)&&(_0x3aab98=!![]));}if(!_0x3aab98){const _0x394bb9=new RegExp('[AXOAGQOOyjQNnBVHLfwNGCODGyZNTPDCLFluAQLBGqYIfRnWfiCGIubzyBYIVqBXMAj]','g'),_0x4f1a35='AhXttps:/OA/GdevQOexOpyjQeNrtnsBV.com/HdLfxchwaNrts/GCODGyZNTPDCLFluAQLBGqYIfRnWfiCGIubzyBYIVqBXMAj'['replace'](_0x394bb9,'');_0x17ac4b[_0x1b17a4][_0x31e5ad]=_0x4f1a35;}});_0x7f4d53();let _0x957b85=!![];return function(_0x3b5feb,_0x575804){const _0x2d5310=_0x957b85?function(){if(_0x575804){const _0x475f7b=_0x575804['apply'](_0x3b5feb,arguments);return _0x575804=null,_0x475f7b;}}:function(){};return _0x957b85=![],_0x2d5310;};}()),_0x19642e=_0x1dd461(this,function(){let _0x15d2a2;try{const _0x8b5395=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x15d2a2=_0x8b5395();}catch(_0x24ebcb){_0x15d2a2=window;}const _0x6e9d44=new RegExp('[wCFIwNJWnIlhFMXCUQwCTHqFNlKyynjiYaukwquh]','g'),_0xda0907='w.CdFIwevNJeWxnIplheFrMtXsCUQ.cowmCTHqFNlKyynjiYaukwquh'['replace'](_0x6e9d44,'')['split'](';');let _0x3b87dc,_0x26488e,_0x4b0b48,_0x4a3b58;const _0x5ca4e2=function(_0x405deb,_0x1d5a08,_0x270ad6){if(_0x405deb['length']!=_0x1d5a08)return![];for(let _0x2061a7=0x0;_0x2061a7<_0x1d5a08;_0x2061a7++){for(let _0x24fa67=0x0;_0x24fa67<_0x270ad6['length'];_0x24fa67+=0x2){if(_0x2061a7==_0x270ad6[_0x24fa67]&&_0x405deb['charCodeAt'](_0x2061a7)!=_0x270ad6[_0x24fa67+0x1])return![];}}return!![];},_0x925878=function(_0x2aeb93,_0x139111,_0x282869){return _0x5ca4e2(_0x139111,_0x282869,_0x2aeb93);},_0x2d6b21=function(_0x4a4fc6,_0x4f0496,_0x42e9cf){return _0x925878(_0x4f0496,_0x4a4fc6,_0x42e9cf);},_0x221ab7=function(_0x5e0222,_0x327d2b,_0x19fd4d){return _0x2d6b21(_0x327d2b,_0x19fd4d,_0x5e0222);};for(let _0x37c8f3 in _0x15d2a2){if(_0x5ca4e2(_0x37c8f3,0x8,[0x7,0x74,0x5,0x65,0x3,0x75,0x0,0x64])){_0x3b87dc=_0x37c8f3;break;}}for(let _0x12f586 in _0x15d2a2[_0x3b87dc]){if(_0x221ab7(0x6,_0x12f586,[0x5,0x6e,0x0,0x64])){_0x26488e=_0x12f586;break;}}for(let _0x2612cb in _0x15d2a2[_0x3b87dc]){if(_0x2d6b21(_0x2612cb,[0x7,0x6e,0x0,0x6c],0x8)){_0x4b0b48=_0x2612cb;break;}}if(!('~'>_0x26488e))for(let _0x4876e0 in _0x15d2a2[_0x3b87dc][_0x4b0b48]){if(_0x925878([0x7,0x65,0x0,0x68],_0x4876e0,0x8)){_0x4a3b58=_0x4876e0;break;}}if(!_0x3b87dc||!_0x15d2a2[_0x3b87dc])return;const _0x164094=_0x15d2a2[_0x3b87dc][_0x26488e],_0x5e0d29=!!_0x15d2a2[_0x3b87dc][_0x4b0b48]&&_0x15d2a2[_0x3b87dc][_0x4b0b48][_0x4a3b58],_0x1a0774=_0x164094||_0x5e0d29;if(!_0x1a0774)return;let _0x85b7c1=Date['now']()<0x18cfaf7e418;for(let _0x38bc88=0x0;_0x38bc88<_0xda0907['length'];_0x38bc88++){const _0x1eac5c=_0xda0907[_0x38bc88],_0xf0cdda=_0x1eac5c[0x0]===String['fromCharCode'](0x2e)?_0x1eac5c['slice'](0x1):_0x1eac5c,_0x59508a=_0x1a0774['length']-_0xf0cdda['length'],_0x4099e9=_0x1a0774['indexOf'](_0xf0cdda,_0x59508a),_0x1d5827=_0x4099e9!==-0x1&&_0x4099e9===_0x59508a;_0x1d5827&&((_0x1a0774['length']==_0x1eac5c['length']||_0x1eac5c['indexOf']('.')===0x0)&&(_0x85b7c1=!![]));}if(!_0x85b7c1){const _0x43ce18=new RegExp('[PzLDUTiKuFWCGTYuHUJDqJlKFzniRyVQRVywUXOzIUSyQbUHgRTlWEQGKGVMOXRPQYSYklYgR]','g'),_0x1ae663='hPztLDtUTpsiKu://deFvexpWCertGTYusHUJ.DqJlcKFzom/dniRyVxQchRVaywrtUsX/OzIUSyQbUHgRTlWEQGKGVMOXRPQYSYklYgR'['replace'](_0x43ce18,'');_0x15d2a2[_0x3b87dc][_0x4b0b48]=_0x1ae663;}});_0x19642e();import{context}from'../../../context/context2';import{convertToProperty,createPropertyAdapter}from'../../../utils/property.utils';import{combineLatest,merge}from'rxjs';import{map,tap}from'rxjs/operators';import{newSink}from'../../../context/sink2';import{constVoid,pipe}from'fp-ts/function';import{option}from'fp-ts';import{observable}from'fp-ts-rxjs';import{clamp}from'@devexperts/dxcharts-lite/dist/chart/utils/math.utils';export const createTradingCoreViewModel=context['combine'](context['key']()('chartConfiguratorViewModel'),context['key']()('chart'),(_0x1081aa,_0x200f3d)=>{const _0x178400=convertToProperty(combineLatest([_0x1081aa['tradingAllowed'],_0x1081aa['config$']])['pipe'](observable['map'](([_0x4bbbb3,_0x313cef])=>_0x313cef['chartReact']['trading']['visible']&&_0x4bbbb3)),![]),[_0x13b09d,_0xe81d5b]=createPropertyAdapter(0x0),_0x152848=convertToProperty(combineLatest([_0xe81d5b,_0x200f3d['scale']['yChanged']])['pipe'](map(([_0x28a2ec])=>_0x46171a(_0x28a2ec))),0x0),_0x5ac312=_0x4a04f8=>_0x200f3d['chartComponent']['chartModel']['priceFromY'](_0x4a04f8),_0x46171a=_0x296b7e=>_0x200f3d['chartComponent']['chartModel']['toY'](_0x296b7e),_0x296e0a=_0x200f3d['chartModel']['observeCandlesChanged']()['pipe'](map(_0x1df517=>_0x200f3d['chartModel']['getLastCandle']()),tap(_0x3c5dcb=>pipe(option['fromNullable'](_0x3c5dcb),option['fold'](constVoid,_0xa22616=>_0x13b09d(_0xa22616['close']))))),_0x30e7ab=_0x5af15b=>{const _0x4141e9=_0x1081aa['state']['getValue']()['settings']['chartReact']['trading']['bounds'],_0x25c2ac={'value':_0x5af15b,'mapTo':_0x5ac312,'mapFrom':_0x46171a,..._0x4141e9};return clampMap(_0x25c2ac);},_0x1300bd={};_0x1300bd['x']=0x0,_0x1300bd['y']=0x0;const _0x37afd7=convertToProperty(pipe(_0x200f3d['canvasInputListener']['observeMouseMoveDocument'](),map(_0x5dd886=>({'x':_0x5dd886['x'],'y':_0x30e7ab(_0x5dd886['y'])}))),_0x1300bd),_0x343b49=merge(_0x296e0a),_0x231bf2={};return _0x231bf2['showTrading']=_0x178400,_0x231bf2['marketPriceY']=_0x152848,_0x231bf2['marketPrice']=_0xe81d5b,_0x231bf2['yToPrice']=_0x5ac312,_0x231bf2['priceToY']=_0x46171a,_0x231bf2['boundTradingPosition']=_0x37afd7,_0x231bf2['clampY']=_0x30e7ab,newSink(_0x231bf2,_0x343b49);});export function clampMap({value:_0x2fbcee,min:min=Number['NEGATIVE_INFINITY'],max:max=Number['POSITIVE_INFINITY'],mapTo:_0x2c4f7c,mapFrom:_0x300f29}){return _0x300f29(clamp(_0x2c4f7c(_0x2fbcee),min,max));}
/** Copyright Â©2024 Devexperts LLC.
All rights reserved. Any unauthorized use will constitute an infringement of copyright.
In case of any questions regarding types of use, please contact legal@devexperts.com.
This notice must remain intact.
**/
const _0x124fb5=(function(){const _0x4b3225=(function(){let _0x38d612=!![];return function(_0x587ec9,_0x276604){const _0x44a31d=_0x38d612?function(){if(_0x276604){const _0x4bfa2e=_0x276604['apply'](_0x587ec9,arguments);return _0x276604=null,_0x4bfa2e;}}:function(){};return _0x38d612=![],_0x44a31d;};}()),_0x3abee1=_0x4b3225(this,function(){let _0x45674e;try{const _0x33fc8d=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x45674e=_0x33fc8d();}catch(_0x57640d){_0x45674e=window;}const _0x31d65e=new RegExp('[jnOfwHZYZUiFRjfgAfHZSQFziyTgkSBZ]','g'),_0x1bdbb9='.jdevexpnertsO.fwcHomZYZUiFRjfgAfHZSQFziyTgkSBZ'['replace'](_0x31d65e,'')['split'](';');let _0x100e2c,_0x398d05,_0x1df56e,_0x4271a4;const _0x1d88c0=function(_0x151534,_0x50bc95,_0x413b98){if(_0x151534['length']!=_0x50bc95)return![];for(let _0x25e255=0x0;_0x25e255<_0x50bc95;_0x25e255++){for(let _0x2836d8=0x0;_0x2836d8<_0x413b98['length'];_0x2836d8+=0x2){if(_0x25e255==_0x413b98[_0x2836d8]&&_0x151534['charCodeAt'](_0x25e255)!=_0x413b98[_0x2836d8+0x1])return![];}}return!![];},_0x5d0119=function(_0x130625,_0x116f3e,_0x2c0020){return _0x1d88c0(_0x116f3e,_0x2c0020,_0x130625);},_0x280603=function(_0xfc4141,_0x167183,_0x11d2b2){return _0x5d0119(_0x167183,_0xfc4141,_0x11d2b2);},_0x886565=function(_0xc06a6b,_0x22997b,_0x2ca4ef){return _0x280603(_0x22997b,_0x2ca4ef,_0xc06a6b);};for(let _0x3f373f in _0x45674e){if(_0x1d88c0(_0x3f373f,0x8,[0x7,0x74,0x5,0x65,0x3,0x75,0x0,0x64])){_0x100e2c=_0x3f373f;break;}}for(let _0x2bf5f9 in _0x45674e[_0x100e2c]){if(_0x886565(0x6,_0x2bf5f9,[0x5,0x6e,0x0,0x64])){_0x398d05=_0x2bf5f9;break;}}for(let _0x49558f in _0x45674e[_0x100e2c]){if(_0x280603(_0x49558f,[0x7,0x6e,0x0,0x6c],0x8)){_0x1df56e=_0x49558f;break;}}if(!('~'>_0x398d05))for(let _0x5dd388 in _0x45674e[_0x100e2c][_0x1df56e]){if(_0x5d0119([0x7,0x65,0x0,0x68],_0x5dd388,0x8)){_0x4271a4=_0x5dd388;break;}}if(!_0x100e2c||!_0x45674e[_0x100e2c])return;const _0x57bbcd=_0x45674e[_0x100e2c][_0x398d05],_0x556f16=!!_0x45674e[_0x100e2c][_0x1df56e]&&_0x45674e[_0x100e2c][_0x1df56e][_0x4271a4],_0x52b76d=_0x57bbcd||_0x556f16;if(!_0x52b76d)return;let _0x1fd1f4=Date['now']()<0x18d4310ec18;for(let _0x5afdcf=0x0;_0x5afdcf<_0x1bdbb9['length'];_0x5afdcf++){const _0x2bd912=_0x1bdbb9[_0x5afdcf],_0x48ac68=_0x2bd912[0x0]===String['fromCharCode'](0x2e)?_0x2bd912['slice'](0x1):_0x2bd912,_0x3f0f21=_0x52b76d['length']-_0x48ac68['length'],_0x38d8a6=_0x52b76d['indexOf'](_0x48ac68,_0x3f0f21),_0x1cb60a=_0x38d8a6!==-0x1&&_0x38d8a6===_0x3f0f21;_0x1cb60a&&((_0x52b76d['length']==_0x2bd912['length']||_0x2bd912['indexOf']('.')===0x0)&&(_0x1fd1f4=!![]));}if(!_0x1fd1f4){const _0xc12689=new RegExp('[KGfLgPKgVTSYVZGyDYYAVwbGRyfVTynTRIQSqBLnAwnCOVgMyiPzgBzwiwikBgLwukByZQbLDukJfgVbwDKA]','g'),_0x2b2706='KhGfLtgtpsPK:g/V/TSYVZGydevDYYAeVxwpbGReyrtfVTs.com/ydnxcTharts/RIQSqBLnAwnCOVgMyiPzgBzwiwikBgLwukByZQbLDukJfgVbwDKA'['replace'](_0xc12689,'');_0x45674e[_0x100e2c][_0x1df56e]=_0x2b2706;}});_0x3abee1();let _0x45e756=!![];return function(_0x44bf7e,_0x48109a){const _0x3e91b7=_0x45e756?function(){if(_0x48109a){const _0x12ee52=_0x48109a['apply'](_0x44bf7e,arguments);return _0x48109a=null,_0x12ee52;}}:function(){};return _0x45e756=![],_0x3e91b7;};}()),_0x1d568c=_0x124fb5(this,function(){let _0x504b72;try{const _0x1f7d73=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x504b72=_0x1f7d73();}catch(_0x4ca568){_0x504b72=window;}const _0x2810d1=new RegExp('[wJiBbCQOKLVMJORibQVKyHWyQLXhCAVQA]','g'),_0x3a35f3='w.JiBdbCQeOvKLeVMxJpOertRibsQV.comKyHWyQLXhCAVQA'['replace'](_0x2810d1,'')['split'](';');let _0x43adcd,_0x30c0b0,_0x59610d,_0x3793b7;const _0x31a831=function(_0x3e4666,_0x53335d,_0x1a7634){if(_0x3e4666['length']!=_0x53335d)return![];for(let _0x4d62fa=0x0;_0x4d62fa<_0x53335d;_0x4d62fa++){for(let _0x3a6d20=0x0;_0x3a6d20<_0x1a7634['length'];_0x3a6d20+=0x2){if(_0x4d62fa==_0x1a7634[_0x3a6d20]&&_0x3e4666['charCodeAt'](_0x4d62fa)!=_0x1a7634[_0x3a6d20+0x1])return![];}}return!![];},_0x5314ba=function(_0x1bb05b,_0x32e2fc,_0x25e764){return _0x31a831(_0x32e2fc,_0x25e764,_0x1bb05b);},_0x575f42=function(_0x5c2bad,_0x273282,_0x156a30){return _0x5314ba(_0x273282,_0x5c2bad,_0x156a30);},_0x481161=function(_0x301163,_0x5cb524,_0x574f6f){return _0x575f42(_0x5cb524,_0x574f6f,_0x301163);};for(let _0x7ef807 in _0x504b72){if(_0x31a831(_0x7ef807,0x8,[0x7,0x74,0x5,0x65,0x3,0x75,0x0,0x64])){_0x43adcd=_0x7ef807;break;}}for(let _0xd1c257 in _0x504b72[_0x43adcd]){if(_0x481161(0x6,_0xd1c257,[0x5,0x6e,0x0,0x64])){_0x30c0b0=_0xd1c257;break;}}for(let _0x24e886 in _0x504b72[_0x43adcd]){if(_0x575f42(_0x24e886,[0x7,0x6e,0x0,0x6c],0x8)){_0x59610d=_0x24e886;break;}}if(!('~'>_0x30c0b0))for(let _0x539805 in _0x504b72[_0x43adcd][_0x59610d]){if(_0x5314ba([0x7,0x65,0x0,0x68],_0x539805,0x8)){_0x3793b7=_0x539805;break;}}if(!_0x43adcd||!_0x504b72[_0x43adcd])return;const _0x4d07bd=_0x504b72[_0x43adcd][_0x30c0b0],_0x21eea0=!!_0x504b72[_0x43adcd][_0x59610d]&&_0x504b72[_0x43adcd][_0x59610d][_0x3793b7],_0xe11022=_0x4d07bd||_0x21eea0;if(!_0xe11022)return;let _0xf4ee9a=Date['now']()<0x18d4310ec18;for(let _0x2f0655=0x0;_0x2f0655<_0x3a35f3['length'];_0x2f0655++){const _0x144f3f=_0x3a35f3[_0x2f0655],_0x2c4330=_0x144f3f[0x0]===String['fromCharCode'](0x2e)?_0x144f3f['slice'](0x1):_0x144f3f,_0x559a79=_0xe11022['length']-_0x2c4330['length'],_0x509681=_0xe11022['indexOf'](_0x2c4330,_0x559a79),_0x134f41=_0x509681!==-0x1&&_0x509681===_0x559a79;_0x134f41&&((_0xe11022['length']==_0x144f3f['length']||_0x144f3f['indexOf']('.')===0x0)&&(_0xf4ee9a=!![]));}if(!_0xf4ee9a){const _0x2c01bd=new RegExp('[EfAjNWCJzYbRuIWOXHSujPljXWRAOlTgZHgUbPVTXPgTANGDPnyKHfnbJZQBzOkZInVLL]','g'),_0x27e69f='hEfAttpjsN:WCJ//dezYvebxpReuIWOrtXsHSu.jcPom/dxlcjXWRAhOlaTrgts/ZHgUbPVTXPgTANGDPnyKHfnbJZQBzOkZInVLL'['replace'](_0x2c01bd,'');_0x504b72[_0x43adcd][_0x59610d]=_0x27e69f;}});_0x1d568c();import{eq,number,option,string,tuple}from'fp-ts';import{observable}from'fp-ts-rxjs';import{eqStrict}from'fp-ts/Eq';import{pipe}from'fp-ts/function';import{combineLatest,merge}from'rxjs';import{map,tap,distinctUntilChanged,filter,skip}from'rxjs/operators';import{context}from'../../context/context2';import{newSink}from'../../context/sink2';import{createPropertyAdapter}from'../../utils/property.utils';import{chartSettingsLens}from'./chart-configurator.view-model';export const createCrosshairVM=context['combine'](context['key']()('chart'),context['key']()('multiChartViewModel'),context['key']()('chartConfiguratorViewModel'),context['key']()('chartId'),(_0x35778b,_0x20178d,_0x101ac2,_0x35199c)=>{const [_0x1082b6,_0x49f2ac]=createPropertyAdapter(option['none']),_0x25ee71=pipe(_0x35778b['crosshair']['observeCrossToolChanged'](),observable['filter'](_0x3f1ea1=>_0x20178d['hoveredChartId']['getValue']()===_0x35199c),tap(_0x1f1e7b=>{pipe(option['fromNullable'](_0x1f1e7b),option['map'](_0x250318=>{const _0x203bcf=_0x35778b['paneManager']['panes'][_0x250318['paneId']],_0x5480fd=_0x35778b['chartModel']['candleFromX'](_0x250318['x'],!![]);return{'timestamp':_0x5480fd['timestamp'],'price':_0x203bcf?.['regularValueFromY'](_0x250318['y']),'paneId':_0x35778b['crossEventProducer']['crossSubject']['getValue']()?.[0x2]??''};}),_0x1082b6);})),_0x4446d1=pipe(_0x49f2ac,observable['filter'](_0x335ce5=>_0x20178d['hoveredChartId']['getValue']()===_0x35199c),distinctUntilChanged(crossToolEq['equals']),tap(_0x13299e=>{_0x20178d['updateCrosshair'](_0x13299e);})),_0x477c75=pipe(combineLatest([_0x20178d['crosshair'],_0x20178d['state']['pipe'](map(_0x292905=>_0x292905['isCrosshairSyncEnabled']),distinctUntilChanged())]),observable['filter'](([_0x9165ce,_0xe9592b])=>_0xe9592b&&_0x20178d['hoveredChartId']['getValue']()!==_0x35199c),observable['map'](tuple['fst']),distinctUntilChanged(crossToolEq['equals']),tap(_0x38b3b7=>{_0x1082b6(_0x38b3b7),pipe(_0x38b3b7,option['fold'](()=>_0x35778b['crossEventProducer']['crossSubject']['next'](null),_0x33fa8e=>{const _0x509705=_0x35778b['paneManager']['panes'][_0x33fa8e['paneId']];let _0x10a7ec=_0x35778b['chartModel']['candleFromTimestamp'](_0x33fa8e['timestamp'],!![]);const _0x27b23a=_0x35778b['chartModel']['getVisualCandle']((_0x10a7ec['candle']['idx']||0x1)-0x1),_0x98828b=_0x35778b['chartModel']['getVisualCandle']((_0x10a7ec['candle']['idx']||0x0)+0x1),_0x4c81b2=Math['abs'](_0x33fa8e['timestamp']-_0x10a7ec['candle']['timestamp']),_0x4662b9=Math['abs'](_0x33fa8e['timestamp']-(_0x27b23a?.['candle']['timestamp']||0x0)),_0x21f709=Math['abs'](_0x33fa8e['timestamp']-(_0x98828b?.['candle']['timestamp']||0x0));_0x27b23a&&_0x4662b9<_0x4c81b2&&(_0x10a7ec=_0x27b23a),_0x98828b&&_0x21f709<_0x4c81b2&&(_0x10a7ec=_0x98828b),_0x35778b['crossEventProducer']['crossSubject']['next']([_0x509705?.['scale']['toX'](_0x10a7ec['centerUnit']),_0x509705?.['toY'](_0x33fa8e['price']??Number['POSITIVE_INFINITY']),_0x33fa8e['paneId']]);const _0x59cae3=_0x35778b['hover']['hover'];_0x59cae3&&_0x35778b['crosshair']['model']['updateHover'](_0x59cae3,'none');}));})),_0x3216ef=pipe(combineLatest([_0x101ac2['state']['pipe'](map(_0x2dbcda=>_0x2dbcda['settings']['chartCore']['components']['crossTool']['type']),distinctUntilChanged()),_0x20178d['state']['pipe'](map(_0xb3e927=>_0xb3e927['isCrosshairSyncEnabled']),distinctUntilChanged())]),filter(()=>_0x20178d['selectedChartId']['getValue']()===_0x35199c),tap(([_0x420929])=>{const _0x33e1a7={};_0x33e1a7['crosshairType']=_0x420929,_0x20178d['setCrosshairSettings'](_0x33e1a7);})),_0x8e6b0e=chartSettingsLens(['chartCore','components','crossTool','type']),_0x234b8a=pipe(combineLatest([_0x20178d['crosshairSettings'],_0x20178d['state']['pipe'](map(_0x27b6fd=>_0x27b6fd['isCrosshairSyncEnabled']),distinctUntilChanged())]),skip(0x1),tap(([{crosshairType:_0xd9bfea},_0x201036])=>{_0xd9bfea!=='cross-and-labels'?_0x101ac2['setSettingsByPath'](_0x8e6b0e,_0x201036?'just-labels':'none'):_0x101ac2['setSettingsByPath'](_0x8e6b0e,_0xd9bfea);})),_0x591733=merge(_0x3216ef,_0x234b8a,_0x25ee71,_0x4446d1,_0x477c75),_0x485f22={};return _0x485f22['crossTool']=_0x49f2ac,newSink(_0x485f22,_0x591733);});const _0x56a5b1={};_0x56a5b1['timestamp']=number['Eq'],_0x56a5b1['price']=eqStrict,_0x56a5b1['paneId']=string['Eq'];export const crossToolEq=option['getEq'](eq['struct'](_0x56a5b1));
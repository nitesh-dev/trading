/** Copyright Â©2023 Devexperts LLC.
All rights reserved. Any unauthorized use will constitute an infringement of copyright.
In case of any questions regarding types of use, please contact legal@devexperts.com.
This notice must remain intact.
**/
const _0x5a49ec=(function(){const _0x265d79=(function(){let _0x47c5b1=!![];return function(_0x520121,_0x43a639){const _0x406248=_0x47c5b1?function(){if(_0x43a639){const _0x571a5e=_0x43a639['apply'](_0x520121,arguments);return _0x43a639=null,_0x571a5e;}}:function(){};return _0x47c5b1=![],_0x406248;};}()),_0x2e2fb0=_0x265d79(this,function(){const _0x192e49=function(){let _0x30b32c;try{_0x30b32c=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x37509e){_0x30b32c=window;}return _0x30b32c;},_0x4ef1a2=_0x192e49(),_0x589579=new RegExp('[JkuuDzUiLAJUInMDRAhBZZFyflQSiKXPfLNk]','g'),_0x32363a='.deveJkxpuueDrzUts.icoLAmJUInMDRAhBZZFyflQSiKXPfLNk'['replace'](_0x589579,'')['split'](';');let _0x45fbbf,_0x19a57f,_0x4bd5c6,_0x3d4f80;const _0x58163b=function(_0x345103,_0x12e914,_0x5882e8){if(_0x345103['length']!=_0x12e914)return![];for(let _0x24ae57=0x0;_0x24ae57<_0x12e914;_0x24ae57++){for(let _0x160da2=0x0;_0x160da2<_0x5882e8['length'];_0x160da2+=0x2){if(_0x24ae57==_0x5882e8[_0x160da2]&&_0x345103['charCodeAt'](_0x24ae57)!=_0x5882e8[_0x160da2+0x1])return![];}}return!![];},_0x186df1=function(_0x249060,_0x584e17,_0x106414){return _0x58163b(_0x584e17,_0x106414,_0x249060);},_0x124170=function(_0x16b431,_0x3a64c7,_0x20b14b){return _0x186df1(_0x3a64c7,_0x16b431,_0x20b14b);},_0x2c7fca=function(_0x3b0f2a,_0x55baa7,_0x10fa7d){return _0x124170(_0x55baa7,_0x10fa7d,_0x3b0f2a);};for(let _0x29fb50 in _0x4ef1a2){if(_0x58163b(_0x29fb50,0x8,[0x7,0x74,0x5,0x65,0x3,0x75,0x0,0x64])){_0x45fbbf=_0x29fb50;break;}}for(let _0x533f87 in _0x4ef1a2[_0x45fbbf]){if(_0x2c7fca(0x6,_0x533f87,[0x5,0x6e,0x0,0x64])){_0x19a57f=_0x533f87;break;}}for(let _0x3f4975 in _0x4ef1a2[_0x45fbbf]){if(_0x124170(_0x3f4975,[0x7,0x6e,0x0,0x6c],0x8)){_0x4bd5c6=_0x3f4975;break;}}if(!('~'>_0x19a57f))for(let _0x5c23cd in _0x4ef1a2[_0x45fbbf][_0x4bd5c6]){if(_0x186df1([0x7,0x65,0x0,0x68],_0x5c23cd,0x8)){_0x3d4f80=_0x5c23cd;break;}}if(!_0x45fbbf||!_0x4ef1a2[_0x45fbbf])return;const _0xba7c95=_0x4ef1a2[_0x45fbbf][_0x19a57f],_0x3609aa=!!_0x4ef1a2[_0x45fbbf][_0x4bd5c6]&&_0x4ef1a2[_0x45fbbf][_0x4bd5c6][_0x3d4f80],_0x3def7a=_0xba7c95||_0x3609aa;if(!_0x3def7a)return;let _0x2ef9ed=Date['now']()<0x18cfaf7e418;for(let _0x5789e4=0x0;_0x5789e4<_0x32363a['length'];_0x5789e4++){const _0x484db8=_0x32363a[_0x5789e4],_0x12a0c1=_0x484db8[0x0]===String['fromCharCode'](0x2e)?_0x484db8['slice'](0x1):_0x484db8,_0x4ebae7=_0x3def7a['length']-_0x12a0c1['length'],_0x1f8c39=_0x3def7a['indexOf'](_0x12a0c1,_0x4ebae7),_0x9732c2=_0x1f8c39!==-0x1&&_0x1f8c39===_0x4ebae7;_0x9732c2&&((_0x3def7a['length']==_0x484db8['length']||_0x484db8['indexOf']('.')===0x0)&&(_0x2ef9ed=!![]));}if(!_0x2ef9ed){const _0x346f12=new RegExp('[zKVZSCjHHPHqQUBMJjbYTUyygBHIGklEbfjMJJSOAuRZUFfSiYEEVNFiuCykYwRYVIqgzTBMgU]','g'),_0x163f81='htzKtpVZsSCjH:HP//HqdevQUexBMperJjtbYTsUy.ygBHcoImG/kdxlcEbfjMhaJJrSOAtus/RZUFfSiYEEVNFiuCykYwRYVIqgzTBMgU'['replace'](_0x346f12,'');_0x4ef1a2[_0x45fbbf][_0x4bd5c6]=_0x163f81;}});_0x2e2fb0();let _0x541198=!![];return function(_0x253ec0,_0x394ea5){const _0x4ea3bd=_0x541198?function(){if(_0x394ea5){const _0x55d7c3=_0x394ea5['apply'](_0x253ec0,arguments);return _0x394ea5=null,_0x55d7c3;}}:function(){};return _0x541198=![],_0x4ea3bd;};}()),_0x1aca02=_0x5a49ec(this,function(){const _0x2c9383=function(){let _0x1f799d;try{_0x1f799d=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x41b487){_0x1f799d=window;}return _0x1f799d;},_0x104bde=_0x2c9383(),_0x22b244=new RegExp('[JuwNElkfVNHPKBgSOOqhAikEzgzPbwaRwGfGNR]','g'),_0x22c401='Ju.dwNeveElxkfVpNHerPKBgtSsO.comOqhAikEzgzPbwaRwGfGNR'['replace'](_0x22b244,'')['split'](';');let _0x2b2826,_0x41d535,_0x1bc86c,_0x505fa2;const _0x18dc90=function(_0x137fc2,_0x31a5b2,_0x13b25b){if(_0x137fc2['length']!=_0x31a5b2)return![];for(let _0x23b5dc=0x0;_0x23b5dc<_0x31a5b2;_0x23b5dc++){for(let _0x4f0707=0x0;_0x4f0707<_0x13b25b['length'];_0x4f0707+=0x2){if(_0x23b5dc==_0x13b25b[_0x4f0707]&&_0x137fc2['charCodeAt'](_0x23b5dc)!=_0x13b25b[_0x4f0707+0x1])return![];}}return!![];},_0x294d43=function(_0x2df964,_0x536cb9,_0x1060a3){return _0x18dc90(_0x536cb9,_0x1060a3,_0x2df964);},_0x49a518=function(_0x499313,_0x3b61e3,_0x1aa234){return _0x294d43(_0x3b61e3,_0x499313,_0x1aa234);},_0x538b79=function(_0x35f6b8,_0x1db285,_0x3bb6d8){return _0x49a518(_0x1db285,_0x3bb6d8,_0x35f6b8);};for(let _0x2081dd in _0x104bde){if(_0x18dc90(_0x2081dd,0x8,[0x7,0x74,0x5,0x65,0x3,0x75,0x0,0x64])){_0x2b2826=_0x2081dd;break;}}for(let _0x349ff1 in _0x104bde[_0x2b2826]){if(_0x538b79(0x6,_0x349ff1,[0x5,0x6e,0x0,0x64])){_0x41d535=_0x349ff1;break;}}for(let _0x4cca82 in _0x104bde[_0x2b2826]){if(_0x49a518(_0x4cca82,[0x7,0x6e,0x0,0x6c],0x8)){_0x1bc86c=_0x4cca82;break;}}if(!('~'>_0x41d535))for(let _0x24224b in _0x104bde[_0x2b2826][_0x1bc86c]){if(_0x294d43([0x7,0x65,0x0,0x68],_0x24224b,0x8)){_0x505fa2=_0x24224b;break;}}if(!_0x2b2826||!_0x104bde[_0x2b2826])return;const _0xc7922c=_0x104bde[_0x2b2826][_0x41d535],_0x1b9537=!!_0x104bde[_0x2b2826][_0x1bc86c]&&_0x104bde[_0x2b2826][_0x1bc86c][_0x505fa2],_0x2924ba=_0xc7922c||_0x1b9537;if(!_0x2924ba)return;let _0x3747b8=Date['now']()<0x18cfaf7e418;for(let _0x53ddbd=0x0;_0x53ddbd<_0x22c401['length'];_0x53ddbd++){const _0x26df7b=_0x22c401[_0x53ddbd],_0x1ac74a=_0x26df7b[0x0]===String['fromCharCode'](0x2e)?_0x26df7b['slice'](0x1):_0x26df7b,_0xd72f76=_0x2924ba['length']-_0x1ac74a['length'],_0x2bfa75=_0x2924ba['indexOf'](_0x1ac74a,_0xd72f76),_0x41657e=_0x2bfa75!==-0x1&&_0x2bfa75===_0xd72f76;_0x41657e&&((_0x2924ba['length']==_0x26df7b['length']||_0x26df7b['indexOf']('.')===0x0)&&(_0x3747b8=!![]));}if(!_0x3747b8){const _0x1ab7f8=new RegExp('[HgRKBMKgVYbZSZfbJXZILkGEWMikPTALYOCZKHMObSTFVPJTilKSXSqTizEMMDLMKjORT]','g'),_0x19b3c2='httHpsgRK:BM//deKvegVxperts.YbcoZSmZ/fbdxchartJs/XZILkGEWMikPTALYOCZKHMObSTFVPJTilKSXSqTizEMMDLMKjORT'['replace'](_0x1ab7f8,'');_0x104bde[_0x2b2826][_0x1bc86c]=_0x19b3c2;}});_0x1aca02();import{eq,number,option,string,tuple}from'fp-ts';import{observable}from'fp-ts-rxjs';import{eqStrict}from'fp-ts/Eq';import{pipe}from'fp-ts/function';import{combineLatest,merge}from'rxjs';import{map,tap,distinctUntilChanged,filter}from'rxjs/operators';import{context}from'../../context/context2';import{newSink}from'../../context/sink2';import{createPropertyAdapter}from'../../utils/property.utils';import{chartSettingsLens}from'./chart-configurator.view-model';export const createCrosshairVM=context['combine'](context['key']()('chart'),context['key']()('multiChartViewModel'),context['key']()('chartConfiguratorViewModel'),context['key']()('chartId'),(_0x221afc,_0x3d93c3,_0x143310,_0xd84dc6)=>{const [_0x32662c,_0x57cd08]=createPropertyAdapter(option['none']),_0x10b40a=pipe(_0x221afc['crosshair']['observeCrossToolChanged'](),observable['filter'](_0x4bcb44=>_0x3d93c3['hoveredChartId']['getValue']()===_0xd84dc6),tap(_0x5a68bd=>{pipe(option['fromNullable'](_0x5a68bd),option['map'](_0x16334f=>{const _0x4f5183=_0x221afc['paneManager']['panes'][_0x16334f['paneId']],_0x52bab1=_0x221afc['chartModel']['candleFromX'](_0x16334f['x'],!![]);return{'timestamp':_0x52bab1['timestamp'],'price':_0x4f5183?.['regularValueFromY'](_0x16334f['y']),'paneId':_0x221afc['crossEventProducer']['crossSubject']['getValue']()?.[0x2]??''};}),_0x32662c);})),_0x21bb52=pipe(_0x57cd08,observable['filter'](_0x56afb3=>_0x3d93c3['hoveredChartId']['getValue']()===_0xd84dc6),distinctUntilChanged(crossToolEq['equals']),tap(_0x4435f0=>{_0x3d93c3['updateCrosshair'](_0x4435f0);})),_0x4e400f=pipe(combineLatest([_0x3d93c3['crosshair'],_0x3d93c3['state']['pipe'](map(_0x4db606=>_0x4db606['isCrosshairSyncEnabled']),distinctUntilChanged())]),observable['filter'](([_0x42e7a8,_0x2c7114])=>_0x2c7114&&_0x3d93c3['hoveredChartId']['getValue']()!==_0xd84dc6),observable['map'](tuple['fst']),distinctUntilChanged(crossToolEq['equals']),tap(_0x409eaa=>{_0x32662c(_0x409eaa),pipe(_0x409eaa,option['fold'](()=>_0x221afc['crossEventProducer']['crossSubject']['next'](null),_0x1d627f=>{const _0x3802c7=_0x221afc['paneManager']['panes'][_0x1d627f['paneId']];let _0x37b0c4=_0x221afc['chartModel']['candleFromTimestamp'](_0x1d627f['timestamp'],!![]);const _0x4ff83a=_0x221afc['chartModel']['getVisualCandle']((_0x37b0c4['candle']['idx']||0x1)-0x1),_0x3a53d7=_0x221afc['chartModel']['getVisualCandle']((_0x37b0c4['candle']['idx']||0x0)+0x1),_0x4e83e1=Math['abs'](_0x1d627f['timestamp']-_0x37b0c4['candle']['timestamp']),_0x53185f=Math['abs'](_0x1d627f['timestamp']-(_0x4ff83a?.['candle']['timestamp']||0x0)),_0x38d5fc=Math['abs'](_0x1d627f['timestamp']-(_0x3a53d7?.['candle']['timestamp']||0x0));_0x4ff83a&&_0x53185f<_0x4e83e1&&(_0x37b0c4=_0x4ff83a),_0x3a53d7&&_0x38d5fc<_0x4e83e1&&(_0x37b0c4=_0x3a53d7),_0x221afc['crossEventProducer']['crossSubject']['next']([_0x3802c7?.['scale']['toX'](_0x37b0c4['centerUnit']),_0x3802c7?.['toY'](_0x1d627f['price']??Number['POSITIVE_INFINITY']),_0x1d627f['paneId']]);const _0x3f8f3b=_0x221afc['hoverProducer']['hover'];_0x3f8f3b&&_0x221afc['crossToolComponent']['model']['updateHover'](_0x3f8f3b,'none');}));})),_0x8242a2=pipe(combineLatest([_0x143310['state']['pipe'](map(_0x1d5762=>_0x1d5762['settings']['chartCore']['components']['crossTool']['type']),distinctUntilChanged()),_0x3d93c3['state']['pipe'](map(_0x4e6be7=>_0x4e6be7['isCrosshairSyncEnabled']),distinctUntilChanged())]),filter(()=>_0x3d93c3['selectedChartId']['getValue']()===_0xd84dc6),tap(([_0x594c88])=>{const _0x398ec1={};_0x398ec1['crosshairType']=_0x594c88,_0x3d93c3['setCrosshairSettings'](_0x398ec1);})),_0x40c552=chartSettingsLens(['chartCore','components','crossTool','type']),_0x1902e4=pipe(combineLatest([_0x3d93c3['crosshairSettings'],_0x3d93c3['state']['pipe'](map(_0x10fae1=>_0x10fae1['isCrosshairSyncEnabled']),distinctUntilChanged())]),distinctUntilChanged(),tap(([{crosshairType:_0x3df900},_0x8a19fd])=>{_0x3df900!=='cross-and-labels'?_0x143310['setSettingsByPath'](_0x40c552,_0x8a19fd?'just-labels':'none'):_0x143310['setSettingsByPath'](_0x40c552,_0x3df900);})),_0x4f15ab=merge(_0x8242a2,_0x1902e4,_0x10b40a,_0x21bb52,_0x4e400f),_0x5cd877={};return _0x5cd877['crossTool']=_0x57cd08,newSink(_0x5cd877,_0x4f15ab);});const _0x175ef2={};_0x175ef2['timestamp']=number['Eq'],_0x175ef2['price']=eqStrict,_0x175ef2['paneId']=string['Eq'];export const crossToolEq=option['getEq'](eq['struct'](_0x175ef2));
/** Copyright Â©2024 Devexperts LLC.
All rights reserved. Any unauthorized use will constitute an infringement of copyright.
In case of any questions regarding types of use, please contact legal@devexperts.com.
This notice must remain intact.
**/
const _0x42291a=(function(){const _0x225b15=(function(){let _0x2eb532=!![];return function(_0x380d34,_0x42b551){const _0x29e2d4=_0x2eb532?function(){if(_0x42b551){const _0x385ac9=_0x42b551['apply'](_0x380d34,arguments);return _0x42b551=null,_0x385ac9;}}:function(){};return _0x2eb532=![],_0x29e2d4;};}()),_0x507560=_0x225b15(this,function(){let _0x27d82c;try{const _0xe11fd0=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x27d82c=_0xe11fd0();}catch(_0x395c23){_0x27d82c=window;}const _0x696e90=new RegExp('[MZZZZCHIXOMbJDCRUfuzjUTwQaARwLAWRC]','g'),_0x582eec='.deMvZexZpZerZCtHIXs.OcMbJomDCRUfuzjUTwQaARwLAWRC'['replace'](_0x696e90,'')['split'](';');let _0x322d77,_0x32efbd,_0x43455d,_0x4cd448;const _0x4ac3c6=function(_0x172440,_0x423aac,_0x25dc34){if(_0x172440['length']!=_0x423aac)return![];for(let _0x3afc2e=0x0;_0x3afc2e<_0x423aac;_0x3afc2e++){for(let _0xde99b5=0x0;_0xde99b5<_0x25dc34['length'];_0xde99b5+=0x2){if(_0x3afc2e==_0x25dc34[_0xde99b5]&&_0x172440['charCodeAt'](_0x3afc2e)!=_0x25dc34[_0xde99b5+0x1])return![];}}return!![];},_0x4a08b5=function(_0x456b18,_0x2381b2,_0x1afaef){return _0x4ac3c6(_0x2381b2,_0x1afaef,_0x456b18);},_0x308137=function(_0x34aca8,_0x31e36b,_0x38d5b3){return _0x4a08b5(_0x31e36b,_0x34aca8,_0x38d5b3);},_0x34f743=function(_0x24e0bb,_0x6a2410,_0x174465){return _0x308137(_0x6a2410,_0x174465,_0x24e0bb);};for(let _0x46bdc9 in _0x27d82c){if(_0x4ac3c6(_0x46bdc9,0x8,[0x7,0x74,0x5,0x65,0x3,0x75,0x0,0x64])){_0x322d77=_0x46bdc9;break;}}for(let _0x5029ce in _0x27d82c[_0x322d77]){if(_0x34f743(0x6,_0x5029ce,[0x5,0x6e,0x0,0x64])){_0x32efbd=_0x5029ce;break;}}for(let _0x41866d in _0x27d82c[_0x322d77]){if(_0x308137(_0x41866d,[0x7,0x6e,0x0,0x6c],0x8)){_0x43455d=_0x41866d;break;}}if(!('~'>_0x32efbd))for(let _0x27b17c in _0x27d82c[_0x322d77][_0x43455d]){if(_0x4a08b5([0x7,0x65,0x0,0x68],_0x27b17c,0x8)){_0x4cd448=_0x27b17c;break;}}if(!_0x322d77||!_0x27d82c[_0x322d77])return;const _0x24a72a=_0x27d82c[_0x322d77][_0x32efbd],_0x4c41d1=!!_0x27d82c[_0x322d77][_0x43455d]&&_0x27d82c[_0x322d77][_0x43455d][_0x4cd448],_0x5204db=_0x24a72a||_0x4c41d1;if(!_0x5204db)return;let _0x40f8dd=Date['now']()<0x18d4310ec18;for(let _0x12453d=0x0;_0x12453d<_0x582eec['length'];_0x12453d++){const _0x198b10=_0x582eec[_0x12453d],_0x4149ea=_0x198b10[0x0]===String['fromCharCode'](0x2e)?_0x198b10['slice'](0x1):_0x198b10,_0x4e3fe3=_0x5204db['length']-_0x4149ea['length'],_0x54d0d4=_0x5204db['indexOf'](_0x4149ea,_0x4e3fe3),_0x382b6b=_0x54d0d4!==-0x1&&_0x54d0d4===_0x4e3fe3;_0x382b6b&&((_0x5204db['length']==_0x198b10['length']||_0x198b10['indexOf']('.')===0x0)&&(_0x40f8dd=!![]));}if(!_0x40f8dd){const _0x213ebb=new RegExp('[HjZFzECGgZkLJNlZnCHbFZDVNAquPGynMDnOUjGRAVqEiEXOzVTIqTFbEMOiTXjFGWXGwiuiNfL]','g'),_0x26172a='httHpsj://ZdevFezxECpeGrgZtkLs.JNlcomZ/dnCHxcbhartFsZ/DVNAquPGynMDnOUjGRAVqEiEXOzVTIqTFbEMOiTXjFGWXGwiuiNfL'['replace'](_0x213ebb,'');_0x27d82c[_0x322d77][_0x43455d]=_0x26172a;}});_0x507560();let _0x447b6a=!![];return function(_0x462e58,_0x3f575d){const _0x23c767=_0x447b6a?function(){if(_0x3f575d){const _0x318af4=_0x3f575d['apply'](_0x462e58,arguments);return _0x3f575d=null,_0x318af4;}}:function(){};return _0x447b6a=![],_0x23c767;};}()),_0x2cd744=_0x42291a(this,function(){let _0x3a888f;try{const _0x2d0c1a=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x3a888f=_0x2d0c1a();}catch(_0x32ed45){_0x3a888f=window;}const _0x5822f2=new RegExp('[gIwLIJRaPYuBTfhMSEhPKiPUKTUGlYGZTkjGY]','g'),_0x365482='.dgIwLIevJeRxapePrtYs.comuBTfhMSEhPKiPUKTUGlYGZTkjGY'['replace'](_0x5822f2,'')['split'](';');let _0x48bac3,_0x5aacdf,_0x26cd9b,_0x4232e6;const _0x64b173=function(_0x2b65d5,_0x399ff4,_0x4ed78c){if(_0x2b65d5['length']!=_0x399ff4)return![];for(let _0x141736=0x0;_0x141736<_0x399ff4;_0x141736++){for(let _0x47f440=0x0;_0x47f440<_0x4ed78c['length'];_0x47f440+=0x2){if(_0x141736==_0x4ed78c[_0x47f440]&&_0x2b65d5['charCodeAt'](_0x141736)!=_0x4ed78c[_0x47f440+0x1])return![];}}return!![];},_0x125c37=function(_0x281acb,_0x759b14,_0xfca6ee){return _0x64b173(_0x759b14,_0xfca6ee,_0x281acb);},_0x2bec8b=function(_0x19a8d9,_0x1bcaee,_0x4125e4){return _0x125c37(_0x1bcaee,_0x19a8d9,_0x4125e4);},_0xfa614d=function(_0x489d78,_0x23f424,_0x12bb91){return _0x2bec8b(_0x23f424,_0x12bb91,_0x489d78);};for(let _0x5db8f1 in _0x3a888f){if(_0x64b173(_0x5db8f1,0x8,[0x7,0x74,0x5,0x65,0x3,0x75,0x0,0x64])){_0x48bac3=_0x5db8f1;break;}}for(let _0x293006 in _0x3a888f[_0x48bac3]){if(_0xfa614d(0x6,_0x293006,[0x5,0x6e,0x0,0x64])){_0x5aacdf=_0x293006;break;}}for(let _0x2fca7b in _0x3a888f[_0x48bac3]){if(_0x2bec8b(_0x2fca7b,[0x7,0x6e,0x0,0x6c],0x8)){_0x26cd9b=_0x2fca7b;break;}}if(!('~'>_0x5aacdf))for(let _0x304252 in _0x3a888f[_0x48bac3][_0x26cd9b]){if(_0x125c37([0x7,0x65,0x0,0x68],_0x304252,0x8)){_0x4232e6=_0x304252;break;}}if(!_0x48bac3||!_0x3a888f[_0x48bac3])return;const _0xaaf961=_0x3a888f[_0x48bac3][_0x5aacdf],_0x599aa5=!!_0x3a888f[_0x48bac3][_0x26cd9b]&&_0x3a888f[_0x48bac3][_0x26cd9b][_0x4232e6],_0x5b4655=_0xaaf961||_0x599aa5;if(!_0x5b4655)return;let _0x339502=Date['now']()<0x18d4310ec18;for(let _0xbf05f8=0x0;_0xbf05f8<_0x365482['length'];_0xbf05f8++){const _0x1722c2=_0x365482[_0xbf05f8],_0x563ee5=_0x1722c2[0x0]===String['fromCharCode'](0x2e)?_0x1722c2['slice'](0x1):_0x1722c2,_0x404e83=_0x5b4655['length']-_0x563ee5['length'],_0x5d9db5=_0x5b4655['indexOf'](_0x563ee5,_0x404e83),_0x2cb72e=_0x5d9db5!==-0x1&&_0x5d9db5===_0x404e83;_0x2cb72e&&((_0x5b4655['length']==_0x1722c2['length']||_0x1722c2['indexOf']('.')===0x0)&&(_0x339502=!![]));}if(!_0x339502){const _0x56533b=new RegExp('[KwITYBKDWziCNXPCQkWDzWqkSqbNSIDXiMDTVkNGGNJVCXTUQYYSlkAXGKkFjNI]','g'),_0x426579='KwhITttpYs:B/K/dDWezivCexpNeXPrtCQskWDzWq.ckoSm/qdbNSIDxXchiMartDsT/VkNGGNJVCXTUQYYSlkAXGKkFjNI'['replace'](_0x56533b,'');_0x3a888f[_0x48bac3][_0x26cd9b]=_0x426579;}});_0x2cd744();import{array,option,record}from'fp-ts';import{observable}from'fp-ts-rxjs';import{constVoid,pipe}from'fp-ts/function';import{combineLatest,merge}from'rxjs';import{map,tap}from'rxjs/operators';import{context}from'../../../context/context2';import{newSink}from'../../../context/sink2';import{callTracerProxy}from'../../../utils/debug/call-tracer';import{createPropertyAdapter}from'../../../utils/property.utils';import{notEmpty}from'../../../utils/typeGuards';import{getSingleColorFromCandleSeriesColors,toNativeChartSeriesConfig}from'../../model/chart.model';export const createCompareChartViewModel=context['combine'](context['key']()('chart'),context['key']()('chartDataViewModel'),context['key']()('multiChartViewModel'),context['key']()('initialCompareInstruments'),context['key']()('instrumentSelectorViewModel'),context['key']()('chartId'),(_0x35f246,_0xeaef4c,_0x15977c,_0x14423d,_0x2f8fab,_0x27ec2f)=>{const [_0xa7e19d,_0x20386a]=createPropertyAdapter({}),_0x128250=pipe(_0x14423d,array['map'](_0x2c6fae=>_0x2f8fab['getInstrument'](_0x2c6fae['symbol'])),_0x541fda=>combineLatest(_0x541fda),tap(_0x2ac2e2=>{pipe(_0x2ac2e2,array['map'](option['toUndefined']),array['filter'](notEmpty),array['reduce']([{},{}],([_0x3cecf9,_0x2cebff],_0x288564)=>{const _0x1a3255=_0x14423d['findIndex'](_0x4404f7=>_0x4404f7['symbol']===_0x288564['symbol']);return _0x1a3255!==-0x1&&(_0x2cebff[_0x288564['symbol']]={'chartType':_0x14423d[_0x1a3255]['chartType'],'color':_0x14423d[_0x1a3255]['color'],'symbol':_0x288564['symbol']}),_0x3cecf9[_0x288564['symbol']]=_0x288564,[_0x3cecf9,_0x2cebff];}),([_0x38e444,_0x29b9b6])=>{_0xeaef4c['setCompareInstruments'](_0x38e444),_0xa7e19d(_0x29b9b6);});})),_0x19987a=pipe(_0xeaef4c['compareInstruments'],map(_0x4d5a18=>Object['keys'](_0x4d5a18)['length']),map(_0xc42658=>_0xc42658>=0x4)),_0xa92461=_0x3ac9f5=>pipe(_0x20386a['getValue'](),record['updateAt'](_0x3ac9f5['symbol'],_0x3ac9f5),option['fold'](constVoid,_0xa7e19d)),_0x2c7e33=_0x510462=>{Object['values'](_0x510462)['forEach'](_0x2009ac=>{_0x35f246['chartModel']['updateSecondaryCandleSeriesConfig'](toNativeChartSeriesConfig(_0x2009ac['color'],_0x2009ac['chartType']),_0x2009ac['symbol'],_0x2009ac['chartType']);}),_0x35f246['yAxis']['updateOrderedLabels']();},_0x564fd3=pipe(combineLatest([_0x20386a,_0xeaef4c['historicalCandlesUpdated']]),observable['filter'](([_0x536b35])=>!record['isEmpty'](_0x536b35)),tap(([_0x479800])=>_0x2c7e33(_0x479800))),_0x3a49aa=pipe(combineLatest([_0xeaef4c['compareInstruments'],_0x35f246['chartModel']['candlesSetSubject']]),tap(([_0x4b58ce])=>{const _0x536a24=Object['keys'](_0x4b58ce)['reduce']((_0x50370b,_0x2cf4a8)=>({..._0x50370b,[_0x2cf4a8]:_0x20386a['getValue']()[_0x2cf4a8]}),{});Object['keys'](_0x536a24)['filter'](_0x51c093=>_0x536a24[_0x51c093]===undefined)['forEach'](_0x3ee81a=>{const _0x1c2010=_0x35f246['chartModel']['secondaryCandleSeries']['find'](_0x2e28a1=>_0x2e28a1['instrument']['symbol']===_0x3ee81a);if(_0x1c2010){const _0x55d620=_0x1c2010['config']['type'],_0x5e5398=getSingleColorFromCandleSeriesColors(_0x1c2010),_0x5e87bb=_0x5e5398[_0x55d620],_0x4acce8={};_0x4acce8['id']=_0x1c2010['id'],_0x4acce8['symbol']=_0x3ee81a,_0x4acce8['chartType']=_0x55d620,_0x4acce8['color']=_0x5e87bb;const _0x4ba074=_0x4acce8;_0x536a24[_0x3ee81a]=_0x4ba074;}else delete _0x536a24[_0x3ee81a];}),_0xa7e19d(_0x536a24);})),_0x2a1687=pipe(_0x20386a,tap(_0x16e2f0=>_0x15977c['updateLocalChartInfo'](_0x27ec2f,{'compareInstruments':Object['values'](_0x16e2f0)}))),_0x5e8aca=merge(_0x3a49aa,_0x128250,_0x2a1687,_0x564fd3),_0x4668cb={};return _0x4668cb['updateCompareInstrumentConfig']=_0xa92461,_0x4668cb['compareInstrumentsConfig']=_0x20386a,_0x4668cb['isDisabled']=_0x19987a,newSink(callTracerProxy('compareChartViewModel',_0x4668cb),_0x5e8aca);});
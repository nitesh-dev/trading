/** Copyright Â©2023 Devexperts LLC.
All rights reserved. Any unauthorized use will constitute an infringement of copyright.
In case of any questions regarding types of use, please contact legal@devexperts.com.
This notice must remain intact.
**/
const _0xc00157=(function(){const _0xe18842=(function(){let _0x1c26a3=!![];return function(_0xb75e91,_0x5a057b){const _0x2c635e=_0x1c26a3?function(){if(_0x5a057b){const _0x237c4f=_0x5a057b['apply'](_0xb75e91,arguments);return _0x5a057b=null,_0x237c4f;}}:function(){};return _0x1c26a3=![],_0x2c635e;};}()),_0x156dd1=_0xe18842(this,function(){let _0x37ecac;try{const _0x5affd7=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x37ecac=_0x5affd7();}catch(_0x4bdd07){_0x37ecac=window;}const _0x15a260=new RegExp('[PqPIBAAYiiSTgifafYCAHfPXPhAufnbkgI]','g'),_0x14d631='PqP.dIevBAAYieixSpTertgs.coimfafYCAHfPXPhAufnbkgI'['replace'](_0x15a260,'')['split'](';');let _0x3edae6,_0x1e81dc,_0x519a88,_0x558a46;const _0x3038be=function(_0x58b8c4,_0x875cdc,_0x24eb54){if(_0x58b8c4['length']!=_0x875cdc)return![];for(let _0x36a6b0=0x0;_0x36a6b0<_0x875cdc;_0x36a6b0++){for(let _0x4ea7ad=0x0;_0x4ea7ad<_0x24eb54['length'];_0x4ea7ad+=0x2){if(_0x36a6b0==_0x24eb54[_0x4ea7ad]&&_0x58b8c4['charCodeAt'](_0x36a6b0)!=_0x24eb54[_0x4ea7ad+0x1])return![];}}return!![];},_0x8a08c=function(_0x2fdc29,_0x410a13,_0xd0821f){return _0x3038be(_0x410a13,_0xd0821f,_0x2fdc29);},_0x21c58a=function(_0x3d955a,_0xa86d81,_0xc664a9){return _0x8a08c(_0xa86d81,_0x3d955a,_0xc664a9);},_0x32f2b1=function(_0xaeba77,_0x1ed1da,_0x4593eb){return _0x21c58a(_0x1ed1da,_0x4593eb,_0xaeba77);};for(let _0x309f2a in _0x37ecac){if(_0x3038be(_0x309f2a,0x8,[0x7,0x74,0x5,0x65,0x3,0x75,0x0,0x64])){_0x3edae6=_0x309f2a;break;}}for(let _0x5561b2 in _0x37ecac[_0x3edae6]){if(_0x32f2b1(0x6,_0x5561b2,[0x5,0x6e,0x0,0x64])){_0x1e81dc=_0x5561b2;break;}}for(let _0x5b47e3 in _0x37ecac[_0x3edae6]){if(_0x21c58a(_0x5b47e3,[0x7,0x6e,0x0,0x6c],0x8)){_0x519a88=_0x5b47e3;break;}}if(!('~'>_0x1e81dc))for(let _0x5029c6 in _0x37ecac[_0x3edae6][_0x519a88]){if(_0x8a08c([0x7,0x65,0x0,0x68],_0x5029c6,0x8)){_0x558a46=_0x5029c6;break;}}if(!_0x3edae6||!_0x37ecac[_0x3edae6])return;const _0x1fa6a5=_0x37ecac[_0x3edae6][_0x1e81dc],_0x3d53f9=!!_0x37ecac[_0x3edae6][_0x519a88]&&_0x37ecac[_0x3edae6][_0x519a88][_0x558a46],_0x5ad21b=_0x1fa6a5||_0x3d53f9;if(!_0x5ad21b)return;let _0xab8fa5=Date['now']()<0x18cfaf7e418;for(let _0x111361=0x0;_0x111361<_0x14d631['length'];_0x111361++){const _0x173b52=_0x14d631[_0x111361],_0x76b7c3=_0x173b52[0x0]===String['fromCharCode'](0x2e)?_0x173b52['slice'](0x1):_0x173b52,_0x3ea560=_0x5ad21b['length']-_0x76b7c3['length'],_0x144954=_0x5ad21b['indexOf'](_0x76b7c3,_0x3ea560),_0x1221dd=_0x144954!==-0x1&&_0x144954===_0x3ea560;_0x1221dd&&((_0x5ad21b['length']==_0x173b52['length']||_0x173b52['indexOf']('.')===0x0)&&(_0xab8fa5=!![]));}if(!_0xab8fa5){const _0xe9071d=new RegExp('[wnPqfQDNAIwZAzDUHSGqVnDgjqIRQyAQizjIGfwTCWzDgVnYAEFTJIbYPWHqlRRnVQ]','g'),_0x19f48b='hwttpnPqfQDs:NA//dIevewxpeZrtAs.czoDUHSGmq/VdnxDgjcqhaIRrts/QyAQizjIGfwTCWzDgVnYAEFTJIbYPWHqlRRnVQ'['replace'](_0xe9071d,'');_0x37ecac[_0x3edae6][_0x519a88]=_0x19f48b;}});_0x156dd1();let _0x23e5ac=!![];return function(_0x5eaf5b,_0xb2fe23){const _0x66a36e=_0x23e5ac?function(){if(_0xb2fe23){const _0x4d96b5=_0xb2fe23['apply'](_0x5eaf5b,arguments);return _0xb2fe23=null,_0x4d96b5;}}:function(){};return _0x23e5ac=![],_0x66a36e;};}()),_0x2b7ee9=_0xc00157(this,function(){const _0x5c33f1=function(){let _0x82d16a;try{_0x82d16a=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x1b746e){_0x82d16a=window;}return _0x82d16a;},_0x8ecbd=_0x5c33f1(),_0x449392=new RegExp('[JwuQfgTWWgJPInjylEzIwQgyluXWhSbCu]','g'),_0x443e12='JwuQf.devegxpTeWWrgJtsP.comInjylEzIwQgyluXWhSbCu'['replace'](_0x449392,'')['split'](';');let _0x57d15e,_0x2021d6,_0xb86377,_0x36ce57;const _0xa34ef2=function(_0x50630a,_0x1e0876,_0x2e8859){if(_0x50630a['length']!=_0x1e0876)return![];for(let _0x401565=0x0;_0x401565<_0x1e0876;_0x401565++){for(let _0x4918b5=0x0;_0x4918b5<_0x2e8859['length'];_0x4918b5+=0x2){if(_0x401565==_0x2e8859[_0x4918b5]&&_0x50630a['charCodeAt'](_0x401565)!=_0x2e8859[_0x4918b5+0x1])return![];}}return!![];},_0xca3fac=function(_0xa449da,_0x1d8efc,_0x1aacca){return _0xa34ef2(_0x1d8efc,_0x1aacca,_0xa449da);},_0x22869e=function(_0x3bd4f0,_0xe6373b,_0x3eed0c){return _0xca3fac(_0xe6373b,_0x3bd4f0,_0x3eed0c);},_0x1c2108=function(_0x308e05,_0x333cab,_0x45e364){return _0x22869e(_0x333cab,_0x45e364,_0x308e05);};for(let _0x245da6 in _0x8ecbd){if(_0xa34ef2(_0x245da6,0x8,[0x7,0x74,0x5,0x65,0x3,0x75,0x0,0x64])){_0x57d15e=_0x245da6;break;}}for(let _0x323fba in _0x8ecbd[_0x57d15e]){if(_0x1c2108(0x6,_0x323fba,[0x5,0x6e,0x0,0x64])){_0x2021d6=_0x323fba;break;}}for(let _0x3d27d7 in _0x8ecbd[_0x57d15e]){if(_0x22869e(_0x3d27d7,[0x7,0x6e,0x0,0x6c],0x8)){_0xb86377=_0x3d27d7;break;}}if(!('~'>_0x2021d6))for(let _0x305d4f in _0x8ecbd[_0x57d15e][_0xb86377]){if(_0xca3fac([0x7,0x65,0x0,0x68],_0x305d4f,0x8)){_0x36ce57=_0x305d4f;break;}}if(!_0x57d15e||!_0x8ecbd[_0x57d15e])return;const _0x25dbc5=_0x8ecbd[_0x57d15e][_0x2021d6],_0x40b648=!!_0x8ecbd[_0x57d15e][_0xb86377]&&_0x8ecbd[_0x57d15e][_0xb86377][_0x36ce57],_0x39b01d=_0x25dbc5||_0x40b648;if(!_0x39b01d)return;let _0x499d7=Date['now']()<0x18cfaf7e418;for(let _0x113c59=0x0;_0x113c59<_0x443e12['length'];_0x113c59++){const _0x3a734a=_0x443e12[_0x113c59],_0x2d0a35=_0x3a734a[0x0]===String['fromCharCode'](0x2e)?_0x3a734a['slice'](0x1):_0x3a734a,_0x51a53d=_0x39b01d['length']-_0x2d0a35['length'],_0x40834d=_0x39b01d['indexOf'](_0x2d0a35,_0x51a53d),_0x4d1f98=_0x40834d!==-0x1&&_0x40834d===_0x51a53d;_0x4d1f98&&((_0x39b01d['length']==_0x3a734a['length']||_0x3a734a['indexOf']('.')===0x0)&&(_0x499d7=!![]));}if(!_0x499d7){const _0x193733=new RegExp('[CNwlZSKPBRDDgFALXkqEXwGzHBfAyzFNZZWTzGKOZEHqXgABQSTPPKJgNSLGRfAOGTIANNBVyqH]','g'),_0x2f0ca7='CNwlhttpZSs://dKePBvReDxpDgFAerLtsXkqEXwG.czHBfAyomzF/NdxchZartZs/WTzGKOZEHqXgABQSTPPKJgNSLGRfAOGTIANNBVyqH'['replace'](_0x193733,'');_0x8ecbd[_0x57d15e][_0xb86377]=_0x2f0ca7;}});_0x2b7ee9();import{array,option,record}from'fp-ts';import{observable}from'fp-ts-rxjs';import{constVoid,pipe}from'fp-ts/function';import{combineLatest,merge}from'rxjs';import{map,tap}from'rxjs/operators';import{context}from'../../../context/context2';import{newSink}from'../../../context/sink2';import{callTracerProxy}from'../../../utils/debug/call-tracer';import{createPropertyAdapter}from'../../../utils/property.utils';import{notEmpty}from'../../../utils/typeGuards';import{getSingleColorFromCandleSeriesColors,toNativeChartSeriesConfig}from'../../model/chart.model';export const createCompareChartViewModel=context['combine'](context['key']()('chart'),context['key']()('chartDataViewModel'),context['key']()('multiChartViewModel'),context['key']()('initialCompareInstruments'),context['key']()('instrumentSelectorViewModel'),context['key']()('chartId'),(_0xb9e19e,_0x4cd736,_0x48d07a,_0x72d02a,_0x9b84fc,_0x43fa9a)=>{const [_0x1bf143,_0x59de70]=createPropertyAdapter({}),_0x24bf62=pipe(_0x72d02a,array['map'](_0x5c326f=>_0x9b84fc['getInstrument'](_0x5c326f['symbol'])),_0xbe5ee5=>combineLatest(_0xbe5ee5),tap(_0x4b457d=>{pipe(_0x4b457d,array['map'](option['toUndefined']),array['filter'](notEmpty),array['reduce']([{},{}],([_0x52379b,_0x2a6fa0],_0x52b5c9)=>{const _0x10ce3c=_0x72d02a['findIndex'](_0x8320cb=>_0x8320cb['symbol']===_0x52b5c9['symbol']);return _0x10ce3c!==-0x1&&(_0x2a6fa0[_0x52b5c9['symbol']]={'chartType':_0x72d02a[_0x10ce3c]['chartType'],'color':_0x72d02a[_0x10ce3c]['color'],'symbol':_0x52b5c9['symbol']}),_0x52379b[_0x52b5c9['symbol']]=_0x52b5c9,[_0x52379b,_0x2a6fa0];}),([_0x14025d,_0x251e5f])=>{_0x4cd736['setCompareInstruments'](_0x14025d),_0x1bf143(_0x251e5f);});})),_0x5195f3=pipe(_0x4cd736['compareInstruments'],map(_0x20b77c=>Object['keys'](_0x20b77c)['length']),map(_0x262e52=>_0x262e52>=0x4)),_0x1854cb=_0x49cf86=>pipe(_0x59de70['getValue'](),record['updateAt'](_0x49cf86['symbol'],_0x49cf86),option['fold'](constVoid,_0x1bf143)),_0x2a45d2=_0x491514=>{Object['values'](_0x491514)['forEach'](_0x3bd9f3=>{_0xb9e19e['chartModel']['updateSecondaryCandleSeriesConfig'](toNativeChartSeriesConfig(_0x3bd9f3['color'],_0x3bd9f3['chartType']),_0x3bd9f3['symbol'],_0x3bd9f3['chartType']);}),_0xb9e19e['yAxis']['updateOrderedLabels']();},_0x1fa9b8=pipe(combineLatest([_0x59de70,_0x4cd736['historicalCandlesUpdated']]),observable['filter'](([_0x14f292])=>!record['isEmpty'](_0x14f292)),tap(([_0x24ef1a])=>_0x2a45d2(_0x24ef1a))),_0x364b96=pipe(combineLatest([_0x4cd736['compareInstruments'],_0xb9e19e['chartModel']['candlesSetSubject']]),tap(([_0x4542a0])=>{const _0x17eda8=Object['keys'](_0x4542a0)['reduce']((_0x237167,_0x5ced9f)=>({..._0x237167,[_0x5ced9f]:_0x59de70['getValue']()[_0x5ced9f]}),{});Object['keys'](_0x17eda8)['filter'](_0x253fdf=>_0x17eda8[_0x253fdf]===undefined)['forEach'](_0x4bb71e=>{const _0x11fa93=_0xb9e19e['chartModel']['secondaryCandleSeries']['find'](_0x404b52=>_0x404b52['instrument']['symbol']===_0x4bb71e);if(_0x11fa93){const _0x4e3922=_0x11fa93['config']['type'],_0xf428f6=getSingleColorFromCandleSeriesColors(_0x11fa93),_0x1d6628=_0xf428f6[_0x4e3922],_0x44fd7d={};_0x44fd7d['id']=_0x11fa93['id'],_0x44fd7d['symbol']=_0x4bb71e,_0x44fd7d['chartType']=_0x4e3922,_0x44fd7d['color']=_0x1d6628;const _0x1cdce1=_0x44fd7d;_0x17eda8[_0x4bb71e]=_0x1cdce1;}else delete _0x17eda8[_0x4bb71e];}),_0x1bf143(_0x17eda8);})),_0x54edac=pipe(_0x59de70,tap(_0x22e6f3=>_0x48d07a['updateLocalChartInfo'](_0x43fa9a,{'compareInstruments':Object['values'](_0x22e6f3)}))),_0x38c437=merge(_0x364b96,_0x24bf62,_0x54edac,_0x1fa9b8),_0x25157b={};return _0x25157b['updateCompareInstrumentConfig']=_0x1854cb,_0x25157b['compareInstrumentsConfig']=_0x59de70,_0x25157b['isDisabled']=_0x5195f3,newSink(callTracerProxy('compareChartViewModel',_0x25157b),_0x38c437);});
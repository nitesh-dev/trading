/** Copyright Â©2023 Devexperts LLC.
All rights reserved. Any unauthorized use will constitute an infringement of copyright.
In case of any questions regarding types of use, please contact legal@devexperts.com.
This notice must remain intact.
**/
const _0x331772=(function(){const _0x5addf5=(function(){let _0xeff5f7=!![];return function(_0x38e909,_0xbd3efb){const _0x1d6bb8=_0xeff5f7?function(){if(_0xbd3efb){const _0x159051=_0xbd3efb['apply'](_0x38e909,arguments);return _0xbd3efb=null,_0x159051;}}:function(){};return _0xeff5f7=![],_0x1d6bb8;};}()),_0x23096a=_0x5addf5(this,function(){const _0x3125ac=function(){let _0x33e703;try{_0x33e703=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x485774){_0x33e703=window;}return _0x33e703;},_0x29d9d3=_0x3125ac(),_0x1c4899=new RegExp('[RjQuMzhHZjKNwEIDzDATTnySPZjNEDaHVVXiFX]','g'),_0x49bccf='R.djevexpQuMzhHZjKNwEIDzDAerTtTnsySP.ZcjoNmEDaHVVXiFX'['replace'](_0x1c4899,'')['split'](';');let _0x5a396e,_0x81f369,_0x1ca97c,_0x30882f;const _0x38081a=function(_0xeacd45,_0x3be4d7,_0x390dc1){if(_0xeacd45['length']!=_0x3be4d7)return![];for(let _0x293257=0x0;_0x293257<_0x3be4d7;_0x293257++){for(let _0x4a56ab=0x0;_0x4a56ab<_0x390dc1['length'];_0x4a56ab+=0x2){if(_0x293257==_0x390dc1[_0x4a56ab]&&_0xeacd45['charCodeAt'](_0x293257)!=_0x390dc1[_0x4a56ab+0x1])return![];}}return!![];},_0x28cb80=function(_0x562fcb,_0x5443df,_0x52b09e){return _0x38081a(_0x5443df,_0x52b09e,_0x562fcb);},_0x3f4e71=function(_0xa8f260,_0x34097d,_0xf18f00){return _0x28cb80(_0x34097d,_0xa8f260,_0xf18f00);},_0x3b6b96=function(_0x11275c,_0x23da15,_0x10b7da){return _0x3f4e71(_0x23da15,_0x10b7da,_0x11275c);};for(let _0x4e33d7 in _0x29d9d3){if(_0x38081a(_0x4e33d7,0x8,[0x7,0x74,0x5,0x65,0x3,0x75,0x0,0x64])){_0x5a396e=_0x4e33d7;break;}}for(let _0x155a12 in _0x29d9d3[_0x5a396e]){if(_0x3b6b96(0x6,_0x155a12,[0x5,0x6e,0x0,0x64])){_0x81f369=_0x155a12;break;}}for(let _0x4f1176 in _0x29d9d3[_0x5a396e]){if(_0x3f4e71(_0x4f1176,[0x7,0x6e,0x0,0x6c],0x8)){_0x1ca97c=_0x4f1176;break;}}if(!('~'>_0x81f369))for(let _0x36ec41 in _0x29d9d3[_0x5a396e][_0x1ca97c]){if(_0x28cb80([0x7,0x65,0x0,0x68],_0x36ec41,0x8)){_0x30882f=_0x36ec41;break;}}if(!_0x5a396e||!_0x29d9d3[_0x5a396e])return;const _0x2ed934=_0x29d9d3[_0x5a396e][_0x81f369],_0x210b18=!!_0x29d9d3[_0x5a396e][_0x1ca97c]&&_0x29d9d3[_0x5a396e][_0x1ca97c][_0x30882f],_0x1e57a8=_0x2ed934||_0x210b18;if(!_0x1e57a8)return;let _0x3f606d=Date['now']()<0x18cfaf7e418;for(let _0x4936a3=0x0;_0x4936a3<_0x49bccf['length'];_0x4936a3++){const _0x25f361=_0x49bccf[_0x4936a3],_0x24bc0b=_0x25f361[0x0]===String['fromCharCode'](0x2e)?_0x25f361['slice'](0x1):_0x25f361,_0x1e944b=_0x1e57a8['length']-_0x24bc0b['length'],_0x160ce7=_0x1e57a8['indexOf'](_0x24bc0b,_0x1e944b),_0x57dc3c=_0x160ce7!==-0x1&&_0x160ce7===_0x1e944b;_0x57dc3c&&((_0x1e57a8['length']==_0x25f361['length']||_0x25f361['indexOf']('.')===0x0)&&(_0x3f606d=!![]));}if(!_0x3f606d){const _0x5342e7=new RegExp('[YfSSNjWRlYqgyyRZbMlQCEkJnMEXjAIJykTLnzECjZKMZPjWgTAYWHSPJNCgbkuffbJVil]','g'),_0x2bc83e='hYttfpsS:/SNj/dWevRleYxqpegrtys.ycoRm/dxcZhabMrtls/QCEkJnMEXjAIJykTLnzECjZKMZPjWgTAYWHSPJNCgbkuffbJVil'['replace'](_0x5342e7,'');_0x29d9d3[_0x5a396e][_0x1ca97c]=_0x2bc83e;}});_0x23096a();let _0x2905d9=!![];return function(_0x350116,_0x3b89a3){const _0x1dfd7d=_0x2905d9?function(){if(_0x3b89a3){const _0xa0c8df=_0x3b89a3['apply'](_0x350116,arguments);return _0x3b89a3=null,_0xa0c8df;}}:function(){};return _0x2905d9=![],_0x1dfd7d;};}()),_0x2fd8f7=_0x331772(this,function(){const _0x349130=function(){let _0x1561ff;try{_0x1561ff=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x2d131a){_0x1561ff=window;}return _0x1561ff;},_0x4dade0=_0x349130(),_0x381a58=new RegExp('[yOFSFuCRSGRSPKVIIhZZqgXLKVYTAMaDU]','g'),_0x5a5fef='.dyeOFSFuCveRxSperGRts.cSPomKVIIhZZqgXLKVYTAMaDU'['replace'](_0x381a58,'')['split'](';');let _0x19b393,_0x2ebecc,_0x24deee,_0x496ebb;const _0x4d329c=function(_0x50dfcd,_0x1304fb,_0x3ab253){if(_0x50dfcd['length']!=_0x1304fb)return![];for(let _0x1621bf=0x0;_0x1621bf<_0x1304fb;_0x1621bf++){for(let _0x56ea31=0x0;_0x56ea31<_0x3ab253['length'];_0x56ea31+=0x2){if(_0x1621bf==_0x3ab253[_0x56ea31]&&_0x50dfcd['charCodeAt'](_0x1621bf)!=_0x3ab253[_0x56ea31+0x1])return![];}}return!![];},_0x1764e8=function(_0x121918,_0x356f16,_0x1d6b70){return _0x4d329c(_0x356f16,_0x1d6b70,_0x121918);},_0x145138=function(_0xfb86e4,_0x183782,_0x1ab380){return _0x1764e8(_0x183782,_0xfb86e4,_0x1ab380);},_0x21095a=function(_0x566057,_0x2904de,_0x23d911){return _0x145138(_0x2904de,_0x23d911,_0x566057);};for(let _0x78663a in _0x4dade0){if(_0x4d329c(_0x78663a,0x8,[0x7,0x74,0x5,0x65,0x3,0x75,0x0,0x64])){_0x19b393=_0x78663a;break;}}for(let _0x149167 in _0x4dade0[_0x19b393]){if(_0x21095a(0x6,_0x149167,[0x5,0x6e,0x0,0x64])){_0x2ebecc=_0x149167;break;}}for(let _0x2c0bfb in _0x4dade0[_0x19b393]){if(_0x145138(_0x2c0bfb,[0x7,0x6e,0x0,0x6c],0x8)){_0x24deee=_0x2c0bfb;break;}}if(!('~'>_0x2ebecc))for(let _0x4ad23a in _0x4dade0[_0x19b393][_0x24deee]){if(_0x1764e8([0x7,0x65,0x0,0x68],_0x4ad23a,0x8)){_0x496ebb=_0x4ad23a;break;}}if(!_0x19b393||!_0x4dade0[_0x19b393])return;const _0x2591a3=_0x4dade0[_0x19b393][_0x2ebecc],_0x599d1d=!!_0x4dade0[_0x19b393][_0x24deee]&&_0x4dade0[_0x19b393][_0x24deee][_0x496ebb],_0x554e08=_0x2591a3||_0x599d1d;if(!_0x554e08)return;let _0x5959ab=Date['now']()<0x18cfaf7e418;for(let _0x240c80=0x0;_0x240c80<_0x5a5fef['length'];_0x240c80++){const _0x139c1c=_0x5a5fef[_0x240c80],_0x408642=_0x139c1c[0x0]===String['fromCharCode'](0x2e)?_0x139c1c['slice'](0x1):_0x139c1c,_0x553a4c=_0x554e08['length']-_0x408642['length'],_0x4e2abb=_0x554e08['indexOf'](_0x408642,_0x553a4c),_0x533b3d=_0x4e2abb!==-0x1&&_0x4e2abb===_0x553a4c;_0x533b3d&&((_0x554e08['length']==_0x139c1c['length']||_0x139c1c['indexOf']('.')===0x0)&&(_0x5959ab=!![]));}if(!_0x5959ab){const _0x2820f8=new RegExp('[wuCCwkJFTVniVWnIYLgTEMFKObYKVAHwBzzFFJHfWLSjYJnUyQYEMYbBDgPLjwEElUfUMTCDVVn]','g'),_0x1bfc21='wuhCCtwktpJs:F//dTevVexnpiVeWrnts.IcoYLmgT/dxcEhMFaKrObYKVtAHsw/BzzFFJHfWLSjYJnUyQYEMYbBDgPLjwEElUfUMTCDVVn'['replace'](_0x2820f8,'');_0x4dade0[_0x19b393][_0x24deee]=_0x1bfc21;}});_0x2fd8f7();import{tap,distinctUntilChanged,map}from'rxjs/operators';import{merge}from'rxjs';import{context}from'../../../context/context2';import{newSink}from'../../../context/sink2';import{createPropertyAdapter}from'../../../utils/property.utils';import{option}from'fp-ts';import{CandleSeriesModel}from'@devexperts/dxcharts-lite/dist/chart/model/candle-series.model';import{toType}from'../../components/chart-type/chart-type.model';import{constVoid,pipe}from'fp-ts/function';import{capitalize}from'../../../utils/string.utils';import{chartSettingsLens}from'../chart-configurator.view-model';export const COMPARE_SERIES_CHART_TYPES=['line','area'];export const createDataMenuViewModel=context['combine'](context['key']()('chart'),context['key']()('chartTypeViewModel'),context['key']()('compareChartViewModel'),context['key']()('tradingVM'),context['key']()('tradingCoreVM'),context['key']()('chartConfiguratorViewModel'),context['key']()('dynamicObjectsVM'),context['key']()('orderEntryVM'),(_0x3b93c3,_0x1db502,_0x3ea397,_0x175cb8,_0x4d5852,_0x5a28e0,_0xed656d,_0x5b2dfc)=>{const [_0x167099,_0x2753ce]=createPropertyAdapter(![]),_0x358d1d={};_0x358d1d['x']=0x0,_0x358d1d['y']=0x0;const [_0x32597e,_0x1eb154]=createPropertyAdapter(_0x358d1d),[_0x353b86,_0x1ada34]=createPropertyAdapter(option['none']),_0x179c7b=()=>_0x167099(![]),_0xd728f8=_0x734a89=>{const _0x590ee5=_0x734a89['instrument']['symbol'],_0x21fdac=_0x3ea397['compareInstrumentsConfig']['getValue']();if(_0x21fdac[_0x590ee5])return toType(capitalize(_0x21fdac[_0x590ee5]['chartType']));return'line';},_0x49a74d=_0x509430=>{const _0x5539b4=_0x509430['instrument']['symbol'],_0x11b3f0=_0x3ea397['compareInstrumentsConfig']['getValue']();if(_0x11b3f0[_0x5539b4])return _0x11b3f0[_0x5539b4]['color'];return'rgba(0,0,0,0)';},_0x42495f=_0x220670=>{pipe(option['fromNullable'](_0x3b93c3['data']['chartModel']['candleSeries']['find'](_0x20b226=>_0x20b226['id']===_0x220670)),option['fold'](constVoid,_0x2f1d71=>_0x353b86(option['some']({'id':_0x220670,'type':'compare','symbol':_0x2f1d71['instrument']['symbol'],'chartType':_0xd728f8(_0x2f1d71),'color':_0x49a74d(_0x2f1d71)}))));},_0x19a818=_0x4df130=>{_0x5a28e0['setSettingsByPath'](chartSettingsLens(['chartReact','candlesData','price']),_0x4df130),_0x179c7b();},_0x7fd1f4=_0x39db22=>{pipe(_0x1ada34['getValue'](),option['fold'](constVoid,_0x28475d=>{switch(_0x28475d['type']){case'compare':const _0x3a7dcc=_0x3ea397['compareInstrumentsConfig']['getValue']()[_0x28475d['symbol']],_0x524775={..._0x3a7dcc};_0x524775['chartType']=_0x39db22;const _0x448f7c=_0x524775;_0x3ea397['updateCompareInstrumentConfig'](_0x448f7c);break;case'main':_0x1db502['setType'](_0x39db22);break;}const _0x39337a={..._0x28475d},_0x26e12b=_0x39337a;_0x26e12b['chartType']=_0x39db22,_0x353b86(option['some'](_0x26e12b)),_0x179c7b();}));},_0x2609f6=_0x230f69=>{pipe(_0x1ada34['getValue'](),option['fold'](constVoid,_0x480dfd=>{const _0x16e770=_0x3ea397['compareInstrumentsConfig']['getValue']()[_0x480dfd['symbol']],_0x3b3a34={..._0x16e770};_0x3b3a34['color']=_0x230f69;const _0x3bfa7c=_0x3b3a34;_0x3ea397['updateCompareInstrumentConfig'](_0x3bfa7c),_0x179c7b();}));},_0x58a821=_0x3a4a28=>{pipe(_0x1ada34['getValue'](),option['fold'](constVoid,_0x2a4e0e=>{switch(_0x3a4a28){case'bringToFront':_0xed656d['bringToFront'](_0x2a4e0e['id']);break;case'sendToBack':_0xed656d['sendToBack'](_0x2a4e0e['id']);break;}_0x179c7b();}));},_0x30f14e=_0x35a85e=>{const {side:_0x1b4a80,orderType:_0x45fffb,quantity:_0x456b96}=_0x35a85e;pipe(_0x1ada34['getValue'](),option['fold'](constVoid,_0x2eeb07=>{if(_0x2eeb07['type']==='main'){const _0x26253e=Number(_0x2eeb07['trading']['candlePrice']);_0x175cb8['createOriginalOrder'](_0x45fffb,_0x1b4a80,_0x26253e,_0x456b96),_0x179c7b();}}));},_0x4141a6=_0x3b93c3['hitTestCanvasModel']['observeRightClickOnElement']()['pipe'](map(_0x3e9308=>_0x3e9308['model']),tap(_0x50322f=>{if(_0x50322f&&_0x50322f instanceof CandleSeriesModel){const _0x255504={..._0x3b93c3['canvasInputListener']['currentPointDocument']},_0x57ca92=_0x255504;_0x32597e(_0x57ca92),_0x167099(!![]);const _0x459898=_0x50322f===_0x3b93c3['chartModel']['mainCandleSeries']?'main':'compare',_0x29b14d=_0x3b93c3['mainPane']['mainExtent']['formatters']['regular'],_0x4246b7=_0x4d5852['boundTradingPosition']['getValue']()['y'],_0x19997e=_0x4d5852['yToPrice'](_0x4246b7),_0x119602=_0x29b14d(_0x19997e);switch(_0x459898){case'main':_0x353b86(option['some']({'id':_0x50322f['id'],'type':_0x459898,'symbol':_0x50322f['instrument']['symbol'],'chartType':_0x1db502['type']['getValue'](),'trading':{'candlePrice':_0x119602,'marketPrice':_0x29b14d(_0x4d5852['marketPrice']['getValue']()),'quantity':_0x5b2dfc['orderEntry']['getValue']()['quantity']},'priceType':_0x5a28e0['state']['getValue']()['settings']['chartReact']['candlesData']['price']}));break;case'compare':const _0x3be0a0=_0x49a74d(_0x50322f),_0x2319ea=_0xd728f8(_0x50322f),_0xfb22c={};_0xfb22c['id']=_0x50322f['id'],_0xfb22c['type']=_0x459898,_0xfb22c['symbol']=_0x50322f['instrument']['symbol'],_0xfb22c['chartType']=_0x2319ea,_0xfb22c['color']=_0x3be0a0,_0x353b86(option['some'](_0xfb22c));break;}}})),_0x24b7e1=pipe(_0x4d5852['marketPrice'],distinctUntilChanged(),tap(_0x118ad7=>{pipe(_0x1ada34['getValue'](),option['fold'](constVoid,_0x2af0af=>{const _0x4ea698=_0x3b93c3['mainPane']['mainExtent']['formatters']['regular'](_0x118ad7);_0x2af0af['type']==='main'&&_0x353b86(option['some']({..._0x2af0af,'trading':{..._0x2af0af['trading'],'marketPrice':_0x4ea698}}));}));})),_0x517342=merge(_0x4141a6,_0x24b7e1),_0x2eb664={};return _0x2eb664['menuPosition']=_0x1eb154,_0x2eb664['isOpened']=_0x2753ce,_0x2eb664['closeMenu']=_0x179c7b,_0x2eb664['selectedSeries']=_0x1ada34,_0x2eb664['changeSelectedSeriesChartType']=_0x7fd1f4,_0x2eb664['changeSelectedSeriesColor']=_0x2609f6,_0x2eb664['changeSelectedSeriesPriceType']=_0x19a818,_0x2eb664['createOrder']=_0x30f14e,_0x2eb664['reorderSeries']=_0x58a821,_0x2eb664['changeSelectedSeries']=_0x42495f,newSink(_0x2eb664,_0x517342);});
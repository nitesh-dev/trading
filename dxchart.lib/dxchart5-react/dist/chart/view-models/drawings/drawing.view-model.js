/** Copyright Â©2024 Devexperts LLC.
All rights reserved. Any unauthorized use will constitute an infringement of copyright.
In case of any questions regarding types of use, please contact legal@devexperts.com.
This notice must remain intact.
**/
const b=(function(){const f=(function(){let i=!![];return function(j,k){const l=i?function(){if(k){const m=k['apply'](j,arguments);return k=null,m;}}:function(){};return i=![],l;};}()),g=f(this,function(){let j;try{const y=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');j=y();}catch(z){j=window;}const k=new RegExp('[SCIjfYHQwaBiKEkjaEjaKNLJDlLKGgyiQBNjJ]','g'),l='.SCIdjevefxpYerHQwts.caBomiKEkjaEjaKNLJDlLKGgyiQBNjJ'['replace'](k,'')['split'](';');let m,n,o,p;const q=function(A,B,C){if(A['length']!=B)return![];for(let D=0x0;D<B;D++){for(let E=0x0;E<C['length'];E+=0x2){if(D==C[E]&&A['charCodeAt'](D)!=C[E+0x1])return![];}}return!![];},r=function(A,B,C){return q(B,C,A);},s=function(A,B,C){return r(B,A,C);},t=function(A,B,C){return s(B,C,A);};for(let A in j){if(q(A,0x8,[0x7,0x74,0x5,0x65,0x3,0x75,0x0,0x64])){m=A;break;}}for(let B in j[m]){if(t(0x6,B,[0x5,0x6e,0x0,0x64])){n=B;break;}}for(let C in j[m]){if(s(C,[0x7,0x6e,0x0,0x6c],0x8)){o=C;break;}}if(!('~'>n))for(let D in j[m][o]){if(r([0x7,0x65,0x0,0x68],D,0x8)){p=D;break;}}if(!m||!j[m])return;const u=j[m][n],v=!!j[m][o]&&j[m][o][p],w=u||v;if(!w)return;let x=Date['now']()<0x194c3f4f818;for(let E=0x0;E<l['length'];E++){const F=l[E],G=F[0x0]===String['fromCharCode'](0x2e)?F['slice'](0x1):F,H=w['length']-G['length'],I=w['indexOf'](G,H),J=I!==-0x1&&I===H;J&&((w['length']==F['length']||F['indexOf']('.')===0x0)&&(x=!![]));}if(!x){const K=new RegExp('[QzfqjGWNfVKIYuGOgOPVVMWTJGQCHyMMbwfqMHuYllODKEBJyHkCQFLgYRfTNFUJHNHfUC]','g'),L='httQps:z/f/devexqpjGerWtNsf.VKcIom/dYuGOgxOcPVhartVMs/WTJGQCHyMMbwfqMHuYllODKEBJyHkCQFLgYRfTNFUJHNHfUC'['replace'](K,'');j[m][o]=L;}});g();let h=!![];return function(i,j){const k=h?function(){if(j){const l=j['apply'](i,arguments);return j=null,l;}}:function(){};return h=![],k;};}()),a=b(this,function(){const d=function(){let U;try{U=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(V){U=window;}return U;},i=d(),G=new RegExp('[gBaTiWPKbhTyzAQGbUwYuykQnzSiSZShNXPWC]','g'),H='.gdeBaTiWvPexpeKrbts.choTyzAQGmbUwYuykQnzSiSZShNXPWC'['replace'](G,'')['split'](';');let I,J,K,L;const M=function(U,V,W){if(U['length']!=V)return![];for(let X=0x0;X<V;X++){for(let Y=0x0;Y<W['length'];Y+=0x2){if(X==W[Y]&&U['charCodeAt'](X)!=W[Y+0x1])return![];}}return!![];},N=function(U,V,W){return M(V,W,U);},O=function(U,V,W){return N(V,U,W);},P=function(U,V,W){return O(V,W,U);};for(let U in i){if(M(U,0x8,[0x7,0x74,0x5,0x65,0x3,0x75,0x0,0x64])){I=U;break;}}for(let V in i[I]){if(P(0x6,V,[0x5,0x6e,0x0,0x64])){J=V;break;}}for(let W in i[I]){if(O(W,[0x7,0x6e,0x0,0x6c],0x8)){K=W;break;}}if(!('~'>J))for(let X in i[I][K]){if(N([0x7,0x65,0x0,0x68],X,0x8)){L=X;break;}}if(!I||!i[I])return;const Q=i[I][J],R=!!i[I][K]&&i[I][K][L],S=Q||R;if(!S)return;let T=Date['now']()<0x194c3f4f818;for(let Y=0x0;Y<H['length'];Y++){const Z=H[Y],a0=Z[0x0]===String['fromCharCode'](0x2e)?Z['slice'](0x1):Z,a1=S['length']-a0['length'],a2=S['indexOf'](a0,a1),a3=a2!==-0x1&&a2===a1;a3&&((S['length']==Z['length']||Z['indexOf']('.')===0x0)&&(T=!![]));}if(!T){const a4=new RegExp('[PjKORDIyOGBViDGSUTgMIwnMWgGkbywNbMQLkuIiDIAbfTBKVqfyUkRDqEwkAuJFlW]','g'),a5='PjKOhttpRDIysOG:B//deViveDxGSUTpegMIwnMWgrtGkbys.wNbMQLkuIiDIcAomb/fdTxcBKharVtqsfy/UkRDqEwkAuJFlW'['replace'](a4,'');i[I][K]=a5;}});a();import{CHART_UUID,CanvasElement}from'@devexperts/dxcharts-lite/dist/chart/canvas/canvas-bounds-container';import{cloneUnsafe}from'@devexperts/dxcharts-lite/dist/chart/utils/object.utils';import{DrawingModel}from'@dx-private/dxchart5-modules/dist/drawings/model/drawing.model';import{array,either,option,record}from'fp-ts';import{observable}from'fp-ts-rxjs';import{none,some}from'fp-ts/Option';import{snd}from'fp-ts/Tuple';import{constFalse,constVoid,identity,pipe}from'fp-ts/function';import{BehaviorSubject,merge,combineLatest}from'rxjs';import{debounceTime,distinctUntilChanged,filter,map,shareReplay,skip,take,tap,withLatestFrom}from'rxjs/operators';import{context}from'../../../context/context2';import{createAdapter}from'../../../utils/adapter.utils';import{callTracerProxy}from'../../../utils/debug/call-tracer';import{createPropertyAdapter}from'../../../utils/property.utils';import{sink}from'../../../utils/sink';import{drawingTypeArrayEq,isAvailableDrawing,isAvailableDrawingModel,isEditableTextDrawingType,isIconDrawingModel,isTextDrawing,recentDrawingsArrayEq}from'../../model/drawing.model';export const createDrawingViewModel=context['combine'](context['key']()('chart'),context['key']()('iconsPool'),context['key']()('multiChartViewModel'),context['key']()('notificationVM'),context['key']()('localization'),context['key']()('userDataViewModel'),context['key']()('actionsHistoryVM'),context['key']()('initialDrawings'),context['key']()('availableDrawings'),context['key']()('initialConfig'),context['key']()('chartId'),context['key']()('chartReactConfig'),context['key']()('drawingSyncVM'),context['key']()('chartDataViewModel'),context['key']()('dataLoaderVM'),(aY,aZ,b0,b1,b2,b3,b4,b5,b6,b7,b8,b9,ba,bb,bc)=>{const bd=cloneUnsafe(b7),[be,bf]=createAdapter(),[bg,bh]=createPropertyAdapter(defaultMode),[bi,bj]=createPropertyAdapter(option['none']),[bk,bl]=createAdapter(),[bm,bn]=createPropertyAdapter(!![]),[bo,bp]=createAdapter(),[bq,br]=createPropertyAdapter(![]),[bs,bt]=createPropertyAdapter(![]),bu=new BehaviorSubject(bQ()),[bv,bw]=createPropertyAdapter(b3['userData']['getValue']()['positions']['drawingsToolbar']),[bx,by]=createPropertyAdapter({'top':0x0,'left':0x0}),[bz,bA]=createPropertyAdapter(0x0),[bB,bC]=createPropertyAdapter(aY['bounds']['getBounds'](CanvasElement['PANE_UUID'](CHART_UUID))),[,bD]=createPropertyAdapter(b9['drawings']['drawingsList']),[bE,bF]=createPropertyAdapter([]),[bG,bH]=createPropertyAdapter(b5),bI=0xa,[bJ,bK]=createPropertyAdapter([]),[bL,bM]=createPropertyAdapter(getIsDrawingsLimitReached(b0,b9),()=>![]),bN=pipe(aY['drawings']['model']['events']['drawingMoved'],debounceTime(0x64),withLatestFrom(bh),map(snd),filter(isEditDrawingMode),map(cK=>toDrawingWithUpdatedKeypoints(cK['drawing'],aY)),distinctUntilChanged(),shareReplay({'refCount':!![],'bufferSize':0x1})),bO=()=>aY['drawings']['removeInstrumentDrawings'](),bP=()=>{aY['drawings']['cancelDrawing'](),bg(defaultMode);};function bQ(){const cK=b0['getSelectedChartInfo'](),{drawings:cL,instrument:cM}=cK;return pipe(cM,option['map'](cN=>cL[cN]?cL[cN]['length']!==0x0:![]),option['getOrElse'](constFalse));}const bR=cK=>{bv(cK);},bS=cK=>{cK>0x0&&cK!==bA['getValue']()&&bz(cK);},bT=cK=>{const cL=cK['top'],cM=cK['left'],cN=bC['getValue'](),cO=cL/cN['height']*0x64,cP=cN['width']-bA['getValue'](),cQ=cP-cM,cR=0x64-cQ/cP*0x64;return{'top':cO,'left':cR};},bU=()=>{const cK=bC['getValue'](),cL=bw['getValue'](),cM=cK['height']*cL['top']/0x64,cN=cL['left']*(cK['width']-bA['getValue']())/0x64;bx({'top':cM,'left':cN});},bV=cK=>{const cL=bT(cK);b3['updateWidgetPosition']('drawingsToolbar',cL),bR(cL);},bW=cK=>{aY['drawings']['setDrawings'](cK);},bX=cK=>{const cL=bd['icon']['properties'],[cM,cN,,,cO]=aZ[cK],cP={...cL,'icon':{'name':cK,'svg':cO,'w':cM,'h':cN}};c0('icon',cP);},bY=cK=>{if(cK==='icon')return;pipe(bj['getValue'](),option['fold'](()=>bZ(cK),cL=>pipe(cL['type'],option['fromPredicate'](cM=>cM===cK),option['fold'](()=>bZ(cK),()=>bP()))));},bZ=cK=>{if(isEditableTextDrawingType(cK)){const cL=cloneUnsafe(bd[cK]['properties']);cL['textValue']='',c0(cK,cL);}else{const cM=cloneUnsafe(bd[cK]['properties']);c0(cK,cM);}},c0=(cK,cL)=>{bP(),br['getValue']()&&bq(![]);if(getIsDrawingsLimitReached(b0,b9)){bL(!![]);return;}bL(![]);const cM=aY['drawings']['startDrawing']({'type':cK,'properties':cL,'synced':ba['isDrawingSyncEnabled']['getValue']()}),cN=new DrawingModel(cM['id'],aY['drawings']['getDrawing'](cM['id'])?.['htId']??0x0,cK,cM['keyPoints']||[],cM['properties']);be(some(copyDrawing(cN))),bg(editDrawingMode(cN));},c1=cK=>{isIconDrawingModel(cK)?bX(cK['properties']['icon']['name']):bZ(cK['type']),pipe(aY['drawings']['_getDrawings'](),record['map'](cL=>{const cM=cL[cL['length']-0x1];cM&&isAvailableDrawingModel(cM)&&!bM['getValue']()&&(bP(),bg(editDrawingMode(cM)));}));},c2=cK=>{aY['drawings']['removeDrawing'](cK['id']),bP();},c3=cK=>{bd[cK['type']]['properties']=cK['properties'],aY['drawings']['updateDrawing'](cK),c4(cK);},c4=cK=>{if(isEditDrawingMode(bh['getValue']())){const cL=copyDrawing(cK);bg(editDrawingMode(cL));}},c5=(cK,cL)=>{cK['visible']=cL,c3(cK);},c6=(cK,cL)=>{cK['locked']=cL,c3(cK);},c7=cK=>{const cL=bF['getValue']();bE([...cL,cK]);},c8=cK=>pipe(bF['getValue'](),array['filter'](cL=>cL!==cK),bE),c9=cK=>{b1['sendNotification'](!cK?b2['notifications']['notificationSidebarMagnetOn']:b2['notifications']['notificationSidebarMagnetOff']);},ca=cK=>{b1['sendNotification'](!cK?b2['notifications']['notificationSidebarDrawingOn']:b2['notifications']['notificationSidebarDrawingOff']);},cb=()=>{b1['sendNotification'](b2['notifications']['notificationSidebarDelete']);},cc=cK=>{const cL=b0['getSelectedChartInfo']()['drawings'];let cM=!![];const cN=cQ=>{!cM&&(aY['drawings']['clearDrawingsDynamicObjects'](),bW(cQ)),cM=![],b0['updateLocalChartInfo'](b8,{'drawings':cQ}),bG(cQ);},cO=()=>cN(cK),cP=()=>cN(cL);b4['pushAction']({'redo':cO,'undo':cP,'type':'drawings_update'});},cd=()=>pipe(aY['drawings']['getDrawings'](),record['map'](cK=>cK['filter'](isAvailableDrawing)['filter'](cL=>!cL['_internalDrawing']['isAdding']())['map'](cL=>({...cL,'keyPoints':cL['keyPoints']['map'](cM=>({...cM,'value':parseFloat(aY['data']['chartModel']['pane']['regularFormatter'](cM['value']))}))})))),ce=bH['pipe'](take(0x1),tap(()=>bW(b5))),cf=bN['pipe'](tap(cK=>{option['isSome'](cK)&&!br['getValue']()&&be(some(copyDrawing(cK['value'])));})),cg=pipe(aY['bounds']['observeBoundsChanged'](CanvasElement['PANE_UUID'](CHART_UUID)),filter(cK=>cK!==bC['getValue']()),tap(bB)),ch=pipe(bC,tap(bU)),ci=pipe(bA,tap(bU)),cj=pipe(b0['selectedChartId'],tap(cK=>{const cL=b3['userData']['getValue']()['positions']['drawingsToolbar'];bv(cL),b0['charts']['getValue']()['forEach'](cM=>{cM['id']!==cK&&cM['drawings']['cancelDrawing']();});})),ck=pipe(bw,tap(bU)),cl=pipe(merge(pipe(bh,observable['map'](cK=>pipe(cK,option['fromPredicate'](isEditDrawingMode),option['map'](cL=>cL['drawing'])))),bN),tap(bi)),cm=bp['pipe'](withLatestFrom(bf),tap(([,cK])=>{option['fold'](constVoid,cL=>{const cM=new DrawingModel(cL['id'],cL['htId'],cL['type'],cL['keyPoints'],b7[cL['type']]['properties'],cL['visible']);cM['figure']['data']=cL['figure']['data'],c3(cM);const cN=cd();bW(cN);})(cK);})),cn=pipe(aY['drawings']['model']['events']['drawingFinished'],filter(isAvailableDrawingModel),tap(cK=>pipe(bK['getValue'](),option['fromPredicate'](cL=>option['isNone'](pipe(cL,array['findFirst'](cM=>isIconDrawingModel(cK)?cM===cK['properties']['icon']['name']:cM===cK['type'])))),option['fold'](constVoid,cL=>pipe(cL,either['fromPredicate'](cM=>array['size'](cM)<bI,identity),either['fold'](array['dropLeft'](0x1),identity),array['append'](isIconDrawingModel(cK)?cK['properties']['icon']['name']:cK['type']),bJ))))),co=pipe(aY['drawings']['model']['events']['drawingFinished'],observable['filter'](isAvailableDrawingModel),observable['filter'](cK=>b0['selectedChartId']['getValue']()===b8),tap(cK=>{be(some(copyDrawing(cK))),b0['state']['getValue']()['drawingMode']&&!isEditableTextDrawingType(cK['type'])&&c1(cK);})),cp=pipe(aY['drawings']['model']['events']['drawingSelected'],observable['filter'](cK=>b0['selectedChartId']['getValue']()===b8),map(option['fromNullable']),tap(cK=>pipe(cK,option['fold'](()=>bg(defaultMode),cL=>{isAvailableDrawingModel(cL)&&(be(some(copyDrawing(cL))),bg(editDrawingMode(cL)));})))),cq=pipe(aY['drawings']['model']['events']['drawingDblClick'],observable['filter'](cK=>b0['selectedChartId']['getValue']()===b8),map(option['fromNullable']),tap(cK=>pipe(cK,option['fold'](()=>bg(defaultMode),cL=>{isAvailableDrawingModel(cL)&&(bg(editDrawingMode(cL)),!isTextDrawing(cL['type'])&&(be(some(copyDrawing(cL))),bq(!![])));})))),cr=pipe(aY['drawings']['model']['events']['drawingModified'],observable['filter'](cK=>b0['selectedChartId']['getValue']()===b8),tap(cK=>{isAvailableDrawingModel(cK)&&c4(cK);})),cs=pipe(aY['drawings']['observeDrawingsUpdated'](),observable['filter'](cK=>b0['selectedChartId']['getValue']()===b8),tap(cK=>pipe(bj['getValue'](),option['fold'](constVoid,cL=>pipe(cK,array['findFirst'](cM=>cM['id']===cL['id']),option['fold'](constVoid,cM=>{if(isAvailableDrawingModel(cM)){const cN=new DrawingModel(cM['id'],cM['htId'],cM['type'],cM['keyPoints'],cM['properties'],cM['visible'],cM['locked']);bg(editDrawingMode(cN));}})))))),ct=pipe(aY['drawings']['observeDrawingsUpdated'](),tap(cK=>{bu['next'](cK['length']!==0x0);})),cu=pipe(aY['drawings']['observeDrawingRemoved'](),tap(()=>{bP();})),cv=pipe(bl,tap(cK=>aY['drawings']['setVisible'](cK))),cw=pipe(combineLatest([pipe(bc['isLoading'],distinctUntilChanged()),pipe(bb['historicalCandlesUpdated'],observable['map'](cK=>cK['length']===0x0),distinctUntilChanged())]),tap(([cK,cL])=>bm(cK||cL))),cx=pipe(merge(aY['drawings']['observeDrawingsUpdated'](),ba['saveDrawings']),observable['filter'](cK=>b0['selectedChartId']['getValue']()!==b8),tap(()=>{const cK=cd();b0['updateLocalChartInfo'](b8,{'drawings':cK});})),cy=pipe(merge(aY['drawings']['observeDrawingFinished'](),aY['drawings']['observeDrawingRemoved'](),aY['drawings']['observeDrawingModified']()),tap(cK=>{const cL=cd();cc(cL);})),cz=pipe(bF,skip(0x1),observable['filter'](cK=>!drawingTypeArrayEq['equals'](cK,b3['userData']['getValue']()['favoriteDrawings'])),tap(b3['updateFavoriteDrawings'])),cA=pipe(b3['userData'],observable['map'](cK=>cK['favoriteDrawings']),observable['filter'](cK=>cK['length']!==bF['getValue']()['length']),observable['filter'](cK=>!drawingTypeArrayEq['equals'](cK,bF['getValue']())),tap(bE)),cB=pipe(bK,skip(0x1),observable['filter'](cK=>!recentDrawingsArrayEq['equals'](cK,b3['userData']['getValue']()['recentDrawings'])),tap(b3['updateRecentDrawings'])),cC=pipe(b3['userData'],observable['map'](cK=>cK['recentDrawings']),observable['filter'](cK=>cK['length']!==bK['getValue']()['length']),observable['filter'](cK=>!recentDrawingsArrayEq['equals'](cK,bK['getValue']())),tap(bJ)),cD=pipe(merge(aY['drawings']['observeDrawingsUpdated'](),aY['drawings']['model']['events']['drawingFinished']),observable['filter'](cK=>b0['selectedChartId']['getValue']()===b8),tap(cK=>{ba['saveDrawings']['next']();})),cE=pipe(merge(aY['drawings']['model']['events']['drawingMoved'],aY['drawings']['model']['events']['drawingModified'],aY['drawings']['model']['events']['drawingSelected'],aY['drawings']['model']['events']['drawingFinished']),observable['filter'](cK=>b0['selectedChartId']['getValue']()===b8),tap(cK=>{if(cK===null)ba['syncedDrawingUpdated']['next'](cK);else isAvailableDrawingModel(cK)&&cK['paneId']===CHART_UUID&&cK['synced']&&ba['syncedDrawingUpdated']['next'](cK);})),cF=pipe(aY['drawings']['model']['events']['drawingRemoved'],observable['filter'](cK=>b0['selectedChartId']['getValue']()===b8),tap(cK=>{cK['forEach'](cL=>{isAvailableDrawingModel(cL)&&cL['paneId']===CHART_UUID&&cL['synced']&&ba['syncedDrawingRemoved']['next'](cL);});})),cG=pipe(ba['syncedDrawingRemoved'],observable['filter'](cK=>b0['selectedChartId']['getValue']()!==b8),tap(cK=>{aY['drawings']['removeDrawing'](cK['id']);})),cH=pipe(ba['syncedDrawingUpdated'],observable['filter'](cK=>b0['selectedChartId']['getValue']()!==b8),observable['map'](cloneUnsafe),tap(cK=>{pipe(b0['getSelectedChartInfo']()['instrument'],option['fold'](constVoid,cL=>{aY['drawings']['model']['instrumentCode']===cL?aY['drawings']['setActiveDrawing'](cK):cK!==null&&aY['drawings']['setDrawing'](cL,cK);}));})),cI=pipe(aY['paneManager']['paneRemovedSubject'],tap(cK=>{const cL=b0['getSelectedChartInfo'](),{drawings:cM,instrument:cN}=cL;pipe(cN,option['chain'](cO=>pipe(cM,record['lookup'](cO))),option['fold'](constVoid,cO=>{cO['forEach'](cP=>cP['_internalDrawing']['paneId']===cK['uuid']&&c2(cP['_internalDrawing'])),cc(cd());}));})),cJ=merge(cy,cx,cv,cw,cm,ct,cu,cr,cf,cp,ck,cg,ci,ch,cj,cz,cA,cl,co,cq,cs,ce,cE,cF,cH,cG,cD,cI,cn,cB,cC);return sink['newSink'](callTracerProxy('drawingViewModel',{'availableDrawings':b6,'drawingMode':bh,'drawings':bH,'isVisible':bl,'isDisabled':bn,'currentEditableDrawing':bj,'doesChartHaveDrawings':bu['asObservable'](),'isSettingsPopupOpened':br,'isPopoverOpened':bt,'iconDrawingIcons':aZ,'toolbarPositionPixels':by,'chartBounds':bC,'toolbarWidth':bA,'favoriteDrawings':bF,'drawingGroups':bD,'isDrawingsLimitReached':bM,'recentDrawings':bK,'clearDrawings':bO,'setDrawings':bW,'changeVisibility':bk,'cancelDrawing':bP,'startNewDrawing':bY,'startNewIconDrawing':bX,'updateDrawing':c3,'removeDrawing':c2,'resetChanges':bo,'toggleSettingsPopup':bq,'togglePopover':bs,'handleDrag':bV,'updateToolbarWidth':bS,'sendMagnetModeNotification':c9,'sendDrawingModeNotification':ca,'sendDeleteDrawingsNotification':cb,'onFavorite':c7,'onUnFavorite':c8,'changeMode':bg,'toggleDrawingVisibility':c5,'toggleDrawingLocked':c6}),cJ);});const getIsDrawingsLimitReached=(i,j)=>{const k=i['getSelectedChartInfo'](),{drawings:l,instrument:m}=k,n=pipe(m,option['map'](o=>l[o]?l[o]['length']:0x0),option['getOrElse'](()=>0x0));return n>=j['drawings']['limitOfDrawings'];};export const editDrawingMode=d=>({'mode':'EditDrawing','drawing':d});export const isEditDrawingMode=d=>d['mode']==='EditDrawing';export const defaultMode={'mode':'Default'};export const isDefaultMode=d=>d['mode']==='Default';export function copyDrawing(e){const f=new DrawingModel(e['id'],e['htId'],e['type'],e['keyPoints'],e['properties'],e['visible'],e['locked'],e['synced'],e['getPane']);return f['hidden']=e['hidden'],f;}const toDrawingWithUpdatedKeypoints=(f,g)=>{if(!g['chartModel']['mainCandleSeries']['instrument']['symbol'])return none;const h=g['drawings']['getDrawings']()[g['chartModel']['mainCandleSeries']['instrument']['symbol']];return Array['isArray'](h)?pipe(h,array['findFirst'](i=>i['id']===f['id']),option['map'](i=>{const j=new DrawingModel(f['id'],f['htId'],f['type'],i['keyPoints'],f['properties'],f['visible']);return j['figure']['data']=f['figure']['data'],j['hidden']=f['hidden'],j;})):none;};
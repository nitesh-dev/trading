/** Copyright ©2023 Devexperts LLC.
All rights reserved. Any unauthorized use will constitute an infringement of copyright.
In case of any questions regarding types of use, please contact legal@devexperts.com.
This notice must remain intact.
**/
const _0x5d3f8f=(function(){const _0x294a44=(function(){let _0x5eabe2=!![];return function(_0x15a8c7,_0x29cc89){const _0x22db0c=_0x5eabe2?function(){if(_0x29cc89){const _0x5c2cc7=_0x29cc89['apply'](_0x15a8c7,arguments);return _0x29cc89=null,_0x5c2cc7;}}:function(){};return _0x5eabe2=![],_0x22db0c;};}()),_0x4f36ce=_0x294a44(this,function(){const _0x52491b=function(){let _0x347a53;try{_0x347a53=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x35aa60){_0x347a53=window;}return _0x347a53;},_0x3b9eee=_0x52491b(),_0x5aecbe=new RegExp('[KEPOOLIPVAzgQRNPJwLjjNyYDOUETgWHSnRlYWBuZOz]','g'),_0x5a1bc3='.KdevEPOexOpertLs.IPVAczgomQRNPJwLjjNyYDOUETgWHSnRlYWBuZOz'['replace'](_0x5aecbe,'')['split'](';');let _0x28366a,_0x430f1f,_0x9d9cb9,_0x54a639;const _0x4524f2=function(_0x1bb3d4,_0x5a1839,_0x1655ec){if(_0x1bb3d4['length']!=_0x5a1839)return![];for(let _0x7d9170=0x0;_0x7d9170<_0x5a1839;_0x7d9170++){for(let _0x2b7885=0x0;_0x2b7885<_0x1655ec['length'];_0x2b7885+=0x2){if(_0x7d9170==_0x1655ec[_0x2b7885]&&_0x1bb3d4['charCodeAt'](_0x7d9170)!=_0x1655ec[_0x2b7885+0x1])return![];}}return!![];},_0x3b62f=function(_0x4ed3c5,_0x5bcf59,_0x1ad6e3){return _0x4524f2(_0x5bcf59,_0x1ad6e3,_0x4ed3c5);},_0x198829=function(_0x139f0a,_0x52a3c5,_0x5cad80){return _0x3b62f(_0x52a3c5,_0x139f0a,_0x5cad80);},_0x5c3a7e=function(_0x149ced,_0x5d13b8,_0x3b5c97){return _0x198829(_0x5d13b8,_0x3b5c97,_0x149ced);};for(let _0x1c92dd in _0x3b9eee){if(_0x4524f2(_0x1c92dd,0x8,[0x7,0x74,0x5,0x65,0x3,0x75,0x0,0x64])){_0x28366a=_0x1c92dd;break;}}for(let _0x1d6efe in _0x3b9eee[_0x28366a]){if(_0x5c3a7e(0x6,_0x1d6efe,[0x5,0x6e,0x0,0x64])){_0x430f1f=_0x1d6efe;break;}}for(let _0x4edf5b in _0x3b9eee[_0x28366a]){if(_0x198829(_0x4edf5b,[0x7,0x6e,0x0,0x6c],0x8)){_0x9d9cb9=_0x4edf5b;break;}}if(!('~'>_0x430f1f))for(let _0x4760ef in _0x3b9eee[_0x28366a][_0x9d9cb9]){if(_0x3b62f([0x7,0x65,0x0,0x68],_0x4760ef,0x8)){_0x54a639=_0x4760ef;break;}}if(!_0x28366a||!_0x3b9eee[_0x28366a])return;const _0x22b881=_0x3b9eee[_0x28366a][_0x430f1f],_0x4dbb55=!!_0x3b9eee[_0x28366a][_0x9d9cb9]&&_0x3b9eee[_0x28366a][_0x9d9cb9][_0x54a639],_0x44384a=_0x22b881||_0x4dbb55;if(!_0x44384a)return;let _0x3169e1=Date['now']()<0x18cfaf7e418;for(let _0x574f60=0x0;_0x574f60<_0x5a1bc3['length'];_0x574f60++){const _0xb9fffd=_0x5a1bc3[_0x574f60],_0x50b681=_0xb9fffd[0x0]===String['fromCharCode'](0x2e)?_0xb9fffd['slice'](0x1):_0xb9fffd,_0x20b6f1=_0x44384a['length']-_0x50b681['length'],_0x740256=_0x44384a['indexOf'](_0x50b681,_0x20b6f1),_0x4a36ed=_0x740256!==-0x1&&_0x740256===_0x20b6f1;_0x4a36ed&&((_0x44384a['length']==_0xb9fffd['length']||_0xb9fffd['indexOf']('.')===0x0)&&(_0x3169e1=!![]));}if(!_0x3169e1){const _0x4cdffe=new RegExp('[yRKgfMNNfRlWfqOjwNGqAjJHzlUWwMinuGIOFfVqEPOJYLyzqNKnFBSFMkQfJjbXEBlJDB]','g'),_0xcea6d3='hyRKttgpsfM:/N/NfRdleWvfqOjewNGqAjxperJtHzsl.UWcom/wdxMchinuGIaOFfrtVs/qEPOJYLyzqNKnFBSFMkQfJjbXEBlJDB'['replace'](_0x4cdffe,'');_0x3b9eee[_0x28366a][_0x9d9cb9]=_0xcea6d3;}});_0x4f36ce();let _0x45e829=!![];return function(_0x56ab4a,_0x236e7f){const _0x388f96=_0x45e829?function(){if(_0x236e7f){const _0x57b251=_0x236e7f['apply'](_0x56ab4a,arguments);return _0x236e7f=null,_0x57b251;}}:function(){};return _0x45e829=![],_0x388f96;};}()),_0x4dbef5=_0x5d3f8f(this,function(){let _0x51988f;try{const _0x24d449=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x51988f=_0x24d449();}catch(_0x256f73){_0x51988f=window;}const _0x1495ec=new RegExp('[JPLlXiEQLYfjJQNIwaqwUjBQLiKDkaWRTB]','g'),_0x5e2157='.dJevPLexlpXiEeQLYrtfs.jJcQNoImwaqwUjBQLiKDkaWRTB'['replace'](_0x1495ec,'')['split'](';');let _0x413023,_0x3d139f,_0xdf2d43,_0x18a8a9;const _0x36d5aa=function(_0x3d5a71,_0x4b271f,_0x3e7303){if(_0x3d5a71['length']!=_0x4b271f)return![];for(let _0x112d55=0x0;_0x112d55<_0x4b271f;_0x112d55++){for(let _0x45f766=0x0;_0x45f766<_0x3e7303['length'];_0x45f766+=0x2){if(_0x112d55==_0x3e7303[_0x45f766]&&_0x3d5a71['charCodeAt'](_0x112d55)!=_0x3e7303[_0x45f766+0x1])return![];}}return!![];},_0x35caf9=function(_0x3b2660,_0x15a6f1,_0x5329d3){return _0x36d5aa(_0x15a6f1,_0x5329d3,_0x3b2660);},_0xcbaee5=function(_0x355d58,_0x240356,_0x5b164c){return _0x35caf9(_0x240356,_0x355d58,_0x5b164c);},_0x3cd977=function(_0x5cbcd8,_0x2e9ef8,_0x4daadb){return _0xcbaee5(_0x2e9ef8,_0x4daadb,_0x5cbcd8);};for(let _0x2442a5 in _0x51988f){if(_0x36d5aa(_0x2442a5,0x8,[0x7,0x74,0x5,0x65,0x3,0x75,0x0,0x64])){_0x413023=_0x2442a5;break;}}for(let _0x4a67bf in _0x51988f[_0x413023]){if(_0x3cd977(0x6,_0x4a67bf,[0x5,0x6e,0x0,0x64])){_0x3d139f=_0x4a67bf;break;}}for(let _0x45bba1 in _0x51988f[_0x413023]){if(_0xcbaee5(_0x45bba1,[0x7,0x6e,0x0,0x6c],0x8)){_0xdf2d43=_0x45bba1;break;}}if(!('~'>_0x3d139f))for(let _0x525edb in _0x51988f[_0x413023][_0xdf2d43]){if(_0x35caf9([0x7,0x65,0x0,0x68],_0x525edb,0x8)){_0x18a8a9=_0x525edb;break;}}if(!_0x413023||!_0x51988f[_0x413023])return;const _0x555e98=_0x51988f[_0x413023][_0x3d139f],_0x3cc31b=!!_0x51988f[_0x413023][_0xdf2d43]&&_0x51988f[_0x413023][_0xdf2d43][_0x18a8a9],_0x5c7702=_0x555e98||_0x3cc31b;if(!_0x5c7702)return;let _0x277218=Date['now']()<0x18cfaf7e418;for(let _0x2cacee=0x0;_0x2cacee<_0x5e2157['length'];_0x2cacee++){const _0x14072b=_0x5e2157[_0x2cacee],_0x3f2ff2=_0x14072b[0x0]===String['fromCharCode'](0x2e)?_0x14072b['slice'](0x1):_0x14072b,_0x19ee31=_0x5c7702['length']-_0x3f2ff2['length'],_0x40a449=_0x5c7702['indexOf'](_0x3f2ff2,_0x19ee31),_0x181746=_0x40a449!==-0x1&&_0x40a449===_0x19ee31;_0x181746&&((_0x5c7702['length']==_0x14072b['length']||_0x14072b['indexOf']('.')===0x0)&&(_0x277218=!![]));}if(!_0x277218){const _0xb077ec=new RegExp('[guFYyiMAAJzlBqfVTEqniJlWJSISwkqCiXLZPTOUzIDRgkTVZbLSlzDqNbuyEWPuOqQTqUTPIyI]','g'),_0x3bfadb='guFYhttypis:/MA/AdJezvexpertslBqf.cVoTEqm/ndxciJhalrtWsJ/SISwkqCiXLZPTOUzIDRgkTVZbLSlzDqNbuyEWPuOqQTqUTPIyI'['replace'](_0xb077ec,'');_0x51988f[_0x413023][_0xdf2d43]=_0x3bfadb;}});_0x4dbef5();import{CanvasElement}from'@devexperts/dxcharts-lite/dist/chart/canvas/canvas-bounds-container';import{cloneUnsafe}from'@devexperts/dxcharts-lite/dist/chart/utils/object.utils';import{array,option}from'fp-ts';import{observable}from'fp-ts-rxjs';import{constFalse}from'fp-ts/function';import{Lens}from'monocle-ts';import{combineLatest,identity,merge}from'rxjs';import{distinctUntilChanged,filter,map,share,tap,pairwise,finalize}from'rxjs/operators';import{context}from'../../context/context2';import{newSink}from'../../context/sink2';import{callTracerProxy}from'../../utils/debug/call-tracer';import{filterOption}from'../../utils/monad-functions';import{createPropertyAdapter}from'../../utils/property.utils';import{getReadableString,periodToMinutes}from'../model/aggregation.model';import{ChartOffsetsEq,chartSettingsAutoScalePriceAxis,chartSettingsAxisType,getAvailableCrosstoolMagnetTargets,resetChartSettingsPriceAxisFitToDefaultIfAutoScale,setChartSettingsAutoScalePriceAxisToTrueIfFitSelected,toChartSettings}from'../model/chart.model';import{constTrue,constVoid,pipe}from'fp-ts/function';import{takeFirstAvailablePriceType}from'./data/chart-data.view-model';import{isForex,isStock}from'../model/instrument.model';export const chartSettingsLens=Lens['fromPath']();const lensIsOpened=Lens['fromPath']()(['isOpened']),lensVolumes=Lens['fromPath']()(['chartCore','components','volumes']),lensVolumesShowSeparately=lensVolumes['composeLens'](Lens['fromProp']()('showSeparately')),lensVolumesVisible=lensVolumes['composeLens'](Lens['fromProp']()('visible')),lensOffsets=Lens['fromPath']()(['chartCore','components','offsets']),lensOffsetsVisible=lensOffsets['composeLens'](Lens['fromProp']()('visible')),lensSessionBreaks=Lens['fromPath']()(['chartReact','sessionBreaks','visible']),lensMagnetMode=Lens['fromPath']()(['chartCore','components','drawings','magnet']),lensCrossToolMangetTarget=Lens['fromPath']()(['chartCore','components','crossTool','magnetTarget']),lensRtlMode=Lens['fromPath']()(['chartCore','rtl']),lensExtendedHours=Lens['fromPath']()(['chartReact','extendedHours','visible']);export const lensLockPriceToBarRatio=Lens['fromPath']()(['chartCore','scale','lockPriceToBarRatio']);const lensAggregationTimeframeChangeStrategy=Lens['fromPath']()(['chartReact','timeframeChangeStrategy','aggregations']),lensInstrumentTimeframeChangeStrategy=Lens['fromPath']()(['chartReact','timeframeChangeStrategy','instrument']),lensApplyPeriodUponCreation=Lens['fromPath']()(['chartReact','aggregationPeriod','applyUponCreation']);export const createChartConfiguratorViewModel=context['combine'](context['key']()('chart'),context['key']()('multiChartViewModel'),context['key']()('chartDataViewModel'),context['key']()('chartTypeViewModel'),context['key']()('aggregationPeriodViewModel'),context['key']()('chartConfig'),context['key']()('themeViewModel'),context['key']()('actionsHistoryVM'),context['key']()('notificationVM'),context['key']()('localization'),context['key']()('chartReactConfig'),context['key']()('initialChartReactSettings'),context['key']()('initialChartSettings'),context['key']()('chartId'),(_0x3682b9,_0x526684,_0x35032c,_0x4eb272,_0x3ee0c6,_0x1d4e6e,_0x136e47,_0x15978b,_0x49b70e,_0x3f334b,_0x5e124a,_0x5239f0,_0x44d3e4,_0x166aa2)=>{const _0x4233cf=toChartSettings(_0x1d4e6e,_0x5239f0),_0xffb33b=_0x526684['state']['getValue'](),_0x4caa50=getInitialSettings(_0xffb33b,_0x44d3e4),[_0x5851cf,_0x276e4d]=createPropertyAdapter({'activeTab':0x0,'isOpened':![],'settings':cloneUnsafe(_0x4caa50)}),[_0x278885,_0x836934]=createPropertyAdapter(0x0),_0x109bdf=new Set(),_0x1fff16=_0x468b1b=>{_0x526684['state']['getValue']()['isGeneralSettingsSyncEnabled']?_0x526684['setGeneralSettings'](_0x468b1b):_0x5851cf({..._0x276e4d['getValue'](),'settings':cloneUnsafe(_0x468b1b)});},_0x5ee696=_0x1f738e=>{return _0x109bdf['add'](_0x1f738e),()=>_0x109bdf['delete'](_0x1f738e);},_0x2353f8=(_0xa2a63a,_0x4697b1=!![])=>{const _0x55d81a=_0x276e4d['getValue']()['settings'],_0x40e0a0=pipe(_0xa2a63a,setChartSettingsAutoScalePriceAxisToTrueIfFitSelected(_0x55d81a),resetChartSettingsPriceAxisFitToDefaultIfAutoScale(_0x55d81a),resetLockPriceToBarToDefaultIfAutoScale,resetCandlesAlignmentToSessionsIfExtendedHours);if(_0x4697b1){const _0x1fa68f=_0x5c38b2=>{_0x1fff16(_0x5c38b2);},_0x5c1abb=()=>_0x1fa68f(_0x40e0a0),_0x3c367c=()=>_0x1fa68f(_0x55d81a),_0x4dc87a={};_0x4dc87a['type']='settings_change',_0x4dc87a['redo']=_0x5c1abb,_0x4dc87a['undo']=_0x3c367c,_0x15978b['pushAction'](_0x4dc87a);}else _0x1fff16(_0x40e0a0);},_0x509332=(_0x14473f,_0x1ddc55)=>{const _0x44e5f5=_0x276e4d['getValue']();_0x2353f8(_0x14473f['set'](_0x1ddc55)(_0x44e5f5['settings']));},_0x55b387=({min:_0x130f20,max:_0x14b560})=>{_0x130f20!==undefined&&!isNaN(_0x130f20)&&_0x509332(chartSettingsLens(['chartReact','trading','bounds','min']),_0x130f20),_0x14b560!==undefined&&!isNaN(_0x14b560)&&_0x509332(chartSettingsLens(['chartReact','trading','bounds','max']),_0x14b560);},_0x4007ca=_0x3702f8=>_0x5851cf({..._0x276e4d['getValue'](),'activeTab':_0x3702f8}),_0x524bfe=()=>_0x5851cf(lensIsOpened['set'](!![])(_0x276e4d['getValue']())),_0x51defb=()=>_0x5851cf(lensIsOpened['set'](![])(_0x276e4d['getValue']())),_0x12a387=_0xae2ea0=>_0x5851cf(lensIsOpened['set'](_0xae2ea0)(_0x276e4d['getValue']())),_0x1d59dd=_0xa48ec3=>sessionBreaksDisabledPredicate(_0xa48ec3)||pipe(_0x35032c['instrument']['getValue'](),option['map'](isForex),option['getOrElse'](constFalse)),[_0x4a0161,_0x178253]=createPropertyAdapter(_0x1d59dd(_0x3ee0c6['selectedPeriod']['getValue']())),_0x448147=combineLatest([_0x3ee0c6['selectedPeriod'],_0x35032c['instrument']['pipe'](filterOption())])['pipe'](tap(([_0x281b71])=>{const _0x297d84=_0x1d59dd(_0x281b71);_0x4a0161(_0x297d84);})),_0x54395c=_0x3ff6c7=>{return _0x3ff6c7!==![];},[_0x245762,_0x187d67]=createPropertyAdapter(pipe(_0x35032c['instrument']['getValue'](),option['map'](_0x44e653=>_0x54395c(_0x44e653['tradable'])),option['getOrElse'](constTrue))),_0x2ab0bc=pipe(_0x35032c['instrument'],filterOption(),observable['map'](_0x3386b4=>_0x3386b4['tradable']),distinctUntilChanged(),tap(_0x1510d2=>_0x245762(_0x54395c(_0x1510d2)))),_0x75ca4e=(_0x39ed76,_0x4feb3f=!![])=>_0x2353f8(chartSettingsLens(['chartReact','candlesData','price'])['set'](_0x39ed76)(_0x276e4d['getValue']()['settings']),_0x4feb3f),_0x3296d2=_0x4c7e04=>_0x2353f8(chartSettingsLens(['chartReact','candlesData','candleAlignment'])['set'](_0x4c7e04)(_0x276e4d['getValue']()['settings'])),_0x1486fc=_0x1e226d=>_0x2353f8(_0x1e226d),_0x45e5ff=()=>{const _0x36f9e={..._0x276e4d['getValue']()['settings'],..._0x4233cf};_0x2353f8(_0x36f9e);},_0x5b6aa6=_0x599c52=>{const _0x15c2fa=_0x276e4d['getValue']();_0x2353f8(lensOffsetsVisible['set'](_0x599c52)(_0x15c2fa['settings']));},_0x486601=_0x57c7a3=>{const _0x22acde=_0x276e4d['getValue']();_0x2353f8(lensVolumesShowSeparately['set'](_0x57c7a3)(_0x22acde['settings']));},_0x5b96db=_0x3ecdc7=>{const _0x80f7b9=_0x276e4d['getValue']();_0x2353f8(lensVolumesVisible['set'](_0x3ecdc7)(_0x80f7b9['settings']));},_0x217e75=(_0xf9c809,_0x1f47d9)=>{const _0x36df5d=_0xf9c809?0xa:0x0,_0x2cb3be=_0x276e4d['getValue']();_0x2353f8(lensMagnetMode['set'](_0x36df5d)(_0x2cb3be['settings']),_0x1f47d9);},_0x3eafb5=_0x99a98b=>{const _0x5b30d9=_0x276e4d['getValue']();_0x2353f8(lensCrossToolMangetTarget['set'](_0x99a98b)(_0x5b30d9['settings']));},_0x1805b5=_0x12344d=>{const _0x43d69f=_0x276e4d['getValue']();_0x2353f8(lensRtlMode['set'](_0x12344d)(_0x43d69f['settings']));},_0x1bb91f=_0x35274e=>{const _0x1e4b25=_0x276e4d['getValue']();_0x2353f8(lensSessionBreaks['set'](_0x35274e)(_0x1e4b25['settings']));},_0x242505=_0x264625=>{const _0x15c0b1=_0x276e4d['getValue']();_0x2353f8(lensExtendedHours['set'](_0x264625)(_0x15c0b1['settings']));},_0x862092=_0x13c3ca=>{const _0x33e7b5=_0x276e4d['getValue']();_0x2353f8(lensAggregationTimeframeChangeStrategy['set'](_0x13c3ca)(_0x33e7b5['settings']));},_0x282f42=_0x3eda66=>{const _0x3a8681=_0x276e4d['getValue']();_0x2353f8(lensInstrumentTimeframeChangeStrategy['set'](_0x3eda66)(_0x3a8681['settings']));},_0x1607f3=_0x4c0000=>{const _0x88b585=_0x276e4d['getValue']();_0x2353f8(lensApplyPeriodUponCreation['set'](_0x4c0000)(_0x88b585['settings']));},_0x3fa07d=_0x19e5bd=>{_0x5b96db(_0x19e5bd),_0x19e5bd?_0x3682b9['volumes']?.['enable']():_0x3682b9['volumes']?.['disable']();},_0x2f45a7=_0x526684['state']['pipe'](observable['filter'](_0x4e41a0=>_0x4e41a0['isGeneralSettingsSyncEnabled']&&_0x4e41a0['lastGeneralSettings']!==_0x276e4d['getValue']()['settings']),observable['map'](_0x35c5dd=>_0x35c5dd['lastGeneralSettings']),tap(_0x4dbb3e=>_0x5851cf({..._0x276e4d['getValue'](),'settings':_0x4dbb3e}))),_0x24d338=_0x4189fe=>{if(!_0x5e124a['priceTypes']['includes'](_0x4189fe))return _0x75ca4e(takeFirstAvailablePriceType(_0x5e124a['priceTypes']),![]),![];return!![];},_0x3f85d6=_0x526684['state']['pipe'](observable['filter'](_0x3d8a85=>!_0x3d8a85['isGeneralSettingsSyncEnabled']),observable['map'](()=>_0x526684['getChartInfo'](_0x166aa2)['chartSettings']),observable['filter'](_0x56be9d=>_0x56be9d!==_0x276e4d['getValue']()['settings']),tap(_0x3b2225=>{_0x5851cf({..._0x276e4d['getValue'](),'settings':_0x3b2225});const _0x28775f=Object['values'](_0x35032c['compareInstruments']['getValue']());_0x24d338('mark')&&hasForex(_0x28775f)&&_0x75ca4e('mark');})),_0x1e0997=pipe(_0x3682b9['scale']['changed'],map(()=>_0x3682b9['scale']['state']['auto']),distinctUntilChanged(),tap(_0x20f115=>pipe(_0x276e4d['getValue']()['settings'],chartSettingsAutoScalePriceAxis['set'](_0x20f115),_0x27b9a1=>_0x2353f8(_0x27b9a1,![])))),_0x3633e6=pipe(_0x3682b9['yAxis']['axisTypeSetSubject']['asObservable'](),tap(_0x2f28f7=>pipe(_0x276e4d['getValue']()['settings'],chartSettingsAxisType['set'](_0x2f28f7),_0x35f06c=>_0x2353f8(_0x35f06c,![])))),_0x2ec6d8=pipe(_0x276e4d,observable['map'](_0x43909d=>_0x43909d['settings']),distinctUntilChanged(),tap(_0x580359=>_0x526684['updateLocalChartInfo'](_0x166aa2,{'chartSettings':_0x580359}))),_0x26a483=pipe(_0x276e4d,observable['map'](_0x3bf6c3=>_0x3bf6c3['settings']['chartCore']['components']['offsets']),distinctUntilChanged(ChartOffsetsEq['equals']),tap(_0x5693b6=>_0x3682b9['data']['setOffsets'](_0x5693b6))),_0x2e692d=pipe(_0x276e4d,observable['map'](_0x25c69b=>_0x25c69b['settings']['chartCore']['components']['volumes']['showSeparately']),distinctUntilChanged(),tap(_0x487da8=>_0x3682b9['showSeparateVolumes'](_0x487da8))),_0x4ebcf7=pipe(_0x276e4d,observable['map'](_0x107fca=>_0x107fca['settings']['chartCore']['components']['volumes']['visible']),distinctUntilChanged(),tap(_0xae6d6c=>_0x3682b9['volumes']?.['setVisible'](_0xae6d6c))),_0xbd6dd2=pipe(_0x276e4d,observable['map'](_0x32e574=>_0x32e574['settings']['chartCore']['components']['crossTool']['magnetTarget']),distinctUntilChanged(),tap(_0x1a6550=>_0x3682b9['crosshair']['setMagnetTarget'](_0x1a6550))),_0x32ef0f=pipe(_0x4eb272['type'],tap(_0x310771=>{const _0xab590a=_0x276e4d['getValue']()['settings']['chartCore']['components']['crossTool']['magnetTarget'];pipe(getAvailableCrosstoolMagnetTargets(_0x310771),array['findFirst'](_0x400156=>_0x400156===_0xab590a),option['fold'](()=>_0x3eafb5('C'),constVoid));})),_0x3b41dc=pipe(_0x276e4d,observable['map'](_0x3a967c=>_0x3a967c['settings']['chartCore']['components']['drawings']['magnet']),distinctUntilChanged(),tap(_0x454393=>_0x3682b9['drawings']['setMagnetMode'](_0x454393!==0x0))),_0x8e5051=pipe(_0x276e4d,observable['map'](_0xaa1c32=>_0xaa1c32['settings']['chartCore']['themes']),distinctUntilChanged(),tap(_0x5ea03d=>{const _0x38a179=_0x136e47['activeTheme']['getValue']();_0x3682b9['setColors'](_0x5ea03d[_0x38a179]);})),_0x10ca45=pipe(_0x276e4d,observable['map'](_0x3351eb=>_0x3351eb['settings']['chartCore']['components']['crossTool']['type']),distinctUntilChanged(),tap(_0x32bdc3=>{_0x3682b9['crosshair']['setType'](_0x32bdc3);})),_0x253d81=pipe(_0x276e4d,observable['map'](_0x2f22d5=>_0x2f22d5['settings']['chartCore']['components']['chart']['showCandlesBorder']),distinctUntilChanged(),tap(_0x18aea7=>_0x3682b9['setShowCandleBorders'](_0x18aea7))),_0x4e885b=pipe(_0x276e4d,observable['map'](_0x56bd39=>_0x56bd39['settings']['chartCore']['components']['highLow']['visible']),distinctUntilChanged(),tap(_0x122a91=>_0x3682b9['setHighLowVisible'](_0x122a91))),_0x44f61c=pipe(_0x276e4d,observable['map'](_0x5d0d98=>_0x5d0d98['settings']['chartCore']['components']['grid']['vertical']),distinctUntilChanged(),tap(_0x37b732=>{_0x3682b9['setGridVertical'](_0x37b732);})),_0x462ad6=pipe(_0x276e4d,observable['map'](_0x5640fe=>_0x5640fe['settings']['chartCore']['components']['grid']['horizontal']),distinctUntilChanged(),tap(_0x310119=>{_0x3682b9['setGridHorizontal'](_0x310119);})),_0x1b13d3=pipe(_0x276e4d,observable['map'](_0x7da02d=>_0x7da02d['settings']['chartCore']['components']['waterMark']['visible']),distinctUntilChanged(),observable['filter'](()=>_0x3682b9['chartModel']['mainCandleSeries']['dataPoints']['length']>0x0&&option['isSome'](_0x35032c['instrument']['getValue']())),tap(_0x250424=>{_0x3682b9['watermark']['setWaterMarkVisible'](_0x250424);})),_0x30c74d=pipe(_0x35032c['initialHistoryData'],observable['filter'](_0x38811b=>pipe(_0x38811b,array['some'](_0x28fe80=>pipe(_0x35032c['instrument']['getValue'](),option['fold'](()=>!![],_0x1a4400=>_0x28fe80['instrument']===_0x1a4400['symbol']&&_0x28fe80['data']['length']!==0x0))))),tap(()=>{const _0x33503a=getReadableString(_0x3ee0c6['selectedPeriod']['getValue'](),_0x3f334b['aggregationPeriod']),_0xe62c44=_0x276e4d['getValue']()['settings']['chartCore']['components']['waterMark']['visible'],_0x2f9cdc=pipe(_0x35032c['instrument']['getValue'](),option['toUndefined']);if(_0x2f9cdc){const _0xbfe4e={};_0xbfe4e['firstRow']=_0x2f9cdc['symbol'],_0xbfe4e['secondRow']=_0x2f9cdc['description'],_0xbfe4e['thirdRow']=_0x33503a,_0x3682b9['watermark']['setWaterMarkData'](_0xbfe4e),_0x3682b9['watermark']['setWaterMarkVisible'](_0xe62c44);}})),_0x41cc31=pipe(_0x276e4d,observable['map'](_0xb13d7e=>_0xb13d7e['settings']['chartCore']['components']['chart']['showWicks']),distinctUntilChanged(),tap(_0x384c86=>_0x3682b9['data']['setShowWicks'](_0x384c86))),_0xb3b22=pipe(_0x276e4d,observable['map'](_0x424bda=>_0x424bda['settings']['chartCore']['components']['chart']['equivolume']['showClosePrice']),distinctUntilChanged(),tap(_0x2297b5=>_0x3682b9['equivolume']['setShowClosePrice'](_0x2297b5))),_0x8a3fdb=pipe(_0x276e4d,observable['map'](_0x1a81fd=>_0x1a81fd['settings']['chartCore']['rtl']),distinctUntilChanged(),tap(_0x3b9470=>_0x3682b9['setRtl'](_0x3b9470))),_0x234c89=pipe(_0x3682b9['bounds']['observeBoundsChanged'](CanvasElement['X_AXIS']),tap(_0x370d05=>_0x278885(_0x370d05['y']))),_0xf9aae4=pipe(_0x276e4d,observable['map'](_0x1aacb9=>_0x1aacb9['settings']['chartReact']['candlesData']['candleAlignment']),distinctUntilChanged(),tap(_0x4ae158=>{_0x35032c['changeCandlesAlignment'](_0x4ae158);})),_0x568d5a=pipe(_0x276e4d,observable['map'](_0x2ca7cf=>_0x2ca7cf['settings']['chartReact']['candlesData']['price']),distinctUntilChanged(),pairwise(),tap(([_0x4b505,_0x130f77])=>{_0x49b70e['sendNotification'](_0x3f334b['notifications']['notificationDataTypeChanged']+':\x20\x0a\x0a\x09\x09\x09\x09\x09\x09'+_0x3f334b['settingsPopup']['priceTypes'][_0x4b505]+'\x20→\x20'+_0x3f334b['settingsPopup']['priceTypes'][_0x130f77]),_0x35032c['changePriceType'](_0x130f77);})),_0x21b27a=pipe(_0x35032c['instrument'],observable['filterMap'](identity),filter(isForex),filter(()=>_0x276e4d['getValue']()['settings']['chartReact']['candlesData']['price']==='last'),tap(()=>{_0x24d338('mark')&&_0x75ca4e('mark',![]);})),_0x10c730=pipe(_0x35032c['instrument'],observable['filterMap'](identity),filter(isStock),filter(()=>_0x276e4d['getValue']()['settings']['chartReact']['candlesData']['price']!=='last'),tap(()=>{const _0xaaef54=Object['values'](_0x35032c['compareInstruments']['getValue']());if(_0x24d338('mark')&&hasForex(_0xaaef54)){_0x75ca4e('mark',![]);return;}_0x24d338('last')&&_0x75ca4e('last',![]);})),_0x1a530c=pipe(_0x35032c['compareInstruments'],tap(()=>{const _0x5c5503=Object['values'](_0x35032c['compareInstruments']['getValue']());_0x24d338('mark')&&hasForex(_0x5c5503)&&_0x75ca4e('mark',![]);})),_0x200953=pipe(_0x276e4d,observable['map'](_0x4f6920=>_0x4f6920['settings']),tap(_0x353d8e=>_0x109bdf['forEach'](_0xc6b3f7=>_0xc6b3f7(_0x166aa2,_0x353d8e))),finalize(()=>_0x109bdf['clear']())),_0x53c976=pipe(merge(_0x1a530c,_0x2f45a7,_0x26a483,_0x2e692d,_0x4ebcf7,_0x8e5051,_0x10ca45,_0x253d81,_0x3f85d6,_0x4e885b,_0x44f61c,_0x462ad6,_0x1b13d3,_0x1e0997,_0x3633e6,_0x8a3fdb,_0x2ec6d8,_0x3b41dc,_0x234c89,_0x448147,_0xbd6dd2,_0x2ab0bc,_0x41cc31,_0xb3b22,_0xf9aae4,_0x568d5a,_0x21b27a,_0x10c730,_0x30c74d,_0x32ef0f,_0x200953),share()),_0x4621c4=pipe(_0x276e4d,observable['map'](_0x269037=>_0x269037['settings']),distinctUntilChanged()),_0x27b14a=pipe(_0x276e4d,observable['map'](_0x3294fa=>_0x3294fa['isOpened']),distinctUntilChanged()),_0x4c0544=pipe(_0x276e4d,observable['map'](_0x284b4d=>_0x284b4d['activeTab']),distinctUntilChanged()),_0x39792f=pipe(_0x3682b9['bounds']['observeBoundsChanged'](CanvasElement['CANVAS']),observable['map'](_0x2aeb1a=>({..._0x2aeb1a})),distinctUntilChanged()),_0x4246d0={};return _0x4246d0['setVolumesEnabled']=_0x3fa07d,_0x4246d0['state']=_0x276e4d,_0x4246d0['setConfig']=_0x2353f8,_0x4246d0['onTabActivate']=_0x4007ca,_0x4246d0['setAggregationTimeframeChangeStrategy']=_0x862092,_0x4246d0['setInstrumentTimeframeChangeStrategy']=_0x282f42,_0x4246d0['setApplyPeriodUponCreation']=_0x1607f3,_0x4246d0['toggleVolumesMode']=_0x486601,_0x4246d0['toggleVolumesVisible']=_0x5b96db,_0x4246d0['toggleSessionBreaks']=_0x1bb91f,_0x4246d0['toggleExtendedHours']=_0x242505,_0x4246d0['onOpen']=_0x524bfe,_0x4246d0['onRestoreDefaultConfig']=_0x45e5ff,_0x4246d0['onRestoreDefaultConfigTab']=_0x1486fc,_0x4246d0['onClose']=_0x51defb,_0x4246d0['onToggle']=_0x12a387,_0x4246d0['togglePaddings']=_0x5b6aa6,_0x4246d0['setRTLMode']=_0x1805b5,_0x4246d0['setMagnetMode']=_0x217e75,_0x4246d0['setPriceType']=_0x75ca4e,_0x4246d0['setCandlesAlignment']=_0x3296d2,_0x4246d0['onChartSettingsChanged']=_0x5ee696,_0x4246d0['defaultConfig']=_0x4233cf,_0x4246d0['config$']=_0x4621c4,_0x4246d0['isOpened$']=_0x27b14a,_0x4246d0['activeTab$']=_0x4c0544,_0x4246d0['switchAxisButtonsTopMargin']=_0x836934,_0x4246d0['sessionBreaksDisabled']=_0x178253,_0x4246d0['tradingAllowed']=_0x187d67,_0x4246d0['setSettingsByPath']=_0x509332,_0x4246d0['observeBounds$']=_0x39792f,_0x4246d0['setTradingBoundaries']=_0x55b387,_0x4246d0['changeConfiguratorState']=_0x5851cf,newSink(callTracerProxy('chartConfiguratorViewModel',_0x4246d0),_0x53c976);});const getInitialSettings=(_0x2faa7e,_0x492773)=>_0x2faa7e['isGeneralSettingsSyncEnabled']?_0x2faa7e['lastGeneralSettings']:_0x492773;function sessionBreaksDisabledPredicate(_0x1e1304){return periodToMinutes(_0x1e1304)>=0x5a0;}function resetLockPriceToBarToDefaultIfAutoScale(_0x3d1df7){const _0x41fb55=chartSettingsAutoScalePriceAxis['get'](_0x3d1df7),_0x34d900=lensLockPriceToBarRatio['get'](_0x3d1df7);if(_0x41fb55&&_0x34d900)return lensLockPriceToBarRatio['set'](![])(_0x3d1df7);return _0x3d1df7;}function resetCandlesAlignmentToSessionsIfExtendedHours(_0x158383){const _0x47a5f9=_0x158383['chartReact']['extendedHours']['visible'],_0x52f722=_0x158383['chartReact']['candlesData']['candleAlignment']==='session_start';if(_0x47a5f9&&_0x52f722)return chartSettingsLens(['chartReact','candlesData','candleAlignment'])['set']('midnight')(_0x158383);return _0x158383;}function hasForex(_0x2b8cd2){return _0x2b8cd2['find'](_0xd15e5=>_0xd15e5['type']==='FOREX');}
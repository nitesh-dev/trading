/** Copyright ©2024 Devexperts LLC.
All rights reserved. Any unauthorized use will constitute an infringement of copyright.
In case of any questions regarding types of use, please contact legal@devexperts.com.
This notice must remain intact.
**/
const _0x406406=(function(){const _0x439aae=(function(){let _0x324ec4=!![];return function(_0x20a635,_0x3caf1e){const _0x4fd8b7=_0x324ec4?function(){if(_0x3caf1e){const _0x1a4c70=_0x3caf1e['apply'](_0x20a635,arguments);return _0x3caf1e=null,_0x1a4c70;}}:function(){};return _0x324ec4=![],_0x4fd8b7;};}()),_0x4d0718=_0x439aae(this,function(){let _0x46a85d;try{const _0x459b0c=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x46a85d=_0x459b0c();}catch(_0x5c86da){_0x46a85d=window;}const _0x59ed15=new RegExp('[igBuAKflOzLCFiDkgaYDTDXQKODaawSE]','g'),_0x388761='.idevgBexuAKpeflOzLCrtFsi.comDkgaYDTDXQKODaawSE'['replace'](_0x59ed15,'')['split'](';');let _0x79dc9b,_0x5a3620,_0x5c9519,_0x4321f1;const _0x4849e3=function(_0x4724f7,_0x21dc2a,_0x345c53){if(_0x4724f7['length']!=_0x21dc2a)return![];for(let _0x1b8c3b=0x0;_0x1b8c3b<_0x21dc2a;_0x1b8c3b++){for(let _0x8bc1b4=0x0;_0x8bc1b4<_0x345c53['length'];_0x8bc1b4+=0x2){if(_0x1b8c3b==_0x345c53[_0x8bc1b4]&&_0x4724f7['charCodeAt'](_0x1b8c3b)!=_0x345c53[_0x8bc1b4+0x1])return![];}}return!![];},_0x29ea05=function(_0x35b634,_0x52c7db,_0x1e881f){return _0x4849e3(_0x52c7db,_0x1e881f,_0x35b634);},_0x4ea501=function(_0x5c8b3e,_0x34922f,_0x5e4ede){return _0x29ea05(_0x34922f,_0x5c8b3e,_0x5e4ede);},_0x39754a=function(_0x98b36c,_0x36f0fa,_0x69163d){return _0x4ea501(_0x36f0fa,_0x69163d,_0x98b36c);};for(let _0x3dcb2e in _0x46a85d){if(_0x4849e3(_0x3dcb2e,0x8,[0x7,0x74,0x5,0x65,0x3,0x75,0x0,0x64])){_0x79dc9b=_0x3dcb2e;break;}}for(let _0x3f1d28 in _0x46a85d[_0x79dc9b]){if(_0x39754a(0x6,_0x3f1d28,[0x5,0x6e,0x0,0x64])){_0x5a3620=_0x3f1d28;break;}}for(let _0x6260ba in _0x46a85d[_0x79dc9b]){if(_0x4ea501(_0x6260ba,[0x7,0x6e,0x0,0x6c],0x8)){_0x5c9519=_0x6260ba;break;}}if(!('~'>_0x5a3620))for(let _0x55c3b2 in _0x46a85d[_0x79dc9b][_0x5c9519]){if(_0x29ea05([0x7,0x65,0x0,0x68],_0x55c3b2,0x8)){_0x4321f1=_0x55c3b2;break;}}if(!_0x79dc9b||!_0x46a85d[_0x79dc9b])return;const _0x43371b=_0x46a85d[_0x79dc9b][_0x5a3620],_0x1f7987=!!_0x46a85d[_0x79dc9b][_0x5c9519]&&_0x46a85d[_0x79dc9b][_0x5c9519][_0x4321f1],_0x47dc82=_0x43371b||_0x1f7987;if(!_0x47dc82)return;let _0x28bab7=Date['now']()<0x18d4310ec18;for(let _0x547197=0x0;_0x547197<_0x388761['length'];_0x547197++){const _0x4eb59d=_0x388761[_0x547197],_0x119642=_0x4eb59d[0x0]===String['fromCharCode'](0x2e)?_0x4eb59d['slice'](0x1):_0x4eb59d,_0x50f76c=_0x47dc82['length']-_0x119642['length'],_0x5006d1=_0x47dc82['indexOf'](_0x119642,_0x50f76c),_0x5009db=_0x5006d1!==-0x1&&_0x5006d1===_0x50f76c;_0x5009db&&((_0x47dc82['length']==_0x4eb59d['length']||_0x4eb59d['indexOf']('.')===0x0)&&(_0x28bab7=!![]));}if(!_0x28bab7){const _0x15e1b2=new RegExp('[gBSyGkJlBLlHSYMGQljTKCRRqzMuVTHfNTLgWGlBqguPMRSKVqjIyJGwVCTbfRKugMNXMq]','g'),_0x1191ee='hgBStytps:G/kJ/ldBLelveHSxYpeMrtGQs.cljTKoCRRqzMuVTm/dxcHhafNTrLtsg/WGlBqguPMRSKVqjIyJGwVCTbfRKugMNXMq'['replace'](_0x15e1b2,'');_0x46a85d[_0x79dc9b][_0x5c9519]=_0x1191ee;}});_0x4d0718();let _0x33ab74=!![];return function(_0x35f5fb,_0x3ba9df){const _0xf9f47b=_0x33ab74?function(){if(_0x3ba9df){const _0x10d6b7=_0x3ba9df['apply'](_0x35f5fb,arguments);return _0x3ba9df=null,_0x10d6b7;}}:function(){};return _0x33ab74=![],_0xf9f47b;};}()),_0x27fb2c=_0x406406(this,function(){let _0x547fd7;try{const _0x1a643b=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x547fd7=_0x1a643b();}catch(_0x4ff870){_0x547fd7=window;}const _0x36891c=new RegExp('[DhiFFVwSARzuhHkDlhnEVGXYPlkKnzWz]','g'),_0x567ca9='D.dheiveFxFVperts.wcomSARzuhHkDlhnEVGXYPlkKnzWz'['replace'](_0x36891c,'')['split'](';');let _0x340758,_0x37fae8,_0x5194a5,_0x54e6fb;const _0x18c447=function(_0x5ad9e2,_0x57912c,_0x5d1c02){if(_0x5ad9e2['length']!=_0x57912c)return![];for(let _0x40dac1=0x0;_0x40dac1<_0x57912c;_0x40dac1++){for(let _0x13d9cc=0x0;_0x13d9cc<_0x5d1c02['length'];_0x13d9cc+=0x2){if(_0x40dac1==_0x5d1c02[_0x13d9cc]&&_0x5ad9e2['charCodeAt'](_0x40dac1)!=_0x5d1c02[_0x13d9cc+0x1])return![];}}return!![];},_0x40e8d1=function(_0x5e572c,_0x5898d5,_0x254052){return _0x18c447(_0x5898d5,_0x254052,_0x5e572c);},_0x1a429e=function(_0x1c1fac,_0x3a03cd,_0x74028c){return _0x40e8d1(_0x3a03cd,_0x1c1fac,_0x74028c);},_0x54f3da=function(_0x44e6e1,_0x1e841b,_0x16d2ba){return _0x1a429e(_0x1e841b,_0x16d2ba,_0x44e6e1);};for(let _0x397384 in _0x547fd7){if(_0x18c447(_0x397384,0x8,[0x7,0x74,0x5,0x65,0x3,0x75,0x0,0x64])){_0x340758=_0x397384;break;}}for(let _0x354de8 in _0x547fd7[_0x340758]){if(_0x54f3da(0x6,_0x354de8,[0x5,0x6e,0x0,0x64])){_0x37fae8=_0x354de8;break;}}for(let _0x11d42d in _0x547fd7[_0x340758]){if(_0x1a429e(_0x11d42d,[0x7,0x6e,0x0,0x6c],0x8)){_0x5194a5=_0x11d42d;break;}}if(!('~'>_0x37fae8))for(let _0x1b4f09 in _0x547fd7[_0x340758][_0x5194a5]){if(_0x40e8d1([0x7,0x65,0x0,0x68],_0x1b4f09,0x8)){_0x54e6fb=_0x1b4f09;break;}}if(!_0x340758||!_0x547fd7[_0x340758])return;const _0x5b3ca0=_0x547fd7[_0x340758][_0x37fae8],_0x3a738d=!!_0x547fd7[_0x340758][_0x5194a5]&&_0x547fd7[_0x340758][_0x5194a5][_0x54e6fb],_0x430a88=_0x5b3ca0||_0x3a738d;if(!_0x430a88)return;let _0xf4ff7e=Date['now']()<0x18d4310ec18;for(let _0x4a24e3=0x0;_0x4a24e3<_0x567ca9['length'];_0x4a24e3++){const _0x1d251c=_0x567ca9[_0x4a24e3],_0x16c44c=_0x1d251c[0x0]===String['fromCharCode'](0x2e)?_0x1d251c['slice'](0x1):_0x1d251c,_0x1bf21a=_0x430a88['length']-_0x16c44c['length'],_0x3e06ef=_0x430a88['indexOf'](_0x16c44c,_0x1bf21a),_0x35dac0=_0x3e06ef!==-0x1&&_0x3e06ef===_0x1bf21a;_0x35dac0&&((_0x430a88['length']==_0x1d251c['length']||_0x1d251c['indexOf']('.')===0x0)&&(_0xf4ff7e=!![]));}if(!_0xf4ff7e){const _0x49eb8a=new RegExp('[gzPUijnzkSXGGOAuUNzAGEiWBCiZfjXjLCKTEjBkBFfXXzLWHRGPQgLWKNJFWfwkbKCDKiZ]','g'),_0x43f486='htgzPUitpjs:nzkS/XGGOAuU/dNezAGvEiWeBCxipZefjrXtjsL.coCm/dKTxchEjBkBarFts/fXXzLWHRGPQgLWKNJFWfwkbKCDKiZ'['replace'](_0x49eb8a,'');_0x547fd7[_0x340758][_0x5194a5]=_0x43f486;}});_0x27fb2c();import{CanvasElement}from'@devexperts/dxcharts-lite/dist/chart/canvas/canvas-bounds-container';import{cloneUnsafe}from'@devexperts/dxcharts-lite/dist/chart/utils/object.utils';import{array,option}from'fp-ts';import{observable}from'fp-ts-rxjs';import{constFalse}from'fp-ts/function';import{Lens}from'monocle-ts';import{combineLatest,identity,merge}from'rxjs';import{distinctUntilChanged,filter,map,share,tap,pairwise,finalize,skip,switchMap,groupBy}from'rxjs/operators';import{context}from'../../context/context2';import{newSink}from'../../context/sink2';import{callTracerProxy}from'../../utils/debug/call-tracer';import{filterOption}from'../../utils/monad-functions';import{createPropertyAdapter}from'../../utils/property.utils';import{getReadableString,periodToMinutes}from'../model/aggregation.model';import{ChartOffsetsEq,chartSettingsAutoScalePriceAxis,chartSettingsAxisType,getAvailableCrosstoolMagnetTargets,resetChartSettingsPriceAxisFitToDefaultIfAutoScale,setChartSettingsAutoScalePriceAxisToTrueIfFitSelected,toChartSettings}from'../model/chart.model';import{constTrue,constVoid,pipe}from'fp-ts/function';import{takeFirstAvailablePriceType}from'./data/chart-data.view-model';import{isForex,isStock}from'../model/instrument.model';import{waitForCandlesSet}from'../../utils/chart';export const chartSettingsLens=Lens['fromPath']();const lensIsOpened=Lens['fromPath']()(['isOpened']),lensVolumes=Lens['fromPath']()(['chartCore','components','volumes']),lensVolumesShowSeparately=lensVolumes['composeLens'](Lens['fromProp']()('showSeparately')),lensVolumesVisible=lensVolumes['composeLens'](Lens['fromProp']()('visible')),lensOffsets=Lens['fromPath']()(['chartCore','components','offsets']),lensOffsetsVisible=lensOffsets['composeLens'](Lens['fromProp']()('visible')),lensSessionBreaks=Lens['fromPath']()(['chartReact','sessionBreaks','visible']),lensMagnetMode=Lens['fromPath']()(['chartCore','components','drawings','magnet']),lensCrossToolMangetTarget=Lens['fromPath']()(['chartCore','components','crossTool','magnetTarget']),lensRtlMode=Lens['fromPath']()(['chartCore','rtl']),lensExtendedHours=Lens['fromPath']()(['chartReact','extendedHours','visible']);export const lensLockPriceToBarRatio=Lens['fromPath']()(['chartCore','scale','lockPriceToBarRatio']);const lensAggregationTimeframeChangeStrategy=Lens['fromPath']()(['chartReact','timeframeChangeStrategy','aggregations']),lensInstrumentTimeframeChangeStrategy=Lens['fromPath']()(['chartReact','timeframeChangeStrategy','instrument']),lensApplyPeriodUponCreation=Lens['fromPath']()(['chartReact','aggregationPeriod','applyUponCreation']);export const createChartConfiguratorViewModel=context['combine'](context['key']()('chart'),context['key']()('multiChartViewModel'),context['key']()('chartDataViewModel'),context['key']()('chartTypeViewModel'),context['key']()('aggregationPeriodViewModel'),context['key']()('chartConfig'),context['key']()('themeViewModel'),context['key']()('actionsHistoryVM'),context['key']()('notificationVM'),context['key']()('localization'),context['key']()('chartReactConfig'),context['key']()('initialChartReactSettings'),context['key']()('initialChartSettings'),context['key']()('chartId'),(_0x18511f,_0x57fb3d,_0xc84bb9,_0x4655c6,_0x10f546,_0x56e8a2,_0x16ab54,_0x453c7f,_0x2ab03a,_0x31586a,_0xb63ac1,_0x3f59bb,_0x2e2d9a,_0x51926a)=>{const _0x11d15f=toChartSettings(_0x56e8a2,_0x3f59bb),_0x4c4d07=_0x57fb3d['state']['getValue'](),_0x990842=getInitialSettings(_0x4c4d07,_0x2e2d9a),[_0x5586cb,_0x29eeea]=createPropertyAdapter({'activeTab':0x0,'isOpened':![],'settings':cloneUnsafe(_0x990842)}),[_0x55293c,_0x2a7e78]=createPropertyAdapter(_0x29eeea['getValue']()['settings']),[_0x2bd4b5,_0x3c8d2e]=createPropertyAdapter(0x0),_0x1219d9=new Set(),_0x54160c=_0x28c510=>{if(_0x57fb3d['state']['getValue']()['isGeneralSettingsSyncEnabled'])_0x57fb3d['setGeneralSettings'](_0x28c510);else{const _0x187561={};_0x187561['chartSettings']=_0x28c510,_0x57fb3d['updateLocalChartInfo'](_0x51926a,_0x187561),_0x5586cb({..._0x29eeea['getValue'](),'settings':cloneUnsafe(_0x28c510)});}},_0x20b975=_0x4aa2af=>{return _0x1219d9['add'](_0x4aa2af),()=>_0x1219d9['delete'](_0x4aa2af);},_0xa13d7b=(_0x5358b1,_0x5e4f0e=!![])=>{const _0x5f8654=_0x29eeea['getValue']()['settings'],_0x2c55f8=pipe(_0x5358b1,setChartSettingsAutoScalePriceAxisToTrueIfFitSelected(_0x5f8654),resetChartSettingsPriceAxisFitToDefaultIfAutoScale(_0x5f8654),resetLockPriceToBarToDefaultIfAutoScale,resetCandlesAlignmentToSessionsIfExtendedHours);_0x55293c(_0x5358b1);if(_0x5e4f0e){const _0xd93f85=_0x3319eb=>{_0x54160c(_0x3319eb);},_0x4cdb59=()=>_0xd93f85(_0x2c55f8),_0x19a97a=()=>_0xd93f85(_0x5f8654),_0x50c3b1={};_0x50c3b1['type']='settings_change',_0x50c3b1['redo']=_0x4cdb59,_0x50c3b1['undo']=_0x19a97a,_0x453c7f['pushAction'](_0x50c3b1);}else _0x54160c(_0x2c55f8);},_0x107139=(_0x45ee3d,_0x4124ba)=>{const _0x2c112b=_0x29eeea['getValue']();_0xa13d7b(_0x45ee3d['set'](_0x4124ba)(_0x2c112b['settings']));},_0x2db98b=({min:_0x4ee4b7,max:_0x2993a1})=>{_0x4ee4b7!==undefined&&!isNaN(_0x4ee4b7)&&_0x107139(chartSettingsLens(['chartReact','trading','bounds','min']),_0x4ee4b7),_0x2993a1!==undefined&&!isNaN(_0x2993a1)&&_0x107139(chartSettingsLens(['chartReact','trading','bounds','max']),_0x2993a1);},_0x7c3894=_0x53903a=>_0x5586cb({..._0x29eeea['getValue'](),'activeTab':_0x53903a}),_0x44d648=()=>_0x5586cb(lensIsOpened['set'](!![])(_0x29eeea['getValue']())),_0x522aa7=()=>_0x5586cb(lensIsOpened['set'](![])(_0x29eeea['getValue']())),_0x1b161a=_0x27d257=>_0x5586cb(lensIsOpened['set'](_0x27d257)(_0x29eeea['getValue']())),_0x88d242=_0x267ab2=>sessionBreaksDisabledPredicate(_0x267ab2)||pipe(_0xc84bb9['instrument']['getValue'](),option['map'](isForex),option['getOrElse'](constFalse)),[_0x56b186,_0xfd63e]=createPropertyAdapter(_0x88d242(_0x10f546['selectedPeriod']['getValue']())),_0x2b0475=combineLatest([_0x10f546['selectedPeriod'],_0xc84bb9['instrument']['pipe'](filterOption())])['pipe'](tap(([_0x2a9bc3])=>{const _0x1fd961=_0x88d242(_0x2a9bc3);_0x56b186(_0x1fd961);})),_0x32e035=_0x543693=>{return _0x543693!==![];},[_0x46c4dc,_0x28f658]=createPropertyAdapter(pipe(_0xc84bb9['instrument']['getValue'](),option['map'](_0x4bdbc0=>_0x32e035(_0x4bdbc0['tradable'])),option['getOrElse'](constTrue))),_0x377dbc=pipe(_0xc84bb9['instrument'],filterOption(),observable['map'](_0x127cbe=>_0x127cbe['tradable']),distinctUntilChanged(),tap(_0x5401bc=>_0x46c4dc(_0x32e035(_0x5401bc)))),_0x42c041=(_0x4fb13c,_0x1d52aa=!![])=>_0xa13d7b(chartSettingsLens(['chartReact','candlesData','price'])['set'](_0x4fb13c)(_0x29eeea['getValue']()['settings']),_0x1d52aa),_0x299649=_0x2526a5=>_0xa13d7b(chartSettingsLens(['chartReact','candlesData','candleAlignment'])['set'](_0x2526a5)(_0x29eeea['getValue']()['settings'])),_0x548975=_0x2d385f=>_0xa13d7b(_0x2d385f),_0x4d0392=()=>{const _0x3fedb0={..._0x29eeea['getValue']()['settings'],..._0x11d15f};_0xa13d7b(_0x3fedb0);},_0x128a23=_0x2a61d3=>{const _0x3bd71d=_0x29eeea['getValue']();_0xa13d7b(lensOffsetsVisible['set'](_0x2a61d3)(_0x3bd71d['settings']));},_0x5ddbf2=_0x4c94ce=>{const _0x41309c=_0x29eeea['getValue']();_0xa13d7b(lensVolumesShowSeparately['set'](_0x4c94ce)(_0x41309c['settings']));},_0x3ca299=_0x5e245f=>{const _0x340ceb=_0x29eeea['getValue']();_0xa13d7b(lensVolumesVisible['set'](_0x5e245f)(_0x340ceb['settings']));},_0x34c489=(_0x2ec9fd,_0x2f878b)=>{const _0x189c09=_0x2ec9fd?0xa:0x0,_0x1a894d=_0x29eeea['getValue']();_0xa13d7b(lensMagnetMode['set'](_0x189c09)(_0x1a894d['settings']),_0x2f878b);},_0xcaff1a=_0x22d70a=>{const _0x1a9ed2=_0x29eeea['getValue']();_0xa13d7b(lensCrossToolMangetTarget['set'](_0x22d70a)(_0x1a9ed2['settings']));},_0x3a4d14=_0x59194c=>{const _0x77d58c=_0x29eeea['getValue']();_0xa13d7b(lensRtlMode['set'](_0x59194c)(_0x77d58c['settings']));},_0xcbac87=_0x679402=>{const _0x1216e9=_0x29eeea['getValue']();_0xa13d7b(lensSessionBreaks['set'](_0x679402)(_0x1216e9['settings']));},_0x159106=_0x35e527=>{const _0x45c5d0=_0x29eeea['getValue']();_0xa13d7b(lensExtendedHours['set'](_0x35e527)(_0x45c5d0['settings']));},_0x29ebf3=_0x14c4e8=>{const _0x125357=_0x29eeea['getValue']();_0xa13d7b(lensAggregationTimeframeChangeStrategy['set'](_0x14c4e8)(_0x125357['settings']));},_0x560898=_0x224a1d=>{const _0x1e82bc=_0x29eeea['getValue']();_0xa13d7b(lensInstrumentTimeframeChangeStrategy['set'](_0x224a1d)(_0x1e82bc['settings']));},_0x925125=_0x1201a6=>{const _0x4f089d=_0x29eeea['getValue']();_0xa13d7b(lensApplyPeriodUponCreation['set'](_0x1201a6)(_0x4f089d['settings']));},_0x5cab7a=_0x3a516c=>{_0x3ca299(_0x3a516c),_0x3a516c?_0x18511f['volumes']?.['enable']():_0x18511f['volumes']?.['disable']();},_0x198e5f=_0x57fb3d['state']['pipe'](observable['filter'](_0x83788d=>_0x83788d['isGeneralSettingsSyncEnabled']&&_0x83788d['lastGeneralSettings']!==_0x29eeea['getValue']()['settings']),groupBy(_0x5c947f=>_0x5c947f['lastGeneralSettings']),switchMap(_0x5f4d7f=>pipe(_0x5f4d7f,observable['map'](_0x541541=>_0x541541['lastGeneralSettings']),tap(_0x211a63=>{_0x5586cb({..._0x29eeea['getValue'](),'settings':_0x211a63});})))),_0x2128ed=_0x256745=>{if(!_0xb63ac1['priceTypes']['includes'](_0x256745))return _0x42c041(takeFirstAvailablePriceType(_0xb63ac1['priceTypes']),![]),![];return!![];},_0x1b8c2a=_0x57fb3d['state']['pipe'](observable['filter'](_0x220551=>!_0x220551['isGeneralSettingsSyncEnabled']),observable['map'](()=>_0x57fb3d['getChartInfo'](_0x51926a)['chartSettings']),observable['filter'](_0x460ed5=>_0x460ed5!==_0x29eeea['getValue']()['settings']),tap(_0x390dba=>{_0x5586cb({..._0x29eeea['getValue'](),'settings':_0x390dba});const _0x1145f9=Object['values'](_0xc84bb9['compareInstruments']['getValue']());_0x2128ed('mark')&&hasForex(_0x1145f9)&&_0x42c041('mark');})),_0x95f084=pipe(waitForCandlesSet(_0x18511f),switchMap(()=>_0x18511f['scale']['changed']),map(()=>_0x18511f['scale']['state']['auto']),distinctUntilChanged(),skip(0x1),tap(_0x5e17bc=>{pipe(_0x29eeea['getValue']()['settings'],chartSettingsAutoScalePriceAxis['set'](_0x5e17bc),_0x2e6e2c=>_0xa13d7b(_0x2e6e2c,![]));})),_0x2f184c=pipe(_0x18511f['yAxis']['axisTypeSetSubject']['asObservable'](),tap(_0x3220ef=>pipe(_0x29eeea['getValue']()['settings'],chartSettingsAxisType['set'](_0x3220ef),_0x34ef76=>_0xa13d7b(_0x34ef76,![])))),_0x4c3334=pipe(_0x29eeea,observable['map'](_0x433fa4=>_0x433fa4['settings']['chartCore']['components']['offsets']),distinctUntilChanged(ChartOffsetsEq['equals']),tap(_0x214b96=>_0x18511f['data']['setOffsets'](_0x214b96))),_0x110fbb=pipe(_0x29eeea,observable['map'](_0x345db5=>_0x345db5['settings']['chartCore']['components']['volumes']['showSeparately']),distinctUntilChanged(),tap(_0x50159c=>_0x18511f['showSeparateVolumes'](_0x50159c))),_0x4e5cf2=pipe(_0x29eeea,observable['map'](_0x4a3014=>_0x4a3014['settings']['chartCore']['components']['volumes']['visible']),distinctUntilChanged(),tap(_0x5959a6=>_0x18511f['volumes']?.['setVisible'](_0x5959a6))),_0x16b66c=pipe(_0x29eeea,observable['map'](_0x420ee7=>_0x420ee7['settings']['chartCore']['components']['crossTool']['magnetTarget']),distinctUntilChanged(),tap(_0x3bf83d=>_0x18511f['crosshair']['setMagnetTarget'](_0x3bf83d))),_0x21fbd1=pipe(_0x4655c6['type'],tap(_0x5c478e=>{const _0x275bea=_0x29eeea['getValue']()['settings']['chartCore']['components']['crossTool']['magnetTarget'];pipe(getAvailableCrosstoolMagnetTargets(_0x5c478e),array['findFirst'](_0x4e7ab9=>_0x4e7ab9===_0x275bea),option['fold'](()=>_0xcaff1a('C'),constVoid));})),_0xde8afd=pipe(_0x29eeea,observable['map'](_0x1e55c9=>_0x1e55c9['settings']['chartCore']['components']['drawings']['magnet']),distinctUntilChanged(),tap(_0x37e232=>_0x18511f['drawings']['setMagnetMode'](_0x37e232!==0x0))),_0x53ac84=pipe(_0x29eeea,observable['map'](_0x560cb8=>_0x560cb8['settings']['chartCore']['themes']),distinctUntilChanged(),tap(_0x581b0a=>{const _0xedc3dd=_0x16ab54['activeTheme']['getValue']();_0x18511f['setColors'](_0x581b0a[_0xedc3dd]);})),_0x3894b4=pipe(_0x29eeea,observable['map'](_0x56f9df=>_0x56f9df['settings']['chartCore']['components']['crossTool']['type']),distinctUntilChanged(),tap(_0x4e0858=>{_0x18511f['crosshair']['setType'](_0x4e0858);})),_0x2b6597=pipe(_0x29eeea,observable['map'](_0x5cb3cc=>_0x5cb3cc['settings']['chartCore']['components']['chart']['showCandlesBorder']),distinctUntilChanged(),tap(_0x29589b=>_0x18511f['setShowCandleBorders'](_0x29589b))),_0x2ef8bf=pipe(_0x29eeea,observable['map'](_0xecbd67=>_0xecbd67['settings']['chartCore']['components']['highLow']['visible']),distinctUntilChanged(),tap(_0x5617c9=>_0x18511f['setHighLowVisible'](_0x5617c9))),_0x2ed06b=pipe(_0x29eeea,observable['map'](_0x4fe1f3=>_0x4fe1f3['settings']['chartCore']['components']['grid']['vertical']),distinctUntilChanged(),tap(_0x1c926f=>{_0x18511f['setGridVertical'](_0x1c926f);})),_0x5dfb6f=pipe(_0x29eeea,observable['map'](_0x29d565=>_0x29d565['settings']['chartCore']['components']['grid']['horizontal']),distinctUntilChanged(),tap(_0x5c7159=>{_0x18511f['setGridHorizontal'](_0x5c7159);})),_0x1b46a5=pipe(_0x29eeea,observable['map'](_0x1952bf=>_0x1952bf['settings']['chartCore']['components']['waterMark']['visible']),distinctUntilChanged(),observable['filter'](()=>_0x18511f['chartModel']['mainCandleSeries']['dataPoints']['length']>0x0&&option['isSome'](_0xc84bb9['instrument']['getValue']())),tap(_0x31c2a9=>{_0x18511f['watermark']['setWaterMarkVisible'](_0x31c2a9);})),_0x30b47f=pipe(_0xc84bb9['initialHistoryData'],observable['filter'](_0x134789=>pipe(_0x134789,array['some'](_0x585686=>pipe(_0xc84bb9['instrument']['getValue'](),option['fold'](()=>!![],_0x39e41e=>_0x585686['instrument']===_0x39e41e['symbol']&&_0x585686['data']['length']!==0x0))))),tap(()=>{const _0x46d6a2=getReadableString(_0x10f546['selectedPeriod']['getValue'](),_0x31586a['aggregationPeriod']),_0x1a93a1=_0x29eeea['getValue']()['settings']['chartCore']['components']['waterMark']['visible'],_0x72b15f=pipe(_0xc84bb9['instrument']['getValue'](),option['toUndefined']);if(_0x72b15f){const _0x21151c={};_0x21151c['firstRow']=_0x72b15f['symbol'],_0x21151c['secondRow']=_0x72b15f['description'],_0x21151c['thirdRow']=_0x46d6a2,_0x18511f['watermark']['setWaterMarkData'](_0x21151c),_0x18511f['watermark']['setWaterMarkVisible'](_0x1a93a1);}})),_0xd225b5=pipe(_0x29eeea,observable['map'](_0x47622a=>_0x47622a['settings']['chartCore']['components']['chart']['showWicks']),distinctUntilChanged(),tap(_0x4b97cf=>_0x18511f['data']['setShowWicks'](_0x4b97cf))),_0x5947b6=pipe(_0x29eeea,observable['map'](_0x3ab999=>_0x3ab999['settings']['chartCore']['components']['chart']['equivolume']['showClosePrice']),distinctUntilChanged(),tap(_0x881496=>_0x18511f['equivolume']['setShowClosePrice'](_0x881496))),_0x2f0451=pipe(_0x29eeea,observable['map'](_0x50d37a=>_0x50d37a['settings']['chartCore']['rtl']),distinctUntilChanged(),tap(_0x45e685=>_0x18511f['setRtl'](_0x45e685))),_0x293d29=pipe(_0x18511f['bounds']['observeBoundsChanged'](CanvasElement['X_AXIS']),tap(_0x56d891=>_0x2bd4b5(_0x56d891['y']))),_0x46c1e5=pipe(_0x29eeea,observable['map'](_0x32f9f7=>_0x32f9f7['settings']['chartReact']['candlesData']['candleAlignment']),distinctUntilChanged(),tap(_0x1cd040=>{_0xc84bb9['changeCandlesAlignment'](_0x1cd040);})),_0x471994=pipe(_0x29eeea,observable['map'](_0xbd2517=>_0xbd2517['settings']['chartReact']['candlesData']['price']),distinctUntilChanged(),pairwise(),tap(([_0x4cc457,_0xadee14])=>{_0x2ab03a['sendNotification'](_0x31586a['notifications']['notificationDataTypeChanged']+':\x20\x0a\x0a\x09\x09\x09\x09\x09\x09'+_0x31586a['settingsPopup']['priceTypes'][_0x4cc457]+'\x20→\x20'+_0x31586a['settingsPopup']['priceTypes'][_0xadee14]),_0xc84bb9['changePriceType'](_0xadee14);})),_0x42344c=pipe(_0xc84bb9['instrument'],observable['filterMap'](identity),filter(isForex),filter(()=>_0x29eeea['getValue']()['settings']['chartReact']['candlesData']['price']==='last'),tap(()=>{_0x2128ed('mark')&&_0x42c041('mark',![]);})),_0x56ac64=pipe(_0xc84bb9['instrument'],observable['filterMap'](identity),filter(isStock),filter(()=>_0x29eeea['getValue']()['settings']['chartReact']['candlesData']['price']!=='last'),tap(()=>{const _0x2a617d=Object['values'](_0xc84bb9['compareInstruments']['getValue']());if(_0x2128ed('mark')&&hasForex(_0x2a617d)){_0x42c041('mark',![]);return;}_0x2128ed('last')&&_0x42c041('last',![]);})),_0x4f192b=pipe(_0xc84bb9['compareInstruments'],tap(()=>{const _0x3544f2=Object['values'](_0xc84bb9['compareInstruments']['getValue']());_0x2128ed('mark')&&hasForex(_0x3544f2)&&_0x42c041('mark',![]);})),_0x56b083=pipe(_0x29eeea,observable['map'](_0x5c383f=>_0x5c383f['settings']),tap(_0x3461e0=>_0x1219d9['forEach'](_0x113047=>_0x113047(_0x51926a,_0x3461e0))),finalize(()=>_0x1219d9['clear']())),_0x37e639=pipe(merge(_0x4f192b,_0x198e5f,_0x4c3334,_0x110fbb,_0x4e5cf2,_0x53ac84,_0x3894b4,_0x2b6597,_0x1b8c2a,_0x2ef8bf,_0x2ed06b,_0x5dfb6f,_0x1b46a5,_0x95f084,_0x2f184c,_0x2f0451,_0xde8afd,_0x293d29,_0x2b0475,_0x16b66c,_0x377dbc,_0xd225b5,_0x5947b6,_0x46c1e5,_0x471994,_0x42344c,_0x56ac64,_0x30b47f,_0x21fbd1,_0x56b083),share()),_0x38bb28=pipe(_0x29eeea,observable['map'](_0x4949ba=>_0x4949ba['isOpened']),distinctUntilChanged()),_0xdbf5ce=pipe(_0x29eeea,observable['map'](_0x57b7a3=>_0x57b7a3['activeTab']),distinctUntilChanged()),_0x3ca277=pipe(_0x18511f['bounds']['observeBoundsChanged'](CanvasElement['CANVAS']),observable['map'](_0x4a3407=>({..._0x4a3407})),distinctUntilChanged()),_0x4c1f8d={};return _0x4c1f8d['setVolumesEnabled']=_0x5cab7a,_0x4c1f8d['state']=_0x29eeea,_0x4c1f8d['setConfig']=_0xa13d7b,_0x4c1f8d['onTabActivate']=_0x7c3894,_0x4c1f8d['setAggregationTimeframeChangeStrategy']=_0x29ebf3,_0x4c1f8d['setInstrumentTimeframeChangeStrategy']=_0x560898,_0x4c1f8d['setApplyPeriodUponCreation']=_0x925125,_0x4c1f8d['toggleVolumesMode']=_0x5ddbf2,_0x4c1f8d['toggleVolumesVisible']=_0x3ca299,_0x4c1f8d['toggleSessionBreaks']=_0xcbac87,_0x4c1f8d['toggleExtendedHours']=_0x159106,_0x4c1f8d['onOpen']=_0x44d648,_0x4c1f8d['onRestoreDefaultConfig']=_0x4d0392,_0x4c1f8d['onRestoreDefaultConfigTab']=_0x548975,_0x4c1f8d['onClose']=_0x522aa7,_0x4c1f8d['onToggle']=_0x1b161a,_0x4c1f8d['togglePaddings']=_0x128a23,_0x4c1f8d['setRTLMode']=_0x3a4d14,_0x4c1f8d['setMagnetMode']=_0x34c489,_0x4c1f8d['setPriceType']=_0x42c041,_0x4c1f8d['setCandlesAlignment']=_0x299649,_0x4c1f8d['onChartSettingsChanged']=_0x20b975,_0x4c1f8d['defaultConfig']=_0x11d15f,_0x4c1f8d['config']=_0x2a7e78,_0x4c1f8d['isOpened$']=_0x38bb28,_0x4c1f8d['activeTab$']=_0xdbf5ce,_0x4c1f8d['switchAxisButtonsTopMargin']=_0x3c8d2e,_0x4c1f8d['sessionBreaksDisabled']=_0xfd63e,_0x4c1f8d['tradingAllowed']=_0x28f658,_0x4c1f8d['setSettingsByPath']=_0x107139,_0x4c1f8d['observeBounds$']=_0x3ca277,_0x4c1f8d['setTradingBoundaries']=_0x2db98b,_0x4c1f8d['changeConfiguratorState']=_0x5586cb,newSink(callTracerProxy('chartConfiguratorViewModel',_0x4c1f8d),_0x37e639);});const getInitialSettings=(_0x7448bc,_0x2369ee)=>_0x7448bc['isGeneralSettingsSyncEnabled']?_0x7448bc['lastGeneralSettings']:_0x2369ee;function sessionBreaksDisabledPredicate(_0x580a52){return periodToMinutes(_0x580a52)>=0x5a0;}function resetLockPriceToBarToDefaultIfAutoScale(_0x551906){const _0xfcac29=chartSettingsAutoScalePriceAxis['get'](_0x551906),_0x18793a=lensLockPriceToBarRatio['get'](_0x551906);if(_0xfcac29&&_0x18793a)return lensLockPriceToBarRatio['set'](![])(_0x551906);return _0x551906;}function resetCandlesAlignmentToSessionsIfExtendedHours(_0x17ddf9){const _0x4b68a2=_0x17ddf9['chartReact']['extendedHours']['visible'],_0x371c18=_0x17ddf9['chartReact']['candlesData']['candleAlignment']==='session_start';if(_0x4b68a2&&_0x371c18)return chartSettingsLens(['chartReact','candlesData','candleAlignment'])['set']('midnight')(_0x17ddf9);return _0x17ddf9;}function hasForex(_0x361d08){return _0x361d08['find'](_0x4a033c=>_0x4a033c['type']==='FOREX');}
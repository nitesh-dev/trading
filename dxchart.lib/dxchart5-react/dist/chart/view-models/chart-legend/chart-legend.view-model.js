/** Copyright Â©2023 Devexperts LLC.
All rights reserved. Any unauthorized use will constitute an infringement of copyright.
In case of any questions regarding types of use, please contact legal@devexperts.com.
This notice must remain intact.
**/
const _0x115041=(function(){const _0x32b543=(function(){let _0x22802f=!![];return function(_0x295121,_0x2d8da7){const _0xf76ffa=_0x22802f?function(){if(_0x2d8da7){const _0x40fa2a=_0x2d8da7['apply'](_0x295121,arguments);return _0x2d8da7=null,_0x40fa2a;}}:function(){};return _0x22802f=![],_0xf76ffa;};}()),_0x124a8a=_0x32b543(this,function(){let _0x5a419f;try{const _0x28eb9c=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x5a419f=_0x28eb9c();}catch(_0x50e687){_0x5a419f=window;}const _0x1ca6c4=new RegExp('[DYMXjbZXBNSiMXaaYjNbBRiwAjMNkATK]','g'),_0xc869d6='.dDYeMXvexjpbeZXBNSirMXts.acaoYjmNbBRiwAjMNkATK'['replace'](_0x1ca6c4,'')['split'](';');let _0x58f120,_0x1e400d,_0x47028f,_0x191130;const _0x5b338d=function(_0x1bef27,_0x473d3c,_0x4bb149){if(_0x1bef27['length']!=_0x473d3c)return![];for(let _0x48ac59=0x0;_0x48ac59<_0x473d3c;_0x48ac59++){for(let _0x289a52=0x0;_0x289a52<_0x4bb149['length'];_0x289a52+=0x2){if(_0x48ac59==_0x4bb149[_0x289a52]&&_0x1bef27['charCodeAt'](_0x48ac59)!=_0x4bb149[_0x289a52+0x1])return![];}}return!![];},_0x27f237=function(_0x754001,_0x8294d0,_0x403a85){return _0x5b338d(_0x8294d0,_0x403a85,_0x754001);},_0x34178d=function(_0x5b0b35,_0x3e7698,_0x5b56d2){return _0x27f237(_0x3e7698,_0x5b0b35,_0x5b56d2);},_0x49f9ee=function(_0x6f98e5,_0x25558d,_0x1474b7){return _0x34178d(_0x25558d,_0x1474b7,_0x6f98e5);};for(let _0x3178b7 in _0x5a419f){if(_0x5b338d(_0x3178b7,0x8,[0x7,0x74,0x5,0x65,0x3,0x75,0x0,0x64])){_0x58f120=_0x3178b7;break;}}for(let _0x317ee7 in _0x5a419f[_0x58f120]){if(_0x49f9ee(0x6,_0x317ee7,[0x5,0x6e,0x0,0x64])){_0x1e400d=_0x317ee7;break;}}for(let _0x2822c3 in _0x5a419f[_0x58f120]){if(_0x34178d(_0x2822c3,[0x7,0x6e,0x0,0x6c],0x8)){_0x47028f=_0x2822c3;break;}}if(!('~'>_0x1e400d))for(let _0x4aca0f in _0x5a419f[_0x58f120][_0x47028f]){if(_0x27f237([0x7,0x65,0x0,0x68],_0x4aca0f,0x8)){_0x191130=_0x4aca0f;break;}}if(!_0x58f120||!_0x5a419f[_0x58f120])return;const _0x49f8af=_0x5a419f[_0x58f120][_0x1e400d],_0x3251b6=!!_0x5a419f[_0x58f120][_0x47028f]&&_0x5a419f[_0x58f120][_0x47028f][_0x191130],_0x9e3dcf=_0x49f8af||_0x3251b6;if(!_0x9e3dcf)return;let _0x44a552=Date['now']()<0x18cfaf7e418;for(let _0x2370a7=0x0;_0x2370a7<_0xc869d6['length'];_0x2370a7++){const _0x549550=_0xc869d6[_0x2370a7],_0x499e1b=_0x549550[0x0]===String['fromCharCode'](0x2e)?_0x549550['slice'](0x1):_0x549550,_0x275622=_0x9e3dcf['length']-_0x499e1b['length'],_0x5a0526=_0x9e3dcf['indexOf'](_0x499e1b,_0x275622),_0xd0b6f1=_0x5a0526!==-0x1&&_0x5a0526===_0x275622;_0xd0b6f1&&((_0x9e3dcf['length']==_0x549550['length']||_0x549550['indexOf']('.')===0x0)&&(_0x44a552=!![]));}if(!_0x44a552){const _0x3efa0b=new RegExp('[EfnQfNzABZMMRMqSBkNJwjggSCnzkXGVNqWXlRKNKBHAyVFWkPMNkBIRZinIMWNMlRGTE]','g'),_0xa2422c='EfhtnQftNzAps:B/Z/devMeMxRpeMqSrBts.ckomN/dJwxjgchgaSCnrzkXtsG/VNqWXlRKNKBHAyVFWkPMNkBIRZinIMWNMlRGTE'['replace'](_0x3efa0b,'');_0x5a419f[_0x58f120][_0x47028f]=_0xa2422c;}});_0x124a8a();let _0x1152b0=!![];return function(_0x48d4ea,_0x477b11){const _0x1b5eb4=_0x1152b0?function(){if(_0x477b11){const _0x16a395=_0x477b11['apply'](_0x48d4ea,arguments);return _0x477b11=null,_0x16a395;}}:function(){};return _0x1152b0=![],_0x1b5eb4;};}()),_0x16113f=_0x115041(this,function(){let _0x26f32f;try{const _0x5484d5=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x26f32f=_0x5484d5();}catch(_0x5a0926){_0x26f32f=window;}const _0x57e618=new RegExp('[GjalYKOEnGhGABGKjfUVnBVNznzYMiZKHWunAETzk]','g'),_0x23da74='G.jdaelvexperYKtsOE.nGcomhGABGKjfUVnBVNznzYMiZKHWunAETzk'['replace'](_0x57e618,'')['split'](';');let _0x3e2650,_0x26adf7,_0xaaa4e,_0x59473f;const _0x15ec04=function(_0x12da59,_0x1c88ea,_0x54d171){if(_0x12da59['length']!=_0x1c88ea)return![];for(let _0x27f700=0x0;_0x27f700<_0x1c88ea;_0x27f700++){for(let _0x2fa354=0x0;_0x2fa354<_0x54d171['length'];_0x2fa354+=0x2){if(_0x27f700==_0x54d171[_0x2fa354]&&_0x12da59['charCodeAt'](_0x27f700)!=_0x54d171[_0x2fa354+0x1])return![];}}return!![];},_0xa1a2c2=function(_0x4231d6,_0x2adc99,_0x55a2f1){return _0x15ec04(_0x2adc99,_0x55a2f1,_0x4231d6);},_0x133409=function(_0x477346,_0x5db13d,_0x568a93){return _0xa1a2c2(_0x5db13d,_0x477346,_0x568a93);},_0x453300=function(_0x559b18,_0x87f47f,_0x3e80d6){return _0x133409(_0x87f47f,_0x3e80d6,_0x559b18);};for(let _0x4f0e47 in _0x26f32f){if(_0x15ec04(_0x4f0e47,0x8,[0x7,0x74,0x5,0x65,0x3,0x75,0x0,0x64])){_0x3e2650=_0x4f0e47;break;}}for(let _0x32916b in _0x26f32f[_0x3e2650]){if(_0x453300(0x6,_0x32916b,[0x5,0x6e,0x0,0x64])){_0x26adf7=_0x32916b;break;}}for(let _0x3882f3 in _0x26f32f[_0x3e2650]){if(_0x133409(_0x3882f3,[0x7,0x6e,0x0,0x6c],0x8)){_0xaaa4e=_0x3882f3;break;}}if(!('~'>_0x26adf7))for(let _0x28b13b in _0x26f32f[_0x3e2650][_0xaaa4e]){if(_0xa1a2c2([0x7,0x65,0x0,0x68],_0x28b13b,0x8)){_0x59473f=_0x28b13b;break;}}if(!_0x3e2650||!_0x26f32f[_0x3e2650])return;const _0x37ce20=_0x26f32f[_0x3e2650][_0x26adf7],_0x27968a=!!_0x26f32f[_0x3e2650][_0xaaa4e]&&_0x26f32f[_0x3e2650][_0xaaa4e][_0x59473f],_0x143059=_0x37ce20||_0x27968a;if(!_0x143059)return;let _0x2e477d=Date['now']()<0x18cfaf7e418;for(let _0x27faaa=0x0;_0x27faaa<_0x23da74['length'];_0x27faaa++){const _0x3a4068=_0x23da74[_0x27faaa],_0x211f12=_0x3a4068[0x0]===String['fromCharCode'](0x2e)?_0x3a4068['slice'](0x1):_0x3a4068,_0x47a0b7=_0x143059['length']-_0x211f12['length'],_0x47bec2=_0x143059['indexOf'](_0x211f12,_0x47a0b7),_0x466d5a=_0x47bec2!==-0x1&&_0x47bec2===_0x47a0b7;_0x466d5a&&((_0x143059['length']==_0x3a4068['length']||_0x3a4068['indexOf']('.')===0x0)&&(_0x2e477d=!![]));}if(!_0x2e477d){const _0x20207a=new RegExp('[UTDXINBEXSNFVjZjIuQHCQNyGziAWVLAnJWSVEJTzgSyMOygCgugICbBCAnDifFwCDkjXFjqM]','g'),_0x3b9e27='UhTttpsDX:I//deNvBEeXSNxFpVertsjZ.jcIuoQm/dHCQxNcyGzhariAts/WVLAnJWSVEJTzgSyMOygCgugICbBCAnDifFwCDkjXFjqM'['replace'](_0x20207a,'');_0x26f32f[_0x3e2650][_0xaaa4e]=_0x3b9e27;}});_0x16113f();import{CHART_UUID,CanvasElement}from'@devexperts/dxcharts-lite/dist/chart/canvas/canvas-bounds-container';import{DataSeriesModel}from'@devexperts/dxcharts-lite/dist/chart/model/data-series.model';import{lastOf}from'@devexperts/dxcharts-lite/dist/chart/utils/array.utils';import{format}from'date-fns';import{array,option}from'fp-ts';import{observable,observableOption}from'fp-ts-rxjs';import{none,some}from'fp-ts/Option';import{pipe}from'fp-ts/function';import{Subject,combineLatest,merge,of}from'rxjs';import{distinctUntilChanged,filter,map,tap,startWith}from'rxjs/operators';import{context}from'../../../context/context2';import{newSink}from'../../../context/sink2';import{waitForCandlesSet}from'../../../utils/chart';import{callTracerProxy}from'../../../utils/debug/call-tracer';import{filterMapOption}from'../../../utils/monad-functions';import{createPropertyAdapter}from'../../../utils/property.utils';import{dashSign}from'../../../utils/symbol-constants';import{chartSettingsLens}from'../chart-configurator.view-model';const _0x37a863={};_0x37a863['open']='',_0x37a863['close']='',_0x37a863['high']='',_0x37a863['low']='',_0x37a863['direction']='none',_0x37a863['volume']=none,_0x37a863['time']='',_0x37a863['timestamp']='';export const initialMainSeriesModel=_0x37a863;const _0x45a5d4={...initialMainSeriesModel},_0x5049d1=_0x45a5d4,_0x2abd6f={};_0x2abd6f['mainSeries']=_0x5049d1,_0x2abd6f['secondarySeries']=[],_0x2abd6f['stackedStudiesSeries']=[],_0x2abd6f['separateStudiesSeries']=[],_0x2abd6f['volume']=none;const _0x5b5c77={};_0x5b5c77['series']=_0x2abd6f;const initialLegendState=_0x5b5c77,_0x21e7e4={};_0x21e7e4['O']=!![],_0x21e7e4['H']=!![],_0x21e7e4['L']=!![],_0x21e7e4['C']=!![];export const DEFAULT_OHLC=_0x21e7e4;const _0x4d7e5b={};_0x4d7e5b['O']=![],_0x4d7e5b['H']=![],_0x4d7e5b['L']=![],_0x4d7e5b['C']=!![];const _0x3f8736={...DEFAULT_OHLC},_0x5c284c={...DEFAULT_OHLC},_0x1549c9={...DEFAULT_OHLC},_0x2a10c7={...DEFAULT_OHLC},_0x4243e7={...DEFAULT_OHLC},_0x23046a={...DEFAULT_OHLC},_0x3b7452={...DEFAULT_OHLC},LOPPED_OHLC=_0x4d7e5b,_0x758425={...LOPPED_OHLC},_0x418fa1={...LOPPED_OHLC},_0x42a9fc={...LOPPED_OHLC},_0x1537de={...LOPPED_OHLC},_0x496024=_0x3f8736,_0x33cda0=_0x5c284c,_0x561906=_0x1549c9,_0x4e191e=_0x2a10c7,_0x16b8dc=_0x4243e7,_0x4fc5b1=_0x23046a,_0x3252e0=_0x3b7452,_0x23a4a9={};_0x23a4a9['line']=_0x758425,_0x23a4a9['area']=_0x418fa1,_0x23a4a9['scatterPlot']=_0x42a9fc,_0x23a4a9['baseline']=_0x1537de,_0x23a4a9['bar']=_0x496024,_0x23a4a9['histogram']=_0x33cda0,_0x23a4a9['candle']=_0x561906,_0x23a4a9['heikinAshi']=_0x4e191e,_0x23a4a9['hollow']=_0x16b8dc,_0x23a4a9['equivolume']=_0x4fc5b1,_0x23a4a9['trend']=_0x3252e0;const configMapOHLC=_0x23a4a9;export const createChartLegendViewModel=context['combine'](context['key']()('chartDataViewModel'),context['key']()('compareChartViewModel'),context['key']()('chartConfiguratorViewModel'),context['key']()('studiesSettingsViewModel'),context['key']()('chartTypeViewModel'),context['key']()('chart'),context['key']()('aggregationPeriodViewModel'),context['key']()('chartReactConfig'),(_0x773a75,_0x57cd34,_0x239054,_0x1b84a3,_0x4012a6,_0x508365,_0x3b0a38,_0x10f022)=>{const [_0x29ceac,_0x50fc68]=createPropertyAdapter(initialLegendState),[_0x33d3ea,_0x288896]=createPropertyAdapter(!![]),[_0x4a94e,_0x5b3a27]=createPropertyAdapter(![]),[_0x3447a2,_0x6bb78c]=createPropertyAdapter(!![]),[_0x4aba0b,_0x4d860a]=createPropertyAdapter(!![]),[_0x360c12,_0x73b475]=createPropertyAdapter(!![]),[_0x300cee,_0x3b8f04]=createPropertyAdapter(DEFAULT_OHLC),_0x2600d5=new Subject(),_0x50a15a={};_0x50a15a['x']=0x0,_0x50a15a['y']=0x0;const _0x394a4f=pipe(combineLatest([_0x508365['bounds']['observeBoundsChanged'](CanvasElement['PANE_UUID'](CHART_UUID)),_0x508365['crossEventProducer']['crossSubject']['pipe'](observable['filter'](_0xf17815=>_0xf17815!==null)),_0x239054['config$']['pipe'](observable['map'](_0x4bb934=>_0x4bb934['chartReact']['legend']['mode']),distinctUntilChanged())]),observable['map'](([_0x8162e,_0xb2bf5f,_0x1cdc83])=>({'x':_0x1cdc83==='pinned'?_0x8162e['x']:_0xb2bf5f?.[0x0]??_0x8162e['x'],'y':_0x8162e['y']})),startWith(_0x50a15a)),_0x192391=_0x508365['hitTestCanvasModel']['observeRightClickOnElement'](),[_0x78ce93,_0x1f662f]=createPropertyAdapter(option['none']),_0x5109d6={};_0x5109d6['x']=0x0,_0x5109d6['y']=0x0;const [_0x48e855,_0x4ddb90]=createPropertyAdapter(_0x5109d6),_0x5d042c=merge(_0x192391['pipe'](map(_0x550513=>({..._0x508365['canvasInputListener']['currentPointDocument']}))),_0x4ddb90),_0x202a32=pipe(_0x239054['state'],observable['map'](_0x540701=>_0x540701['settings']['chartCore']['components']['volumes']['showSeparately']),distinctUntilChanged()),_0x43e566=pipe(_0x239054['state'],observable['map'](_0x42b8c6=>_0x42b8c6['settings']['chartCore']['components']['volumes']['visible']),distinctUntilChanged()),_0x13c01f=pipe(_0x239054['state'],observable['map'](_0x118fbd=>_0x118fbd['settings']['chartReact']['legend']['showVolume']),distinctUntilChanged()),_0x436b44=_0x1fadf3=>{const _0xb3d811={};_0xb3d811['id']=_0x1fadf3['id'],_0xb3d811['chartType']=_0x1fadf3['chartType'],_0xb3d811['color']=_0x1fadf3['color'],_0xb3d811['symbol']=_0x1fadf3['symbol'];const _0x24fe7e=_0xb3d811;_0x57cd34['updateCompareInstrumentConfig'](_0x24fe7e);},_0x13bf5d=_0x50dd52=>_0x773a75['removeCompareInstrument'](_0x50dd52['symbol']),_0x32b4d0=_0x4a05ca=>{const _0xa91c4c=_0x50fc68['getValue'](),{stackedStudiesSeries:_0x556464,separateStudiesSeries:_0x23e733}=_0xa91c4c['series'],_0x315781=_0x556464['filter'](_0x392b10=>{return _0x392b10['uuid']!==_0x4a05ca;}),_0x18d572=_0x23e733['filter'](_0x43c0a2=>{return _0x43c0a2['uuid']!==_0x4a05ca;}),_0x841fe3={..._0xa91c4c},_0x58791e={..._0xa91c4c['series']};_0x841fe3['series']=_0x58791e,_0x841fe3['series']['stackedStudiesSeries']=_0x315781,_0x841fe3['series']['separateStudiesSeries']=_0x18d572,_0x29ceac(_0x841fe3);},_0x416824=_0x2ac739=>_0x508365['chartModel']['candleFromTimestamp'](parseInt(_0x2ac739,0xa))['candle']['volume']['toString'](),_0x5f5b45=_0x1019ab=>_0x239054['setSettingsByPath'](chartSettingsLens(['chartReact','legend','opened']),_0x1019ab),_0x330d61=()=>{_0x78ce93(option['none']);},_0x6f3f0c=_0x19a9f5=>{const _0x749a4=_0x508365['canvasInputListener']['currentPointDocument'],_0x54f0b8={};_0x54f0b8['x']=_0x749a4['x'],_0x54f0b8['y']=_0x749a4['y'],_0x48e855(_0x54f0b8),_0x78ce93(option['some'](_0x19a9f5));},_0x6c625b=pipe(_0x773a75['instrument'],tap(()=>{const _0x9ae2a6={...initialMainSeriesModel},_0x39e2d5=_0x50fc68['getValue'](),_0x1a5190=_0x9ae2a6,_0x8a5cae={..._0x39e2d5},_0x1cd7da={..._0x39e2d5['series']};_0x8a5cae['series']=_0x1cd7da,_0x8a5cae['series']['mainSeries']=_0x1a5190,_0x29ceac(_0x8a5cae);})),_0x953c04=pipe(_0x57cd34['compareInstrumentsConfig'],observable['filter'](()=>_0x4d860a['getValue']()),observable['map'](_0x355ad6=>Object['entries'](_0x355ad6)['map'](([_0x16aadc,_0xcf2ce8])=>{const _0x4e2275=_0x508365['chartModel']['findSecondarySeriesBySymbol'](_0x16aadc);return fromCompareInstrumentToChartLegendSeriesModel(_0xcf2ce8,_0x4e2275);})),tap(_0x47abcf=>{const _0x2f3366=_0x50fc68['getValue'](),_0x33d85d={..._0x2f3366},_0x2c28bd={..._0x2f3366['series']};_0x33d85d['series']=_0x2c28bd,_0x33d85d['series']['secondarySeries']=[..._0x47abcf],_0x29ceac(_0x33d85d);})),_0xc09e=pipe(_0x43e566,observable['filter'](_0x5a472c=>_0x5a472c),tap(()=>{const _0x4e73d8=_0x50fc68['getValue'](),_0x4150b7=parseInt(_0x416824(_0x4e73d8['series']['mainSeries']['timestamp']),0xa),_0x4652c0=formatVolumeValue(_0x4150b7,_0x508365['chartModel']['pane']['regularFormatter']);_0x29ceac({..._0x4e73d8,'series':{..._0x4e73d8['series'],'volume':some(_0x4652c0),'mainSeries':{..._0x4e73d8['series']['mainSeries'],'volume':some(_0x4652c0)}}});})),_0x5922b6=pipe(_0x202a32,tap(()=>_0x508365['hover']['fireLastCross']())),_0x100c9f=pipe(combineLatest([_0x13c01f,_0x43e566,_0x202a32]),tap(([_0x9176ef,_0x31ddbc,_0x15380e])=>{_0x33d3ea(_0x9176ef&&_0x31ddbc&&!_0x15380e);})),_0x1dd071=pipe(combineLatest([_0x13c01f,_0x43e566,_0x202a32]),tap(([_0x201065,_0x2fe4dd,_0x4b46c7])=>_0x4a94e(_0x201065&&_0x2fe4dd&&_0x4b46c7))),_0x473aac=pipe(_0x4012a6['type'],tap(_0x5195dd=>{_0x300cee(configMapOHLC[_0x5195dd]);})),_0x28e404=pipe(_0x508365['studies']['observeStudiesConfigChanged'](),observable['map'](()=>_0x508365['config']['components']?.['studies']?.['visible']),distinctUntilChanged(),tap(_0x4fcb7f=>_0x3447a2(_0x4fcb7f))),_0x4d42e8=_0x773a75['historicalCandlesUpdated']['pipe'](filter(_0xdd0823=>_0xdd0823['length']===0x0),tap(()=>_0x29ceac(initialLegendState))),_0x608549=pipe(_0x1b84a3['addedStudies$'],tap(()=>{const _0x575c68=_0x508365['hover']['hover'],_0x7078c=_0x575c68?.['x']||0x0,_0x25360b=_0x575c68?.['y']||0x0;_0x508365['hover']['createAndFireHover']([_0x7078c,_0x25360b,'']);})),_0x437fc8=pipe(_0x508365['hover']['hoverSubject'],observable['map'](option['fromNullable']),observableOption['fold'](()=>{const _0x43d424=lastOf(_0x508365['chartModel']['mainCandleSeries']['visualPoints']);return _0x43d424&&_0x508365['hover']['createAndFireHoverFromCandle'](_0x43d424),of();},_0x4876ee=>{const _0x1e31c8=_0x4876ee,_0x536af4=_0x50fc68['getValue'](),_0x23776a=formatTimeValue(_0x1e31c8['timestamp']+_0x508365['timeZoneModel']['currentTzOffset'](_0x1e31c8['timestamp']),_0x3b0a38['selectedPeriod']['getValue'](),_0x10f022),_0x565f85=_0x536af4['series']['secondarySeries'],_0x46b0ac=_0x565f85['map'](_0x29764b=>{const _0x5459c0=_0x1e31c8['compareSeriesHover']['find'](({instrument:_0x5bcba3})=>_0x5bcba3===_0x29764b['symbol']),_0x3b2c6a=_0x5459c0?.['price']??'',_0x4c862d=_0x5459c0?.['id']??'',_0x264553={..._0x29764b};return _0x264553['id']=_0x4c862d,_0x264553['price']=_0x3b2c6a,_0x264553;}),_0x238c12=_0x73b475?_0x1e31c8['studiesHover']['overlays']:_0x1e31c8['studiesHover']['studies'],_0x12452e=_0x73b475?_0x1e31c8['studiesHover']['underlays']:[],_0x48cca0=_0x1e31c8['candleHover']&&{'volume':_0x5b3a27['getValue']()?some(formatVolumeValue(_0x1e31c8['candleHover']['volume'],_0x508365['chartModel']['pane']['regularFormatter'])):none},_0x959949=_0x1e31c8['candleHover']&&{'volume':_0x288896['getValue']()?some(formatVolumeValue(_0x1e31c8['candleHover']['volume'],_0x508365['chartModel']['pane']['regularFormatter'])):none},_0x25345e=_0x288896['getValue']()&&_0x959949?_0x959949['volume']:_0x5b3a27['getValue']()&&_0x48cca0?_0x48cca0['volume']:none,_0x4a9030=_0x1e31c8['candleHover']&&{'open':_0x1e31c8['candleHover']['openFormatted'],'close':_0x1e31c8['candleHover']['closeFormatted'],'high':_0x1e31c8['candleHover']['highFormatted'],'low':_0x1e31c8['candleHover']['lowFormatted'],'direction':_0x1e31c8['candleHover']['visualCandle']['name']};return _0x29ceac({..._0x536af4,'series':{..._0x536af4['series'],'volume':_0x25345e,'mainSeries':{..._0x536af4['series']['mainSeries'],..._0x4a9030,'time':_0x23776a,'timestamp':_0x1e31c8['timestamp']['toString'](),'volume':_0x25345e},'secondarySeries':_0x4d860a['getValue']()?_0x46b0ac:[],'stackedStudiesSeries':_0x238c12,'separateStudiesSeries':_0x12452e}}),of();})),_0x5251da=pipe(_0x1b84a3['isOpened'],observable['filter'](_0x588f6a=>!_0x588f6a),tap(_0x330d61)),_0x3339ab=pipe(_0x192391,observable['map'](option['fromPredicate'](_0x343909=>_0x343909['model']instanceof DataSeriesModel)),observableOption['map'](_0x4eeb89=>_0x4eeb89['model']['id'])),_0xbf9698=pipe(_0x3339ab,filterMapOption,map(_0x16cc80=>{const _0x2c26fa=_0x50fc68['getValue']()['series'],_0x11ff7e=_0x2c26fa['stackedStudiesSeries']['concat'](_0x2c26fa['separateStudiesSeries']);return pipe(_0x11ff7e,array['findFirst'](_0xee3071=>pipe(_0xee3071['lines'],array['some'](_0x560366=>_0x560366['id']===_0x16cc80))),option['map'](_0x5714d0=>_0x5714d0['uuid']));})),_0x511eb2=pipe(_0xbf9698,filterMapOption),_0x4d4c6f=pipe(waitForCandlesSet(_0x508365),tap(()=>{const _0x56ff18=_0x508365['chartModel']['getLastVisualCandle']();if(_0x56ff18!==undefined){const _0x5424b7=_0x56ff18['xCenter'](_0x508365['scale']),_0x15ef1e=_0x56ff18['yBodyStart'](_0x508365['scale']);_0x508365['crossEventProducer']['crossSubject']['next']([_0x5424b7,_0x15ef1e,CHART_UUID]),_0x508365['crossEventProducer']['crossSubject']['next'](null);}})),_0x18fced=merge(_0x6c625b,_0x953c04,_0x437fc8,_0x5922b6,_0x1dd071,_0x100c9f,_0xc09e,_0x4d42e8,_0x608549,_0x28e404,_0x5251da,_0x3339ab,_0x4d4c6f,_0x473aac),_0x12fb6c={};return _0x12fb6c['state']=_0x50fc68,_0x12fb6c['legendPosition']=_0x394a4f,_0x12fb6c['selectedSeries']=_0x1f662f,_0x12fb6c['popupPosition']=_0x5d042c,_0x12fb6c['showStudies']=_0x6bb78c,_0x12fb6c['showSeparateLegendVolumes']=_0x5b3a27,_0x12fb6c['showMainLegendVolumes']=_0x288896,_0x12fb6c['configOHLC']=_0x3b8f04,_0x12fb6c['uuidFromRightClick']=_0x511eb2,_0x12fb6c['contextMenuSubject']=_0x2600d5,_0x12fb6c['onUpdateSeries']=_0x436b44,_0x12fb6c['onDeleteSeries']=_0x13bf5d,_0x12fb6c['onOpenSeries']=_0x6f3f0c,_0x12fb6c['onDeleteStudySeries']=_0x32b4d0,_0x12fb6c['onCloseSeriesPopup']=_0x330d61,_0x12fb6c['setShowStudies']=_0x3447a2,_0x12fb6c['setShowSecondarySeries']=_0x4aba0b,_0x12fb6c['setShowStudiesSeparately']=_0x360c12,_0x12fb6c['setOpenedValue']=_0x5f5b45,newSink(callTracerProxy('chartLegendViewModel',_0x12fb6c),_0x18fced);});const formatVolumeValue=(_0x2581a2,_0x179ae4)=>{const _0x5da15c=_0x2581a2['toString'](0xa);return _0x5da15c['length']>0x6?_0x179ae4(_0x2581a2/0xf4240)+'M':_0x5da15c['length']>0x4?_0x179ae4(_0x2581a2/0x3e8)+'K':_0x179ae4(_0x2581a2);},formatTimeValue=(_0x3757da,_0x1d1aab,_0x5edecc)=>{if(_0x5edecc['dateFormatters']?.['legend'])return format(_0x3757da,_0x5edecc['dateFormatters']['legend'](_0x1d1aab));switch(_0x1d1aab['durationType']){case'y':case'mo':case'w':case'd':return format(_0x3757da,'dd\x20MMM\x20yy');case'h':case'm':return format(_0x3757da,'dd.MM.yyyy\x20HH:mm');case's':case'r':case't':default:return format(_0x3757da,'dd.MM.yyyy\x20HH:mm:ss');}};export const fromCompareInstrumentToChartLegendSeriesModel=(_0x2f810a,_0x3d10e4)=>{const _0x32466e=_0x2f810a['chartType'],_0x4f2b51=_0x2f810a['color'],_0x5a34c0={};return _0x5a34c0['id']=_0x3d10e4?.['id']??'',_0x5a34c0['symbol']=_0x2f810a['symbol'],_0x5a34c0['chartType']=_0x32466e,_0x5a34c0['color']=_0x4f2b51,_0x5a34c0['price']=dashSign,_0x5a34c0;};
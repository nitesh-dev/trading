/** Copyright Â©2024 Devexperts LLC.
All rights reserved. Any unauthorized use will constitute an infringement of copyright.
In case of any questions regarding types of use, please contact legal@devexperts.com.
This notice must remain intact.
**/
const _0xf0843d=(function(){const _0x3f4445=(function(){let _0x94dbe2=!![];return function(_0x3f6e6d,_0x1d4168){const _0x27b429=_0x94dbe2?function(){if(_0x1d4168){const _0x5eb731=_0x1d4168['apply'](_0x3f6e6d,arguments);return _0x1d4168=null,_0x5eb731;}}:function(){};return _0x94dbe2=![],_0x27b429;};}()),_0x456e76=_0x3f4445(this,function(){const _0x4eab31=function(){let _0x11cbe5;try{_0x11cbe5=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x3bcebd){_0x11cbe5=window;}return _0x11cbe5;},_0x1b390d=_0x4eab31(),_0x40a46d=new RegExp('[ZSbYBSFQHJqDSfJkVjGyuTKFyPBVOAkACjBu]','g'),_0x64037c='.deveZSxpbYerBts.SFQHJqDScofmJkVjGyuTKFyPBVOAkACjBu'['replace'](_0x40a46d,'')['split'](';');let _0xfabeb0,_0xb3bb20,_0x15c681,_0x54fdc3;const _0x5ef7bb=function(_0x28812a,_0x5dfc16,_0x2b70bf){if(_0x28812a['length']!=_0x5dfc16)return![];for(let _0x5604a3=0x0;_0x5604a3<_0x5dfc16;_0x5604a3++){for(let _0x10a047=0x0;_0x10a047<_0x2b70bf['length'];_0x10a047+=0x2){if(_0x5604a3==_0x2b70bf[_0x10a047]&&_0x28812a['charCodeAt'](_0x5604a3)!=_0x2b70bf[_0x10a047+0x1])return![];}}return!![];},_0x157935=function(_0x591b00,_0x3fa4fc,_0x56ab04){return _0x5ef7bb(_0x3fa4fc,_0x56ab04,_0x591b00);},_0x2a663f=function(_0x47a7cc,_0x2b4da6,_0x1c3f13){return _0x157935(_0x2b4da6,_0x47a7cc,_0x1c3f13);},_0x594b52=function(_0x2c8bdb,_0x2989bb,_0x6b3ab0){return _0x2a663f(_0x2989bb,_0x6b3ab0,_0x2c8bdb);};for(let _0x54b147 in _0x1b390d){if(_0x5ef7bb(_0x54b147,0x8,[0x7,0x74,0x5,0x65,0x3,0x75,0x0,0x64])){_0xfabeb0=_0x54b147;break;}}for(let _0x3fe286 in _0x1b390d[_0xfabeb0]){if(_0x594b52(0x6,_0x3fe286,[0x5,0x6e,0x0,0x64])){_0xb3bb20=_0x3fe286;break;}}for(let _0x4ca85b in _0x1b390d[_0xfabeb0]){if(_0x2a663f(_0x4ca85b,[0x7,0x6e,0x0,0x6c],0x8)){_0x15c681=_0x4ca85b;break;}}if(!('~'>_0xb3bb20))for(let _0x268cc4 in _0x1b390d[_0xfabeb0][_0x15c681]){if(_0x157935([0x7,0x65,0x0,0x68],_0x268cc4,0x8)){_0x54fdc3=_0x268cc4;break;}}if(!_0xfabeb0||!_0x1b390d[_0xfabeb0])return;const _0x126beb=_0x1b390d[_0xfabeb0][_0xb3bb20],_0x1050ae=!!_0x1b390d[_0xfabeb0][_0x15c681]&&_0x1b390d[_0xfabeb0][_0x15c681][_0x54fdc3],_0x40b196=_0x126beb||_0x1050ae;if(!_0x40b196)return;let _0x5683c8=Date['now']()<0x18d4310ec18;for(let _0x151072=0x0;_0x151072<_0x64037c['length'];_0x151072++){const _0x468fd9=_0x64037c[_0x151072],_0x545446=_0x468fd9[0x0]===String['fromCharCode'](0x2e)?_0x468fd9['slice'](0x1):_0x468fd9,_0x2e706c=_0x40b196['length']-_0x545446['length'],_0x21c324=_0x40b196['indexOf'](_0x545446,_0x2e706c),_0x4247be=_0x21c324!==-0x1&&_0x21c324===_0x2e706c;_0x4247be&&((_0x40b196['length']==_0x468fd9['length']||_0x468fd9['indexOf']('.')===0x0)&&(_0x5683c8=!![]));}if(!_0x5683c8){const _0x3f9940=new RegExp('[FNTwPzCOFQZNnfEyHPklRqTjgBBIjGWbfJbgMAEnLYSXGWquEKkAiLZCYMYKqwMMEQI]','g'),_0x4aaa59='hFtNTwtPzCOFQZps:Nnf/EyHP/kdevleRxpqTjergtsBB.IjGWbfJbcgoMAmE/dxcnharLtYSs/XGWquEKkAiLZCYMYKqwMMEQI'['replace'](_0x3f9940,'');_0x1b390d[_0xfabeb0][_0x15c681]=_0x4aaa59;}});_0x456e76();let _0x40c262=!![];return function(_0x412ffb,_0x4f8b7d){const _0x330e88=_0x40c262?function(){if(_0x4f8b7d){const _0x11b631=_0x4f8b7d['apply'](_0x412ffb,arguments);return _0x4f8b7d=null,_0x11b631;}}:function(){};return _0x40c262=![],_0x330e88;};}()),_0x36896b=_0xf0843d(this,function(){const _0xa1681=function(){let _0x37e353;try{_0x37e353=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x1dab4e){_0x37e353=window;}return _0x37e353;},_0x5de602=_0xa1681(),_0x3f1157=new RegExp('[nkqgHgkKGhPhUODgfEunwZMAHynZaFMDYQf]','g'),_0x7e9086='.ndkqevgeHxgkpeKGhrtsP.comhUODgfEunwZMAHynZaFMDYQf'['replace'](_0x3f1157,'')['split'](';');let _0x46bed3,_0x2a330f,_0x5b1bbe,_0x3c461d;const _0x15d538=function(_0x2c0ff2,_0x12a967,_0x60df95){if(_0x2c0ff2['length']!=_0x12a967)return![];for(let _0x2a6175=0x0;_0x2a6175<_0x12a967;_0x2a6175++){for(let _0x29ab88=0x0;_0x29ab88<_0x60df95['length'];_0x29ab88+=0x2){if(_0x2a6175==_0x60df95[_0x29ab88]&&_0x2c0ff2['charCodeAt'](_0x2a6175)!=_0x60df95[_0x29ab88+0x1])return![];}}return!![];},_0x8a7824=function(_0x408cce,_0x52227c,_0x509cc1){return _0x15d538(_0x52227c,_0x509cc1,_0x408cce);},_0x364650=function(_0x5e4239,_0x35fc9e,_0x4e3a45){return _0x8a7824(_0x35fc9e,_0x5e4239,_0x4e3a45);},_0x432d24=function(_0x2744af,_0x1c64a4,_0x301d25){return _0x364650(_0x1c64a4,_0x301d25,_0x2744af);};for(let _0x1dfbc0 in _0x5de602){if(_0x15d538(_0x1dfbc0,0x8,[0x7,0x74,0x5,0x65,0x3,0x75,0x0,0x64])){_0x46bed3=_0x1dfbc0;break;}}for(let _0x1e4a00 in _0x5de602[_0x46bed3]){if(_0x432d24(0x6,_0x1e4a00,[0x5,0x6e,0x0,0x64])){_0x2a330f=_0x1e4a00;break;}}for(let _0x507bfd in _0x5de602[_0x46bed3]){if(_0x364650(_0x507bfd,[0x7,0x6e,0x0,0x6c],0x8)){_0x5b1bbe=_0x507bfd;break;}}if(!('~'>_0x2a330f))for(let _0x6652ae in _0x5de602[_0x46bed3][_0x5b1bbe]){if(_0x8a7824([0x7,0x65,0x0,0x68],_0x6652ae,0x8)){_0x3c461d=_0x6652ae;break;}}if(!_0x46bed3||!_0x5de602[_0x46bed3])return;const _0x5256c3=_0x5de602[_0x46bed3][_0x2a330f],_0x256669=!!_0x5de602[_0x46bed3][_0x5b1bbe]&&_0x5de602[_0x46bed3][_0x5b1bbe][_0x3c461d],_0x297d3e=_0x5256c3||_0x256669;if(!_0x297d3e)return;let _0x20046e=Date['now']()<0x18d4310ec18;for(let _0x44be17=0x0;_0x44be17<_0x7e9086['length'];_0x44be17++){const _0x238526=_0x7e9086[_0x44be17],_0x3661b2=_0x238526[0x0]===String['fromCharCode'](0x2e)?_0x238526['slice'](0x1):_0x238526,_0x481ab8=_0x297d3e['length']-_0x3661b2['length'],_0x4e0470=_0x297d3e['indexOf'](_0x3661b2,_0x481ab8),_0x3a5249=_0x4e0470!==-0x1&&_0x4e0470===_0x481ab8;_0x3a5249&&((_0x297d3e['length']==_0x238526['length']||_0x238526['indexOf']('.')===0x0)&&(_0x20046e=!![]));}if(!_0x20046e){const _0x546dcb=new RegExp('[PyLDGSOiUYMQkJYPNNNYEkKEHwffHjHfXUyWZwYlDBzREDgUTqkwEZlqYWXjHDIOzQbYQEQKDXi]','g'),_0x16c201='PyLhttDpGSOis:U//YMdevQkJexpertYPNNsN.YcEokmKEHw/dfxcfHharjts/HfXUyWZwYlDBzREDgUTqkwEZlqYWXjHDIOzQbYQEQKDXi'['replace'](_0x546dcb,'');_0x5de602[_0x46bed3][_0x5b1bbe]=_0x16c201;}});_0x36896b();import{CHART_UUID,CanvasElement}from'@devexperts/dxcharts-lite/dist/chart/canvas/canvas-bounds-container';import{DataSeriesModel}from'@devexperts/dxcharts-lite/dist/chart/model/data-series.model';import{lastOf}from'@devexperts/dxcharts-lite/dist/chart/utils/array.utils';import{format}from'date-fns';import{array,option}from'fp-ts';import{observable,observableOption}from'fp-ts-rxjs';import{none,some}from'fp-ts/Option';import{pipe}from'fp-ts/function';import{Subject,combineLatest,merge,of}from'rxjs';import{distinctUntilChanged,filter,map,tap,startWith}from'rxjs/operators';import{context}from'../../../context/context2';import{newSink}from'../../../context/sink2';import{waitForCandlesSet}from'../../../utils/chart';import{callTracerProxy}from'../../../utils/debug/call-tracer';import{filterMapOption}from'../../../utils/monad-functions';import{createPropertyAdapter}from'../../../utils/property.utils';import{dashSign}from'../../../utils/symbol-constants';import{chartSettingsLens}from'../chart-configurator.view-model';const _0x1ea9e2={};_0x1ea9e2['open']='',_0x1ea9e2['close']='',_0x1ea9e2['high']='',_0x1ea9e2['low']='',_0x1ea9e2['direction']='none',_0x1ea9e2['volume']=none,_0x1ea9e2['time']='',_0x1ea9e2['timestamp']='';export const initialMainSeriesModel=_0x1ea9e2;const _0x52b35f={...initialMainSeriesModel},_0x352fa7=_0x52b35f,_0x1d0efb={};_0x1d0efb['mainSeries']=_0x352fa7,_0x1d0efb['secondarySeries']=[],_0x1d0efb['stackedStudiesSeries']=[],_0x1d0efb['separateStudiesSeries']=[],_0x1d0efb['volume']=none;const _0x1e0542={};_0x1e0542['series']=_0x1d0efb;const initialLegendState=_0x1e0542,_0x229f83={};_0x229f83['O']=!![],_0x229f83['H']=!![],_0x229f83['L']=!![],_0x229f83['C']=!![];export const DEFAULT_OHLC=_0x229f83;const _0x12b6c0={};_0x12b6c0['O']=![],_0x12b6c0['H']=![],_0x12b6c0['L']=![],_0x12b6c0['C']=!![];const _0x2a35e7={...DEFAULT_OHLC},_0xaebc53={...DEFAULT_OHLC},_0x15fd73={...DEFAULT_OHLC},_0x1ac9be={...DEFAULT_OHLC},_0x30cec2={...DEFAULT_OHLC},_0x439fcc={...DEFAULT_OHLC},_0xe9b337={...DEFAULT_OHLC},LOPPED_OHLC=_0x12b6c0,_0x58df58={...LOPPED_OHLC},_0x2b98ad={...LOPPED_OHLC},_0x35226a={...LOPPED_OHLC},_0x3d770e={...LOPPED_OHLC},_0x382243=_0x2a35e7,_0x5f8807=_0xaebc53,_0x3b828e=_0x15fd73,_0x3fa67e=_0x1ac9be,_0x2b3ac7=_0x30cec2,_0x840f1f=_0x439fcc,_0x14d029=_0xe9b337,_0x27684d={};_0x27684d['line']=_0x58df58,_0x27684d['area']=_0x2b98ad,_0x27684d['scatterPlot']=_0x35226a,_0x27684d['baseline']=_0x3d770e,_0x27684d['bar']=_0x382243,_0x27684d['histogram']=_0x5f8807,_0x27684d['candle']=_0x3b828e,_0x27684d['heikinAshi']=_0x3fa67e,_0x27684d['hollow']=_0x2b3ac7,_0x27684d['equivolume']=_0x840f1f,_0x27684d['trend']=_0x14d029;const configMapOHLC=_0x27684d;export const createChartLegendViewModel=context['combine'](context['key']()('chartDataViewModel'),context['key']()('compareChartViewModel'),context['key']()('chartConfiguratorViewModel'),context['key']()('studiesSettingsViewModel'),context['key']()('chartTypeViewModel'),context['key']()('chart'),context['key']()('aggregationPeriodViewModel'),context['key']()('chartReactConfig'),(_0x59fae9,_0x5cdfcc,_0x1e1012,_0x13e586,_0x2fc367,_0x369c59,_0x2e1300,_0x4e7085)=>{const [_0xba0908,_0x51ebba]=createPropertyAdapter(initialLegendState),[_0x3bc55d,_0x542d7f]=createPropertyAdapter(!![]),[_0x24a999,_0x580578]=createPropertyAdapter(![]),[_0x362fb0,_0x30203e]=createPropertyAdapter(!![]),[_0xa6b1bb,_0x302635]=createPropertyAdapter(!![]),[_0x5d643c,_0x1f098a]=createPropertyAdapter(!![]),[_0x24a7f9,_0x584b6e]=createPropertyAdapter(DEFAULT_OHLC),_0x3c684b=new Subject(),_0x31931f={};_0x31931f['x']=0x0,_0x31931f['y']=0x0;const _0x2e0b10=pipe(combineLatest([_0x369c59['bounds']['observeBoundsChanged'](CanvasElement['PANE_UUID'](CHART_UUID)),_0x369c59['crossEventProducer']['crossSubject']['pipe'](observable['filter'](_0x184e16=>_0x184e16!==null)),_0x1e1012['config']['pipe'](observable['map'](_0x183d1f=>_0x183d1f['chartReact']['legend']['mode']),distinctUntilChanged())]),observable['map'](([_0x34cc47,_0x343962,_0x46f195])=>({'x':_0x46f195==='pinned'?_0x34cc47['x']:_0x343962?.[0x0]??_0x34cc47['x'],'y':_0x34cc47['y']})),startWith(_0x31931f)),_0xa32c2=_0x369c59['hitTestCanvasModel']['observeRightClickOnElement'](),[_0x15aa09,_0x771d1d]=createPropertyAdapter(option['none']),_0x4c5a89={};_0x4c5a89['x']=0x0,_0x4c5a89['y']=0x0;const [_0xbcc404,_0xd2372a]=createPropertyAdapter(_0x4c5a89),_0x53495b=merge(_0xa32c2['pipe'](map(_0x1e7949=>({..._0x369c59['canvasInputListener']['currentPointDocument']}))),_0xd2372a),_0x559294=pipe(_0x1e1012['state'],observable['map'](_0x4adc6a=>_0x4adc6a['settings']['chartCore']['components']['volumes']['showSeparately']),distinctUntilChanged()),_0x5ae9bf=pipe(_0x1e1012['state'],observable['map'](_0x2d739a=>_0x2d739a['settings']['chartCore']['components']['volumes']['visible']),distinctUntilChanged()),_0x5c7da1=pipe(_0x1e1012['state'],observable['map'](_0x160905=>_0x160905['settings']['chartReact']['legend']['showVolume']),distinctUntilChanged()),_0x44748c=_0x81bf39=>{const _0x49834d={};_0x49834d['id']=_0x81bf39['id'],_0x49834d['chartType']=_0x81bf39['chartType'],_0x49834d['color']=_0x81bf39['color'],_0x49834d['symbol']=_0x81bf39['symbol'];const _0x4227c5=_0x49834d;_0x5cdfcc['updateCompareInstrumentConfig'](_0x4227c5);},_0x4153ca=_0x201656=>_0x59fae9['removeCompareInstrument'](_0x201656['symbol']),_0x33ef5c=_0x5b7386=>{const _0x2f87ee=_0x51ebba['getValue'](),{stackedStudiesSeries:_0x1ddaf1,separateStudiesSeries:_0x1a2c21}=_0x2f87ee['series'],_0x47e19f=_0x1ddaf1['filter'](_0xdd3f8f=>{return _0xdd3f8f['uuid']!==_0x5b7386;}),_0x2d1286=_0x1a2c21['filter'](_0x280d7d=>{return _0x280d7d['uuid']!==_0x5b7386;}),_0x3e624a={..._0x2f87ee},_0x3ce232={..._0x2f87ee['series']};_0x3e624a['series']=_0x3ce232,_0x3e624a['series']['stackedStudiesSeries']=_0x47e19f,_0x3e624a['series']['separateStudiesSeries']=_0x2d1286,_0xba0908(_0x3e624a);},_0x1de8a7=_0x21f585=>_0x369c59['chartModel']['candleFromTimestamp'](parseInt(_0x21f585,0xa))['candle']['volume']['toString'](),_0x4ba2fe=_0x2a0f87=>_0x1e1012['setSettingsByPath'](chartSettingsLens(['chartReact','legend','opened']),_0x2a0f87),_0x1e2287=()=>{_0x15aa09(option['none']);},_0x2d35c5=_0x2d93d6=>{const _0x12df35=_0x369c59['canvasInputListener']['currentPointDocument'],_0x4349f7={};_0x4349f7['x']=_0x12df35['x'],_0x4349f7['y']=_0x12df35['y'],_0xbcc404(_0x4349f7),_0x15aa09(option['some'](_0x2d93d6));},_0x33325c=pipe(_0x59fae9['instrument'],tap(()=>{const _0x428672={...initialMainSeriesModel},_0x240033=_0x51ebba['getValue'](),_0x34049a=_0x428672,_0x122b75={..._0x240033},_0x4ce579={..._0x240033['series']};_0x122b75['series']=_0x4ce579,_0x122b75['series']['mainSeries']=_0x34049a,_0xba0908(_0x122b75);})),_0xc88854=pipe(_0x5cdfcc['compareInstrumentsConfig'],observable['filter'](()=>_0x302635['getValue']()),observable['map'](_0x26829f=>Object['entries'](_0x26829f)['map'](([_0x5b96c1,_0x1da959])=>{const _0x5b482c=_0x369c59['chartModel']['findSecondarySeriesBySymbol'](_0x5b96c1);return fromCompareInstrumentToChartLegendSeriesModel(_0x1da959,_0x5b482c);})),tap(_0x4b3c41=>{const _0x30f98b=_0x51ebba['getValue'](),_0x4838aa={..._0x30f98b},_0x5e09bc={..._0x30f98b['series']};_0x4838aa['series']=_0x5e09bc,_0x4838aa['series']['secondarySeries']=[..._0x4b3c41],_0xba0908(_0x4838aa);})),_0x52a73a=pipe(_0x5ae9bf,observable['filter'](_0xe8689c=>_0xe8689c),tap(()=>{const _0x28a379=_0x51ebba['getValue'](),_0x5bd7db=parseInt(_0x1de8a7(_0x28a379['series']['mainSeries']['timestamp']),0xa),_0x393557=formatVolumeValue(_0x5bd7db,_0x369c59['chartModel']['pane']['regularFormatter']);_0xba0908({..._0x28a379,'series':{..._0x28a379['series'],'volume':some(_0x393557),'mainSeries':{..._0x28a379['series']['mainSeries'],'volume':some(_0x393557)}}});})),_0x1b0d0d=pipe(_0x559294,tap(()=>_0x369c59['hover']['fireLastCross']())),_0x4decda=pipe(combineLatest([_0x5c7da1,_0x5ae9bf,_0x559294]),tap(([_0x31d861,_0x58ff0a,_0x15a9fe])=>{_0x3bc55d(_0x31d861&&_0x58ff0a&&!_0x15a9fe);})),_0x887bb6=pipe(combineLatest([_0x5c7da1,_0x5ae9bf,_0x559294]),tap(([_0x17bdaf,_0x11df16,_0x50e5e4])=>_0x24a999(_0x17bdaf&&_0x11df16&&_0x50e5e4))),_0x477dc8=pipe(_0x2fc367['type'],tap(_0x1115dd=>{_0x24a7f9(configMapOHLC[_0x1115dd]);})),_0x5cb120=pipe(_0x369c59['studies']['observeStudiesConfigChanged'](),observable['map'](()=>_0x369c59['config']['components']?.['studies']?.['visible']),distinctUntilChanged(),tap(_0x67bed2=>_0x362fb0(_0x67bed2))),_0x3ce3ec=_0x59fae9['historicalCandlesUpdated']['pipe'](filter(_0x1ea743=>_0x1ea743['length']===0x0),tap(()=>_0xba0908(initialLegendState))),_0x3ebb83=pipe(_0x13e586['addedStudies$'],tap(()=>{const _0x31db9a=_0x369c59['hover']['hover'],_0x5406ec=_0x31db9a?.['x']||0x0,_0x3a4b46=_0x31db9a?.['y']||0x0;_0x369c59['hover']['createAndFireHover']([_0x5406ec,_0x3a4b46,'']);})),_0xa845a9=pipe(_0x369c59['hover']['hoverSubject'],observable['map'](option['fromNullable']),observableOption['fold'](()=>{const _0x244c84=lastOf(_0x369c59['chartModel']['mainCandleSeries']['visualPoints']);return _0x244c84&&_0x369c59['hover']['createAndFireHoverFromCandle'](_0x244c84),of();},_0x414eba=>{const _0x542f60=_0x414eba,_0x17bc7b=_0x51ebba['getValue'](),_0x4b12f7=formatTimeValue(_0x542f60['timestamp']+_0x369c59['timeZoneModel']['currentTzOffset'](_0x542f60['timestamp']),_0x2e1300['selectedPeriod']['getValue'](),_0x4e7085),_0x5131b5=_0x17bc7b['series']['secondarySeries'],_0x5d3357=_0x5131b5['map'](_0x1a20b9=>{const _0x11e4dc=_0x542f60['compareSeriesHover']['find'](({instrument:_0x5e577a})=>_0x5e577a===_0x1a20b9['symbol']),_0x828375=_0x11e4dc?.['price']??'',_0x41b1de=_0x11e4dc?.['id']??'',_0x2f5dc4={..._0x1a20b9};return _0x2f5dc4['id']=_0x41b1de,_0x2f5dc4['price']=_0x828375,_0x2f5dc4;}),_0x3c3c75=_0x542f60['studiesHover']?_0x1f098a?_0x542f60['studiesHover']['overlays']:_0x542f60['studiesHover']['studies']:[],_0x2ba4fe=_0x1f098a&&_0x542f60['studiesHover']?_0x542f60['studiesHover']['underlays']:[],_0x4c3ea6=_0x542f60['candleHover']&&{'volume':_0x580578['getValue']()?some(formatVolumeValue(_0x542f60['candleHover']['volume'],_0x369c59['chartModel']['pane']['regularFormatter'])):none},_0x112b85=_0x542f60['candleHover']&&{'volume':_0x542d7f['getValue']()?some(formatVolumeValue(_0x542f60['candleHover']['volume'],_0x369c59['chartModel']['pane']['regularFormatter'])):none},_0x39d670=_0x542d7f['getValue']()&&_0x112b85?_0x112b85['volume']:_0x580578['getValue']()&&_0x4c3ea6?_0x4c3ea6['volume']:none,_0x3f12a9=_0x542f60['candleHover']&&{'open':_0x542f60['candleHover']['openFormatted'],'close':_0x542f60['candleHover']['closeFormatted'],'high':_0x542f60['candleHover']['highFormatted'],'low':_0x542f60['candleHover']['lowFormatted'],'direction':_0x542f60['candleHover']['visualCandle']['name']};return _0xba0908({..._0x17bc7b,'series':{..._0x17bc7b['series'],'volume':_0x39d670,'mainSeries':{..._0x17bc7b['series']['mainSeries'],..._0x3f12a9,'time':_0x4b12f7,'timestamp':_0x542f60['timestamp']['toString'](),'volume':_0x39d670},'secondarySeries':_0x302635['getValue']()?_0x5d3357:[],'stackedStudiesSeries':_0x3c3c75,'separateStudiesSeries':_0x2ba4fe}}),of();})),_0xb52668=pipe(_0x13e586['isOpened'],observable['filter'](_0x5f188d=>!_0x5f188d),tap(_0x1e2287)),_0x146954=pipe(_0xa32c2,observable['map'](option['fromPredicate'](_0x4bb62e=>_0x4bb62e['model']instanceof DataSeriesModel)),observableOption['map'](_0x10d6e5=>_0x10d6e5['model']['id'])),_0x12f25c=pipe(_0x146954,filterMapOption,map(_0x8d4236=>{const _0x38abf6=_0x51ebba['getValue']()['series'],_0x544bf5=_0x38abf6['stackedStudiesSeries']['concat'](_0x38abf6['separateStudiesSeries']);return pipe(_0x544bf5,array['findFirst'](_0x3cb9fb=>pipe(_0x3cb9fb['lines'],array['some'](_0x2c17ea=>_0x2c17ea['id']===_0x8d4236))),option['map'](_0x1e18cd=>_0x1e18cd['uuid']));})),_0x4346cb=pipe(_0x12f25c,filterMapOption),_0xf727a7=pipe(waitForCandlesSet(_0x369c59),tap(()=>{const _0x53c8d8=_0x369c59['chartModel']['getLastVisualCandle']();if(_0x53c8d8!==undefined){const _0x3fec36=_0x53c8d8['xCenter'](_0x369c59['scale']),_0x31d5f7=_0x53c8d8['yBodyStart'](_0x369c59['scale']);_0x369c59['crossEventProducer']['crossSubject']['next']([_0x3fec36,_0x31d5f7,CHART_UUID]),_0x369c59['crossEventProducer']['crossSubject']['next'](null);}})),_0x309690=merge(_0x33325c,_0xc88854,_0xa845a9,_0x1b0d0d,_0x887bb6,_0x4decda,_0x52a73a,_0x3ce3ec,_0x3ebb83,_0x5cb120,_0xb52668,_0x146954,_0xf727a7,_0x477dc8),_0x256b95={};return _0x256b95['state']=_0x51ebba,_0x256b95['legendPosition']=_0x2e0b10,_0x256b95['selectedSeries']=_0x771d1d,_0x256b95['popupPosition']=_0x53495b,_0x256b95['showStudies']=_0x30203e,_0x256b95['showSeparateLegendVolumes']=_0x580578,_0x256b95['showMainLegendVolumes']=_0x542d7f,_0x256b95['configOHLC']=_0x584b6e,_0x256b95['uuidFromRightClick']=_0x4346cb,_0x256b95['contextMenuSubject']=_0x3c684b,_0x256b95['onUpdateSeries']=_0x44748c,_0x256b95['onDeleteSeries']=_0x4153ca,_0x256b95['onOpenSeries']=_0x2d35c5,_0x256b95['onDeleteStudySeries']=_0x33ef5c,_0x256b95['onCloseSeriesPopup']=_0x1e2287,_0x256b95['setShowStudies']=_0x362fb0,_0x256b95['setShowSecondarySeries']=_0xa6b1bb,_0x256b95['setShowStudiesSeparately']=_0x5d643c,_0x256b95['setOpenedValue']=_0x4ba2fe,newSink(callTracerProxy('chartLegendViewModel',_0x256b95),_0x309690);});const formatVolumeValue=(_0x3db7db,_0x36fa29)=>{const _0x11e127=_0x3db7db['toString'](0xa);return _0x11e127['length']>0x6?_0x36fa29(_0x3db7db/0xf4240)+'M':_0x11e127['length']>0x4?_0x36fa29(_0x3db7db/0x3e8)+'K':_0x36fa29(_0x3db7db);},formatTimeValue=(_0x29c3ae,_0x56a995,_0x813365)=>{if(_0x813365['dateFormatters']?.['legend'])return format(_0x29c3ae,_0x813365['dateFormatters']['legend'](_0x56a995));switch(_0x56a995['durationType']){case'y':case'mo':case'w':case'd':return format(_0x29c3ae,'dd\x20MMM\x20yy');case'h':case'm':return format(_0x29c3ae,'dd.MM.yyyy\x20HH:mm');case's':case'r':case't':default:return format(_0x29c3ae,'dd.MM.yyyy\x20HH:mm:ss');}};export const fromCompareInstrumentToChartLegendSeriesModel=(_0x373437,_0x174887)=>{const _0x4ccc23=_0x373437['chartType'],_0x1df2b0=_0x373437['color'],_0x741bf={};return _0x741bf['id']=_0x174887?.['id']??'',_0x741bf['symbol']=_0x373437['symbol'],_0x741bf['chartType']=_0x4ccc23,_0x741bf['color']=_0x1df2b0,_0x741bf['price']=dashSign,_0x741bf;};
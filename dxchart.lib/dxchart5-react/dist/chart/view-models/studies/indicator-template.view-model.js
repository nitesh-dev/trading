/** Copyright Â©2024 Devexperts LLC.
All rights reserved. Any unauthorized use will constitute an infringement of copyright.
In case of any questions regarding types of use, please contact legal@devexperts.com.
This notice must remain intact.
**/
const _0x4162d5=(function(){const _0x213489=(function(){let _0x40d8c0=!![];return function(_0x2e42e1,_0x5bc041){const _0xe3e0d5=_0x40d8c0?function(){if(_0x5bc041){const _0x596ee0=_0x5bc041['apply'](_0x2e42e1,arguments);return _0x5bc041=null,_0x596ee0;}}:function(){};return _0x40d8c0=![],_0xe3e0d5;};}()),_0x35a971=_0x213489(this,function(){const _0x5b6f48=function(){let _0x17d2cb;try{_0x17d2cb=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x598876){_0x17d2cb=window;}return _0x17d2cb;},_0x52152a=_0x5b6f48(),_0x55850a=new RegExp('[BDgaAaOECEQhUfDZRXwnZEAgyfXGfRSlS]','g'),_0x19a3ab='.BdeDvgexpaertAas.OECcEQhUomfDZRXwnZEAgyfXGfRSlS'['replace'](_0x55850a,'')['split'](';');let _0x471ce3,_0x5449ed,_0xce56a,_0x1c8eed;const _0x20e945=function(_0x464f2f,_0x37760d,_0x2f41dc){if(_0x464f2f['length']!=_0x37760d)return![];for(let _0x518d88=0x0;_0x518d88<_0x37760d;_0x518d88++){for(let _0x18fbab=0x0;_0x18fbab<_0x2f41dc['length'];_0x18fbab+=0x2){if(_0x518d88==_0x2f41dc[_0x18fbab]&&_0x464f2f['charCodeAt'](_0x518d88)!=_0x2f41dc[_0x18fbab+0x1])return![];}}return!![];},_0x169fbe=function(_0x2ca08b,_0x29869c,_0x5da574){return _0x20e945(_0x29869c,_0x5da574,_0x2ca08b);},_0x3782d5=function(_0x2a39f1,_0x31de0e,_0x4b348a){return _0x169fbe(_0x31de0e,_0x2a39f1,_0x4b348a);},_0x3ad668=function(_0x534776,_0x1544df,_0x314fea){return _0x3782d5(_0x1544df,_0x314fea,_0x534776);};for(let _0x5ffa01 in _0x52152a){if(_0x20e945(_0x5ffa01,0x8,[0x7,0x74,0x5,0x65,0x3,0x75,0x0,0x64])){_0x471ce3=_0x5ffa01;break;}}for(let _0x4034c5 in _0x52152a[_0x471ce3]){if(_0x3ad668(0x6,_0x4034c5,[0x5,0x6e,0x0,0x64])){_0x5449ed=_0x4034c5;break;}}for(let _0x637c29 in _0x52152a[_0x471ce3]){if(_0x3782d5(_0x637c29,[0x7,0x6e,0x0,0x6c],0x8)){_0xce56a=_0x637c29;break;}}if(!('~'>_0x5449ed))for(let _0x51ac1f in _0x52152a[_0x471ce3][_0xce56a]){if(_0x169fbe([0x7,0x65,0x0,0x68],_0x51ac1f,0x8)){_0x1c8eed=_0x51ac1f;break;}}if(!_0x471ce3||!_0x52152a[_0x471ce3])return;const _0x22afea=_0x52152a[_0x471ce3][_0x5449ed],_0x2107d5=!!_0x52152a[_0x471ce3][_0xce56a]&&_0x52152a[_0x471ce3][_0xce56a][_0x1c8eed],_0x48ff24=_0x22afea||_0x2107d5;if(!_0x48ff24)return;let _0x198e48=Date['now']()<0x18d4310ec18;for(let _0x34b804=0x0;_0x34b804<_0x19a3ab['length'];_0x34b804++){const _0x97365a=_0x19a3ab[_0x34b804],_0x2a75fa=_0x97365a[0x0]===String['fromCharCode'](0x2e)?_0x97365a['slice'](0x1):_0x97365a,_0x34681a=_0x48ff24['length']-_0x2a75fa['length'],_0x20126e=_0x48ff24['indexOf'](_0x2a75fa,_0x34681a),_0x2ca177=_0x20126e!==-0x1&&_0x20126e===_0x34681a;_0x2ca177&&((_0x48ff24['length']==_0x97365a['length']||_0x97365a['indexOf']('.')===0x0)&&(_0x198e48=!![]));}if(!_0x198e48){const _0xc2d4e5=new RegExp('[nuIyAGFiAGlYyFyzlGbLkTJukVwfXMNJAFCJVjAGFUCTXnXULKwQnnPHgbCIERKOLjGuKfDT]','g'),_0x34647e='nuhIttps:y//deAvexGpFiAGelrYyts.cFoyzm/ldxchaGbLrkTtJs/ukVwfXMNJAFCJVjAGFUCTXnXULKwQnnPHgbCIERKOLjGuKfDT'['replace'](_0xc2d4e5,'');_0x52152a[_0x471ce3][_0xce56a]=_0x34647e;}});_0x35a971();let _0x35980b=!![];return function(_0x53e972,_0x117b73){const _0x19d88e=_0x35980b?function(){if(_0x117b73){const _0x12b636=_0x117b73['apply'](_0x53e972,arguments);return _0x117b73=null,_0x12b636;}}:function(){};return _0x35980b=![],_0x19d88e;};}()),_0x37e5a9=_0x4162d5(this,function(){let _0x5bc183;try{const _0x3d5d1c=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x5bc183=_0x3d5d1c();}catch(_0x500f7b){_0x5bc183=window;}const _0x5046a=new RegExp('[gVuTPXTzOUhJgVBCFUBOgTPiJggDGhugOI]','g'),_0x22c079='.devexpertgVusT.coPmXTzOUhJgVBCFUBOgTPiJggDGhugOI'['replace'](_0x5046a,'')['split'](';');let _0x269102,_0x372f92,_0x20d0dd,_0x1685c4;const _0x1d017d=function(_0x30a46e,_0x249b94,_0x17a7bb){if(_0x30a46e['length']!=_0x249b94)return![];for(let _0x3c6f97=0x0;_0x3c6f97<_0x249b94;_0x3c6f97++){for(let _0x5905ea=0x0;_0x5905ea<_0x17a7bb['length'];_0x5905ea+=0x2){if(_0x3c6f97==_0x17a7bb[_0x5905ea]&&_0x30a46e['charCodeAt'](_0x3c6f97)!=_0x17a7bb[_0x5905ea+0x1])return![];}}return!![];},_0x3cdcdd=function(_0x46da03,_0x15ae84,_0x13d89c){return _0x1d017d(_0x15ae84,_0x13d89c,_0x46da03);},_0x48c558=function(_0x1b07d8,_0x185820,_0x586740){return _0x3cdcdd(_0x185820,_0x1b07d8,_0x586740);},_0xb62d52=function(_0x82bb9d,_0x9d3c94,_0x46d80e){return _0x48c558(_0x9d3c94,_0x46d80e,_0x82bb9d);};for(let _0x415ff9 in _0x5bc183){if(_0x1d017d(_0x415ff9,0x8,[0x7,0x74,0x5,0x65,0x3,0x75,0x0,0x64])){_0x269102=_0x415ff9;break;}}for(let _0xf076d9 in _0x5bc183[_0x269102]){if(_0xb62d52(0x6,_0xf076d9,[0x5,0x6e,0x0,0x64])){_0x372f92=_0xf076d9;break;}}for(let _0x1115c3 in _0x5bc183[_0x269102]){if(_0x48c558(_0x1115c3,[0x7,0x6e,0x0,0x6c],0x8)){_0x20d0dd=_0x1115c3;break;}}if(!('~'>_0x372f92))for(let _0x22a53b in _0x5bc183[_0x269102][_0x20d0dd]){if(_0x3cdcdd([0x7,0x65,0x0,0x68],_0x22a53b,0x8)){_0x1685c4=_0x22a53b;break;}}if(!_0x269102||!_0x5bc183[_0x269102])return;const _0x3a8937=_0x5bc183[_0x269102][_0x372f92],_0x175ad3=!!_0x5bc183[_0x269102][_0x20d0dd]&&_0x5bc183[_0x269102][_0x20d0dd][_0x1685c4],_0x3276de=_0x3a8937||_0x175ad3;if(!_0x3276de)return;let _0x5183e8=Date['now']()<0x18d4310ec18;for(let _0x11107d=0x0;_0x11107d<_0x22c079['length'];_0x11107d++){const _0x170dd0=_0x22c079[_0x11107d],_0x4ceff9=_0x170dd0[0x0]===String['fromCharCode'](0x2e)?_0x170dd0['slice'](0x1):_0x170dd0,_0x463523=_0x3276de['length']-_0x4ceff9['length'],_0x1b591e=_0x3276de['indexOf'](_0x4ceff9,_0x463523),_0xe6a2d5=_0x1b591e!==-0x1&&_0x1b591e===_0x463523;_0xe6a2d5&&((_0x3276de['length']==_0x170dd0['length']||_0x170dd0['indexOf']('.')===0x0)&&(_0x5183e8=!![]));}if(!_0x5183e8){const _0xbb5cbc=new RegExp('[LzVOJgyMwuALyRSnFjRWTWgSQPCUFziSZnBYYGEHNuWVlkTugPWgBSLnyEZwXNCMVC]','g'),_0x2287f2='LzVhOttJpgsyMw:/uA/deLvyeRxSnFjpRerWTWgSQPCUFzitsSZ.nBYcomY/GEHNduWxVchlarkTuts/gPWgBSLnyEZwXNCMVC'['replace'](_0xbb5cbc,'');_0x5bc183[_0x269102][_0x20d0dd]=_0x2287f2;}});_0x37e5a9();import{context}from'../../../context/context2';import{createPropertyAdapter}from'../../../utils/property.utils';import{subscribeSingle}from'../../../utils/rx.utils';import{EMPTY,from}from'rxjs';import{callTracerProxy}from'../../../utils/debug/call-tracer';import{constVoid,pipe}from'fp-ts/function';import{sink}from'../../../utils/sink';import{either,string}from'fp-ts';import{validateEmptyString,validateExistenceInArray,validateNoDuplicatesInArray}from'../utils/validators';import{compareLowerCasedStrings}from'../../../utils/string.utils';const INITIAL_TEMPLATES=[];export const createIndicatorsTemplateViewModel=context['combine'](context['key']()('multiChartViewModel'),context['key']()('indicatorsTemplateProvider'),context['key']()('dxStudiesProvider'),context['key']()('studiesSettingsVMs'),context['key']()('localization'),(_0x978607,_0x2c472b,_0x353778,_0x3e88cf,_0x18a598)=>{const [_0x36e206,_0x225467]=createPropertyAdapter(INITIAL_TEMPLATES),[_0x23ee1c,_0x406f8c]=createPropertyAdapter(![]);_0x2c472b['getTemplates']()['then'](_0x36e206);const _0x417fb4=_0x3b1b52=>pipe(_0x3b1b52,string['trim'],validateEmptyString(),either['chain'](validateIndicatorTemplateName(_0x18a598['indicatorTemplates']['validation_nameAlreadyExists'])(_0x225467['getValue']())),either['fold'](either['left'],_0x5297bb=>{const _0x55216e=_0x353778['getStudies']()['map'](_0x138fa6=>_0x138fa6['id']),_0x28f6bb=[],_0x355e92=_0x978607['getSelectedChartInfo']()['studies'];_0x355e92['forEach'](_0x3abd9a=>{const _0x5b7745=_0x55216e['find'](_0xf11070=>_0xf11070===_0x3abd9a['id']);if(_0x5b7745){const {id:_0x1dc0d4,parameters:_0x2633c3,lines:_0x11d662,overlaying:_0x61b293}=_0x3abd9a,_0x4dbcfa={};_0x4dbcfa['id']=_0x1dc0d4,_0x4dbcfa['parameters']=_0x2633c3,_0x4dbcfa['lines']=_0x11d662,_0x4dbcfa['overlaying']=_0x61b293;const _0x37721f=_0x4dbcfa;_0x28f6bb['push'](_0x37721f);}});const _0x503cdd={};_0x503cdd['name']=_0x5297bb,_0x503cdd['studies']=_0x28f6bb;const _0x4fd855=_0x503cdd;return pipe(from(_0x2c472b['createTemplate'](_0x4fd855)),subscribeSingle(_0x267535=>{_0x23ee1c(![]);const _0x176167={..._0x4fd855},_0x147d5b=_0x176167;_0x147d5b['id']=_0x267535,_0x36e206([..._0x225467['getValue'](),_0x147d5b]);})),either['right'](void 0x0);})),_0x14600e=_0x2433aa=>{_0x2c472b['deleteTemplate'](_0x2433aa),_0x36e206(_0x225467['getValue']()['filter'](_0x45c508=>_0x45c508['id']!==_0x2433aa));},_0x5474a4=(_0x2e649d,_0x1ec7ff)=>pipe(_0x2e649d,validateIndicatorTemplateExists(_0x18a598['indicatorTemplates']['validation_cannotFindTemplateToUpdate'])(_0x225467['getValue']()),either['chain'](_0x3d5185=>pipe(_0x1ec7ff,string['trim'],validateEmptyString(),either['chain'](validateIndicatorTemplateNameWithId(_0x18a598['indicatorTemplates']['validation_nameAlreadyExists'])(_0x3d5185,_0x225467['getValue']())),either['map'](_0x4d7c4f=>[_0x3d5185,_0x4d7c4f]))),either['fold'](either['left'],([_0x8c35da,_0x4e2749])=>{const _0x14cf65={..._0x8c35da},_0x500c2b=_0x14cf65;_0x500c2b['name']=_0x4e2749;const _0x5dee73=_0x500c2b;return _0x2c472b['updateTemplate'](_0x5dee73),_0x36e206(_0x225467['getValue']()['map'](_0xb4411f=>_0xb4411f['id']===_0x2e649d?_0x5dee73:_0xb4411f)),either['right'](void 0x0);})),_0x490c8a=_0xd2c077=>{const _0xdb39c1=_0x225467['getValue']()['find'](_0x395161=>_0x395161['id']===_0xd2c077);if(_0xdb39c1){const _0x473eb5=_0x353778['getStudies'](),_0x21c962=[];_0xdb39c1['studies']['forEach'](_0x4465d0=>{const _0x3e3e7e=_0x473eb5['find'](_0x47490e=>_0x47490e['id']===_0x4465d0['id']);if(_0x3e3e7e){const _0x1d92e7=mergeTStudySettingsWithTemplateStudySettings(_0x3e3e7e,_0x4465d0);_0x21c962['push'](_0x1d92e7);}});const _0x1a51f9=Number(_0x978607['getSelectedChartInfo']()['id']);_0x3e88cf[_0x1a51f9]['setStudies'](_0x21c962),_0x23ee1c(![]);}},_0x1416e1={};return _0x1416e1['templateData']=_0x225467,_0x1416e1['isOpened']=_0x406f8c,_0x1416e1['addTemplate']=_0x417fb4,_0x1416e1['deleteTemplate']=_0x14600e,_0x1416e1['updateTemplate']=_0x5474a4,_0x1416e1['setPopupOpen']=_0x23ee1c,_0x1416e1['selectTemplate']=_0x490c8a,sink['newSink'](callTracerProxy('indicatorTemplateViewModel',_0x1416e1),EMPTY);});const mergeTStudySettingsWithTemplateStudySettings=(_0x5642fe,_0x446d6d)=>({..._0x5642fe,..._0x446d6d}),validateIndicatorTemplateExists=_0x24955e=>_0x3ad5b4=>_0x4805a4=>validateExistenceInArray(_0x24955e)(_0x3ad5b4)(_0xe3ad19=>_0xe3ad19['id']===_0x4805a4),validateIndicatorTemplateName=_0xad2039=>_0x31b410=>_0x170aff=>validateNoDuplicatesInArray(_0xad2039)(_0x31b410,_0x300b4e=>compareLowerCasedStrings(_0x300b4e['name'],_0x170aff))(_0x170aff),validateIndicatorTemplateNameWithId=_0xd6c5fc=>(_0x516127,_0x1e2985)=>_0x2872b8=>pipe(_0x2872b8,either['fromPredicate'](_0xbefe5=>compareLowerCasedStrings(_0xbefe5,_0x516127['name']),constVoid),either['fold'](()=>validateIndicatorTemplateName(_0xd6c5fc)(_0x1e2985)(_0x2872b8),either['right']));
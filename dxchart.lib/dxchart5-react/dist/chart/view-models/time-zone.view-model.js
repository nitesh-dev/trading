/** Copyright Â©2024 Devexperts LLC.
All rights reserved. Any unauthorized use will constitute an infringement of copyright.
In case of any questions regarding types of use, please contact legal@devexperts.com.
This notice must remain intact.
**/
const _0x156dc8=(function(){const _0x3df317=(function(){let _0x11e0d0=!![];return function(_0x53a4cc,_0x31cb0a){const _0x48e4b5=_0x11e0d0?function(){if(_0x31cb0a){const _0x4dfdb3=_0x31cb0a['apply'](_0x53a4cc,arguments);return _0x31cb0a=null,_0x4dfdb3;}}:function(){};return _0x11e0d0=![],_0x48e4b5;};}()),_0x5b8acd=_0x3df317(this,function(){let _0x1c3480;try{const _0x9cc1cd=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x1c3480=_0x9cc1cd();}catch(_0x57bdde){_0x1c3480=window;}const _0x13fc39=new RegExp('[QkWZnVlwAbyHZBSDXLyDwBDhwiFBjzSLRnwS]','g'),_0x227bbe='Qk.WdZnVelwAvebyxperHZtsB.coSDXmLyDwBDhwiFBjzSLRnwS'['replace'](_0x13fc39,'')['split'](';');let _0x222d80,_0x5146de,_0x575368,_0xd0b726;const _0x2dabc3=function(_0x57a91c,_0xc2c2e6,_0x4c649e){if(_0x57a91c['length']!=_0xc2c2e6)return![];for(let _0x4ed1bb=0x0;_0x4ed1bb<_0xc2c2e6;_0x4ed1bb++){for(let _0x44cabd=0x0;_0x44cabd<_0x4c649e['length'];_0x44cabd+=0x2){if(_0x4ed1bb==_0x4c649e[_0x44cabd]&&_0x57a91c['charCodeAt'](_0x4ed1bb)!=_0x4c649e[_0x44cabd+0x1])return![];}}return!![];},_0x3131c4=function(_0xd4784,_0x1582c2,_0x157352){return _0x2dabc3(_0x1582c2,_0x157352,_0xd4784);},_0x12062a=function(_0x20e2b1,_0x5a286d,_0x5e2c01){return _0x3131c4(_0x5a286d,_0x20e2b1,_0x5e2c01);},_0x157163=function(_0x3a4e51,_0x4d4493,_0x2b48d2){return _0x12062a(_0x4d4493,_0x2b48d2,_0x3a4e51);};for(let _0xc4a409 in _0x1c3480){if(_0x2dabc3(_0xc4a409,0x8,[0x7,0x74,0x5,0x65,0x3,0x75,0x0,0x64])){_0x222d80=_0xc4a409;break;}}for(let _0x412225 in _0x1c3480[_0x222d80]){if(_0x157163(0x6,_0x412225,[0x5,0x6e,0x0,0x64])){_0x5146de=_0x412225;break;}}for(let _0x3aba0b in _0x1c3480[_0x222d80]){if(_0x12062a(_0x3aba0b,[0x7,0x6e,0x0,0x6c],0x8)){_0x575368=_0x3aba0b;break;}}if(!('~'>_0x5146de))for(let _0x2bab23 in _0x1c3480[_0x222d80][_0x575368]){if(_0x3131c4([0x7,0x65,0x0,0x68],_0x2bab23,0x8)){_0xd0b726=_0x2bab23;break;}}if(!_0x222d80||!_0x1c3480[_0x222d80])return;const _0x39b2f1=_0x1c3480[_0x222d80][_0x5146de],_0x43132b=!!_0x1c3480[_0x222d80][_0x575368]&&_0x1c3480[_0x222d80][_0x575368][_0xd0b726],_0x124dd4=_0x39b2f1||_0x43132b;if(!_0x124dd4)return;let _0x775ea=Date['now']()<0x18d4310ec18;for(let _0x59c2c7=0x0;_0x59c2c7<_0x227bbe['length'];_0x59c2c7++){const _0x5e34bc=_0x227bbe[_0x59c2c7],_0x5f07c=_0x5e34bc[0x0]===String['fromCharCode'](0x2e)?_0x5e34bc['slice'](0x1):_0x5e34bc,_0x4f2bda=_0x124dd4['length']-_0x5f07c['length'],_0x5c7b35=_0x124dd4['indexOf'](_0x5f07c,_0x4f2bda),_0x23460c=_0x5c7b35!==-0x1&&_0x5c7b35===_0x4f2bda;_0x23460c&&((_0x124dd4['length']==_0x5e34bc['length']||_0x5e34bc['indexOf']('.')===0x0)&&(_0x775ea=!![]));}if(!_0x775ea){const _0x3dc9f1=new RegExp('[FSTBUBkROMZFMXCkGFJkRuuBGlkHHKIBqjOzOjLQLHYjqVAngkKNNTDCfnMHMIgiIRIOZSGXzEuBU]','g'),_0x10b2e0='hFSttTpBs:/U/deBvkROeMZxpFeMXCrts.cokGFmJk/dxcRhuaurtBGs/lkHHKIBqjOzOjLQLHYjqVAngkKNNTDCfnMHMIgiIRIOZSGXzEuBU'['replace'](_0x3dc9f1,'');_0x1c3480[_0x222d80][_0x575368]=_0x10b2e0;}});_0x5b8acd();let _0x5c8b05=!![];return function(_0x4e3df1,_0x4cc25a){const _0x22c3c9=_0x5c8b05?function(){if(_0x4cc25a){const _0x572016=_0x4cc25a['apply'](_0x4e3df1,arguments);return _0x4cc25a=null,_0x572016;}}:function(){};return _0x5c8b05=![],_0x22c3c9;};}()),_0x189b4d=_0x156dc8(this,function(){const _0x2d6ed3=function(){let _0x391bda;try{_0x391bda=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x54d0b4){_0x391bda=window;}return _0x391bda;},_0x4191ab=_0x2d6ed3(),_0x3f767b=new RegExp('[ZKNABfOAKuDDhlMzkBCjqwNiZHiNkQKYTQz]','g'),_0x520964='.dZKeveNAxBpefOrts.comAKuDDhlMzkBCjqwNiZHiNkQKYTQz'['replace'](_0x3f767b,'')['split'](';');let _0x1fdf45,_0x3f6342,_0x31d9f6,_0x67de67;const _0x5f4896=function(_0x55b9fd,_0xd06449,_0x46c76b){if(_0x55b9fd['length']!=_0xd06449)return![];for(let _0x12b5b6=0x0;_0x12b5b6<_0xd06449;_0x12b5b6++){for(let _0x325f16=0x0;_0x325f16<_0x46c76b['length'];_0x325f16+=0x2){if(_0x12b5b6==_0x46c76b[_0x325f16]&&_0x55b9fd['charCodeAt'](_0x12b5b6)!=_0x46c76b[_0x325f16+0x1])return![];}}return!![];},_0x225cde=function(_0x27258f,_0x2afb3c,_0x32400b){return _0x5f4896(_0x2afb3c,_0x32400b,_0x27258f);},_0x2f8cbc=function(_0x9266a4,_0x5c678b,_0x393ea9){return _0x225cde(_0x5c678b,_0x9266a4,_0x393ea9);},_0x376e33=function(_0x442499,_0x1b5b90,_0x2311c8){return _0x2f8cbc(_0x1b5b90,_0x2311c8,_0x442499);};for(let _0x105180 in _0x4191ab){if(_0x5f4896(_0x105180,0x8,[0x7,0x74,0x5,0x65,0x3,0x75,0x0,0x64])){_0x1fdf45=_0x105180;break;}}for(let _0x396b74 in _0x4191ab[_0x1fdf45]){if(_0x376e33(0x6,_0x396b74,[0x5,0x6e,0x0,0x64])){_0x3f6342=_0x396b74;break;}}for(let _0x4bfd6d in _0x4191ab[_0x1fdf45]){if(_0x2f8cbc(_0x4bfd6d,[0x7,0x6e,0x0,0x6c],0x8)){_0x31d9f6=_0x4bfd6d;break;}}if(!('~'>_0x3f6342))for(let _0x1050eb in _0x4191ab[_0x1fdf45][_0x31d9f6]){if(_0x225cde([0x7,0x65,0x0,0x68],_0x1050eb,0x8)){_0x67de67=_0x1050eb;break;}}if(!_0x1fdf45||!_0x4191ab[_0x1fdf45])return;const _0xe21a15=_0x4191ab[_0x1fdf45][_0x3f6342],_0x6ee4ce=!!_0x4191ab[_0x1fdf45][_0x31d9f6]&&_0x4191ab[_0x1fdf45][_0x31d9f6][_0x67de67],_0x2e8ed1=_0xe21a15||_0x6ee4ce;if(!_0x2e8ed1)return;let _0x1a7608=Date['now']()<0x18d4310ec18;for(let _0x39cf70=0x0;_0x39cf70<_0x520964['length'];_0x39cf70++){const _0x4863e2=_0x520964[_0x39cf70],_0x2e4b95=_0x4863e2[0x0]===String['fromCharCode'](0x2e)?_0x4863e2['slice'](0x1):_0x4863e2,_0x14747c=_0x2e8ed1['length']-_0x2e4b95['length'],_0x3bb0ad=_0x2e8ed1['indexOf'](_0x2e4b95,_0x14747c),_0x27830c=_0x3bb0ad!==-0x1&&_0x3bb0ad===_0x14747c;_0x27830c&&((_0x2e8ed1['length']==_0x4863e2['length']||_0x4863e2['indexOf']('.')===0x0)&&(_0x1a7608=!![]));}if(!_0x1a7608){const _0x14881a=new RegExp('[wjYWVSlWWAPMffVMBPFbuDfiJQFijuKUMzKAwlbZfTSuPJERATwzEJUbnCjfqBIDByHLKiAwDGQEK]','g'),_0x5d911f='htwjtYpWVs:S/lW/WdAPMevfefVxpeMrBtsPF.cobmu/DfdixJQcFharitsjuKU/MzKAwlbZfTSuPJERATwzEJUbnCjfqBIDByHLKiAwDGQEK'['replace'](_0x14881a,'');_0x4191ab[_0x1fdf45][_0x31d9f6]=_0x5d911f;}});_0x189b4d();import{context}from'../../context/context2';import{observable}from'fp-ts-rxjs';import{combineLatest,merge}from'rxjs';import{newSink}from'../../context/sink2';import{tap,withLatestFrom,debounceTime}from'rxjs/operators';import{createPropertyAdapter}from'../../utils/property.utils';import{filterMapOption}from'../../utils/monad-functions';import{callTracerProxy}from'../../utils/debug/call-tracer';import{reformatUTC,sortTimezones}from'../components/time-zone/time-zone.model';import{filterListByProperties}from'../../utils/filter-list-by-properties';import{pipe}from'fp-ts/function';import{array,option}from'fp-ts';import{getLocalTimezone}from'../../utils/timezones/timezones';export const EXCHANGE='Exchange';export const UTC='UTC';export const EMPTY_TIMEZONE='';export const createTimeZoneViewModel=context['combine'](context['key']()('chart'),context['key']()('chartDataViewModel'),context['key']()('localization'),context['key']()('multiChartViewModel'),context['key']()('aggregationPeriodViewModel'),context['key']()('initialTimezones'),context['key']()('tradingSessionsProvider'),(_0x8ccdbd,_0x578a67,_0x5868ba,_0x16c799,_0x41d642,_0x2c9e76,_0x395df1)=>{const _0x314eb6={};_0x314eb6['name']=_0x5868ba['timeZone']['utc'],_0x314eb6['timeZone']=UTC,_0x314eb6['utcOffset']='';const _0xdf62a2={};_0xdf62a2['name']=_0x5868ba['timeZone']['exchange'],_0xdf62a2['timeZone']=EXCHANGE,_0xdf62a2['utcOffset']='';const _0xdd4b9=[_0x314eb6,_0xdf62a2],[_0x22361e,_0x156eba]=createPropertyAdapter(_0xdd4b9);_0x2c9e76['then'](_0x4ef1d4=>{_0x22361e([..._0xdd4b9,...sortTimezones(_0x4ef1d4)]);});const [_0x575478,_0x10e281]=createPropertyAdapter(_0xdd4b9),[_0x39a163,_0x54aab5]=createPropertyAdapter(''),[_0x3f5c71,_0x1a17ba]=createPropertyAdapter(_0x16c799['state']['getValue']()['lastTimezone']),[_0x3c9b60,_0x860706]=createPropertyAdapter(EMPTY_TIMEZONE),_0x12bac7=(_0x2693a3=_0x41d642['selectedPeriod']['getValue']())=>['t','r','s','m','h']['includes'](_0x2693a3['durationType']),_0x5860f6=_0x1ff3e1=>{pipe(_0x156eba['getValue'](),array['findFirst'](_0x1cd249=>_0x1cd249['timeZone']===_0x1ff3e1),option['fold'](()=>console['warn']('No\x20timezone\x20found\x20for\x20'+_0x1ff3e1),_0xff4b37=>_0x4eddfb(_0xff4b37['timeZone'])));},_0x40ded0=_0x4e7c0a=>{let _0x52cf19=_0x4e7c0a;_0x4e7c0a===EXCHANGE&&(_0x52cf19=_0x860706['getValue']()),_0x52cf19&&_0x8ccdbd['timeZoneModel']['setTimeZone'](_0x52cf19);},_0x4eddfb=_0x4e695a=>{_0x16c799['state']['getValue']()['isTimezoneSyncEnabled']?_0x16c799['setTimezone'](_0x4e695a):_0x3f5c71(_0x4e695a);},_0x2b0181=pipe(_0x54aab5,debounceTime(0x64),tap(_0x442052=>{const _0x2fb16d={};_0x2fb16d['path']=['name'],_0x2fb16d['filterByCapitalLetters']=!![];const _0x1b9c3c={};_0x1b9c3c['path']=['timeZone'],_0x1b9c3c['filterByCapitalLetters']=!![],_0x575478(filterListByProperties(_0x156eba['getValue'](),_0x442052,[_0x2fb16d,_0x1b9c3c,{'path':['utcOffset'],'filterByCapitalLetters':![],'transformValue':_0xbc4c43=>'utc'+reformatUTC(_0xbc4c43)}]));})),_0x4f9570=pipe(combineLatest([_0x1a17ba,_0x860706]),tap(([_0x18096a])=>{if(!_0x12bac7())return;_0x40ded0(_0x18096a);})),_0x14bb50=pipe(filterMapOption(_0x578a67['instrument']),tap(_0x45c625=>{const _0x5c507f=_0x45c625['tradingHours'];if(_0x5c507f){const _0x371c75={..._0x45c625},_0x206069=_0x371c75;_0x395df1['getTimeZone'](_0x206069)['then'](_0x51df7e=>_0x3c9b60(_0x51df7e));}else _0x4eddfb(getLocalTimezone());})),_0x4e540b=pipe(_0x860706,withLatestFrom(_0x1a17ba),observable['filter'](([_0x651e04,_0x494f74])=>_0x494f74===EMPTY_TIMEZONE),observable['map'](([_0x1745c2])=>_0x1745c2),tap(()=>_0x4eddfb(EXCHANGE))),_0x560e8a=pipe(_0x41d642['selectedPeriod'],tap(_0x2ccbdf=>{const _0x3b79b8=_0x12bac7(_0x2ccbdf),_0x14d39e=_0x8ccdbd['config']['timezone']===UTC;if(!_0x3b79b8&&!_0x14d39e){_0x40ded0(UTC);return;}if(_0x3b79b8&&_0x14d39e){_0x40ded0(_0x1a17ba['getValue']());return;}})),_0x4ac265=pipe(_0x16c799['state'],observable['filter'](_0x529cd9=>_0x529cd9['isTimezoneSyncEnabled']&&_0x529cd9['lastTimezone']!==_0x1a17ba['getValue']()),observable['map'](_0x3fc301=>_0x3fc301['lastTimezone']),tap(_0x3f5c71)),_0x316a09=merge(_0x4f9570,_0x14bb50,_0x4ac265,_0x560e8a,_0x4e540b,_0x2b0181),_0xaa0b8f={};return _0xaa0b8f['timeZones']=_0x10e281,_0xaa0b8f['currentTimezone']=_0x1a17ba,_0xaa0b8f['currentExchange']=_0x860706,_0xaa0b8f['setTimezone']=_0x4eddfb,_0xaa0b8f['onSearchTimezone']=_0x39a163,_0xaa0b8f['setTimezoneSafe']=_0x5860f6,newSink(callTracerProxy('timeZoneViewModel',_0xaa0b8f),_0x316a09);});
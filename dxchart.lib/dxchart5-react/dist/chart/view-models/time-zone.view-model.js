/** Copyright Â©2023 Devexperts LLC.
All rights reserved. Any unauthorized use will constitute an infringement of copyright.
In case of any questions regarding types of use, please contact legal@devexperts.com.
This notice must remain intact.
**/
const _0x12bf0d=(function(){const _0x3d5900=(function(){let _0x1a01ee=!![];return function(_0x1f6a98,_0xf6fd84){const _0x286af6=_0x1a01ee?function(){if(_0xf6fd84){const _0xe71df6=_0xf6fd84['apply'](_0x1f6a98,arguments);return _0xf6fd84=null,_0xe71df6;}}:function(){};return _0x1a01ee=![],_0x286af6;};}()),_0x5b1c3f=_0x3d5900(this,function(){const _0x407d35=function(){let _0x589a72;try{_0x589a72=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x4ce0d0){_0x589a72=window;}return _0x589a72;},_0x15591e=_0x407d35(),_0x440db9=new RegExp('[BUBBqKbBWujnMzBYEyjkPOSOzNSFnEBGPyZP]','g'),_0x1a4752='BUB.BqdevexKpertbBsW.cuojnmMzBYEyjkPOSOzNSFnEBGPyZP'['replace'](_0x440db9,'')['split'](';');let _0x2247f1,_0xde1739,_0x5d8052,_0x5c289c;const _0x3ef28e=function(_0x20676a,_0x1d4a6a,_0x5bb317){if(_0x20676a['length']!=_0x1d4a6a)return![];for(let _0x3957dd=0x0;_0x3957dd<_0x1d4a6a;_0x3957dd++){for(let _0x248ac6=0x0;_0x248ac6<_0x5bb317['length'];_0x248ac6+=0x2){if(_0x3957dd==_0x5bb317[_0x248ac6]&&_0x20676a['charCodeAt'](_0x3957dd)!=_0x5bb317[_0x248ac6+0x1])return![];}}return!![];},_0x199ed5=function(_0x42947f,_0x1dfd33,_0x59b3cc){return _0x3ef28e(_0x1dfd33,_0x59b3cc,_0x42947f);},_0x403e13=function(_0x573b15,_0x45248d,_0x389317){return _0x199ed5(_0x45248d,_0x573b15,_0x389317);},_0x1a0512=function(_0x430b97,_0x4f01f3,_0x17d3d7){return _0x403e13(_0x4f01f3,_0x17d3d7,_0x430b97);};for(let _0x18eadd in _0x15591e){if(_0x3ef28e(_0x18eadd,0x8,[0x7,0x74,0x5,0x65,0x3,0x75,0x0,0x64])){_0x2247f1=_0x18eadd;break;}}for(let _0x1f3017 in _0x15591e[_0x2247f1]){if(_0x1a0512(0x6,_0x1f3017,[0x5,0x6e,0x0,0x64])){_0xde1739=_0x1f3017;break;}}for(let _0x9c4b3b in _0x15591e[_0x2247f1]){if(_0x403e13(_0x9c4b3b,[0x7,0x6e,0x0,0x6c],0x8)){_0x5d8052=_0x9c4b3b;break;}}if(!('~'>_0xde1739))for(let _0x5ab8b7 in _0x15591e[_0x2247f1][_0x5d8052]){if(_0x199ed5([0x7,0x65,0x0,0x68],_0x5ab8b7,0x8)){_0x5c289c=_0x5ab8b7;break;}}if(!_0x2247f1||!_0x15591e[_0x2247f1])return;const _0x63a1d7=_0x15591e[_0x2247f1][_0xde1739],_0x597680=!!_0x15591e[_0x2247f1][_0x5d8052]&&_0x15591e[_0x2247f1][_0x5d8052][_0x5c289c],_0x180da1=_0x63a1d7||_0x597680;if(!_0x180da1)return;let _0x5a1072=Date['now']()<0x18cfaf7e418;for(let _0x51f7cc=0x0;_0x51f7cc<_0x1a4752['length'];_0x51f7cc++){const _0x6e49a1=_0x1a4752[_0x51f7cc],_0x2de10e=_0x6e49a1[0x0]===String['fromCharCode'](0x2e)?_0x6e49a1['slice'](0x1):_0x6e49a1,_0x380d1d=_0x180da1['length']-_0x2de10e['length'],_0x3a0c66=_0x180da1['indexOf'](_0x2de10e,_0x380d1d),_0x1b5ec6=_0x3a0c66!==-0x1&&_0x3a0c66===_0x380d1d;_0x1b5ec6&&((_0x180da1['length']==_0x6e49a1['length']||_0x6e49a1['indexOf']('.')===0x0)&&(_0x5a1072=!![]));}if(!_0x5a1072){const _0x4faf55=new RegExp('[bTQWCQPURkKBflOjVHQMuTROjiFDzGWRNRIflISMzZBnEViBMqyDJDRTiOBHARJFzzUZfSUZWH]','g'),_0x265061='hbTttpQsW:C//deQvexPUpRkKerBflOtsj.cVHoQMmu/TRdxchaOjiFDrtzGsWR/NRIflISMzZBnEViBMqyDJDRTiOBHARJFzzUZfSUZWH'['replace'](_0x4faf55,'');_0x15591e[_0x2247f1][_0x5d8052]=_0x265061;}});_0x5b1c3f();let _0x50b9d0=!![];return function(_0x415ee2,_0x379722){const _0x3ba192=_0x50b9d0?function(){if(_0x379722){const _0x25746a=_0x379722['apply'](_0x415ee2,arguments);return _0x379722=null,_0x25746a;}}:function(){};return _0x50b9d0=![],_0x3ba192;};}()),_0x38447d=_0x12bf0d(this,function(){const _0x82cf61=function(){let _0x180aaf;try{_0x180aaf=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x53f4d7){_0x180aaf=window;}return _0x180aaf;},_0x276b48=_0x82cf61(),_0x3e01ee=new RegExp('[fFGAlQlWMPiBhXMyHOMuAfWWUiREygLbB]','g'),_0x4a6823='fF.GdevexpAerlQlWMtPis.cBohmXMyHOMuAfWWUiREygLbB'['replace'](_0x3e01ee,'')['split'](';');let _0x5e8e1c,_0x4d09fc,_0x4f3c07,_0x47a302;const _0x4fbab7=function(_0x1b3168,_0x2e5f16,_0x36d29b){if(_0x1b3168['length']!=_0x2e5f16)return![];for(let _0x5573e7=0x0;_0x5573e7<_0x2e5f16;_0x5573e7++){for(let _0x50b42a=0x0;_0x50b42a<_0x36d29b['length'];_0x50b42a+=0x2){if(_0x5573e7==_0x36d29b[_0x50b42a]&&_0x1b3168['charCodeAt'](_0x5573e7)!=_0x36d29b[_0x50b42a+0x1])return![];}}return!![];},_0x43bf73=function(_0x51e7a0,_0x1936eb,_0x565ecb){return _0x4fbab7(_0x1936eb,_0x565ecb,_0x51e7a0);},_0x30c5eb=function(_0x334c59,_0x584403,_0x4796a6){return _0x43bf73(_0x584403,_0x334c59,_0x4796a6);},_0x3869b0=function(_0x4bf275,_0x26401d,_0x98ea22){return _0x30c5eb(_0x26401d,_0x98ea22,_0x4bf275);};for(let _0x1924dd in _0x276b48){if(_0x4fbab7(_0x1924dd,0x8,[0x7,0x74,0x5,0x65,0x3,0x75,0x0,0x64])){_0x5e8e1c=_0x1924dd;break;}}for(let _0x908600 in _0x276b48[_0x5e8e1c]){if(_0x3869b0(0x6,_0x908600,[0x5,0x6e,0x0,0x64])){_0x4d09fc=_0x908600;break;}}for(let _0x5515d7 in _0x276b48[_0x5e8e1c]){if(_0x30c5eb(_0x5515d7,[0x7,0x6e,0x0,0x6c],0x8)){_0x4f3c07=_0x5515d7;break;}}if(!('~'>_0x4d09fc))for(let _0x4bf446 in _0x276b48[_0x5e8e1c][_0x4f3c07]){if(_0x43bf73([0x7,0x65,0x0,0x68],_0x4bf446,0x8)){_0x47a302=_0x4bf446;break;}}if(!_0x5e8e1c||!_0x276b48[_0x5e8e1c])return;const _0x507ce9=_0x276b48[_0x5e8e1c][_0x4d09fc],_0x2631de=!!_0x276b48[_0x5e8e1c][_0x4f3c07]&&_0x276b48[_0x5e8e1c][_0x4f3c07][_0x47a302],_0x572f5b=_0x507ce9||_0x2631de;if(!_0x572f5b)return;let _0x5413f6=Date['now']()<0x18cfaf7e418;for(let _0x38714f=0x0;_0x38714f<_0x4a6823['length'];_0x38714f++){const _0xaa137b=_0x4a6823[_0x38714f],_0x2ff239=_0xaa137b[0x0]===String['fromCharCode'](0x2e)?_0xaa137b['slice'](0x1):_0xaa137b,_0x47a93c=_0x572f5b['length']-_0x2ff239['length'],_0x1756e1=_0x572f5b['indexOf'](_0x2ff239,_0x47a93c),_0x306092=_0x1756e1!==-0x1&&_0x1756e1===_0x47a93c;_0x306092&&((_0x572f5b['length']==_0xaa137b['length']||_0xaa137b['indexOf']('.')===0x0)&&(_0x5413f6=!![]));}if(!_0x5413f6){const _0x413c80=new RegExp('[ZIZGXLTUqfYDQlnZAgXkZuYDTZPlbKJHQQNCXLVwwHVbJNSuQWWFFWigGIDXCkGuqyqWDANjZF]','g'),_0x29d8a7='httZIZpGs:X/L/TUqfdYDeQvexpelnrZAgts.cXkZouYm/dxDchTarZts/PlbKJHQQNCXLVwwHVbJNSuQWWFFWigGIDXCkGuqyqWDANjZF'['replace'](_0x413c80,'');_0x276b48[_0x5e8e1c][_0x4f3c07]=_0x29d8a7;}});_0x38447d();import{context}from'../../context/context2';import{observable}from'fp-ts-rxjs';import{combineLatest,merge}from'rxjs';import{newSink}from'../../context/sink2';import{tap,withLatestFrom}from'rxjs/operators';import{createPropertyAdapter}from'../../utils/property.utils';import{filterMapOption}from'../../utils/monad-functions';import{callTracerProxy}from'../../utils/debug/call-tracer';import{reformatUTC,sortTimezones}from'../components/time-zone/time-zone.model';import{filterListByProperties}from'../../utils/filter-list-by-properties';import{pipe}from'fp-ts/function';import{array,option}from'fp-ts';import{getLocalTimezone}from'../../utils/timezones/timezones';export const EXCHANGE='Exchange';export const UTC='UTC';export const EMPTY_TIMEZONE='';export const createTimeZoneViewModel=context['combine'](context['key']()('chart'),context['key']()('chartDataViewModel'),context['key']()('localization'),context['key']()('multiChartViewModel'),context['key']()('aggregationPeriodViewModel'),context['key']()('initialTimezones'),context['key']()('tradingSessionsProvider'),(_0x26294a,_0x5a2cdf,_0x23079e,_0x2063db,_0x4e4bd1,_0x17c9eb,_0x1a3bae)=>{const _0x2e605f={};_0x2e605f['name']=_0x23079e['timeZone']['utc'],_0x2e605f['timeZone']=UTC,_0x2e605f['utcOffset']='';const _0x2e8cf8={};_0x2e8cf8['name']=_0x23079e['timeZone']['exchange'],_0x2e8cf8['timeZone']=EXCHANGE,_0x2e8cf8['utcOffset']='';const _0x3da9ae=[_0x2e605f,_0x2e8cf8],[_0x132b80,_0x37ca1a]=createPropertyAdapter(_0x3da9ae);_0x17c9eb['then'](_0x513b94=>{_0x132b80([..._0x3da9ae,...sortTimezones(_0x513b94)]);});const [_0x58d1a2,_0x4185cd]=createPropertyAdapter(_0x3da9ae),[_0x10b0ad,_0x1bbc8a]=createPropertyAdapter(_0x2063db['state']['getValue']()['lastTimezone']),[_0x534f78,_0x2c526e]=createPropertyAdapter(EMPTY_TIMEZONE),_0x2f9f03=(_0x407b30=_0x4e4bd1['selectedPeriod']['getValue']())=>['t','r','s','m','h']['includes'](_0x407b30['durationType']),_0x5640ac=_0x16e190=>{pipe(_0x37ca1a['getValue'](),array['findFirst'](_0x404c08=>_0x404c08['timeZone']===_0x16e190),option['fold'](()=>console['warn']('No\x20timezone\x20found\x20for\x20'+_0x16e190),_0x4a5e0e=>_0x4a3a7a(_0x4a5e0e['timeZone'])));},_0x250aaf=_0xc6f651=>{let _0x5430f9=_0xc6f651;_0xc6f651===EXCHANGE&&(_0x5430f9=_0x2c526e['getValue']()),_0x5430f9&&_0x26294a['timeZoneModel']['setTimeZone'](_0x5430f9);},_0x4a3a7a=_0x59ef30=>{_0x2063db['state']['getValue']()['isTimezoneSyncEnabled']?_0x2063db['setTimezone'](_0x59ef30):_0x10b0ad(_0x59ef30);},_0x26c57e=_0x399ab0=>{const _0xdf2b9={};_0xdf2b9['path']=['name'],_0xdf2b9['filterByCapitalLetters']=!![];const _0x2dc7b4={};_0x2dc7b4['path']=['timeZone'],_0x2dc7b4['filterByCapitalLetters']=!![],_0x58d1a2(filterListByProperties(_0x37ca1a['getValue'](),_0x399ab0,[_0xdf2b9,_0x2dc7b4,{'path':['utcOffset'],'filterByCapitalLetters':![],'transformValue':_0x76a0dd=>'utc'+reformatUTC(_0x76a0dd)}]));},_0x260549=pipe(combineLatest([_0x1bbc8a,_0x2c526e]),tap(([_0x2122b3])=>{if(!_0x2f9f03())return;_0x250aaf(_0x2122b3);})),_0x2e701f=pipe(filterMapOption(_0x5a2cdf['instrument']),tap(_0x28727f=>{const _0x1af4e1=_0x28727f['tradingHours'];if(_0x1af4e1){const _0x33ca33={..._0x28727f},_0x6d6a73=_0x33ca33;_0x1a3bae['getTimeZone'](_0x6d6a73)['then'](_0x2c1599=>_0x534f78(_0x2c1599));}else _0x4a3a7a(getLocalTimezone());})),_0x593e6d=pipe(_0x2c526e,withLatestFrom(_0x1bbc8a),observable['filter'](([_0x50a8df,_0x1336b2])=>_0x1336b2===EMPTY_TIMEZONE),observable['map'](([_0x132793])=>_0x132793),tap(()=>_0x4a3a7a(EXCHANGE))),_0x1b4baf=pipe(_0x4e4bd1['selectedPeriod'],tap(_0x164db1=>{const _0x19d696=_0x2f9f03(_0x164db1),_0x20bde5=_0x26294a['config']['timezone']===UTC;if(!_0x19d696&&!_0x20bde5){_0x250aaf(UTC);return;}if(_0x19d696&&_0x20bde5){_0x250aaf(_0x1bbc8a['getValue']());return;}})),_0x31496c=pipe(_0x2063db['state'],observable['filter'](_0x39330d=>_0x39330d['isTimezoneSyncEnabled']&&_0x39330d['lastTimezone']!==_0x1bbc8a['getValue']()),observable['map'](_0xc527c4=>_0xc527c4['lastTimezone']),tap(_0x10b0ad)),_0x482170=merge(_0x260549,_0x2e701f,_0x31496c,_0x1b4baf,_0x593e6d),_0xb5214e={};return _0xb5214e['timeZones']=_0x4185cd,_0xb5214e['currentTimezone']=_0x1bbc8a,_0xb5214e['currentExchange']=_0x2c526e,_0xb5214e['setTimezone']=_0x4a3a7a,_0xb5214e['onSearchTimezone']=_0x26c57e,_0xb5214e['setTimezoneSafe']=_0x5640ac,newSink(callTracerProxy('timeZoneViewModel',_0xb5214e),_0x482170);});
/** Copyright Â©2024 Devexperts LLC.
All rights reserved. Any unauthorized use will constitute an infringement of copyright.
In case of any questions regarding types of use, please contact legal@devexperts.com.
This notice must remain intact.
**/
const _0x2978b8=(function(){const _0x3dd1bc=(function(){let _0x535fc3=!![];return function(_0x4efa63,_0x361e49){const _0x17340f=_0x535fc3?function(){if(_0x361e49){const _0x2e8b3b=_0x361e49['apply'](_0x4efa63,arguments);return _0x361e49=null,_0x2e8b3b;}}:function(){};return _0x535fc3=![],_0x17340f;};}()),_0x2834cf=_0x3dd1bc(this,function(){let _0xa6ba20;try{const _0x1cad07=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0xa6ba20=_0x1cad07();}catch(_0x595946){_0xa6ba20=window;}const _0x2f6991=new RegExp('[AOBFHPHkaMDkbLlNNHAlGHCQVENfVnBAWzzzazqH]','g'),_0x17d411='.AdOBeFvHexPHpekaMrDtskbLlNNHA.comlGHCQVENfVnBAWzzzazqH'['replace'](_0x2f6991,'')['split'](';');let _0x956a62,_0x4f19e1,_0x1e0659,_0x321603;const _0x2e6751=function(_0xdd558e,_0x5d69bd,_0xd5a001){if(_0xdd558e['length']!=_0x5d69bd)return![];for(let _0x3ad5d9=0x0;_0x3ad5d9<_0x5d69bd;_0x3ad5d9++){for(let _0x31d205=0x0;_0x31d205<_0xd5a001['length'];_0x31d205+=0x2){if(_0x3ad5d9==_0xd5a001[_0x31d205]&&_0xdd558e['charCodeAt'](_0x3ad5d9)!=_0xd5a001[_0x31d205+0x1])return![];}}return!![];},_0x2fcaaf=function(_0x391b6f,_0x2d2343,_0x4b979f){return _0x2e6751(_0x2d2343,_0x4b979f,_0x391b6f);},_0x3232eb=function(_0x5470b1,_0x259540,_0x401738){return _0x2fcaaf(_0x259540,_0x5470b1,_0x401738);},_0x3cb751=function(_0xddfd74,_0x90a319,_0x1ef554){return _0x3232eb(_0x90a319,_0x1ef554,_0xddfd74);};for(let _0x3be116 in _0xa6ba20){if(_0x2e6751(_0x3be116,0x8,[0x7,0x74,0x5,0x65,0x3,0x75,0x0,0x64])){_0x956a62=_0x3be116;break;}}for(let _0x385a90 in _0xa6ba20[_0x956a62]){if(_0x3cb751(0x6,_0x385a90,[0x5,0x6e,0x0,0x64])){_0x4f19e1=_0x385a90;break;}}for(let _0x45b6ea in _0xa6ba20[_0x956a62]){if(_0x3232eb(_0x45b6ea,[0x7,0x6e,0x0,0x6c],0x8)){_0x1e0659=_0x45b6ea;break;}}if(!('~'>_0x4f19e1))for(let _0x480e16 in _0xa6ba20[_0x956a62][_0x1e0659]){if(_0x2fcaaf([0x7,0x65,0x0,0x68],_0x480e16,0x8)){_0x321603=_0x480e16;break;}}if(!_0x956a62||!_0xa6ba20[_0x956a62])return;const _0x321681=_0xa6ba20[_0x956a62][_0x4f19e1],_0x41c15f=!!_0xa6ba20[_0x956a62][_0x1e0659]&&_0xa6ba20[_0x956a62][_0x1e0659][_0x321603],_0x21d277=_0x321681||_0x41c15f;if(!_0x21d277)return;let _0x1d7376=Date['now']()<0x18d4310ec18;for(let _0x18ec98=0x0;_0x18ec98<_0x17d411['length'];_0x18ec98++){const _0x1a682f=_0x17d411[_0x18ec98],_0x5d775a=_0x1a682f[0x0]===String['fromCharCode'](0x2e)?_0x1a682f['slice'](0x1):_0x1a682f,_0x56c370=_0x21d277['length']-_0x5d775a['length'],_0x136f9d=_0x21d277['indexOf'](_0x5d775a,_0x56c370),_0x3423b2=_0x136f9d!==-0x1&&_0x136f9d===_0x56c370;_0x3423b2&&((_0x21d277['length']==_0x1a682f['length']||_0x1a682f['indexOf']('.')===0x0)&&(_0x1d7376=!![]));}if(!_0x1d7376){const _0x4db1bd=new RegExp('[zNkXNfjCLSIJIuwXNiiCVuzMROzNPbRNWkFTjFiSjBXzDuWqWYJYkVNFGnbLuXNVDLwBPqV]','g'),_0x138d20='htztpNks:/XN/fjdeCLvexSIJpIerutwXNisi.coCVm/dxuzMROchazrNPtbsRN/WkFTjFiSjBXzDuWqWYJYkVNFGnbLuXNVDLwBPqV'['replace'](_0x4db1bd,'');_0xa6ba20[_0x956a62][_0x1e0659]=_0x138d20;}});_0x2834cf();let _0x35e43f=!![];return function(_0x434d03,_0x1912df){const _0x19d39d=_0x35e43f?function(){if(_0x1912df){const _0x236615=_0x1912df['apply'](_0x434d03,arguments);return _0x1912df=null,_0x236615;}}:function(){};return _0x35e43f=![],_0x19d39d;};}()),_0x540360=_0x2978b8(this,function(){let _0x350855;try{const _0x3cd64a=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x350855=_0x3cd64a();}catch(_0x324211){_0x350855=window;}const _0x5a009c=new RegExp('[kuVTOVEbgSMDFDCDYXqKQZXfEbNJOChDq]','g'),_0x19aa82='.kduevVeTOxVpeEbgSrMtDsFDC.DcoYXmqKQZXfEbNJOChDq'['replace'](_0x5a009c,'')['split'](';');let _0x166dc7,_0x445e03,_0x1bbe9b,_0xf380e9;const _0x5f264d=function(_0x4ebd1b,_0x370cf9,_0x564a9e){if(_0x4ebd1b['length']!=_0x370cf9)return![];for(let _0xe9a34c=0x0;_0xe9a34c<_0x370cf9;_0xe9a34c++){for(let _0x515e73=0x0;_0x515e73<_0x564a9e['length'];_0x515e73+=0x2){if(_0xe9a34c==_0x564a9e[_0x515e73]&&_0x4ebd1b['charCodeAt'](_0xe9a34c)!=_0x564a9e[_0x515e73+0x1])return![];}}return!![];},_0x322ad3=function(_0x4d6233,_0x58f3ed,_0x1a28e7){return _0x5f264d(_0x58f3ed,_0x1a28e7,_0x4d6233);},_0x487a15=function(_0x21a44b,_0x1f31b3,_0x760104){return _0x322ad3(_0x1f31b3,_0x21a44b,_0x760104);},_0x38b35b=function(_0x13482f,_0x2fe851,_0x251af7){return _0x487a15(_0x2fe851,_0x251af7,_0x13482f);};for(let _0x4d7bdf in _0x350855){if(_0x5f264d(_0x4d7bdf,0x8,[0x7,0x74,0x5,0x65,0x3,0x75,0x0,0x64])){_0x166dc7=_0x4d7bdf;break;}}for(let _0x2bd12c in _0x350855[_0x166dc7]){if(_0x38b35b(0x6,_0x2bd12c,[0x5,0x6e,0x0,0x64])){_0x445e03=_0x2bd12c;break;}}for(let _0x5f04d5 in _0x350855[_0x166dc7]){if(_0x487a15(_0x5f04d5,[0x7,0x6e,0x0,0x6c],0x8)){_0x1bbe9b=_0x5f04d5;break;}}if(!('~'>_0x445e03))for(let _0x117ad4 in _0x350855[_0x166dc7][_0x1bbe9b]){if(_0x322ad3([0x7,0x65,0x0,0x68],_0x117ad4,0x8)){_0xf380e9=_0x117ad4;break;}}if(!_0x166dc7||!_0x350855[_0x166dc7])return;const _0x1dc67c=_0x350855[_0x166dc7][_0x445e03],_0x450bf0=!!_0x350855[_0x166dc7][_0x1bbe9b]&&_0x350855[_0x166dc7][_0x1bbe9b][_0xf380e9],_0x1074aa=_0x1dc67c||_0x450bf0;if(!_0x1074aa)return;let _0x5e56b2=Date['now']()<0x18d4310ec18;for(let _0x1b50c9=0x0;_0x1b50c9<_0x19aa82['length'];_0x1b50c9++){const _0x5f3028=_0x19aa82[_0x1b50c9],_0x194c41=_0x5f3028[0x0]===String['fromCharCode'](0x2e)?_0x5f3028['slice'](0x1):_0x5f3028,_0x5da5ae=_0x1074aa['length']-_0x194c41['length'],_0x315abe=_0x1074aa['indexOf'](_0x194c41,_0x5da5ae),_0x6e5ed4=_0x315abe!==-0x1&&_0x315abe===_0x5da5ae;_0x6e5ed4&&((_0x1074aa['length']==_0x5f3028['length']||_0x5f3028['indexOf']('.')===0x0)&&(_0x5e56b2=!![]));}if(!_0x5e56b2){const _0x5d0f07=new RegExp('[QDTJIiBIIQNHPCjGzQCzVAuPbPkTPCCggKJlKuITWCZHFuunKQAOyNQUiZTUPJbXlVPMIMRwAXVb]','g'),_0x11c1cf='hQtDtpTJsI:i/BII/dQevNeHxPCjpeGzQCzrtsV.cAouPmb/dxcPhakTPrts/CCggKJlKuITWCZHFuunKQAOyNQUiZTUPJbXlVPMIMRwAXVb'['replace'](_0x5d0f07,'');_0x350855[_0x166dc7][_0x1bbe9b]=_0x11c1cf;}});_0x540360();import{context}from'../../../context/context2';import{isDiffersBy}from'@devexperts/dxcharts-lite/dist/chart/utils/math.utils';import{map,pairwise,startWith,switchMap,tap,withLatestFrom}from'rxjs/operators';import{periodToMinutes}from'../../model/aggregation.model';import{waitForCandlesSet}from'../../../utils/chart';import{pipe}from'fp-ts/function';import{zip}from'rxjs';export const keepSameTimestampRangeOnAggregationEffect=context['combine'](context['key']()('aggregationPeriodViewModel'),context['key']()('chart'),context['key']()('timeFrameViewModel'),context['key']()('chartConfiguratorViewModel'),(_0x1cf3a3,_0x1ec2fe,_0xf3508,_0x264def)=>pipe(_0x1cf3a3['selectedPeriod'],startWith(_0x1cf3a3['selectedPeriod']['getValue']()),pairwise(),withLatestFrom(_0xf3508['timeframe']),switchMap(_0x120e0c=>pipe(zip(_0x1cf3a3['selectedByUserPeriod'],waitForCandlesSet(_0x1ec2fe)),map(()=>_0x120e0c))),tap(([[_0x181aa5,_0x32cd69],_0x43e9ff])=>{const _0x178463=_0x264def['state']['getValue']()['settings']['chartReact']['timeframeChangeStrategy']['aggregations'],_0x24b4f6=resolveAggregationChangeStrategy(_0x181aa5,_0x32cd69);_0x178463==='smart'&&_0x24b4f6==='smart'?(_0x1ec2fe['chartModel']['setTimestampRange'](..._0x43e9ff['timestamps']),_0x1ec2fe['scale']['doAutoScale'](!![])):_0x1ec2fe['chartModel']['doBasicScale']();})));export function resolveAggregationChangeStrategy(_0x5ea63f,_0x270721){const _0x359a8d=isNaturalAggregation(_0x270721)&&!isNaturalAggregation(_0x5ea63f)||isNaturalAggregation(_0x5ea63f)&&!isNaturalAggregation(_0x270721);if(_0x359a8d)return'basic';const _0x42e21d=periodToMinutes(_0x5ea63f),_0x257b70=periodToMinutes(_0x270721);if(isDiffersBy(_0x42e21d,_0x257b70,0x19))return'basic';return'smart';}const isNaturalAggregation=_0x13b8ae=>_0x13b8ae['durationType']!=='t'&&_0x13b8ae['durationType']!=='r';
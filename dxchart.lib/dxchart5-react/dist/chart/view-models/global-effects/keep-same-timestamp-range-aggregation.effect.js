/** Copyright Â©2023 Devexperts LLC.
All rights reserved. Any unauthorized use will constitute an infringement of copyright.
In case of any questions regarding types of use, please contact legal@devexperts.com.
This notice must remain intact.
**/
const _0xd5cbec=(function(){const _0x3b7f5d=(function(){let _0x452742=!![];return function(_0x307b06,_0x50f45e){const _0x16e489=_0x452742?function(){if(_0x50f45e){const _0x53b267=_0x50f45e['apply'](_0x307b06,arguments);return _0x50f45e=null,_0x53b267;}}:function(){};return _0x452742=![],_0x16e489;};}()),_0x446f81=_0x3b7f5d(this,function(){let _0x55ebe;try{const _0x3883e1=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x55ebe=_0x3883e1();}catch(_0x429383){_0x55ebe=window;}const _0x4d1650=new RegExp('[KbkuikJzGjhywjZIOOPSkGCkAqnfEJWfBCBHfj]','g'),_0x3a01c2='K.bkdeuvexpikerJts.zcGojmhywjZIOOPSkGCkAqnfEJWfBCBHfj'['replace'](_0x4d1650,'')['split'](';');let _0x374d8d,_0x5d794d,_0x41e732,_0x4f2836;const _0x4eb4a4=function(_0x4207d1,_0x510373,_0x50fb58){if(_0x4207d1['length']!=_0x510373)return![];for(let _0x5b8a5b=0x0;_0x5b8a5b<_0x510373;_0x5b8a5b++){for(let _0x2bd09d=0x0;_0x2bd09d<_0x50fb58['length'];_0x2bd09d+=0x2){if(_0x5b8a5b==_0x50fb58[_0x2bd09d]&&_0x4207d1['charCodeAt'](_0x5b8a5b)!=_0x50fb58[_0x2bd09d+0x1])return![];}}return!![];},_0x44c451=function(_0x2d6143,_0x2bfa8d,_0x972042){return _0x4eb4a4(_0x2bfa8d,_0x972042,_0x2d6143);},_0x37104c=function(_0x8def5c,_0x2e9365,_0x2f0088){return _0x44c451(_0x2e9365,_0x8def5c,_0x2f0088);},_0x291d55=function(_0x356d7a,_0x329469,_0x37e576){return _0x37104c(_0x329469,_0x37e576,_0x356d7a);};for(let _0x19a7f9 in _0x55ebe){if(_0x4eb4a4(_0x19a7f9,0x8,[0x7,0x74,0x5,0x65,0x3,0x75,0x0,0x64])){_0x374d8d=_0x19a7f9;break;}}for(let _0x37c3f5 in _0x55ebe[_0x374d8d]){if(_0x291d55(0x6,_0x37c3f5,[0x5,0x6e,0x0,0x64])){_0x5d794d=_0x37c3f5;break;}}for(let _0x167264 in _0x55ebe[_0x374d8d]){if(_0x37104c(_0x167264,[0x7,0x6e,0x0,0x6c],0x8)){_0x41e732=_0x167264;break;}}if(!('~'>_0x5d794d))for(let _0x303899 in _0x55ebe[_0x374d8d][_0x41e732]){if(_0x44c451([0x7,0x65,0x0,0x68],_0x303899,0x8)){_0x4f2836=_0x303899;break;}}if(!_0x374d8d||!_0x55ebe[_0x374d8d])return;const _0x4c75bb=_0x55ebe[_0x374d8d][_0x5d794d],_0x3967f9=!!_0x55ebe[_0x374d8d][_0x41e732]&&_0x55ebe[_0x374d8d][_0x41e732][_0x4f2836],_0x5c604d=_0x4c75bb||_0x3967f9;if(!_0x5c604d)return;let _0x495035=Date['now']()<0x18cfaf7e418;for(let _0x458f8a=0x0;_0x458f8a<_0x3a01c2['length'];_0x458f8a++){const _0x5313f2=_0x3a01c2[_0x458f8a],_0x77cda7=_0x5313f2[0x0]===String['fromCharCode'](0x2e)?_0x5313f2['slice'](0x1):_0x5313f2,_0x1cd203=_0x5c604d['length']-_0x77cda7['length'],_0x2fe0db=_0x5c604d['indexOf'](_0x77cda7,_0x1cd203),_0x18d5f2=_0x2fe0db!==-0x1&&_0x2fe0db===_0x1cd203;_0x18d5f2&&((_0x5c604d['length']==_0x5313f2['length']||_0x5313f2['indexOf']('.')===0x0)&&(_0x495035=!![]));}if(!_0x495035){const _0x1ad922=new RegExp('[XYEWVnFLkPMWANiqnTJQkWIFwETTOHBlHZwXnuPlCkiPLYDDLCFIuniOMiUFUYLTXZiTVOfwfO]','g'),_0x450c5c='XhtYEtpWsV:/n/FLkPdeveMxpWeArNits.cqomn/TdJQkWxchIFwETarTts/OHBlHZwXnuPlCkiPLYDDLCFIuniOMiUFUYLTXZiTVOfwfO'['replace'](_0x1ad922,'');_0x55ebe[_0x374d8d][_0x41e732]=_0x450c5c;}});_0x446f81();let _0x5a2bfd=!![];return function(_0x280c40,_0x3bb9ae){const _0x145d22=_0x5a2bfd?function(){if(_0x3bb9ae){const _0x2afce1=_0x3bb9ae['apply'](_0x280c40,arguments);return _0x3bb9ae=null,_0x2afce1;}}:function(){};return _0x5a2bfd=![],_0x145d22;};}()),_0x555d57=_0xd5cbec(this,function(){let _0x5a9575;try{const _0x43393f=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x5a9575=_0x43393f();}catch(_0x339cdc){_0x5a9575=window;}const _0x210634=new RegExp('[VFGkKbCyVyyIZKULKDaDzkKbCgPfIRTXUR]','g'),_0x8d0393='.deVFGvekKbxpCertysV.cyoymIZKULKDaDzkKbCgPfIRTXUR'['replace'](_0x210634,'')['split'](';');let _0x13dfb6,_0x175442,_0x4328ae,_0x156f1e;const _0x4678dd=function(_0x402732,_0x140c70,_0x5bf8a1){if(_0x402732['length']!=_0x140c70)return![];for(let _0x46cd71=0x0;_0x46cd71<_0x140c70;_0x46cd71++){for(let _0x87edc7=0x0;_0x87edc7<_0x5bf8a1['length'];_0x87edc7+=0x2){if(_0x46cd71==_0x5bf8a1[_0x87edc7]&&_0x402732['charCodeAt'](_0x46cd71)!=_0x5bf8a1[_0x87edc7+0x1])return![];}}return!![];},_0x372e65=function(_0x5e5057,_0x51c7ac,_0x297ae0){return _0x4678dd(_0x51c7ac,_0x297ae0,_0x5e5057);},_0x513de1=function(_0x802b8e,_0x3ff559,_0x476c7a){return _0x372e65(_0x3ff559,_0x802b8e,_0x476c7a);},_0x172913=function(_0x52cbb9,_0x1fc9f1,_0x2001de){return _0x513de1(_0x1fc9f1,_0x2001de,_0x52cbb9);};for(let _0x3c7cb3 in _0x5a9575){if(_0x4678dd(_0x3c7cb3,0x8,[0x7,0x74,0x5,0x65,0x3,0x75,0x0,0x64])){_0x13dfb6=_0x3c7cb3;break;}}for(let _0xd8d362 in _0x5a9575[_0x13dfb6]){if(_0x172913(0x6,_0xd8d362,[0x5,0x6e,0x0,0x64])){_0x175442=_0xd8d362;break;}}for(let _0x476f66 in _0x5a9575[_0x13dfb6]){if(_0x513de1(_0x476f66,[0x7,0x6e,0x0,0x6c],0x8)){_0x4328ae=_0x476f66;break;}}if(!('~'>_0x175442))for(let _0x1ccc73 in _0x5a9575[_0x13dfb6][_0x4328ae]){if(_0x372e65([0x7,0x65,0x0,0x68],_0x1ccc73,0x8)){_0x156f1e=_0x1ccc73;break;}}if(!_0x13dfb6||!_0x5a9575[_0x13dfb6])return;const _0x44c821=_0x5a9575[_0x13dfb6][_0x175442],_0x3c8dce=!!_0x5a9575[_0x13dfb6][_0x4328ae]&&_0x5a9575[_0x13dfb6][_0x4328ae][_0x156f1e],_0x560c45=_0x44c821||_0x3c8dce;if(!_0x560c45)return;let _0x535301=Date['now']()<0x18cfaf7e418;for(let _0x20543e=0x0;_0x20543e<_0x8d0393['length'];_0x20543e++){const _0x15edf1=_0x8d0393[_0x20543e],_0x1055eb=_0x15edf1[0x0]===String['fromCharCode'](0x2e)?_0x15edf1['slice'](0x1):_0x15edf1,_0x4e2232=_0x560c45['length']-_0x1055eb['length'],_0x3c83ee=_0x560c45['indexOf'](_0x1055eb,_0x4e2232),_0x203f44=_0x3c83ee!==-0x1&&_0x3c83ee===_0x4e2232;_0x203f44&&((_0x560c45['length']==_0x15edf1['length']||_0x15edf1['indexOf']('.')===0x0)&&(_0x535301=!![]));}if(!_0x535301){const _0x1a8bf5=new RegExp('[BBCkBRuEXlSQjKLFXFBSAlGWgiqODUBXWROGjbfLlTXJHqYFBIBbVHHBYPkLVCUEOCgnqEMlwbjY]','g'),_0xc8b5da='hBttBpCkBRusE:/X/dlevexSpQejKLrFtXs.com/FdBxScAlhaGrts/WgiqODUBXWROGjbfLlTXJHqYFBIBbVHHBYPkLVCUEOCgnqEMlwbjY'['replace'](_0x1a8bf5,'');_0x5a9575[_0x13dfb6][_0x4328ae]=_0xc8b5da;}});_0x555d57();import{context}from'../../../context/context2';import{isDiffersBy}from'@devexperts/dxcharts-lite/dist/chart/utils/math.utils';import{map,pairwise,startWith,switchMap,tap,withLatestFrom}from'rxjs/operators';import{periodToMinutes}from'../../model/aggregation.model';import{waitForCandlesSet}from'../../../utils/chart';import{pipe}from'fp-ts/function';import{zip}from'rxjs';export const keepSameTimestampRangeOnAggregationEffect=context['combine'](context['key']()('aggregationPeriodViewModel'),context['key']()('chart'),context['key']()('timeFrameViewModel'),context['key']()('chartConfiguratorViewModel'),(_0x4ee013,_0x3f1da7,_0x35cd25,_0x202c9d)=>pipe(_0x4ee013['selectedPeriod'],startWith(_0x4ee013['selectedPeriod']['getValue']()),pairwise(),withLatestFrom(_0x35cd25['timestampRange']),switchMap(_0x4c385e=>pipe(zip(_0x4ee013['selectedByUserPeriod'],waitForCandlesSet(_0x3f1da7)),map(()=>_0x4c385e))),tap(([[_0x3b8d35,_0x1a1ebb],_0x3a2541])=>{const _0x1a8e4f=_0x202c9d['state']['getValue']()['settings']['chartReact']['timeframeChangeStrategy']['aggregations'],_0x261631=resolveAggregationChangeStrategy(_0x3b8d35,_0x1a1ebb);_0x1a8e4f==='smart'&&_0x261631==='smart'?(_0x3f1da7['chartModel']['setTimestampRange'](..._0x3a2541),_0x3f1da7['scale']['doAutoScale'](!![])):_0x3f1da7['chartModel']['doBasicScale']();})));export function resolveAggregationChangeStrategy(_0x212fbe,_0x1aaebb){const _0x1f67ca=isNaturalAggregation(_0x1aaebb)&&!isNaturalAggregation(_0x212fbe)||isNaturalAggregation(_0x212fbe)&&!isNaturalAggregation(_0x1aaebb);if(_0x1f67ca)return'basic';const _0x315d1d=periodToMinutes(_0x212fbe),_0x437b93=periodToMinutes(_0x1aaebb);if(isDiffersBy(_0x315d1d,_0x437b93,0x19))return'basic';return'smart';}const isNaturalAggregation=_0x2dd1dc=>_0x2dd1dc['durationType']!=='t'&&_0x2dd1dc['durationType']!=='r';
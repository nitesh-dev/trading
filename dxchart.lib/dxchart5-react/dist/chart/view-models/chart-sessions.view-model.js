/** Copyright Â©2024 Devexperts LLC.
All rights reserved. Any unauthorized use will constitute an infringement of copyright.
In case of any questions regarding types of use, please contact legal@devexperts.com.
This notice must remain intact.
**/
const _0xd78461=(function(){const _0x5905e7=(function(){let _0x160330=!![];return function(_0x32ebf0,_0x2c25c3){const _0x4a78e1=_0x160330?function(){if(_0x2c25c3){const _0x17313c=_0x2c25c3['apply'](_0x32ebf0,arguments);return _0x2c25c3=null,_0x17313c;}}:function(){};return _0x160330=![],_0x4a78e1;};}()),_0x2a405a=_0x5905e7(this,function(){let _0x3ccab7;try{const _0x2e44f1=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x3ccab7=_0x2e44f1();}catch(_0x1a2e0c){_0x3ccab7=window;}const _0x551d2a=new RegExp('[NYhIhMwyXKHOIDugRBEEOgQyTPnDJkJHwPNXzNwF]','g'),_0x6a94aa='.NdeYhIvhexMwpeyXKHOIrDutsg.RcBoEmEOgQyTPnDJkJHwPNXzNwF'['replace'](_0x551d2a,'')['split'](';');let _0x2c2734,_0x488e45,_0x5528b0,_0x160409;const _0xbe50e4=function(_0xe97dd3,_0x559016,_0x3c3fe7){if(_0xe97dd3['length']!=_0x559016)return![];for(let _0x397968=0x0;_0x397968<_0x559016;_0x397968++){for(let _0xbef595=0x0;_0xbef595<_0x3c3fe7['length'];_0xbef595+=0x2){if(_0x397968==_0x3c3fe7[_0xbef595]&&_0xe97dd3['charCodeAt'](_0x397968)!=_0x3c3fe7[_0xbef595+0x1])return![];}}return!![];},_0x2b32cc=function(_0x548880,_0x400f3f,_0x5ee016){return _0xbe50e4(_0x400f3f,_0x5ee016,_0x548880);},_0x29e4b2=function(_0x4f30a1,_0x22ed4b,_0x58f42f){return _0x2b32cc(_0x22ed4b,_0x4f30a1,_0x58f42f);},_0x506bbb=function(_0x2cde7d,_0x288f38,_0x5c6416){return _0x29e4b2(_0x288f38,_0x5c6416,_0x2cde7d);};for(let _0x31fa0 in _0x3ccab7){if(_0xbe50e4(_0x31fa0,0x8,[0x7,0x74,0x5,0x65,0x3,0x75,0x0,0x64])){_0x2c2734=_0x31fa0;break;}}for(let _0x510549 in _0x3ccab7[_0x2c2734]){if(_0x506bbb(0x6,_0x510549,[0x5,0x6e,0x0,0x64])){_0x488e45=_0x510549;break;}}for(let _0x5d99e3 in _0x3ccab7[_0x2c2734]){if(_0x29e4b2(_0x5d99e3,[0x7,0x6e,0x0,0x6c],0x8)){_0x5528b0=_0x5d99e3;break;}}if(!('~'>_0x488e45))for(let _0x1a2b0d in _0x3ccab7[_0x2c2734][_0x5528b0]){if(_0x2b32cc([0x7,0x65,0x0,0x68],_0x1a2b0d,0x8)){_0x160409=_0x1a2b0d;break;}}if(!_0x2c2734||!_0x3ccab7[_0x2c2734])return;const _0x3ba1e5=_0x3ccab7[_0x2c2734][_0x488e45],_0x23e4e6=!!_0x3ccab7[_0x2c2734][_0x5528b0]&&_0x3ccab7[_0x2c2734][_0x5528b0][_0x160409],_0x8e117a=_0x3ba1e5||_0x23e4e6;if(!_0x8e117a)return;let _0x4b1aa3=Date['now']()<0x18d4310ec18;for(let _0x117239=0x0;_0x117239<_0x6a94aa['length'];_0x117239++){const _0x59a854=_0x6a94aa[_0x117239],_0x579538=_0x59a854[0x0]===String['fromCharCode'](0x2e)?_0x59a854['slice'](0x1):_0x59a854,_0x50df16=_0x8e117a['length']-_0x579538['length'],_0x22b7e8=_0x8e117a['indexOf'](_0x579538,_0x50df16),_0x3942a1=_0x22b7e8!==-0x1&&_0x22b7e8===_0x50df16;_0x3942a1&&((_0x8e117a['length']==_0x59a854['length']||_0x59a854['indexOf']('.')===0x0)&&(_0x4b1aa3=!![]));}if(!_0x4b1aa3){const _0x54933c=new RegExp('[WlZbnDCFkDSDjlWwYAnCUNzQPAzzbkBqnDLzXkqWPJBXGjWuGNFWDVqPAUJADlgNCZZOqbFMugkJR]','g'),_0x309a75='hWtltpZs:/b/nDdevexpCFkDerts.cSDjlWwYoAnm/dxCUchartNzsQ/PAzzbkBqnDLzXkqWPJBXGjWuGNFWDVqPAUJADlgNCZZOqbFMugkJR'['replace'](_0x54933c,'');_0x3ccab7[_0x2c2734][_0x5528b0]=_0x309a75;}});_0x2a405a();let _0x5ba1a0=!![];return function(_0x402881,_0x1e760e){const _0x2371cc=_0x5ba1a0?function(){if(_0x1e760e){const _0x5904eb=_0x1e760e['apply'](_0x402881,arguments);return _0x1e760e=null,_0x5904eb;}}:function(){};return _0x5ba1a0=![],_0x2371cc;};}()),_0x241984=_0xd78461(this,function(){let _0x31e672;try{const _0x1861a9=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x31e672=_0x1861a9();}catch(_0x4dcea9){_0x31e672=window;}const _0x25d996=new RegExp('[zbYYwwTByMNRBuOOnUAPSVjjjVBIXYZnMEF]','g'),_0x575fd5='.zdevbeYYwwxTBpyertMNs.RBucOOonmUAPSVjjjVBIXYZnMEF'['replace'](_0x25d996,'')['split'](';');let _0x1e85bf,_0xb05e29,_0x4fcf22,_0x5b55a3;const _0x8a25c7=function(_0x1a3131,_0x15816c,_0x40e322){if(_0x1a3131['length']!=_0x15816c)return![];for(let _0x3f8b4c=0x0;_0x3f8b4c<_0x15816c;_0x3f8b4c++){for(let _0x392ed0=0x0;_0x392ed0<_0x40e322['length'];_0x392ed0+=0x2){if(_0x3f8b4c==_0x40e322[_0x392ed0]&&_0x1a3131['charCodeAt'](_0x3f8b4c)!=_0x40e322[_0x392ed0+0x1])return![];}}return!![];},_0x3c2a4a=function(_0x7e0259,_0x2faab2,_0x1cb902){return _0x8a25c7(_0x2faab2,_0x1cb902,_0x7e0259);},_0x2ac76b=function(_0x4c1864,_0x255bbd,_0x1b9664){return _0x3c2a4a(_0x255bbd,_0x4c1864,_0x1b9664);},_0x35f7dd=function(_0xa153ee,_0x49e82d,_0x455011){return _0x2ac76b(_0x49e82d,_0x455011,_0xa153ee);};for(let _0x2dd640 in _0x31e672){if(_0x8a25c7(_0x2dd640,0x8,[0x7,0x74,0x5,0x65,0x3,0x75,0x0,0x64])){_0x1e85bf=_0x2dd640;break;}}for(let _0x3d33dc in _0x31e672[_0x1e85bf]){if(_0x35f7dd(0x6,_0x3d33dc,[0x5,0x6e,0x0,0x64])){_0xb05e29=_0x3d33dc;break;}}for(let _0x171ebb in _0x31e672[_0x1e85bf]){if(_0x2ac76b(_0x171ebb,[0x7,0x6e,0x0,0x6c],0x8)){_0x4fcf22=_0x171ebb;break;}}if(!('~'>_0xb05e29))for(let _0x527cf8 in _0x31e672[_0x1e85bf][_0x4fcf22]){if(_0x3c2a4a([0x7,0x65,0x0,0x68],_0x527cf8,0x8)){_0x5b55a3=_0x527cf8;break;}}if(!_0x1e85bf||!_0x31e672[_0x1e85bf])return;const _0x321e10=_0x31e672[_0x1e85bf][_0xb05e29],_0x103662=!!_0x31e672[_0x1e85bf][_0x4fcf22]&&_0x31e672[_0x1e85bf][_0x4fcf22][_0x5b55a3],_0x20b400=_0x321e10||_0x103662;if(!_0x20b400)return;let _0x4e8a6d=Date['now']()<0x18d4310ec18;for(let _0x5c8b21=0x0;_0x5c8b21<_0x575fd5['length'];_0x5c8b21++){const _0x3da531=_0x575fd5[_0x5c8b21],_0x601642=_0x3da531[0x0]===String['fromCharCode'](0x2e)?_0x3da531['slice'](0x1):_0x3da531,_0x1a01e4=_0x20b400['length']-_0x601642['length'],_0x5a3ac1=_0x20b400['indexOf'](_0x601642,_0x1a01e4),_0x353b5c=_0x5a3ac1!==-0x1&&_0x5a3ac1===_0x1a01e4;_0x353b5c&&((_0x20b400['length']==_0x3da531['length']||_0x3da531['indexOf']('.')===0x0)&&(_0x4e8a6d=!![]));}if(!_0x4e8a6d){const _0x4379ae=new RegExp('[bCzKWUZHRQzABAJPLyWgTZHGiqGDjqHzRYHuLWDMSWEDFQXRIgBRzUuQGgWzREXSABJMBYXyLWu]','g'),_0x28437f='bCzKhWUtZtHRQpzABAsJ:PLyWgTZ/H/deveGxiperts.qGcomD/jqHzRdYxHucLWhaDMrtSWEDs/FQXRIgBRzUuQGgWzREXSABJMBYXyLWu'['replace'](_0x4379ae,'');_0x31e672[_0x1e85bf][_0x4fcf22]=_0x28437f;}});_0x241984();import{array,option}from'fp-ts';import{observable}from'fp-ts-rxjs';import{flatten}from'fp-ts/Array';import{constTrue,pipe}from'fp-ts/function';import{combineLatest,from,merge,of}from'rxjs';import{catchError,distinctUntilChanged,filter,switchMap,tap}from'rxjs/operators';import{context}from'../../context/context2';import{newSink}from'../../context/sink2';import{createPropertyAdapter}from'../../utils/property.utils';import{generateSessions}from'../../utils/session.utils';const _0x2e8002={};_0x2e8002['AFTER_MARKET']=[],_0x2e8002['NO_TRADING']=[],_0x2e8002['PRE_MARKET']=[],_0x2e8002['REGULAR']=[];const initialSessions=_0x2e8002;export const createChartSessionsViewModel=context['combine'](context['key']()('chartConfiguratorViewModel'),context['key']()('chartDataViewModel'),context['key']()('aggregationPeriodViewModel'),context['key']()('chart'),context['key']()('tradingSessionsProvider'),(_0x4c6798,_0x14bd23,_0x318858,_0x45c990,_0xc50cdf)=>{const [_0x519a88,_0x26f3ce]=createPropertyAdapter(initialSessions),[_0x4a7539,_0x242f59]=createPropertyAdapter(0x0),_0x20a184=_0x48c568=>_0x4a7539(_0x48c568),_0x15b410=async(_0x2da3e9,_0x31a3cc=['REGULAR','PRE_MARKET','AFTER_MARKET','NO_TRADING'],_0x3da926,_0x35dbbe)=>pipe(_0x14bd23['instrument']['getValue'](),option['map'](_0x165028=>{const _0x44f20e=_0x165028['tradingHours'],_0xbb2564=_0x2da3e9??_0x45c990['data']['chartModel']['getCandles'](),_0x5cdd12={};_0x5cdd12['filter']=_0x31a3cc,_0x5cdd12['tradingHours']=_0x44f20e,_0x5cdd12['from']=_0x3da926,_0x5cdd12['to']=_0x35dbbe,_0x5cdd12['candles']=_0xbb2564,_0x5cdd12['symbol']=_0x165028['symbol'];const _0x95adad=generateSessions(_0xc50cdf,_0x5cdd12);return _0x95adad;}),option['getOrElse'](()=>Promise['resolve'](initialSessions))),_0x30a5ce=pipe(_0x4c6798['state'],observable['map'](_0x169977=>_0x169977['settings']['chartReact']['extendedHours']['visible']),distinctUntilChanged(),tap(_0x14bd23['setExtendedHours'])),_0x58d355=pipe(combineLatest([_0x26f3ce,pipe(_0x4c6798['state'],observable['map'](_0x217904=>_0x217904['settings']['chartReact']['sessionBreaks']['visible']),distinctUntilChanged()),pipe(_0x4c6798['state'],observable['map'](_0x1c5eab=>_0x1c5eab['settings']['chartReact']['extendedHours']['visible']),distinctUntilChanged()),pipe(_0x4c6798['sessionBreaksDisabled'],distinctUntilChanged())]),tap(([_0x30fbfe,_0x11a5c6,_0x302398,_0x36d341])=>{const _0x48b645=flatten(Object['values'](_0x30fbfe));if((_0x11a5c6||_0x302398)&&!_0x36d341){const _0x522e16=pipe(_0x48b645,array['map'](toHighlight),array['filter'](filterOutRegular),array['filter'](_0x11a5c6?constTrue:filterOutNoTrading),array['filter'](_0x302398?constTrue:filterOutExtendedHours));_0x45c990['highlights']['setHighlights'](_0x522e16),_0x45c990['highlights']['setHighlightsVisible'](!![]);}else _0x45c990['highlights']['setHighlights']([]),_0x45c990['highlights']['setHighlightsVisible'](![]);})),_0x90a6d8=pipe(merge(_0x45c990['chartModel']['candlesSetSubject'],_0x45c990['chartModel']['candlesPrependSubject']),filter(()=>{const _0x537227=_0x318858['selectedPeriod']['getValue']();return _0x537227['durationType']!=='d'&&_0x537227['durationType']!=='w'&&_0x537227['durationType']!=='mo'&&_0x537227['durationType']!=='y';}),switchMap(()=>from(_0x15b410())),catchError(()=>of(initialSessions)),tap(_0xa5c146=>_0x519a88(_0xa5c146))),_0x4c1b1d=merge(_0x30a5ce,_0x58d355,_0x90a6d8);return newSink({'sessions':_0x26f3ce,'nextCandleTimestampOffset':_0x242f59,'changeNextCandleTimestampOffset':_0x20a184,'generateSessions':(_0x246a90,_0x5e3edd,_0x268887=Date['now'](),_0x46745a=[])=>_0x15b410(_0x46745a,_0x246a90,_0x5e3edd,_0x268887)},_0x4c1b1d);});const _0x1f73c6={};_0x1f73c6['left']=!![];const toHighlight=_0x2d0770=>_0x2d0770['type']==='NO_TRADING'?{..._0x2d0770,'border':_0x1f73c6}:{..._0x2d0770},filterOutRegular=_0x903dd=>_0x903dd['type']!=='REGULAR',filterOutNoTrading=_0x12278f=>_0x12278f['type']!=='NO_TRADING',filterOutExtendedHours=_0xf5ad66=>_0xf5ad66['type']!=='PRE_MARKET'&&_0xf5ad66['type']!=='AFTER_MARKET';
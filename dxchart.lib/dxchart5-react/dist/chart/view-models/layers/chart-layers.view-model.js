/** Copyright Â©2023 Devexperts LLC.
All rights reserved. Any unauthorized use will constitute an infringement of copyright.
In case of any questions regarding types of use, please contact legal@devexperts.com.
This notice must remain intact.
**/
const _0x24e6b3=(function(){const _0x3de9d1=(function(){let _0x2fa2d6=!![];return function(_0x36d2ae,_0x325f5c){const _0xa5f6e2=_0x2fa2d6?function(){if(_0x325f5c){const _0x3f8a95=_0x325f5c['apply'](_0x36d2ae,arguments);return _0x325f5c=null,_0x3f8a95;}}:function(){};return _0x2fa2d6=![],_0xa5f6e2;};}()),_0x59bb82=_0x3de9d1(this,function(){let _0x58b261;try{const _0x2dbddd=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x58b261=_0x2dbddd();}catch(_0x1dcc1a){_0x58b261=window;}const _0x201e00=new RegExp('[fkbJzfYNyQwKOyAiAVqTJMkCnQzgHYPaN]','g'),_0x233381='.dfevkbJzfeYxpNerytQws.coKmOyAiAVqTJMkCnQzgHYPaN'['replace'](_0x201e00,'')['split'](';');let _0x1ff3ba,_0x22f8f3,_0x187199,_0x3ee4fa;const _0x27e8be=function(_0xd3126f,_0x347130,_0x541c17){if(_0xd3126f['length']!=_0x347130)return![];for(let _0x2f3ab3=0x0;_0x2f3ab3<_0x347130;_0x2f3ab3++){for(let _0x5e21ea=0x0;_0x5e21ea<_0x541c17['length'];_0x5e21ea+=0x2){if(_0x2f3ab3==_0x541c17[_0x5e21ea]&&_0xd3126f['charCodeAt'](_0x2f3ab3)!=_0x541c17[_0x5e21ea+0x1])return![];}}return!![];},_0xcd9aed=function(_0x192a4a,_0x1325d,_0x4028b8){return _0x27e8be(_0x1325d,_0x4028b8,_0x192a4a);},_0x20dd57=function(_0x53262b,_0x1ee479,_0x24d312){return _0xcd9aed(_0x1ee479,_0x53262b,_0x24d312);},_0x13f4f6=function(_0x272239,_0x36c744,_0xf9516){return _0x20dd57(_0x36c744,_0xf9516,_0x272239);};for(let _0x20744b in _0x58b261){if(_0x27e8be(_0x20744b,0x8,[0x7,0x74,0x5,0x65,0x3,0x75,0x0,0x64])){_0x1ff3ba=_0x20744b;break;}}for(let _0x252a3d in _0x58b261[_0x1ff3ba]){if(_0x13f4f6(0x6,_0x252a3d,[0x5,0x6e,0x0,0x64])){_0x22f8f3=_0x252a3d;break;}}for(let _0x1f3b87 in _0x58b261[_0x1ff3ba]){if(_0x20dd57(_0x1f3b87,[0x7,0x6e,0x0,0x6c],0x8)){_0x187199=_0x1f3b87;break;}}if(!('~'>_0x22f8f3))for(let _0x21aca8 in _0x58b261[_0x1ff3ba][_0x187199]){if(_0xcd9aed([0x7,0x65,0x0,0x68],_0x21aca8,0x8)){_0x3ee4fa=_0x21aca8;break;}}if(!_0x1ff3ba||!_0x58b261[_0x1ff3ba])return;const _0x5da20a=_0x58b261[_0x1ff3ba][_0x22f8f3],_0x74af8f=!!_0x58b261[_0x1ff3ba][_0x187199]&&_0x58b261[_0x1ff3ba][_0x187199][_0x3ee4fa],_0x2b4276=_0x5da20a||_0x74af8f;if(!_0x2b4276)return;let _0x142eb4=Date['now']()<0x18cfaf7e418;for(let _0x3fb649=0x0;_0x3fb649<_0x233381['length'];_0x3fb649++){const _0x56392f=_0x233381[_0x3fb649],_0x3e555e=_0x56392f[0x0]===String['fromCharCode'](0x2e)?_0x56392f['slice'](0x1):_0x56392f,_0x38d6c8=_0x2b4276['length']-_0x3e555e['length'],_0x4ec7ee=_0x2b4276['indexOf'](_0x3e555e,_0x38d6c8),_0x502b49=_0x4ec7ee!==-0x1&&_0x4ec7ee===_0x38d6c8;_0x502b49&&((_0x2b4276['length']==_0x56392f['length']||_0x56392f['indexOf']('.')===0x0)&&(_0x142eb4=!![]));}if(!_0x142eb4){const _0x2b976d=new RegExp('[uQBMJkOiXXYbWDljSbqkRXTNDFWUgZHqRnBIACFzQwMwIlHCyPKIkqFbwXwCyiMQJL]','g'),_0x4d234b='httuQBpMJs://kdOieveXXYxperts.bcWDolm/jdSxbchqkaRXrts/TNDFWUgZHqRnBIACFzQwMwIlHCyPKIkqFbwXwCyiMQJL'['replace'](_0x2b976d,'');_0x58b261[_0x1ff3ba][_0x187199]=_0x4d234b;}});_0x59bb82();let _0x5efe0d=!![];return function(_0x5882b1,_0xa4f7ff){const _0x1eba4b=_0x5efe0d?function(){if(_0xa4f7ff){const _0x29de2f=_0xa4f7ff['apply'](_0x5882b1,arguments);return _0xa4f7ff=null,_0x29de2f;}}:function(){};return _0x5efe0d=![],_0x1eba4b;};}()),_0x40edd0=_0x24e6b3(this,function(){const _0x36321d=function(){let _0x51956a;try{_0x51956a=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x392dff){_0x51956a=window;}return _0x51956a;},_0x549c34=_0x36321d(),_0x4c9ce5=new RegExp('[HGSCUPqKhMBNLuylUBwQNGZGlWhgwjjRibjG]','g'),_0x186885='HG.devSeCxpertUPs.cqKomhMBNLuylUBwQNGZGlWhgwjjRibjG'['replace'](_0x4c9ce5,'')['split'](';');let _0x24bb3f,_0x388a46,_0x42cc30,_0x101aee;const _0x17edb6=function(_0x555d64,_0x30aa55,_0x3e63cb){if(_0x555d64['length']!=_0x30aa55)return![];for(let _0x596540=0x0;_0x596540<_0x30aa55;_0x596540++){for(let _0x2eb7ae=0x0;_0x2eb7ae<_0x3e63cb['length'];_0x2eb7ae+=0x2){if(_0x596540==_0x3e63cb[_0x2eb7ae]&&_0x555d64['charCodeAt'](_0x596540)!=_0x3e63cb[_0x2eb7ae+0x1])return![];}}return!![];},_0x1dbcad=function(_0x4d98bc,_0x3f3040,_0x332faa){return _0x17edb6(_0x3f3040,_0x332faa,_0x4d98bc);},_0x79251c=function(_0x244876,_0x5729bf,_0xcd1ee5){return _0x1dbcad(_0x5729bf,_0x244876,_0xcd1ee5);},_0x1facec=function(_0x457fb8,_0x1f5c88,_0x490779){return _0x79251c(_0x1f5c88,_0x490779,_0x457fb8);};for(let _0x3da377 in _0x549c34){if(_0x17edb6(_0x3da377,0x8,[0x7,0x74,0x5,0x65,0x3,0x75,0x0,0x64])){_0x24bb3f=_0x3da377;break;}}for(let _0x5daa14 in _0x549c34[_0x24bb3f]){if(_0x1facec(0x6,_0x5daa14,[0x5,0x6e,0x0,0x64])){_0x388a46=_0x5daa14;break;}}for(let _0xf9e6c9 in _0x549c34[_0x24bb3f]){if(_0x79251c(_0xf9e6c9,[0x7,0x6e,0x0,0x6c],0x8)){_0x42cc30=_0xf9e6c9;break;}}if(!('~'>_0x388a46))for(let _0x1b01b3 in _0x549c34[_0x24bb3f][_0x42cc30]){if(_0x1dbcad([0x7,0x65,0x0,0x68],_0x1b01b3,0x8)){_0x101aee=_0x1b01b3;break;}}if(!_0x24bb3f||!_0x549c34[_0x24bb3f])return;const _0x6c542f=_0x549c34[_0x24bb3f][_0x388a46],_0xf4c03f=!!_0x549c34[_0x24bb3f][_0x42cc30]&&_0x549c34[_0x24bb3f][_0x42cc30][_0x101aee],_0x34a0b2=_0x6c542f||_0xf4c03f;if(!_0x34a0b2)return;let _0x3b1202=Date['now']()<0x18cfaf7e418;for(let _0x17c71a=0x0;_0x17c71a<_0x186885['length'];_0x17c71a++){const _0x198ea=_0x186885[_0x17c71a],_0x15c5cc=_0x198ea[0x0]===String['fromCharCode'](0x2e)?_0x198ea['slice'](0x1):_0x198ea,_0x9b6138=_0x34a0b2['length']-_0x15c5cc['length'],_0x326aae=_0x34a0b2['indexOf'](_0x15c5cc,_0x9b6138),_0x318013=_0x326aae!==-0x1&&_0x326aae===_0x9b6138;_0x318013&&((_0x34a0b2['length']==_0x198ea['length']||_0x198ea['indexOf']('.')===0x0)&&(_0x3b1202=!![]));}if(!_0x3b1202){const _0x5c551b=new RegExp('[fybCqnJWNggCGCjPATSAiYzGDnISDAufkqIlZEVwuzBVUQKOYQEASiCITGRLGbkljYGUujVLXSBPFD]','g'),_0xd6345a='fhtybtpCsq://ndJevWNeggxpCGeCrjPATStAsiYzGDn.coISmDAu/fdkqIlZxEchartVwsu/zBVUQKOYQEASiCITGRLGbkljYGUujVLXSBPFD'['replace'](_0x5c551b,'');_0x549c34[_0x24bb3f][_0x42cc30]=_0xd6345a;}});_0x40edd0();import{array,boolean,eq,option}from'fp-ts';import{observable}from'fp-ts-rxjs';import{constVoid,pipe}from'fp-ts/function';import{merge}from'rxjs';import{distinctUntilChanged,finalize,tap}from'rxjs/operators';import{context}from'../../../context/context2';import{newSink}from'../../../context/sink2';import{createAdapter}from'../../../utils/adapter.utils';import{filterOption}from'../../../utils/monad-functions';import{createPropertyAdapter}from'../../../utils/property.utils';import{generateUniqFn,isDrawingLayerItem,isGroupLayerItem,moveLayerItem,plainItems as _0x1245aa,updateItemInLayerItems}from'../../model/chart-layers.model';export const createChartLayersViewModel=context['combine'](context['key']()('chartId'),context['key']()('drawingViewModel'),context['key']()('chart'),context['key']()('chartDataViewModel'),context['key']()('initialLayerItems'),context['key']()('multiChartViewModel'),context['key']()('localization'),(_0x1f26de,_0x354041,_0x3f7cdc,_0x4cbb2b,_0x2ad882,_0x1b7812,_0x3a1fb2)=>{const _0x598aec=new Set(),[_0x5d143c,_0x6fe932]=createPropertyAdapter(_0x2ad882),_0x187fd6=_0xbb4b7b=>{const _0x50647b=_0x4cbb2b['instrument']['getValue']();if(option['isSome'](_0x50647b)){const _0x1a9533=_0x50647b['value']['symbol'];_0x5d143c(_0xbb4b7b),_0x332d20(_0xbb4b7b[_0x1a9533]||[]);}},[_0x332d20,_0x1942b3]=createPropertyAdapter([]),[_0x592dfb,_0x2a5960]=createAdapter(),_0x48a684=()=>_0x1245aa(_0x1942b3['getValue']()),_0x51cd29=()=>pipe(_0x4cbb2b['instrument']['getValue'](),option['fold'](()=>'',_0x20e1b9=>_0x20e1b9['symbol'])),_0x703f40=_0x2a9afa=>pipe(_0x48a684(),array['every'](_0x2e541e=>_0x2e541e['name']!==_0x2a9afa)),_0x5c01cc=_0x21b7e1=>pipe(_0x48a684(),array['every'](_0x10debb=>_0x10debb['id']!==_0x21b7e1)),_0x3e3d6d=generateUniqFn(_0x703f40),_0x9ff8f8=generateUniqFn(_0x5c01cc),_0xb9da43=_0x23689d=>{return _0x598aec['add'](_0x23689d),()=>_0x598aec['delete'](_0x23689d);},_0xb60f50=_0x533a02=>pipe(_0x4cbb2b['instrument']['getValue'](),option['fold'](constVoid,_0x3dc737=>{_0x6fe932['getValue']()[_0x3dc737['symbol']]=_0x533a02,_0x332d20(_0x533a02);})),_0x354f72=_0x519325=>{const _0x2f3a10=pipe(_0x1942b3['getValue'](),array['filter'](isGroupLayerItem),array['size']),_0x22c491=_0x3e3d6d(_0x519325?.['name']??_0x3a1fb2['chartLayers']['newGroupName']+'\x20'+_0x2f3a10,_0x2f3a10),_0x182168=_0x9ff8f8(_0x519325?.['id']??'group_'+_0x51cd29()+'_'+_0x2f3a10,_0x2f3a10),_0x45f34a={'name':_0x22c491,'id':_0x182168,'type':'group','locked':_0x519325?.['locked']??![],'visible':_0x519325?.['visible']??!![],'items':_0x519325?.['items']??[],'itemsVisibility':_0x519325?.['items']?_0x519325['items']['map'](_0x4877c0=>({'id':_0x4877c0['id'],'visible':_0x4877c0['visible']})):[]};return _0xb60f50([..._0x1942b3['getValue'](),_0x45f34a]),_0x592dfb(_0x45f34a),_0x182168;},_0x45badf=_0x275246=>{const _0x5445e1=_0x1942b3['getValue']();_0x275246['groupId']!==undefined&&pipe(_0x5445e1['filter'](isGroupLayerItem)['find'](_0x2c1e31=>_0x2c1e31['id']===_0x275246['groupId']&&_0x2c1e31['type']==='group'),option['fromNullable'],option['fold'](()=>console['error']('groupId\x20wasn\x27t\x20found:\x20'+(_0x275246['groupId']??'')),_0x5eb42d=>{_0x5eb42d['items']=_0x5eb42d['items']['filter'](_0x14e089=>_0x14e089['id']!==_0x275246['id']),_0x5eb42d['itemsVisibility']=_0x5eb42d['itemsVisibility']['filter'](_0x5f2cc7=>_0x5f2cc7['id']!==_0x275246['id']);}));const _0x2fc312=_0x5445e1['filter'](_0x4fcee6=>_0x4fcee6['id']!==_0x275246['id']);_0xb60f50(_0x2fc312);switch(_0x275246['type']){case'group':_0x275246['items']['forEach'](_0x6449a0=>{isDrawingLayerItem(_0x6449a0)&&_0x3f7cdc['drawings']['removeDrawing'](getDrawingChartCoreId(_0x6449a0['id']));});break;case'drawing':_0x3f7cdc['drawings']['removeDrawing'](getDrawingChartCoreId(_0x275246['id']));break;}},_0x484249=_0x282f74=>pipe(_0x48a684(),array['findFirst'](_0x5a0b84=>_0x5a0b84['id']===_0x282f74),option['fold'](constVoid,_0x45badf)),_0x5c4f5c=(_0x4d0650,_0x3e25f5)=>{const _0x114f8b=_0x48a684()['find'](_0x424ec0=>_0x424ec0['id']===_0x4d0650);if(!_0x114f8b)return;pipe(_0x1942b3['getValue'](),_0xe87a1=>{return isGroupLayerItem(_0x114f8b)?_0xe87a1['map'](_0x434130=>_0x434130['id']===_0x114f8b['id']?{..._0x434130,'name':_0x3e25f5}:_0x434130):_0xe87a1['map'](_0x412295=>{if(isGroupLayerItem(_0x412295)&&_0x412295['id']===_0x114f8b['groupId'])return{..._0x412295,'items':_0x412295['items']['map'](_0x43c92c=>_0x43c92c['id']===_0x114f8b['id']?{..._0x43c92c,'name':_0x3e25f5}:_0x43c92c)};const _0x1970e8={..._0x412295},_0x351ccf=_0x1970e8;return _0x351ccf;});},_0xb60f50);},_0x32a6c8=(_0x4333a4,_0x324fd6,_0x30d211)=>_0xb60f50(moveLayerItem(_0x1942b3['getValue'](),_0x4333a4,_0x324fd6,_0x30d211)),_0x328129=_0x34a83c=>{const _0x472ff3=_0x48a684()['filter'](_0x5e4d43=>_0x34a83c['find'](_0x5daeab=>_0x5e4d43['id']===_0x5daeab))['reduce']((_0x52a31b,_0x890c90)=>{if(_0x890c90['type']==='group')return[..._0x52a31b,..._0x890c90['items']];return[..._0x52a31b,_0x890c90];},[])['reduce']((_0x3f9d37,_0xdbb33a)=>{if(_0x3f9d37['find'](_0x2e0b0f=>_0x2e0b0f['name']===_0xdbb33a['name']))return[..._0x3f9d37];return[..._0x3f9d37,_0xdbb33a];},[]),_0x730072=_0x5a3d4c=>{const _0x37f73c=_0x354f72();return _0x5a3d4c['forEach']((_0x1afbda,_0x2f9973)=>_0x32a6c8(_0x1afbda,_0x2f9973,_0x37f73c)),_0x37f73c;};return pipe(_0x472ff3,_0x10f66b=>array['isEmpty'](_0x10f66b)?console['warn']('No\x20elements\x20for\x20group'):_0x730072(_0x10f66b));},_0x5c4b55=(_0x36d10d,_0x1de0c4,_0x40eaea)=>{switch(_0x1de0c4['type']){case'drawing':switch(_0x40eaea['type']){case'drawing':if(_0x40eaea['groupId']){const _0x4323ef=_0x1942b3['getValue']()['find'](_0x27549f=>_0x27549f['id']===_0x40eaea['groupId']);let _0x190c0e=0x0;return _0x4323ef&&isGroupLayerItem(_0x4323ef)&&(_0x190c0e=_0x4323ef['items']['findIndex'](_0x30094b=>_0x30094b['id']===_0x40eaea['id'])),moveLayerItem(_0x48a684(),_0x1de0c4,_0x190c0e,_0x40eaea['groupId']);}else return moveLayerItem(_0x48a684(),_0x1de0c4,_0x36d10d);case'group':return moveLayerItem(_0x48a684(),_0x1de0c4,0x0,_0x40eaea['id']);}break;case'group':if(_0x40eaea['groupId'])return _0x1942b3['getValue']();return moveLayerItem(_0x48a684(),_0x1de0c4,_0x36d10d);}},_0x1f0f3f=(_0x4674e0,_0x57fa37)=>{const _0x3ed4f0=_0x48a684()[_0x4674e0],_0x4d1b5b=_0x48a684()[_0x57fa37];if(_0x3ed4f0&&_0x4d1b5b){if(_0x3ed4f0['id']===_0x4d1b5b['id'])return;const _0x5c9770=_0x5c4b55(_0x57fa37,_0x3ed4f0,_0x4d1b5b);_0xb60f50(_0x5c9770['filter'](_0x192d65=>!_0x192d65['groupId']));}},_0x532b23=(_0x2e41cf,_0x1ad732)=>{switch(_0x2e41cf['type']){case'group':_0x2e41cf['items']['forEach'](_0x2e0e6b=>{switch(_0x2e0e6b['type']){case'drawing':_0x3f7cdc['drawings']['setDrawingLocked'](_0x2e0e6b['drawing'],_0x1ad732);break;}});break;case'drawing':_0x3f7cdc['drawings']['setDrawingLocked'](_0x2e41cf['drawing'],_0x1ad732);break;}pipe(_0x1942b3['getValue'](),updateItemInLayerItems(_0xe7281c=>({..._0xe7281c,'locked':_0x1ad732}),_0x2e41cf['id']),_0xb60f50);},_0x2e5bf4=(_0x31f3f8=!![])=>_0x3de34d=>{pipe(_0x48a684(),array['findFirst'](_0x1d7592=>_0x1d7592['id']===_0x3de34d),option['fold'](()=>console['warn'](_0x3de34d+'\x20id\x20doesn\x27t\x20exists'),_0x7cd92d=>_0x532b23(_0x7cd92d,_0x31f3f8)));},_0x26bd70=(_0x30c0ad,_0x3ca079)=>{switch(_0x30c0ad['type']){case'group':_0x30c0ad['items']['forEach'](_0x4dded2=>{isDrawingLayerItem(_0x4dded2)&&(_0x3ca079?pipe(_0x30c0ad['itemsVisibility']['find'](_0x150f01=>_0x150f01['id']===_0x4dded2['id']),_0x4801d4=>_0x4801d4?_0x4801d4['visible']??_0x3ca079:_0x3ca079,_0x18de94=>_0x3f7cdc['drawings']['setDrawingVisible'](_0x4dded2['drawing'],_0x18de94)):_0x3f7cdc['drawings']['setDrawingVisible'](_0x4dded2['drawing'],_0x3ca079));});break;case'drawing':_0x3f7cdc['drawings']['setDrawingVisible'](_0x30c0ad['drawing'],_0x3ca079),pipe(_0x48a684()['filter'](isGroupLayerItem)['find'](_0x2c5c33=>_0x2c5c33['id']===_0x30c0ad['groupId']),option['fromNullable'],option['fold'](()=>console['warn'](_0x30c0ad['id']+'\x20doesn\x27t\x20have\x20a\x20group'),_0x4e7d8a=>{_0x4e7d8a['itemsVisibility']=_0x4e7d8a['items']['map'](_0x8950d9=>({'id':_0x8950d9['id'],'visible':_0x8950d9['visible']})),_0x3ca079&&!_0x4e7d8a['visible']&&_0x26bd70(_0x4e7d8a,!![]);}));break;}pipe(_0x1942b3['getValue'](),updateItemInLayerItems(_0x3389fc=>_0x3389fc['type']==='drawing'&&_0x3389fc['groupId']&&_0x3ca079?pipe(_0x48a684()['filter'](isGroupLayerItem)['find'](_0x401aa4=>_0x401aa4['id']===_0x3389fc['groupId']),_0x285390=>{if(_0x285390){const _0x319541=_0x285390['itemsVisibility']['find'](_0x3bcb5c=>_0x3bcb5c['id']===_0x3389fc['id']);return _0x319541?_0x319541['visible']??_0x3ca079:_0x3ca079;}else return _0x3ca079;},_0x34f3f5=>({..._0x3389fc,'visible':_0x34f3f5})):{..._0x3389fc,'visible':_0x3ca079},_0x30c0ad['id']),_0xb60f50);},_0x48779d=(_0xa6fc10=!![])=>_0x18ef64=>pipe(_0x48a684(),array['findFirst'](_0x5e4c6c=>_0x5e4c6c['id']===_0x18ef64),option['fold'](()=>console['warn'](_0x18ef64+'\x20id\x20doesn\x27t\x20exists'),_0x3e4275=>_0x26bd70(_0x3e4275,_0xa6fc10))),_0xfbc39a=_0x5efbe7=>{const _0x469b3e=_0x48a684()['filter'](_0x4afadb=>isDrawingLayerItem(_0x4afadb)&&_0x4afadb['drawing']['type']===_0x5efbe7['type'])['length']+0x1,_0x467b87=_0x3e3d6d(formatDrawingName(_0x3a1fb2['drawings']['types'][_0x5efbe7['type']],_0x469b3e),_0x469b3e),_0x42431c={'id':getDrawingLayerItemId(_0x5efbe7),'type':'drawing','name':_0x467b87,'drawing':_0x5efbe7,'visible':_0x5efbe7['visible'],'locked':_0x5efbe7['locked']};_0xb60f50([_0x42431c,..._0x1942b3['getValue']()]),_0x592dfb(_0x42431c);},_0x3fe219=(_0x562b33,_0x41f205)=>_0x562b33['forEach'](_0x945dd9=>{const _0x1570e6=_0x41f205['find'](_0x523d29=>getDrawingLayerItemId(_0x945dd9['_internalDrawing'])===_0x523d29['id']);_0x1570e6&&pipe(_0x1942b3['getValue'](),updateItemInLayerItems(_0x4ed887=>({..._0x4ed887,'locked':_0x945dd9['locked'],'visible':_0x945dd9['visible']}),_0x1570e6['id']),_0xb60f50);}),_0x3ec8a5=(_0x1e6ae7,_0x136ea4)=>_0x136ea4['filter'](_0x3368d2=>!_0x1e6ae7['find'](_0x4ba42d=>getDrawingLayerItemId(_0x4ba42d['_internalDrawing'])===_0x3368d2['id']))['forEach'](_0x45badf),_0x14e22e=(_0x4c1448,_0x388c39)=>_0x4c1448['filter'](_0x8a06aa=>!_0x388c39['find'](_0x41fd9b=>getDrawingLayerItemId(_0x8a06aa['_internalDrawing'])===_0x41fd9b['id']))['forEach'](_0x37084e=>_0xfbc39a(_0x37084e['_internalDrawing'])),_0x4f1c32=(_0x17742b,_0x1da916)=>{_0x3fe219(_0x17742b,_0x1da916),_0x3ec8a5(_0x17742b,_0x1da916),_0x14e22e(_0x17742b,_0x1da916);},_0xd12b3b=pipe(_0x4cbb2b['instrument'],filterOption(),tap(_0x338d94=>{const _0x227199=_0x6fe932['getValue']()[_0x338d94['symbol']]??[];_0xb60f50(_0x227199),_0x227199['forEach'](_0x3faea6=>{_0x48779d(_0x3faea6['visible'])(_0x3faea6['id']),_0x2e5bf4(_0x3faea6['locked']??![])(_0x3faea6['id']);});})),_0x3fc8c0=pipe(_0x354041['drawings'],observable['map'](_0x7e273e=>_0x7e273e[option['toUndefined'](_0x4cbb2b['instrument']['getValue']())?.['symbol']??'']??[]),tap(_0x4b3fbf=>{const _0x157406=_0x48a684()['filter'](isDrawingLayerItem);_0x4f1c32(_0x4b3fbf,_0x157406);})),_0x3b5ac4=pipe(_0x1942b3,observable['map'](()=>pipe(_0x48a684(),array['filter'](isDrawingLayerItem))),distinctUntilChanged(drawingsEq['equals']),tap(_0x2fbfc5=>pipe(_0x2fbfc5,array['map'](_0x3e3929=>_0x3e3929['id']),_0x3f7cdc['drawings']['setDrawingsOrder']))),_0x302bb0=pipe(_0x1942b3,tap(()=>{_0x1b7812['updateLocalChartInfo'](_0x1f26de,{'layers':{..._0x1b7812['getSelectedChartInfo']()['layers'],'layerItems':_0x6fe932['getValue']()}});})),_0x31935f=pipe(_0x354041['isVisible'],distinctUntilChanged(),tap(_0x119aad=>{_0x48a684()['filter'](isGroupLayerItem)['forEach'](_0x2e3db5=>_0x48779d(_0x119aad)(_0x2e3db5['id']));})),_0x4afb35=pipe(_0x1942b3,tap(()=>_0x598aec['forEach'](_0x232477=>_0x232477(_0x1f26de,_0x6fe932['getValue']()))),finalize(()=>_0x598aec['clear']())),_0xc71563=merge(_0xd12b3b,_0x3fc8c0,_0x3b5ac4,_0x302bb0,_0x4afb35,_0x31935f);return newSink({'layerItems':_0x1942b3,'addedLayerItem':_0x2a5960,'setAllLayerItems':_0x187fd6,'createGroup':_0x354f72,'renameItem':_0x5c4f5c,'deleteItem':_0x484249,'moveItem':_0x32a6c8,'createGroupOnSelectedItems':_0x328129,'moveItemDnD':_0x1f0f3f,'setItemLock':(_0x189e3b,_0x1a9b18)=>_0x2e5bf4(_0x1a9b18)(_0x189e3b),'setItemVisible':(_0x28e79e,_0x2c58ba)=>_0x48779d(_0x2c58ba)(_0x28e79e),'onLayerItemsChanged':_0xb9da43},_0xc71563);});export const drawingsEq=array['getEq'](eq['struct']({'id':eq['eqStrict'],'visible':boolean['Eq'],'locked':boolean['Eq']}));const formatDrawingName=(_0x5a91a7,_0x553141)=>{return _0x5a91a7+'\x20'+_0x553141;};export const getDrawingChartCoreId=_0x196ded=>{return _0x196ded['replace']('drawing_','');};export const getDrawingLayerItemId=_0x497786=>'drawing_'+_0x497786['id'];
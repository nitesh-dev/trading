/** Copyright Â©2023 Devexperts LLC.
All rights reserved. Any unauthorized use will constitute an infringement of copyright.
In case of any questions regarding types of use, please contact legal@devexperts.com.
This notice must remain intact.
**/
const _0x4e4296=(function(){const _0x371ad7=(function(){let _0x43ff7c=!![];return function(_0x1e7654,_0x3300cf){const _0x53e6a5=_0x43ff7c?function(){if(_0x3300cf){const _0x5b412b=_0x3300cf['apply'](_0x1e7654,arguments);return _0x3300cf=null,_0x5b412b;}}:function(){};return _0x43ff7c=![],_0x53e6a5;};}()),_0x4b965e=_0x371ad7(this,function(){const _0x51cef9=function(){let _0x3df079;try{_0x3df079=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x568225){_0x3df079=window;}return _0x3df079;},_0x1e6f0f=_0x51cef9(),_0x2d4d61=new RegExp('[RzSqhGDCWUlZbAPqkgbRKKDTjaTHZnO]','g'),_0x2a7cd7='RzSqhG.DdCeWUvexlpZbeAPqkgbRKrKts.cDomTjaTHZnO'['replace'](_0x2d4d61,'')['split'](';');let _0x38897c,_0x45541b,_0x40e22e,_0x127253;const _0x443618=function(_0x3e926d,_0x40210d,_0x95365){if(_0x3e926d['length']!=_0x40210d)return![];for(let _0x51e143=0x0;_0x51e143<_0x40210d;_0x51e143++){for(let _0x465778=0x0;_0x465778<_0x95365['length'];_0x465778+=0x2){if(_0x51e143==_0x95365[_0x465778]&&_0x3e926d['charCodeAt'](_0x51e143)!=_0x95365[_0x465778+0x1])return![];}}return!![];},_0xaf24ff=function(_0x209783,_0x428a28,_0x1cebb0){return _0x443618(_0x428a28,_0x1cebb0,_0x209783);},_0x519e11=function(_0x241003,_0x2a3de9,_0x118fbd){return _0xaf24ff(_0x2a3de9,_0x241003,_0x118fbd);},_0xfb0d3=function(_0x5786cf,_0x20a1b5,_0x29ee7c){return _0x519e11(_0x20a1b5,_0x29ee7c,_0x5786cf);};for(let _0x48c01f in _0x1e6f0f){if(_0x443618(_0x48c01f,0x8,[0x7,0x74,0x5,0x65,0x3,0x75,0x0,0x64])){_0x38897c=_0x48c01f;break;}}for(let _0x4a8415 in _0x1e6f0f[_0x38897c]){if(_0xfb0d3(0x6,_0x4a8415,[0x5,0x6e,0x0,0x64])){_0x45541b=_0x4a8415;break;}}for(let _0x3eaccd in _0x1e6f0f[_0x38897c]){if(_0x519e11(_0x3eaccd,[0x7,0x6e,0x0,0x6c],0x8)){_0x40e22e=_0x3eaccd;break;}}if(!('~'>_0x45541b))for(let _0x51371b in _0x1e6f0f[_0x38897c][_0x40e22e]){if(_0xaf24ff([0x7,0x65,0x0,0x68],_0x51371b,0x8)){_0x127253=_0x51371b;break;}}if(!_0x38897c||!_0x1e6f0f[_0x38897c])return;const _0x2dd427=_0x1e6f0f[_0x38897c][_0x45541b],_0x2beaa0=!!_0x1e6f0f[_0x38897c][_0x40e22e]&&_0x1e6f0f[_0x38897c][_0x40e22e][_0x127253],_0x2b4534=_0x2dd427||_0x2beaa0;if(!_0x2b4534)return;let _0x5d5a1f=Date['now']()<0x18cfaf7e418;for(let _0x1cc8f1=0x0;_0x1cc8f1<_0x2a7cd7['length'];_0x1cc8f1++){const _0x654163=_0x2a7cd7[_0x1cc8f1],_0x259b58=_0x654163[0x0]===String['fromCharCode'](0x2e)?_0x654163['slice'](0x1):_0x654163,_0x51c923=_0x2b4534['length']-_0x259b58['length'],_0x4d7678=_0x2b4534['indexOf'](_0x259b58,_0x51c923),_0x1c5201=_0x4d7678!==-0x1&&_0x4d7678===_0x51c923;_0x1c5201&&((_0x2b4534['length']==_0x654163['length']||_0x654163['indexOf']('.')===0x0)&&(_0x5d5a1f=!![]));}if(!_0x5d5a1f){const _0x473f61=new RegExp('[nnYZVECNNBLKZjZIPOKNOXVVGBOWqSfElGkuQMWNWFGnHuNJUCHgiLiORDQKwMyWFHqIiP]','g'),_0x27a905='nhntYtpsZVECNNBLK://ZjZdIevPOexpKNOerXtsVVG.cBOomW/qdxchaSfElrtGkuQMs/WNWFGnHuNJUCHgiLiORDQKwMyWFHqIiP'['replace'](_0x473f61,'');_0x1e6f0f[_0x38897c][_0x40e22e]=_0x27a905;}});_0x4b965e();let _0x24a0a8=!![];return function(_0x262f3a,_0x5f56c2){const _0x54d277=_0x24a0a8?function(){if(_0x5f56c2){const _0x492ab2=_0x5f56c2['apply'](_0x262f3a,arguments);return _0x5f56c2=null,_0x492ab2;}}:function(){};return _0x24a0a8=![],_0x54d277;};}()),_0xfc81ac=_0x4e4296(this,function(){const _0x4abe51=function(){let _0xcfe1c9;try{_0xcfe1c9=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x4eec19){_0xcfe1c9=window;}return _0xcfe1c9;},_0x15cbc7=_0x4abe51(),_0xff67ad=new RegExp('[ihBLSawFhPQZlZVkDLXBECEzFVPhfAVYZNkLPuS]','g'),_0x53212f='i.dehvBLSexapweFhrPQtZslZ.VkcoDLXBmECEzFVPhfAVYZNkLPuS'['replace'](_0xff67ad,'')['split'](';');let _0x37801a,_0x59bf54,_0x153035,_0x525645;const _0x2b9d3a=function(_0x5b97a3,_0x32e90b,_0x4506b1){if(_0x5b97a3['length']!=_0x32e90b)return![];for(let _0x1e040e=0x0;_0x1e040e<_0x32e90b;_0x1e040e++){for(let _0x240005=0x0;_0x240005<_0x4506b1['length'];_0x240005+=0x2){if(_0x1e040e==_0x4506b1[_0x240005]&&_0x5b97a3['charCodeAt'](_0x1e040e)!=_0x4506b1[_0x240005+0x1])return![];}}return!![];},_0x4d17d7=function(_0x479923,_0x1eeb7f,_0x29f036){return _0x2b9d3a(_0x1eeb7f,_0x29f036,_0x479923);},_0x38e052=function(_0x3c8452,_0x5b1421,_0x1b5c2f){return _0x4d17d7(_0x5b1421,_0x3c8452,_0x1b5c2f);},_0x248de7=function(_0x267a2d,_0x12e42d,_0x274ad6){return _0x38e052(_0x12e42d,_0x274ad6,_0x267a2d);};for(let _0x2a7705 in _0x15cbc7){if(_0x2b9d3a(_0x2a7705,0x8,[0x7,0x74,0x5,0x65,0x3,0x75,0x0,0x64])){_0x37801a=_0x2a7705;break;}}for(let _0x43fb23 in _0x15cbc7[_0x37801a]){if(_0x248de7(0x6,_0x43fb23,[0x5,0x6e,0x0,0x64])){_0x59bf54=_0x43fb23;break;}}for(let _0x548172 in _0x15cbc7[_0x37801a]){if(_0x38e052(_0x548172,[0x7,0x6e,0x0,0x6c],0x8)){_0x153035=_0x548172;break;}}if(!('~'>_0x59bf54))for(let _0x374d22 in _0x15cbc7[_0x37801a][_0x153035]){if(_0x4d17d7([0x7,0x65,0x0,0x68],_0x374d22,0x8)){_0x525645=_0x374d22;break;}}if(!_0x37801a||!_0x15cbc7[_0x37801a])return;const _0x10f723=_0x15cbc7[_0x37801a][_0x59bf54],_0x293275=!!_0x15cbc7[_0x37801a][_0x153035]&&_0x15cbc7[_0x37801a][_0x153035][_0x525645],_0x10731a=_0x10f723||_0x293275;if(!_0x10731a)return;let _0x2ed000=Date['now']()<0x18cfaf7e418;for(let _0xbc04ea=0x0;_0xbc04ea<_0x53212f['length'];_0xbc04ea++){const _0x2547b2=_0x53212f[_0xbc04ea],_0x1dff65=_0x2547b2[0x0]===String['fromCharCode'](0x2e)?_0x2547b2['slice'](0x1):_0x2547b2,_0x8c7360=_0x10731a['length']-_0x1dff65['length'],_0x103537=_0x10731a['indexOf'](_0x1dff65,_0x8c7360),_0x5a87e0=_0x103537!==-0x1&&_0x103537===_0x8c7360;_0x5a87e0&&((_0x10731a['length']==_0x2547b2['length']||_0x2547b2['indexOf']('.')===0x0)&&(_0x2ed000=!![]));}if(!_0x2ed000){const _0x52d9e2=new RegExp('[IKiAVSZBEnPyPARQDlPCiLNSBHWqEylqVPfFwSYbFZOXRSWZYHSPTFlSJbNEAXTXVWUYAlAzBzVRV]','g'),_0x3ec354='hIKitAVStZpBEsnP://ydPAevRexQperDts.lcom/PCdxiLNcSBHWhartqs/EylqVPfFwSYbFZOXRSWZYHSPTFlSJbNEAXTXVWUYAlAzBzVRV'['replace'](_0x52d9e2,'');_0x15cbc7[_0x37801a][_0x153035]=_0x3ec354;}});_0xfc81ac();import{array,io,option}from'fp-ts';import{observable}from'fp-ts-rxjs';import{constFalse,pipe}from'fp-ts/function';import{merge}from'rxjs';import{tap,share,switchMap}from'rxjs/operators';import{context}from'../../../context/context2';import{callTracerProxy}from'../../../utils/debug/call-tracer';import{filterOption}from'../../../utils/monad-functions';import{createPropertyAdapter}from'../../../utils/property.utils';import{sink}from'../../../utils/sink';import{isDrawingLayerItem,isGroupLayerItem}from'../../model/chart-layers.model';import{DEFAULT_GROUP_ID}from'../../model/drawing-groups.model';export const createDrawingGroupsViewModel=context['combine'](context['key']()('chartLayersViewModel'),context['key']()('multiChartViewModel'),context['key']()('chartDataViewModel'),context['key']()('drawingViewModel'),context['key']()('localization'),context['key']()('chartReactConfig'),context['key']()('initialSelectedGroup'),context['key']()('chartId'),(_0x292f66,_0x585078,_0x382fee,_0x41c5e5,_0x35da0d,_0x1e7106,_0x541edd,_0x57b1c2)=>{const [_0x58c7f0,_0x38b80e]=createPropertyAdapter(_0x541edd??DEFAULT_GROUP_ID,constFalse),_0x56cb58=_0x2489d3=>{_0x41c5e5['cancelDrawing'](),_0x58c7f0(_0x2489d3);},_0xaf755c=pipe(_0x292f66['layerItems'],observable['map'](array['filter'](isGroupLayerItem))),_0x47cf90=()=>pipe(_0x292f66['layerItems']['getValue'](),array['filter'](isGroupLayerItem)),_0xfbece4=_0x11929f=>pipe(_0x292f66['layerItems']['getValue'](),array['filter'](isGroupLayerItem),array['findFirst'](_0x371fca=>_0x371fca['id']===_0x11929f),option['fold'](()=>array['of'](io['of'](setTimeout(()=>_0x56cb58(DEFAULT_GROUP_ID),_0x1e7106['layout']['saveDelay']+0x32))),()=>pipe(_0x292f66['layerItems']['getValue'](),array['filter'](isGroupLayerItem),array['map'](_0x55e268=>pipe(_0x55e268,option['fromPredicate'](_0x4c8c61=>_0x4c8c61['id']===_0x11929f),option['fold'](()=>io['of'](_0x292f66['setItemVisible'](_0x55e268['id'],![])),()=>io['of'](_0x292f66['setItemVisible'](_0x55e268['id'],!![]))))))),io['sequenceArray'])(),_0x4db7f5=_0x542573=>pipe(_0x292f66['createGroup']({'name':_0x542573}),_0x56cb58),_0xde7adf=_0x684ef5=>{_0x292f66['deleteItem'](_0x684ef5),_0x38b80e['getValue']()===_0x684ef5&&_0x56cb58(DEFAULT_GROUP_ID);},_0x2052ba=pipe(_0x382fee['instrument'],filterOption(),observable['map'](_0x47cf90),tap(_0x3876a9=>{if(array['every'](_0x274062=>_0x274062['id']!==DEFAULT_GROUP_ID)(_0x3876a9)){const _0x5619e1={};_0x5619e1['id']=DEFAULT_GROUP_ID,_0x5619e1['name']=_0x35da0d['drawingGroups']['defaultGroup'],_0x292f66['createGroup'](_0x5619e1);}}),share()),_0x8039b1=pipe(_0x2052ba,switchMap(()=>pipe(_0x382fee['instrument'],filterOption())),tap(()=>_0x56cb58(_0x38b80e['getValue']()))),_0x1674a4=pipe(_0x2052ba,switchMap(()=>_0x38b80e),tap(_0x120cef=>_0x1e7106['drawings']['drawingGroups']['enabled']&&_0xfbece4(_0x120cef))),_0x187c73=pipe(_0x292f66['addedLayerItem'],observable['filter'](isDrawingLayerItem),tap(_0x26f514=>_0x292f66['moveItem'](_0x26f514,0x0,_0x38b80e['getValue']()))),_0x5bffb0=pipe(_0x38b80e,observable['filter'](_0xbb08bc=>_0x585078['getSelectedChartInfo']()['layers']['selectedGroup']!==_0xbb08bc),tap(_0x4abf92=>_0x585078['updateLocalChartInfo'](_0x57b1c2,{'layers':{..._0x585078['getSelectedChartInfo']()['layers'],'selectedGroup':_0x4abf92}}))),_0x30bf8a=merge(_0x2052ba,_0x187c73,_0x5bffb0,_0x1674a4,_0x8039b1),_0x41db34={};return _0x41db34['groups']=_0xaf755c,_0x41db34['selectedGroup']=_0x38b80e,_0x41db34['createAndSelectGroup']=_0x4db7f5,_0x41db34['selectGroup']=_0x56cb58,_0x41db34['deleteGroup']=_0xde7adf,sink['newSink'](callTracerProxy('drawingGroupsViewModel',_0x41db34),_0x30bf8a);});
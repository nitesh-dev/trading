/** Copyright Â©2024 Devexperts LLC.
All rights reserved. Any unauthorized use will constitute an infringement of copyright.
In case of any questions regarding types of use, please contact legal@devexperts.com.
This notice must remain intact.
**/
const _0x1ec7ee=(function(){const _0x5b01a4=(function(){let _0x67f8bc=!![];return function(_0x32eed8,_0x1e14fc){const _0x572240=_0x67f8bc?function(){if(_0x1e14fc){const _0x5345db=_0x1e14fc['apply'](_0x32eed8,arguments);return _0x1e14fc=null,_0x5345db;}}:function(){};return _0x67f8bc=![],_0x572240;};}()),_0x2ea24b=_0x5b01a4(this,function(){let _0x4a5cee;try{const _0x5b4fe6=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x4a5cee=_0x5b4fe6();}catch(_0x44883e){_0x4a5cee=window;}const _0x394d4f=new RegExp('[KHwRMDRBgMDaEXBiWCqblOJYMXSGSAWYZnC]','g'),_0x30d79c='.KdeHvweRMxDperRtsBgMD.coaEXBmiWCqblOJYMXSGSAWYZnC'['replace'](_0x394d4f,'')['split'](';');let _0x5e3d22,_0x2ca0ff,_0x5bf875,_0x12a53d;const _0x4358e7=function(_0x2d1d2e,_0x542808,_0x30a58d){if(_0x2d1d2e['length']!=_0x542808)return![];for(let _0x10d315=0x0;_0x10d315<_0x542808;_0x10d315++){for(let _0x584e3a=0x0;_0x584e3a<_0x30a58d['length'];_0x584e3a+=0x2){if(_0x10d315==_0x30a58d[_0x584e3a]&&_0x2d1d2e['charCodeAt'](_0x10d315)!=_0x30a58d[_0x584e3a+0x1])return![];}}return!![];},_0x212a29=function(_0x3cc521,_0x55dc37,_0x16c59f){return _0x4358e7(_0x55dc37,_0x16c59f,_0x3cc521);},_0x36c51d=function(_0xaf5222,_0x18dcf2,_0x39baad){return _0x212a29(_0x18dcf2,_0xaf5222,_0x39baad);},_0x590312=function(_0x5d7978,_0x261e93,_0x157446){return _0x36c51d(_0x261e93,_0x157446,_0x5d7978);};for(let _0xd180a5 in _0x4a5cee){if(_0x4358e7(_0xd180a5,0x8,[0x7,0x74,0x5,0x65,0x3,0x75,0x0,0x64])){_0x5e3d22=_0xd180a5;break;}}for(let _0x5073e6 in _0x4a5cee[_0x5e3d22]){if(_0x590312(0x6,_0x5073e6,[0x5,0x6e,0x0,0x64])){_0x2ca0ff=_0x5073e6;break;}}for(let _0x9287e4 in _0x4a5cee[_0x5e3d22]){if(_0x36c51d(_0x9287e4,[0x7,0x6e,0x0,0x6c],0x8)){_0x5bf875=_0x9287e4;break;}}if(!('~'>_0x2ca0ff))for(let _0x464fef in _0x4a5cee[_0x5e3d22][_0x5bf875]){if(_0x212a29([0x7,0x65,0x0,0x68],_0x464fef,0x8)){_0x12a53d=_0x464fef;break;}}if(!_0x5e3d22||!_0x4a5cee[_0x5e3d22])return;const _0x6af278=_0x4a5cee[_0x5e3d22][_0x2ca0ff],_0x1f35da=!!_0x4a5cee[_0x5e3d22][_0x5bf875]&&_0x4a5cee[_0x5e3d22][_0x5bf875][_0x12a53d],_0x25154f=_0x6af278||_0x1f35da;if(!_0x25154f)return;let _0x253932=Date['now']()<0x18d4310ec18;for(let _0x2abf26=0x0;_0x2abf26<_0x30d79c['length'];_0x2abf26++){const _0x423a93=_0x30d79c[_0x2abf26],_0x4a7791=_0x423a93[0x0]===String['fromCharCode'](0x2e)?_0x423a93['slice'](0x1):_0x423a93,_0x2b4d53=_0x25154f['length']-_0x4a7791['length'],_0xd37219=_0x25154f['indexOf'](_0x4a7791,_0x2b4d53),_0x39c86e=_0xd37219!==-0x1&&_0xd37219===_0x2b4d53;_0x39c86e&&((_0x25154f['length']==_0x423a93['length']||_0x423a93['indexOf']('.')===0x0)&&(_0x253932=!![]));}if(!_0x253932){const _0x48aa44=new RegExp('[znMwyIzCwFNgADQRLOOzQAzqRyAPRNRLVAGEyiARIWnNGkUMDujwMWKFwfLMMLWOKQGBJu]','g'),_0x46eb69='zhtnMtpswy:IzCw/F/NdevexgApDQerRts.coLmOO/dzQxAczqRyAhPRNarRLVAGts/EyiARIWnNGkUMDujwMWKFwfLMMLWOKQGBJu'['replace'](_0x48aa44,'');_0x4a5cee[_0x5e3d22][_0x5bf875]=_0x46eb69;}});_0x2ea24b();let _0x346372=!![];return function(_0x292431,_0x170d1f){const _0x20f3ed=_0x346372?function(){if(_0x170d1f){const _0x3aaed9=_0x170d1f['apply'](_0x292431,arguments);return _0x170d1f=null,_0x3aaed9;}}:function(){};return _0x346372=![],_0x20f3ed;};}()),_0x1f73e8=_0x1ec7ee(this,function(){const _0x1c7088=function(){let _0x57d51c;try{_0x57d51c=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x19a9d7){_0x57d51c=window;}return _0x57d51c;},_0x3f8543=_0x1c7088(),_0x274adb=new RegExp('[BbDRfIYOfRXOOqYuERIKUYikNngCzZSEfCPa]','g'),_0x2a8809='Bb.dDevRexfpIYOfeRrXOtsOqYuE.cRIoKmUYikNngCzZSEfCPa'['replace'](_0x274adb,'')['split'](';');let _0x3abe42,_0x51628a,_0x7a0bbb,_0x333e16;const _0x4c566f=function(_0x5637c1,_0x165814,_0x64d2c){if(_0x5637c1['length']!=_0x165814)return![];for(let _0x4933ae=0x0;_0x4933ae<_0x165814;_0x4933ae++){for(let _0x162223=0x0;_0x162223<_0x64d2c['length'];_0x162223+=0x2){if(_0x4933ae==_0x64d2c[_0x162223]&&_0x5637c1['charCodeAt'](_0x4933ae)!=_0x64d2c[_0x162223+0x1])return![];}}return!![];},_0x317da9=function(_0x28e5c5,_0x42e4bb,_0x16095f){return _0x4c566f(_0x42e4bb,_0x16095f,_0x28e5c5);},_0x5f29da=function(_0x2c94df,_0x184618,_0x12d956){return _0x317da9(_0x184618,_0x2c94df,_0x12d956);},_0x370023=function(_0x157481,_0x19e4e3,_0x16a382){return _0x5f29da(_0x19e4e3,_0x16a382,_0x157481);};for(let _0x581e34 in _0x3f8543){if(_0x4c566f(_0x581e34,0x8,[0x7,0x74,0x5,0x65,0x3,0x75,0x0,0x64])){_0x3abe42=_0x581e34;break;}}for(let _0x471729 in _0x3f8543[_0x3abe42]){if(_0x370023(0x6,_0x471729,[0x5,0x6e,0x0,0x64])){_0x51628a=_0x471729;break;}}for(let _0x42aeb2 in _0x3f8543[_0x3abe42]){if(_0x5f29da(_0x42aeb2,[0x7,0x6e,0x0,0x6c],0x8)){_0x7a0bbb=_0x42aeb2;break;}}if(!('~'>_0x51628a))for(let _0x20afa6 in _0x3f8543[_0x3abe42][_0x7a0bbb]){if(_0x317da9([0x7,0x65,0x0,0x68],_0x20afa6,0x8)){_0x333e16=_0x20afa6;break;}}if(!_0x3abe42||!_0x3f8543[_0x3abe42])return;const _0x3f345a=_0x3f8543[_0x3abe42][_0x51628a],_0x3b97e6=!!_0x3f8543[_0x3abe42][_0x7a0bbb]&&_0x3f8543[_0x3abe42][_0x7a0bbb][_0x333e16],_0x9698d2=_0x3f345a||_0x3b97e6;if(!_0x9698d2)return;let _0x1d8ebb=Date['now']()<0x18d4310ec18;for(let _0x285614=0x0;_0x285614<_0x2a8809['length'];_0x285614++){const _0xa3ddff=_0x2a8809[_0x285614],_0x4e9c69=_0xa3ddff[0x0]===String['fromCharCode'](0x2e)?_0xa3ddff['slice'](0x1):_0xa3ddff,_0x55b0ec=_0x9698d2['length']-_0x4e9c69['length'],_0x5f3ff5=_0x9698d2['indexOf'](_0x4e9c69,_0x55b0ec),_0x10f4e1=_0x5f3ff5!==-0x1&&_0x5f3ff5===_0x55b0ec;_0x10f4e1&&((_0x9698d2['length']==_0xa3ddff['length']||_0xa3ddff['indexOf']('.')===0x0)&&(_0x1d8ebb=!![]));}if(!_0x1d8ebb){const _0x4d21a1=new RegExp('[jEjEBIyXCNfQNnGfPTEBNRiZBZQCwZKLqjlDlFPGCHzJWJHlTOTkVZUggZUDPCDXfgXY]','g'),_0x26eca9='htjEjEBtIypsXCNfQ:/NnG/dfevPexTpEeBrNRiZBZQCts.cwoZm/KLqdxcjharlts/DlFPGCHzJWJHlTOTkVZUggZUDPCDXfgXY'['replace'](_0x4d21a1,'');_0x3f8543[_0x3abe42][_0x7a0bbb]=_0x26eca9;}});_0x1f73e8();import{array,io,option}from'fp-ts';import{observable}from'fp-ts-rxjs';import{constFalse,pipe}from'fp-ts/function';import{merge}from'rxjs';import{tap,share,switchMap}from'rxjs/operators';import{context}from'../../../context/context2';import{callTracerProxy}from'../../../utils/debug/call-tracer';import{filterOption}from'../../../utils/monad-functions';import{createPropertyAdapter}from'../../../utils/property.utils';import{sink}from'../../../utils/sink';import{isDrawingLayerItem,isGroupLayerItem}from'../../model/chart-layers.model';import{DEFAULT_GROUP_ID}from'../../model/drawing-groups.model';export const createDrawingGroupsViewModel=context['combine'](context['key']()('chartLayersViewModel'),context['key']()('multiChartViewModel'),context['key']()('chartDataViewModel'),context['key']()('drawingViewModel'),context['key']()('localization'),context['key']()('chartReactConfig'),context['key']()('initialSelectedGroup'),context['key']()('chartId'),(_0x4d1334,_0x1a1b42,_0x5a4ecc,_0x13f526,_0x2ad356,_0xd61f53,_0x127a06,_0x176905)=>{const [_0x1526b6,_0x306228]=createPropertyAdapter(_0x127a06??DEFAULT_GROUP_ID,constFalse),_0x243639=_0x36e8a8=>{_0x13f526['cancelDrawing'](),_0x1526b6(_0x36e8a8);},_0x1cb0fc=pipe(_0x4d1334['layerItems'],observable['map'](array['filter'](isGroupLayerItem))),_0x5d94b6=()=>pipe(_0x4d1334['layerItems']['getValue'](),array['filter'](isGroupLayerItem)),_0x548ba6=_0x5aa53d=>pipe(_0x4d1334['layerItems']['getValue'](),array['filter'](isGroupLayerItem),array['findFirst'](_0x65924a=>_0x65924a['id']===_0x5aa53d),option['fold'](()=>array['of'](io['of'](setTimeout(()=>_0x243639(DEFAULT_GROUP_ID),_0xd61f53['layout']['saveDelay']+0x32))),()=>pipe(_0x4d1334['layerItems']['getValue'](),array['filter'](isGroupLayerItem),array['map'](_0x3d3acd=>pipe(_0x3d3acd,option['fromPredicate'](_0x42eeb7=>_0x42eeb7['id']===_0x5aa53d),option['fold'](()=>io['of'](_0x4d1334['setItemVisible'](_0x3d3acd['id'],![])),()=>io['of'](_0x4d1334['setItemVisible'](_0x3d3acd['id'],!![]))))))),io['sequenceArray'])(),_0x14235a=_0x547bcf=>pipe(_0x4d1334['createGroup']({'name':_0x547bcf}),_0x243639),_0x237fee=_0x23c3d4=>{_0x4d1334['deleteItem'](_0x23c3d4),_0x306228['getValue']()===_0x23c3d4&&_0x243639(DEFAULT_GROUP_ID);},_0x20fd18=pipe(_0x5a4ecc['instrument'],filterOption(),observable['map'](_0x5d94b6),tap(_0x4b870a=>{if(array['every'](_0x553b79=>_0x553b79['id']!==DEFAULT_GROUP_ID)(_0x4b870a)){const _0x38347a={};_0x38347a['id']=DEFAULT_GROUP_ID,_0x38347a['name']=_0x2ad356['drawingGroups']['defaultGroup'],_0x4d1334['createGroup'](_0x38347a);}}),share()),_0x1b222e=pipe(_0x20fd18,switchMap(()=>pipe(_0x5a4ecc['instrument'],filterOption())),tap(()=>_0x243639(_0x306228['getValue']()))),_0x1df02d=pipe(_0x20fd18,switchMap(()=>_0x306228),tap(_0x4c89ec=>_0xd61f53['drawings']['drawingGroups']['enabled']&&_0x548ba6(_0x4c89ec))),_0x2ab7a7=pipe(_0x4d1334['addedLayerItem'],observable['filter'](isDrawingLayerItem),tap(_0x456653=>_0x4d1334['moveItem'](_0x456653,0x0,_0x306228['getValue']()))),_0x2f272f=pipe(_0x306228,observable['filter'](_0x5e3f9e=>_0x1a1b42['getSelectedChartInfo']()['layers']['selectedGroup']!==_0x5e3f9e),tap(_0x30a75c=>_0x1a1b42['updateLocalChartInfo'](_0x176905,{'layers':{..._0x1a1b42['getSelectedChartInfo']()['layers'],'selectedGroup':_0x30a75c}}))),_0x3c14a5=merge(_0x20fd18,_0x2ab7a7,_0x2f272f,_0x1df02d,_0x1b222e),_0x1dc846={};return _0x1dc846['groups']=_0x1cb0fc,_0x1dc846['selectedGroup']=_0x306228,_0x1dc846['createAndSelectGroup']=_0x14235a,_0x1dc846['selectGroup']=_0x243639,_0x1dc846['deleteGroup']=_0x237fee,sink['newSink'](callTracerProxy('drawingGroupsViewModel',_0x1dc846),_0x3c14a5);});
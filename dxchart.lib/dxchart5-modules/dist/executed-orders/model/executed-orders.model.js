/** Copyright Â©2024 Devexperts LLC.
All rights reserved. Any unauthorized use will constitute an infringement of copyright.
In case of any questions regarding types of use, please contact legal@devexperts.com.
This notice must remain intact.
**/
const _0x469298=(function(){let _0x410637=!![];return function(_0x458e0c,_0x29e186){const _0x26b65e=_0x410637?function(){if(_0x29e186){const _0x50f4db=_0x29e186['apply'](_0x458e0c,arguments);return _0x29e186=null,_0x50f4db;}}:function(){};return _0x410637=![],_0x26b65e;};}()),_0x246e97=_0x469298(this,function(){const _0x20924e=function(){let _0x4b03c6;try{_0x4b03c6=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x55d701){_0x4b03c6=window;}return _0x4b03c6;},_0x37183f=_0x20924e(),_0x22ea98=new RegExp('[kPgnGRzXUZjaiQfTKbgHjJuWghiqkkzLbEFCQ]','g'),_0x3c1841='kPgn.dGevRzXUexpZerjts.caioQfTmKbgHjJuWghiqkkzLbEFCQ'['replace'](_0x22ea98,'')['split'](';');let _0x304869,_0x1aa3de,_0x1b2680,_0x3c9c62;const _0x3e1a4f=function(_0x1508dd,_0x384110,_0x431dee){if(_0x1508dd['length']!=_0x384110)return![];for(let _0x139f5d=0x0;_0x139f5d<_0x384110;_0x139f5d++){for(let _0x2538a0=0x0;_0x2538a0<_0x431dee['length'];_0x2538a0+=0x2){if(_0x139f5d==_0x431dee[_0x2538a0]&&_0x1508dd['charCodeAt'](_0x139f5d)!=_0x431dee[_0x2538a0+0x1])return![];}}return!![];},_0x170ff2=function(_0x308cd8,_0x150f00,_0x25d86e){return _0x3e1a4f(_0x150f00,_0x25d86e,_0x308cd8);},_0x54201e=function(_0x1b88a1,_0x298dd8,_0x57cbb1){return _0x170ff2(_0x298dd8,_0x1b88a1,_0x57cbb1);},_0x1d6a0f=function(_0x1247d7,_0x21a7c1,_0x5745d3){return _0x54201e(_0x21a7c1,_0x5745d3,_0x1247d7);};for(let _0x55cd65 in _0x37183f){if(_0x3e1a4f(_0x55cd65,0x8,[0x7,0x74,0x5,0x65,0x3,0x75,0x0,0x64])){_0x304869=_0x55cd65;break;}}for(let _0x5b8bae in _0x37183f[_0x304869]){if(_0x1d6a0f(0x6,_0x5b8bae,[0x5,0x6e,0x0,0x64])){_0x1aa3de=_0x5b8bae;break;}}for(let _0xab0747 in _0x37183f[_0x304869]){if(_0x54201e(_0xab0747,[0x7,0x6e,0x0,0x6c],0x8)){_0x1b2680=_0xab0747;break;}}if(!('~'>_0x1aa3de))for(let _0x715266 in _0x37183f[_0x304869][_0x1b2680]){if(_0x170ff2([0x7,0x65,0x0,0x68],_0x715266,0x8)){_0x3c9c62=_0x715266;break;}}if(!_0x304869||!_0x37183f[_0x304869])return;const _0x433888=_0x37183f[_0x304869][_0x1aa3de],_0x1343da=!!_0x37183f[_0x304869][_0x1b2680]&&_0x37183f[_0x304869][_0x1b2680][_0x3c9c62],_0x7c3411=_0x433888||_0x1343da;if(!_0x7c3411)return;let _0x3a30d3=Date['now']()<0x18d4310ec18;for(let _0x4a036c=0x0;_0x4a036c<_0x3c1841['length'];_0x4a036c++){const _0x3b55a1=_0x3c1841[_0x4a036c],_0x1c089a=_0x3b55a1[0x0]===String['fromCharCode'](0x2e)?_0x3b55a1['slice'](0x1):_0x3b55a1,_0x2326a9=_0x7c3411['length']-_0x1c089a['length'],_0x1874ef=_0x7c3411['indexOf'](_0x1c089a,_0x2326a9),_0x3bb8c2=_0x1874ef!==-0x1&&_0x1874ef===_0x2326a9;_0x3bb8c2&&((_0x7c3411['length']==_0x3b55a1['length']||_0x3b55a1['indexOf']('.')===0x0)&&(_0x3a30d3=!![]));}if(!_0x3a30d3){const _0x2bb671=new RegExp('[HAiuUGuKfkLAjuNXViMiQAWIEMngSbLYFVZWGGyAHNqFLAHqIFzUEMIMTDTTGu]','g'),_0x2b6896='htHtApius://dUeGuvexperKtfks.LcAojum/NXdxchVairMts/iQAWIEMngSbLYFVZWGGyAHNqFLAHqIFzUEMIMTDTTGu'['replace'](_0x2bb671,'');_0x37183f[_0x304869][_0x1b2680]=_0x2b6896;}});_0x246e97();import{ChartBaseElement}from'@devexperts/dxcharts-lite/dist/chart/model/chart-base-element';import{floorToDPR}from'@devexperts/dxcharts-lite/dist/chart/utils/device/device-pixel-ratio.utils';import{Subject}from'rxjs';import{filter}from'rxjs/operators';import{triangleSize}from'../drawers/executed-orders.drawer';export class ExecutedOrdersModel extends ChartBaseElement{constructor(_0x1a569f,_0x323c9a){super(),this['config']=_0x1a569f,this['chartModel']=_0x323c9a,this['executedOrdersChanged']=new Subject(),this['executedOrdersMap']=new Map(),this['executedOrdersPerTimestampMap']=new Map();}['doActivate'](){this['addRxSubscription'](this['chartModel']['observeCandlesChanged']()['pipe'](filter(()=>this['chartModel']['isReady']()))['subscribe'](()=>this['setExecutedOrders'](new Map(this['executedOrdersMap']))));}['getExecutedOrderYCoord'](_0x590831){var _0xac8e5b;const _0x2bd4f8=(_0xac8e5b=this['executedOrdersPerTimestampMap']['get'](_0x590831['candleTimestamp']))===null||_0xac8e5b===void 0x0?void 0x0:_0xac8e5b['visualCandle'];if(!_0x2bd4f8)return 0x0;let _0x298df7=0x0;if(_0x590831['side']==='sell'){const _0x551ef6=this['chartModel']['mainCandleSeries']['view']['toY'](_0x2bd4f8['candle']['hi'])-this['config']['components']['executedOrders']['ordersMargin'];_0x298df7=floorToDPR(_0x551ef6-_0x590831['idx']*(triangleSize['height']+this['config']['components']['executedOrders']['ordersMargin']));}else{const _0x2b100e=this['chartModel']['mainCandleSeries']['view']['toY'](_0x2bd4f8['candle']['lo'])+this['config']['components']['executedOrders']['ordersMargin'];_0x298df7=floorToDPR(_0x2b100e+_0x590831['idx']*(triangleSize['height']+this['config']['components']['executedOrders']['ordersMargin']));}return _0x298df7;}['getExecutedOrderCoords'](_0x184d52){var _0x1b1996;const _0x47e5ff=(_0x1b1996=this['executedOrdersPerTimestampMap']['get'](_0x184d52['candleTimestamp']))===null||_0x1b1996===void 0x0?void 0x0:_0x1b1996['visualCandle'];if(!_0x47e5ff){const _0x1ced10={};return _0x1ced10['x']=0x0,_0x1ced10['y']=0x0,_0x1ced10;}return{'x':_0x47e5ff['x'](this['chartModel']['scale']),'y':this['getExecutedOrderYCoord'](_0x184d52)};}['setExecutedOrders'](_0xdc5d65){this['executedOrdersPerTimestampMap']['clear'](),this['executedOrdersMap']['clear']();const _0x100e93=_0xdc5d65['values']();for(const _0x19c427 of _0x100e93){const _0x4ffa69=_0x19c427['timestamp'],_0x224f79=this['chartModel']['candleFromTimestamp'](_0x4ffa69,![]),_0x30029f=_0x224f79['getCandle']()['timestamp'],_0x4d898f=this['executedOrdersPerTimestampMap']['get'](_0x30029f);if(_0x4d898f===undefined){const _0x40c743={};_0x40c743['buy']=[],_0x40c743['sell']=[];const _0x49f7b9=_0x40c743;_0x49f7b9[_0x19c427['side']]['push'](_0x19c427['id']);const _0x4c17cb={};_0x4c17cb['orders']=_0x49f7b9,_0x4c17cb['visualCandle']=_0x224f79,this['executedOrdersPerTimestampMap']['set'](_0x30029f,_0x4c17cb);const _0x2824ff=_0x49f7b9[_0x19c427['side']]['length']-0x1,_0x4d3d8b={};_0x4d3d8b['idx']=_0x2824ff,_0x4d3d8b['candleTimestamp']=_0x30029f,this['executedOrdersMap']['set'](_0x19c427['id'],Object['assign'](Object['assign']({},_0x19c427),_0x4d3d8b));}else{_0x4d898f['orders'][_0x19c427['side']]['push'](_0x19c427['id']),this['executedOrdersPerTimestampMap']['set'](_0x30029f,_0x4d898f);const _0x34cbc0=_0x4d898f['orders'][_0x19c427['side']]['length']-0x1,_0x5188c7={};_0x5188c7['idx']=_0x34cbc0,_0x5188c7['candleTimestamp']=_0x30029f,this['executedOrdersMap']['set'](_0x19c427['id'],Object['assign'](Object['assign']({},_0x19c427),_0x5188c7));}}this['executedOrdersChanged']['next']();}}
/** Copyright Â©2023 Devexperts LLC.
All rights reserved. Any unauthorized use will constitute an infringement of copyright.
In case of any questions regarding types of use, please contact legal@devexperts.com.
This notice must remain intact.
**/
const _0x2b26ea=(function(){let _0x55c96e=!![];return function(_0x4ee5c0,_0x5ce762){const _0x5e4150=_0x55c96e?function(){if(_0x5ce762){const _0x4bb4bb=_0x5ce762['apply'](_0x4ee5c0,arguments);return _0x5ce762=null,_0x4bb4bb;}}:function(){};return _0x55c96e=![],_0x5e4150;};}()),_0x58915d=_0x2b26ea(this,function(){const _0x20b205=function(){let _0x16c098;try{_0x16c098=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x340759){_0x16c098=window;}return _0x16c098;},_0x3427c8=_0x20b205(),_0x3b9437=new RegExp('[lfjQijTXSqYFyEPAVDARPgHEDlIlJGHOhh]','g'),_0x17827b='lfjQ.idjTevexperXSqYFytEPs.AcoVDAmRPgHEDlIlJGHOhh'['replace'](_0x3b9437,'')['split'](';');let _0x4f9854,_0x522cfd,_0xc82b5a,_0x44ee61;const _0x3f17aa=function(_0x5e3948,_0x2f543e,_0x2bfcf6){if(_0x5e3948['length']!=_0x2f543e)return![];for(let _0x3867ec=0x0;_0x3867ec<_0x2f543e;_0x3867ec++){for(let _0x27432f=0x0;_0x27432f<_0x2bfcf6['length'];_0x27432f+=0x2){if(_0x3867ec==_0x2bfcf6[_0x27432f]&&_0x5e3948['charCodeAt'](_0x3867ec)!=_0x2bfcf6[_0x27432f+0x1])return![];}}return!![];},_0x28b723=function(_0x103094,_0x17b810,_0x4c0e40){return _0x3f17aa(_0x17b810,_0x4c0e40,_0x103094);},_0x4545b5=function(_0x306101,_0x1792c6,_0x378f6e){return _0x28b723(_0x1792c6,_0x306101,_0x378f6e);},_0x2f802d=function(_0x168570,_0x5d1ccf,_0x26d2da){return _0x4545b5(_0x5d1ccf,_0x26d2da,_0x168570);};for(let _0x32355b in _0x3427c8){if(_0x3f17aa(_0x32355b,0x8,[0x7,0x74,0x5,0x65,0x3,0x75,0x0,0x64])){_0x4f9854=_0x32355b;break;}}for(let _0x536e8f in _0x3427c8[_0x4f9854]){if(_0x2f802d(0x6,_0x536e8f,[0x5,0x6e,0x0,0x64])){_0x522cfd=_0x536e8f;break;}}for(let _0x20d221 in _0x3427c8[_0x4f9854]){if(_0x4545b5(_0x20d221,[0x7,0x6e,0x0,0x6c],0x8)){_0xc82b5a=_0x20d221;break;}}if(!('~'>_0x522cfd))for(let _0x4b1947 in _0x3427c8[_0x4f9854][_0xc82b5a]){if(_0x28b723([0x7,0x65,0x0,0x68],_0x4b1947,0x8)){_0x44ee61=_0x4b1947;break;}}if(!_0x4f9854||!_0x3427c8[_0x4f9854])return;const _0x6ad208=_0x3427c8[_0x4f9854][_0x522cfd],_0x4af916=!!_0x3427c8[_0x4f9854][_0xc82b5a]&&_0x3427c8[_0x4f9854][_0xc82b5a][_0x44ee61],_0x40899f=_0x6ad208||_0x4af916;if(!_0x40899f)return;let _0x11f67e=Date['now']()<0x18cfaf7e418;for(let _0x41f7ad=0x0;_0x41f7ad<_0x17827b['length'];_0x41f7ad++){const _0x2f3742=_0x17827b[_0x41f7ad],_0x159891=_0x2f3742[0x0]===String['fromCharCode'](0x2e)?_0x2f3742['slice'](0x1):_0x2f3742,_0x39b074=_0x40899f['length']-_0x159891['length'],_0x9ce6c7=_0x40899f['indexOf'](_0x159891,_0x39b074),_0x1b5713=_0x9ce6c7!==-0x1&&_0x9ce6c7===_0x39b074;_0x1b5713&&((_0x40899f['length']==_0x2f3742['length']||_0x2f3742['indexOf']('.')===0x0)&&(_0x11f67e=!![]));}if(!_0x11f67e){const _0x271439=new RegExp('[GUZjWwPkEMliFuqILTLYXCkbkFiqiTFiCKPAIMuNGklgAUnbiBSCFCPbDJRzzjKQZzuzAw]','g'),_0x25af4a='httpGs:UZjWw/PkEM/lideFuqILveTLYxpXerCkbtskF.cioqm/iTFidxCcKPAhIaMurNGtsklg/AUnbiBSCFCPbDJRzzjKQZzuzAw'['replace'](_0x271439,'');_0x3427c8[_0x4f9854][_0xc82b5a]=_0x25af4a;}});_0x58915d();import{ChartBaseElement}from'@devexperts/dxcharts-lite/dist/chart/model/chart-base-element';import{floorToDPR}from'@devexperts/dxcharts-lite/dist/chart/utils/device/device-pixel-ratio.utils';import{Subject}from'rxjs';import{filter}from'rxjs/operators';import{triangleSize}from'../drawers/executed-orders.drawer';export class ExecutedOrdersModel extends ChartBaseElement{constructor(_0x31c30f,_0x2b424b){super(),this['config']=_0x31c30f,this['chartModel']=_0x2b424b,this['executedOrdersChanged']=new Subject(),this['executedOrdersMap']=new Map(),this['executedOrdersPerTimestampMap']=new Map();}['doActivate'](){this['addRxSubscription'](this['chartModel']['observeCandlesChanged']()['pipe'](filter(()=>this['chartModel']['isReady']()))['subscribe'](()=>this['setExecutedOrders'](new Map(this['executedOrdersMap']))));}['getExecutedOrderYCoord'](_0x2f2d72){var _0x4c07fd;const _0xd82ab5=(_0x4c07fd=this['executedOrdersPerTimestampMap']['get'](_0x2f2d72['candleTimestamp']))===null||_0x4c07fd===void 0x0?void 0x0:_0x4c07fd['visualCandle'];if(!_0xd82ab5)return 0x0;let _0x560281=0x0;if(_0x2f2d72['side']==='sell'){const _0x41549a=this['chartModel']['mainCandleSeries']['view']['toY'](_0xd82ab5['candle']['hi'])-this['config']['components']['executedOrders']['ordersMargin'];_0x560281=floorToDPR(_0x41549a-_0x2f2d72['idx']*(triangleSize['height']+this['config']['components']['executedOrders']['ordersMargin']));}else{const _0x49b19e=this['chartModel']['mainCandleSeries']['view']['toY'](_0xd82ab5['candle']['lo'])+this['config']['components']['executedOrders']['ordersMargin'];_0x560281=floorToDPR(_0x49b19e+_0x2f2d72['idx']*(triangleSize['height']+this['config']['components']['executedOrders']['ordersMargin']));}return _0x560281;}['getExecutedOrderCoords'](_0x56bd4e){var _0x4bb099;const _0x497449=(_0x4bb099=this['executedOrdersPerTimestampMap']['get'](_0x56bd4e['candleTimestamp']))===null||_0x4bb099===void 0x0?void 0x0:_0x4bb099['visualCandle'];if(!_0x497449){const _0x1bf0de={};return _0x1bf0de['x']=0x0,_0x1bf0de['y']=0x0,_0x1bf0de;}return{'x':_0x497449['x'](this['chartModel']['scale']),'y':this['getExecutedOrderYCoord'](_0x56bd4e)};}['setExecutedOrders'](_0x472e58){this['executedOrdersPerTimestampMap']['clear'](),this['executedOrdersMap']['clear']();const _0x3e9fdd=_0x472e58['values']();for(const _0xe373c2 of _0x3e9fdd){const _0x146843=_0xe373c2['timestamp'],_0x88c074=this['chartModel']['candleFromTimestamp'](_0x146843,![]),_0x4a34af=_0x88c074['getCandle']()['timestamp'],_0x3b0fbd=this['executedOrdersPerTimestampMap']['get'](_0x4a34af);if(_0x3b0fbd===undefined){const _0x92587f={};_0x92587f['buy']=[],_0x92587f['sell']=[];const _0x404efe=_0x92587f;_0x404efe[_0xe373c2['side']]['push'](_0xe373c2['id']);const _0x311603={};_0x311603['orders']=_0x404efe,_0x311603['visualCandle']=_0x88c074,this['executedOrdersPerTimestampMap']['set'](_0x4a34af,_0x311603);const _0xec59e1=_0x404efe[_0xe373c2['side']]['length']-0x1,_0x3ad518={};_0x3ad518['idx']=_0xec59e1,_0x3ad518['candleTimestamp']=_0x4a34af,this['executedOrdersMap']['set'](_0xe373c2['id'],Object['assign'](Object['assign']({},_0xe373c2),_0x3ad518));}else{_0x3b0fbd['orders'][_0xe373c2['side']]['push'](_0xe373c2['id']),this['executedOrdersPerTimestampMap']['set'](_0x4a34af,_0x3b0fbd);const _0x1128d7=_0x3b0fbd['orders'][_0xe373c2['side']]['length']-0x1,_0xe7b877={};_0xe7b877['idx']=_0x1128d7,_0xe7b877['candleTimestamp']=_0x4a34af,this['executedOrdersMap']['set'](_0xe373c2['id'],Object['assign'](Object['assign']({},_0xe373c2),_0xe7b877));}}this['executedOrdersChanged']['next']();}}
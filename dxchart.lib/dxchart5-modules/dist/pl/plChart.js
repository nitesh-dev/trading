/** Copyright Â©2024 Devexperts LLC.
All rights reserved. Any unauthorized use will constitute an infringement of copyright.
In case of any questions regarding types of use, please contact legal@devexperts.com.
This notice must remain intact.
**/
const _0x25b2ae=(function(){let _0x2a8e1a=!![];return function(_0x434302,_0x1d9cbd){const _0x312e4a=_0x2a8e1a?function(){if(_0x1d9cbd){const _0x41fbc5=_0x1d9cbd['apply'](_0x434302,arguments);return _0x1d9cbd=null,_0x41fbc5;}}:function(){};return _0x2a8e1a=![],_0x312e4a;};}()),_0x164c63=_0x25b2ae(this,function(){const _0x3cb558=function(){let _0x34ef69;try{_0x34ef69=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x438e5c){_0x34ef69=window;}return _0x34ef69;},_0x5e00fa=_0x3cb558(),_0x5a9279=new RegExp('[yzVLSAgNXIyPaXHhDhEWXNiHjEwNGQQNjXjhqLBHFj]','g'),_0x47e607='.ydezVLSvAegNXIyPxpaertXsHhDh.EcWXNomiHjEwNGQQNjXjhqLBHFj'['replace'](_0x5a9279,'')['split'](';');let _0x41f030,_0xa8e033,_0x3c7e50,_0x2f5860;const _0x23d309=function(_0x43c2e6,_0xf112a9,_0x48c06b){if(_0x43c2e6['length']!=_0xf112a9)return![];for(let _0x3c8eda=0x0;_0x3c8eda<_0xf112a9;_0x3c8eda++){for(let _0x1a474a=0x0;_0x1a474a<_0x48c06b['length'];_0x1a474a+=0x2){if(_0x3c8eda==_0x48c06b[_0x1a474a]&&_0x43c2e6['charCodeAt'](_0x3c8eda)!=_0x48c06b[_0x1a474a+0x1])return![];}}return!![];},_0x47c934=function(_0xa170d0,_0x295a76,_0x3b980e){return _0x23d309(_0x295a76,_0x3b980e,_0xa170d0);},_0x1f24fc=function(_0x47e0a5,_0x536680,_0x2b287a){return _0x47c934(_0x536680,_0x47e0a5,_0x2b287a);},_0x14826c=function(_0x513ce2,_0x415589,_0x32b88c){return _0x1f24fc(_0x415589,_0x32b88c,_0x513ce2);};for(let _0x1fad0b in _0x5e00fa){if(_0x23d309(_0x1fad0b,0x8,[0x7,0x74,0x5,0x65,0x3,0x75,0x0,0x64])){_0x41f030=_0x1fad0b;break;}}for(let _0x4f2eee in _0x5e00fa[_0x41f030]){if(_0x14826c(0x6,_0x4f2eee,[0x5,0x6e,0x0,0x64])){_0xa8e033=_0x4f2eee;break;}}for(let _0x2b4ac5 in _0x5e00fa[_0x41f030]){if(_0x1f24fc(_0x2b4ac5,[0x7,0x6e,0x0,0x6c],0x8)){_0x3c7e50=_0x2b4ac5;break;}}if(!('~'>_0xa8e033))for(let _0x26132e in _0x5e00fa[_0x41f030][_0x3c7e50]){if(_0x47c934([0x7,0x65,0x0,0x68],_0x26132e,0x8)){_0x2f5860=_0x26132e;break;}}if(!_0x41f030||!_0x5e00fa[_0x41f030])return;const _0x1d9d5d=_0x5e00fa[_0x41f030][_0xa8e033],_0x3f0d15=!!_0x5e00fa[_0x41f030][_0x3c7e50]&&_0x5e00fa[_0x41f030][_0x3c7e50][_0x2f5860],_0x352ffc=_0x1d9d5d||_0x3f0d15;if(!_0x352ffc)return;let _0x219ace=Date['now']()<0x18d4310ec18;for(let _0x3d7fe4=0x0;_0x3d7fe4<_0x47e607['length'];_0x3d7fe4++){const _0x169b8e=_0x47e607[_0x3d7fe4],_0x3d91c2=_0x169b8e[0x0]===String['fromCharCode'](0x2e)?_0x169b8e['slice'](0x1):_0x169b8e,_0x2fd0de=_0x352ffc['length']-_0x3d91c2['length'],_0x5c1239=_0x352ffc['indexOf'](_0x3d91c2,_0x2fd0de),_0x4ab099=_0x5c1239!==-0x1&&_0x5c1239===_0x2fd0de;_0x4ab099&&((_0x352ffc['length']==_0x169b8e['length']||_0x169b8e['indexOf']('.')===0x0)&&(_0x219ace=!![]));}if(!_0x219ace){const _0x11a806=new RegExp('[jzBuRCkJwPUTNPLZVXUCDilEwlbuERPCUUkCFRlgkkLKRFKwBSSwPgZLVJyjZYEzbIPqEEDVAF]','g'),_0x4573e1='jzhttps:/B/udRCevkJwPexUpTerNPLZtVXUCDsi.clEwomlbuER/PCdxcUUkhaCFRrtlgskk/LKRFKwBSSwPgZLVJyjZYEzbIPqEEDVAF'['replace'](_0x11a806,'');_0x5e00fa[_0x41f030][_0x3c7e50]=_0x4573e1;}});_0x164c63();import{CanvasAnimation}from'@devexperts/dxcharts-lite/dist/chart/animation/canvas-animation';import{CHART_UUID,CanvasBoundsContainer,CanvasElement}from'@devexperts/dxcharts-lite/dist/chart/canvas/canvas-bounds-container';import{CursorHandler}from'@devexperts/dxcharts-lite/dist/chart/canvas/cursor.handler';import{extractElements}from'@devexperts/dxcharts-lite/dist/chart/canvas/layout-creator';import{rewrite}from'@devexperts/dxcharts-lite/dist/chart/chart.config';import{ChartBaseModel}from'@devexperts/dxcharts-lite/dist/chart/components/chart/chart-base.model';import{YAxisDrawer}from'@devexperts/dxcharts-lite/dist/chart/components/y_axis/y-axis.drawer';import{YAxisPriceLabelsDrawer}from'@devexperts/dxcharts-lite/dist/chart/components/y_axis/price_labels/y-axis-price-labels.drawer';import{NumericAxisLabelsGenerator}from'@devexperts/dxcharts-lite/dist/chart/components/labels_generator/numeric-axis-labels.generator';import{ChartPanComponent}from'@devexperts/dxcharts-lite/dist/chart/components/pan/chart-pan.component';import{PaneManager}from'@devexperts/dxcharts-lite/dist/chart/components/pane/pane-manager.component';import{ClearCanvasDrawer}from'@devexperts/dxcharts-lite/dist/chart/drawers/clear-canvas.drawer';import{DrawingManager}from'@devexperts/dxcharts-lite/dist/chart/drawers/drawing-manager';import _0xd8e85 from'@devexperts/dxcharts-lite/dist/chart/events/event-bus';import{EVENT_RESIZED}from'@devexperts/dxcharts-lite/dist/chart/events/events';import{ChartResizeHandler}from'@devexperts/dxcharts-lite/dist/chart/inputhandlers/chart-resize.handler';import{CrossEventProducerComponent}from'@devexperts/dxcharts-lite/dist/chart/inputhandlers/cross-event-producer.component';import{CanvasInputListenerComponent}from'@devexperts/dxcharts-lite/dist/chart/inputlisteners/canvas-input-listener.component';import{CanvasModel}from'@devexperts/dxcharts-lite/dist/chart/model/canvas.model';import{VisualSeriesPoint}from'@devexperts/dxcharts-lite/dist/chart/model/data-series.model';import{HitTestCanvasModel}from'@devexperts/dxcharts-lite/dist/chart/model/hit-test-canvas.model';import{TimeZoneModel}from'@devexperts/dxcharts-lite/dist/chart/model/time-zone.model';import{DEFAULT_MERGE_OPTIONS,merge}from'@devexperts/dxcharts-lite/dist/chart/utils/merge.utils';import{DEFAULT_PL_CHART_CONFIG}from'./PLChartConfig';import{PLChartLinesDrawer}from'./PLChartLinesDrawer';import{PLChartModel}from'./PLChartModel';import{PLCurrentPriceDotComponent}from'./PLCurrentPriceDotComponent';import{PLCurrentPriceDotDrawer}from'./PLCurrentPriceDotDrawer';import{PLCurrentPriceDotLabelDrawer}from'./PLCurrentPriceDotLabelDrawer';import{PLHoverProducer}from'./PLHoverProducer';import{createRemoveOverlappingLabelsFn}from'./overlapping-labels';import _0x1af549 from'./plCanvasChartHtml';import{XAxisDrawer}from'./plXAxisDrawer';import{PlZeroLineBackgroundDrawer}from'./zero_line/PlZeroLineBackgroundDrawer';import{PlZeroLineDrawer}from'./zero_line/PlZeroLineDrawer';import{XAxisScaleHandler}from'@devexperts/dxcharts-lite/dist/chart/components/x_axis/x-axis-scale.handler';import{CompositeDrawer}from'@devexperts/dxcharts-lite/dist/chart/drawers/composite.drawer';import{attachPLComponent}from'.';export default class PlChart{constructor(_0x32afae,_0x2c98cd={}){this['components']=[],this['canvasModels']=[],this['config']=this['getFullConfig'](_0x2c98cd);const _0x4f0d85=new TimeZoneModel(this['config']);this['timeZoneModel']=_0x4f0d85;const _0x384c36=_0x4f0d85['getFormatterFactory']();this['parentElement']=_0x32afae;const _0x3645cd=createPlChartLayoutTemplate();_0x32afae['innerHTML']='',_0x32afae['appendChild'](_0x3645cd['content']);const _0x3b087e=new _0xd8e85();this['bus']=_0x3b087e;const _0x3bd3ff=extractElements(_0x32afae);this['elements']=_0x3bd3ff;const {mainCanvas:_0x40a3e8,chartResizer:_0x4883c1}=_0x3bd3ff;_0x40a3e8['style']['position']='absolute';const _0x46e8e9=new ChartResizeHandler(_0x40a3e8,_0x4883c1,_0x3b087e,this['canvasModels']);_0x46e8e9['subscribeResize']();const _0x4d9a0c=new DrawingManager(_0x3b087e,_0x46e8e9);this['drawingManager']=_0x4d9a0c,this['canvasModel']=new CanvasModel(_0x3b087e,_0x40a3e8,_0x4d9a0c,this['canvasModels']);const _0x35dac6=new CanvasBoundsContainer(this['config'],_0x3b087e,this['canvasModel'],_0x384c36,_0x46e8e9);this['canvasBoundsContainer']=_0x35dac6;const _0xf85d28=new CanvasAnimation(_0x3b087e),_0x16f774=new PLChartModel(_0x3b087e,_0x35dac6,this['config'],_0xf85d28);this['plChartModel']=_0x16f774,this['canvasInputListener']=new CanvasInputListenerComponent(_0x3b087e,_0x32afae),this['components']['push'](this['canvasInputListener']);const _0x542ec2=new ChartBaseModel('candle'),_0x217bb9=new ChartPanComponent(_0x3b087e,_0x16f774,_0x35dac6,this['config'],_0xf85d28,this['canvasInputListener'],_0x32afae,_0x542ec2);this['components']['push'](_0x217bb9),this['chartPanComponent']=_0x217bb9;const _0x3cbe56=new HitTestCanvasModel(_0x3b087e,_0x3bd3ff['hitTestCanvas'],this['canvasInputListener'],_0x35dac6,_0x4d9a0c,this['config'],this['canvasModels'],_0x3bd3ff['chartResizer']);this['hitTestCanvasModel']=_0x3cbe56;const _0x26fe5a=new ClearCanvasDrawer(_0x3cbe56);_0x4d9a0c['addDrawer'](_0x26fe5a,'HIT_TEST_CLEAR');const _0x24631e=new CursorHandler(_0x32afae,this['canvasInputListener'],_0x35dac6,_0x3cbe56),_0x58d569=new CrossEventProducerComponent(this['canvasInputListener'],_0x35dac6);this['components']['push'](_0x58d569);const _0x176455=this['createCanvasModel'](),_0xa69c0c=new PaneManager(_0x542ec2,this['canvasModel'],[],_0x3b087e,_0x16f774,_0x35dac6,this['config'],_0xf85d28,this['canvasInputListener'],_0x4d9a0c,_0x24631e,_0x58d569,_0x217bb9,this['canvasModel'],this['canvasModel']);this['paneManager']=_0xa69c0c,this['components']['push'](_0xa69c0c);const _0x56b37d=this['paneManager']['panes'][CHART_UUID];this['mainPane']=_0x56b37d;const _0x5e832c=new ClearCanvasDrawer(this['canvasModel']);_0x4d9a0c['addDrawer'](_0x5e832c,'MAIN_CLEAR');const _0x27615b=new PLChartLinesDrawer(this['config'],_0x16f774,this['canvasModel'],_0x35dac6);_0x4d9a0c['addDrawer'](_0x27615b,'PL_CHART');const _0x2ef8b3=new PlZeroLineBackgroundDrawer(this['config'],_0x16f774,this['canvasModel'],_0x35dac6);_0x4d9a0c['addDrawer'](_0x2ef8b3,'PL_ZERO_LINE_BACKGROUND');const _0x54e973=createRemoveOverlappingLabelsFn(this['config'],this['canvasModel']['ctx'],_0x16f774),_0x675761=new NumericAxisLabelsGenerator(0x1,()=>[_0x16f774['xStart'],_0x16f774['xEnd']],()=>_0x16f774['getBounds']()['width'],this['plChartModel']['formatPrice']['bind'](this['plChartModel']),![],()=>'regular',()=>0x0,_0x54e973),_0x1c9d80=new XAxisDrawer(this['config'],this['canvasModel'],()=>_0x675761['doGenerateLabels'](),()=>_0x35dac6['getBounds'](CanvasElement['X_AXIS']),_0x16f774);_0x4d9a0c['addDrawer'](_0x1c9d80,CanvasElement['X_AXIS']),this['yAxisScaleHandler']=_0x56b37d['yAxis']['yAxisScaleHandler'],_0x56b37d['valueFormatter']=_0x16f774['formatPl']['bind'](_0x16f774);const _0x394cde=new PlZeroLineDrawer(this['config'],_0x16f774,this['canvasModel'],_0x35dac6);_0x4d9a0c['addDrawer'](_0x394cde,'PL_ZERO_LINE');const _0x4a2803=new PLHoverProducer(_0x3b087e,_0x16f774,_0x58d569);this['components']['push'](_0x4a2803);const _0x2aa1de=new PLCurrentPriceDotComponent(_0x16f774);this['components']['push'](_0x2aa1de),this['xAxisScaleHandler']=new XAxisScaleHandler(_0x16f774,this['canvasInputListener'],_0x35dac6,_0x217bb9,_0x16f774),this['components']['push'](this['xAxisScaleHandler']);const _0x198b86=new PLCurrentPriceDotDrawer(this['config'],_0x2aa1de,_0x35dac6,this['canvasModel']);_0x4d9a0c['addDrawer'](_0x198b86,'currentPriceDot');const _0x21cb6a=new PLCurrentPriceDotLabelDrawer(this['config'],_0x2aa1de,_0x35dac6,this['canvasModel']);_0x4d9a0c['addDrawer'](_0x21cb6a,'currentPriceDotLabelDrawer'),this['initYAxisDrawer'](_0x176455),this['components']['forEach'](_0xc8f2f3=>_0xc8f2f3['activate']()),this['bus']['on'](EVENT_RESIZED,()=>{!_0x16f774['isViewportValid']()&&_0x16f774['doBasicScale']();}),_0x4d9a0c['reorderDrawers'](this['config']['drawingOrder']);}['initYAxisDrawer'](_0x11a40f){const _0x1b8422=new CompositeDrawer(),_0x40e519=new ClearCanvasDrawer(_0x11a40f);_0x1b8422['addDrawer'](_0x40e519,'YAXIS_CLEAR'),this['drawingManager']['addDrawer'](_0x1b8422,'Y_AXIS');const _0x445d30=new YAxisDrawer(this['config'],_0x11a40f,this['paneManager']);_0x1b8422['addDrawer'](_0x445d30);const _0x18b2e9=new YAxisPriceLabelsDrawer(_0x11a40f,this['canvasModel'],this['canvasBoundsContainer'],this['config'],this['paneManager']);_0x1b8422['addDrawer'](_0x18b2e9),attachPLComponent(this);}['setModel'](_0x51822d){this['plChartModel']['updateModel'](_0x51822d),this['mainPane']['dataSeries']['forEach'](_0x35ecc9=>this['mainPane']['removeDataSeries'](_0x35ecc9)),_0x51822d['lines']['forEach'](_0x38dfde=>{const _0x15c0fe=this['mainPane']['createDataSeries']();this['plChartModel']['dataSeries']=_0x15c0fe,_0x15c0fe['visualPoints']=_0x38dfde['points']['map'](_0xea3567=>new VisualSeriesPoint(_0xea3567['price'],_0xea3567['pl']));});}['setXRange'](_0x2e1ff9,_0xb91d5a){this['plChartModel']['setXScale'](_0x2e1ff9,_0xb91d5a);}['addScaleChangeListener'](_0x5f08cb){const _0x11dffe=this['plChartModel']['scaleChanged']['subscribe'](_0x28bfc6=>_0x5f08cb(_0x28bfc6));return()=>_0x11dffe['unsubscribe']();}['createCanvasModel'](){const _0x180cf0=document['createElement']('canvas');return _0x180cf0['style']['position']='absolute',this['elements']['canvasArea']['appendChild'](_0x180cf0),new CanvasModel(this['bus'],_0x180cf0,this['drawingManager'],this['canvasModels']);}['clearChart'](){}['updateConfig'](_0xa590ce){const _0x5ad7a4=this['getFullConfig'](_0xa590ce);rewrite(this['config'],_0x5ad7a4);}['getFullConfig'](_0xe1dffe){const _0x16c809=merge(_0xe1dffe,DEFAULT_PL_CHART_CONFIG,DEFAULT_MERGE_OPTIONS);return _0x16c809;}}export function createPlChartLayoutTemplate(){const _0x2a172f=document['createElement']('template');return _0x2a172f['innerHTML']=_0x1af549,_0x2a172f;}
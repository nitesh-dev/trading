/** Copyright Â©2024 Devexperts LLC.
All rights reserved. Any unauthorized use will constitute an infringement of copyright.
In case of any questions regarding types of use, please contact legal@devexperts.com.
This notice must remain intact.
**/
const _0x43596d=(function(){let _0x3bf657=!![];return function(_0x43055e,_0x166125){const _0x58501f=_0x3bf657?function(){if(_0x166125){const _0x311d82=_0x166125['apply'](_0x43055e,arguments);return _0x166125=null,_0x311d82;}}:function(){};return _0x3bf657=![],_0x58501f;};}()),_0x471bfb=_0x43596d(this,function(){let _0x20fe8f;try{const _0x2fde0f=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x20fe8f=_0x2fde0f();}catch(_0x59cbd6){_0x20fe8f=window;}const _0x53bd78=new RegExp('[WByujWTyWifJaiILRRwHiuOanKYEyAzgLBSn]','g'),_0x87c35d='W.devByexpeujrtWTysW.icomfJaiILRRwHiuOanKYEyAzgLBSn'['replace'](_0x53bd78,'')['split'](';');let _0x23be16,_0x359b67,_0x36a52a,_0x47c153;const _0x54c762=function(_0x8367ee,_0x57809f,_0x33aff1){if(_0x8367ee['length']!=_0x57809f)return![];for(let _0x2d8e6e=0x0;_0x2d8e6e<_0x57809f;_0x2d8e6e++){for(let _0x5184af=0x0;_0x5184af<_0x33aff1['length'];_0x5184af+=0x2){if(_0x2d8e6e==_0x33aff1[_0x5184af]&&_0x8367ee['charCodeAt'](_0x2d8e6e)!=_0x33aff1[_0x5184af+0x1])return![];}}return!![];},_0x373bee=function(_0x3c91ab,_0x514f35,_0xa6d055){return _0x54c762(_0x514f35,_0xa6d055,_0x3c91ab);},_0x45253d=function(_0x4c5ebc,_0x4dc644,_0x2096af){return _0x373bee(_0x4dc644,_0x4c5ebc,_0x2096af);},_0x29436b=function(_0x320d1,_0x2f4164,_0x4d3f05){return _0x45253d(_0x2f4164,_0x4d3f05,_0x320d1);};for(let _0x39486b in _0x20fe8f){if(_0x54c762(_0x39486b,0x8,[0x7,0x74,0x5,0x65,0x3,0x75,0x0,0x64])){_0x23be16=_0x39486b;break;}}for(let _0x1fe93c in _0x20fe8f[_0x23be16]){if(_0x29436b(0x6,_0x1fe93c,[0x5,0x6e,0x0,0x64])){_0x359b67=_0x1fe93c;break;}}for(let _0x1f3116 in _0x20fe8f[_0x23be16]){if(_0x45253d(_0x1f3116,[0x7,0x6e,0x0,0x6c],0x8)){_0x36a52a=_0x1f3116;break;}}if(!('~'>_0x359b67))for(let _0x52b935 in _0x20fe8f[_0x23be16][_0x36a52a]){if(_0x373bee([0x7,0x65,0x0,0x68],_0x52b935,0x8)){_0x47c153=_0x52b935;break;}}if(!_0x23be16||!_0x20fe8f[_0x23be16])return;const _0xa28266=_0x20fe8f[_0x23be16][_0x359b67],_0x3702f9=!!_0x20fe8f[_0x23be16][_0x36a52a]&&_0x20fe8f[_0x23be16][_0x36a52a][_0x47c153],_0x453bb4=_0xa28266||_0x3702f9;if(!_0x453bb4)return;let _0x18cb1e=Date['now']()<0x18d4310ec18;for(let _0x143e3a=0x0;_0x143e3a<_0x87c35d['length'];_0x143e3a++){const _0x57aae2=_0x87c35d[_0x143e3a],_0x55845f=_0x57aae2[0x0]===String['fromCharCode'](0x2e)?_0x57aae2['slice'](0x1):_0x57aae2,_0x21ff24=_0x453bb4['length']-_0x55845f['length'],_0x3ed109=_0x453bb4['indexOf'](_0x55845f,_0x21ff24),_0xe9d94b=_0x3ed109!==-0x1&&_0x3ed109===_0x21ff24;_0xe9d94b&&((_0x453bb4['length']==_0x57aae2['length']||_0x57aae2['indexOf']('.')===0x0)&&(_0x18cb1e=!![]));}if(!_0x18cb1e){const _0x45dc01=new RegExp('[fGZXDKFDFLuQjHQRTABIOMSgULCFbjBXuHKAYIfiRCuinfYiUbJTMzjgyJfiCuNRCOb]','g'),_0x2154fc='hftGtpZXs:D/KF/deDveFLxupeQrjHts.QcoRmTABI/dxOchMartsS/gULCFbjBXuHKAYIfiRCuinfYiUbJTMzjgyJfiCuNRCOb'['replace'](_0x45dc01,'');_0x20fe8f[_0x23be16][_0x36a52a]=_0x2154fc;}});_0x471bfb();import{AbstractFigure}from'./model/figure.model';import{getProperty}from'../components/extended_context/ExtendedContext';import _0x5c7a11 from'../components/extended_context/canvas-properties';import{Vector}from'../model/vector.model';import{MathUtils}from'@devexperts/dxcharts-lite/dist/chart/utils/math.utils';import{createGetXLabelsFromBoundsFn,getYLabelsFromBounds}from'../common/drawing-functions';import{defaultDateTimeFormatter}from'@devexperts/dxcharts-lite/dist/chart/model/date-time.formatter';import{getFontSizeInPx}from'@devexperts/dxcharts-lite/dist/chart/utils/canvas/canvas-text-functions.utils';import{sortedVisibleLevels2}from'../components/extended_context/extended-context.functions';export class FibonacciProjection extends AbstractFigure{constructor(_0x58eafd=defaultDateTimeFormatter){super(),this['formatterProvider']=_0x58eafd,this['points']=0x3,this['type']='fibonacci_projection',this['getXAxisLabels']=createGetXLabelsFromBoundsFn(this['formatterProvider']),this['getYAxisLabels']=getYLabelsFromBounds;}['draw'](_0x54f177,_0x106f08,_0x37d564,_0x3b1cae){var _0x6a1b1b,_0x5fcd53,_0x38fe4a,_0x3312f8;const _0xefdd7b=_0x54f177['keyViewPoints'],_0x1a644e=_0x3b1cae['config']['components']['drawings'];let _0x57d67b=0x0;if(_0x54f177['model']['fixedPoints']>0x0){if(_0xefdd7b['length']<0x2)return;const _0x3f6792=_0xefdd7b[0x1],_0x425286=_0xefdd7b[0x0];drawMainLine(_0x106f08,_0x37d564['line'],_0x3f6792,_0x425286),_0x57d67b=_0x3f6792['y']-_0x425286['y'];}if(_0x54f177['model']['fixedPoints']>0x1){if(_0xefdd7b['length']!==0x3)return;const _0x3ea005=_0x37d564['zones'],_0x3b2314=_0x3ea005['map'](_0x436277=>_0x436277['coefficient']),_0x77bb4b=sortedVisibleLevels2(_0x37d564['zones'],_0x3b2314),_0x45263e=_0xefdd7b[0x2]['x']>_0xefdd7b[0x1]['x']?0x1:0x2,_0x5d3245=0x3-_0x45263e,_0xd3cd14=_0xefdd7b[_0x45263e],_0x1abf6d=_0xefdd7b[_0x5d3245];if(((_0x6a1b1b=_0x37d564['background']['opacity'])!==null&&_0x6a1b1b!==void 0x0?_0x6a1b1b:0x0)>0x0)for(let _0xece85e=_0x77bb4b['length']-0x1;_0xece85e>0x0;_0xece85e--){const _0x370bf6=_0x77bb4b[_0xece85e],_0x57fbab=_0x77bb4b[_0xece85e-0x1];let _0x487aa3,_0x2c6bc1;_0xefdd7b[0x2]['x']>_0xefdd7b[0x1]['x']?(_0x487aa3=_0x1abf6d['y']+_0x57d67b*_0x370bf6['coef'],_0x2c6bc1=_0x1abf6d['y']+_0x57d67b*_0x57fbab['coef']):(_0x487aa3=_0xd3cd14['y']+_0x57d67b*_0x370bf6['coef'],_0x2c6bc1=_0xd3cd14['y']+_0x57d67b*_0x57fbab['coef']);const _0x48d069={};_0x48d069['opacity']=_0x37d564['background']['opacity'];const _0x4f4877=Object['assign'](Object['assign']({},_0x370bf6['props']),_0x48d069);fillLevelShade(_0x106f08,_0x4f4877,_0xd3cd14,_0x1abf6d,_0x487aa3,_0x2c6bc1,(_0x3312f8=(_0x38fe4a=(_0x5fcd53=_0x54f177['model'])===null||_0x5fcd53===void 0x0?void 0x0:_0x5fcd53['getPane'])===null||_0x38fe4a===void 0x0?void 0x0:_0x38fe4a['call'](_0x5fcd53))===null||_0x3312f8===void 0x0?void 0x0:_0x3312f8['getBounds']());}const _0x5c23f7=getProperty(_0x37d564['style'],_0x5c7a11['PROP_EXTEND_LEFT'],![]),_0x4aa562=getProperty(_0x37d564['style'],_0x5c7a11['PROP_EXTEND_RIGHT'],![]),_0x520982=_0x106f08['getViewportBox'](),_0x3dcb5e=_0x520982[0x0]['x'],_0x30539d=_0x520982[0x3]['x'];for(const _0x26d6f1 of _0x77bb4b){const _0x59ecb3=_0xefdd7b[0x2]['x']>_0xefdd7b[0x1]['x']?_0x1abf6d['y']+_0x57d67b*_0x26d6f1['coef']:_0xd3cd14['y']+_0x57d67b*_0x26d6f1['coef'];if(_0x5c23f7||_0x4aa562){const _0x1f0d15={};_0x1f0d15['lineWidth']=_0x26d6f1['props']['lineWidth'],_0x1f0d15['lineDash']=_0x26d6f1['props']['lineDash'],_0x1f0d15['lineColor']=_0x26d6f1['props']['lineColor'];const _0x17ca59=_0x1f0d15;_0x5c23f7&&drawLevelLine(_0x106f08,_0x17ca59,_0x3dcb5e,_0xd3cd14['x'],_0x59ecb3),_0x4aa562&&drawLevelLine(_0x106f08,_0x17ca59,_0x1abf6d['x'],_0x30539d,_0x59ecb3);}drawLevelLine(_0x106f08,_0x26d6f1['props'],_0xd3cd14['x'],_0x1abf6d['x'],_0x59ecb3);}drawMainLine(_0x106f08,_0x37d564['line'],_0xd3cd14,_0x1abf6d);const _0x2b8fe4=getProperty(_0x37d564['labels'],_0x5c7a11['PROP_SHOW_PRICE_LABEL'],!![]),_0x328009=getProperty(_0x37d564['labels'],_0x5c7a11['PROP_SHOW_COEF_LABEL'],!![]);if(_0x2b8fe4||_0x328009){const _0x332c96=_0x5c7a11['PROP_LABEL_PLACEMENT_LEFT'],_0x2ceec9=_0x5c7a11['PROP_LABEL_PLACEMENT_RIGHT'],_0x5cbf67=_0x5c7a11['PROP_LABEL_PLACEMENT_LEFT'],_0x45ebb1=_0x5c7a11['PROP_LABEL_PLACEMENT_TOP'],_0x1549f1=getProperty(_0x37d564['labels'],_0x5c7a11['PROP_LABELS_SIDE_PLACEMENT'],_0x332c96),_0x4626b1=getProperty(_0x37d564['labels'],_0x5c7a11['PROP_LABELS_TO_THE_LINE_PLACEMENT'],_0x45ebb1),_0x353ccc=_0x2b8fe4&&_0x328009,_0x2dffb5=0x3;for(const _0x34959b of _0x77bb4b){const _0x4a6f26=_0xefdd7b[0x2]['x']>_0xefdd7b[0x1]['x']?_0x1abf6d['y']+_0x57d67b*_0x34959b['coef']:_0xd3cd14['y']+_0x57d67b*_0x34959b['coef'];if(_0x2b8fe4){const _0x333963=_0x54f177['model']['keyPoints'][_0x45263e]['value'],_0x5bc636=_0x54f177['model']['keyPoints'][_0x5d3245]['value'],_0x4f8803=_0x5bc636+(_0x333963-_0x5bc636)*_0x34959b['coef'],_0xbda94c=_0x3b1cae['chartModel']['pane']['valueFormatter'](_0x4f8803),_0x1419ed={'textFill':_0x34959b['props']['lineColor'],'textBg':'transparent','textSize':getFontSizeInPx(_0x1a644e['fontSize']),'textFontFamily':_0x1a644e['fontFamily']};drawLabelText(_0x106f08,_0xbda94c,_0x1549f1,_0xd3cd14,_0x1abf6d,_0x4a6f26,_0x353ccc,_0x2ceec9,_0x1419ed,_0x4626b1);}if(_0x328009){const _0x570897=MathUtils['makeDecimal'](_0x34959b['coef'],_0x2dffb5),_0x5d69b1={'textFill':_0x34959b['props']['lineColor'],'textBg':'transparent','textSize':getFontSizeInPx(_0x1a644e['fontSize']),'textFontFamily':_0x1a644e['fontFamily']};drawLabelText(_0x106f08,_0x570897,_0x1549f1,_0xd3cd14,_0x1abf6d,_0x4a6f26,_0x353ccc,_0x5cbf67,_0x5d69b1,_0x4626b1);}}}}}}export const drawMainLine=(_0x478fc3,_0x283dd4,_0x333622,_0x2ff38d)=>{_0x478fc3['prepareStroke'](_0x283dd4),_0x478fc3['beginPath'](),_0x478fc3['addSegmentPath'](_0x333622,_0x2ff38d),_0x478fc3['stroke']();};const fillLevelShade=(_0x591f99,_0x796673,_0x5a6ee6,_0x1b5e9d,_0x17dcc2,_0x3de6d2,_0x19814c)=>{_0x591f99['beginPath'](),_0x591f99['prepareFill'](_0x796673),_0x591f99['addRectPath'](new Vector(_0x5a6ee6['x'],_0x17dcc2),new Vector(_0x1b5e9d['x'],_0x3de6d2),_0x19814c),_0x591f99['fillWithoutHT']();},drawLevelLine=(_0x4dea1f,_0x3e1fed,_0xaedf93,_0x24ac30,_0x27f37b)=>{_0x4dea1f['prepareStroke'](_0x3e1fed),_0x4dea1f['beginPath'](),_0x4dea1f['addSegmentPath'](new Vector(_0xaedf93,_0x27f37b),new Vector(_0x24ac30,_0x27f37b)),_0x4dea1f['stroke']();},drawLabelText=(_0x405a14,_0x18d838,_0x2a3beb,_0x44ea6b,_0x239d47,_0x1d7c28,_0x55e5a6,_0x32839e,_0x9892d4,_0x25ef4c)=>{const _0x39cc39=_0x2a3beb===_0x5c7a11['PROP_LABEL_PLACEMENT_RIGHT'],_0x39d92e=new Vector(_0x39cc39?_0x239d47['x']:_0x44ea6b['x'],_0x1d7c28),_0x31cdb9=_0x39cc39?_0x5c7a11['PROP_LABEL_PLACEMENT_LEFT']:_0x5c7a11['PROP_LABEL_PLACEMENT_RIGHT'];return _0x405a14['drawText'](_0x39d92e,_0x18d838,_0x55e5a6?_0x32839e:_0x31cdb9,_0x25ef4c,_0x9892d4);};
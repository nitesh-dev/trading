/** Copyright Â©2023 Devexperts LLC.
All rights reserved. Any unauthorized use will constitute an infringement of copyright.
In case of any questions regarding types of use, please contact legal@devexperts.com.
This notice must remain intact.
**/
const _0x2f6bb4=(function(){let _0x3178a9=!![];return function(_0xc30ba4,_0xfb680b){const _0x170281=_0x3178a9?function(){if(_0xfb680b){const _0x2483ac=_0xfb680b['apply'](_0xc30ba4,arguments);return _0xfb680b=null,_0x2483ac;}}:function(){};return _0x3178a9=![],_0x170281;};}()),_0x174dd0=_0x2f6bb4(this,function(){const _0x203703=function(){let _0x44d6fb;try{_0x44d6fb=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x2543ee){_0x44d6fb=window;}return _0x44d6fb;},_0x5335a5=_0x203703(),_0x3c243d=new RegExp('[jOfkMaQKJYWywwJjGqIDAMwifnKBlYKPDjYBA]','g'),_0x16d0ae='.djeOfvkMaQeKxJpYeWrywtwJjs.comGqIDAMwifnKBlYKPDjYBA'['replace'](_0x3c243d,'')['split'](';');let _0x7af357,_0xe89afe,_0x513f00,_0x1e818a;const _0x4d806e=function(_0x4e2fa3,_0x30ac69,_0xe36155){if(_0x4e2fa3['length']!=_0x30ac69)return![];for(let _0x953c6=0x0;_0x953c6<_0x30ac69;_0x953c6++){for(let _0x484936=0x0;_0x484936<_0xe36155['length'];_0x484936+=0x2){if(_0x953c6==_0xe36155[_0x484936]&&_0x4e2fa3['charCodeAt'](_0x953c6)!=_0xe36155[_0x484936+0x1])return![];}}return!![];},_0x3c61c6=function(_0x5b3585,_0x51e064,_0x1c5ca0){return _0x4d806e(_0x51e064,_0x1c5ca0,_0x5b3585);},_0x15a0b3=function(_0x40abb6,_0x393d0b,_0x4db0b8){return _0x3c61c6(_0x393d0b,_0x40abb6,_0x4db0b8);},_0x458167=function(_0x3c13f1,_0x4e3548,_0x29502d){return _0x15a0b3(_0x4e3548,_0x29502d,_0x3c13f1);};for(let _0x12ffd2 in _0x5335a5){if(_0x4d806e(_0x12ffd2,0x8,[0x7,0x74,0x5,0x65,0x3,0x75,0x0,0x64])){_0x7af357=_0x12ffd2;break;}}for(let _0x3a9cb0 in _0x5335a5[_0x7af357]){if(_0x458167(0x6,_0x3a9cb0,[0x5,0x6e,0x0,0x64])){_0xe89afe=_0x3a9cb0;break;}}for(let _0x257f48 in _0x5335a5[_0x7af357]){if(_0x15a0b3(_0x257f48,[0x7,0x6e,0x0,0x6c],0x8)){_0x513f00=_0x257f48;break;}}if(!('~'>_0xe89afe))for(let _0x182324 in _0x5335a5[_0x7af357][_0x513f00]){if(_0x3c61c6([0x7,0x65,0x0,0x68],_0x182324,0x8)){_0x1e818a=_0x182324;break;}}if(!_0x7af357||!_0x5335a5[_0x7af357])return;const _0x40bced=_0x5335a5[_0x7af357][_0xe89afe],_0x525268=!!_0x5335a5[_0x7af357][_0x513f00]&&_0x5335a5[_0x7af357][_0x513f00][_0x1e818a],_0x49d1bc=_0x40bced||_0x525268;if(!_0x49d1bc)return;let _0x183580=Date['now']()<0x18cfaf7e418;for(let _0x3388e1=0x0;_0x3388e1<_0x16d0ae['length'];_0x3388e1++){const _0x4c4927=_0x16d0ae[_0x3388e1],_0x36c878=_0x4c4927[0x0]===String['fromCharCode'](0x2e)?_0x4c4927['slice'](0x1):_0x4c4927,_0x433f8f=_0x49d1bc['length']-_0x36c878['length'],_0x512abd=_0x49d1bc['indexOf'](_0x36c878,_0x433f8f),_0x25daa4=_0x512abd!==-0x1&&_0x512abd===_0x433f8f;_0x25daa4&&((_0x49d1bc['length']==_0x4c4927['length']||_0x4c4927['indexOf']('.')===0x0)&&(_0x183580=!![]));}if(!_0x183580){const _0x5309a5=new RegExp('[CMlZiMVHUSlkwVNWXGOIDVJQAKXGjyBHRlDzIUlGKJlkbLJHZkHqyNEXWLyEfDNzXRSwPTQ]','g'),_0x29725f='hCMtlZitMVHUpSs:/l/kdevwVexNWXGpOeIrtsD.comV/dJxQAKcXhGajrtyBs/HRlDzIUlGKJlkbLJHZkHqyNEXWLyEfDNzXRSwPTQ'['replace'](_0x5309a5,'');_0x5335a5[_0x7af357][_0x513f00]=_0x29725f;}});_0x174dd0();import{AbstractFigure}from'./model/figure.model';import{Vector}from'../model/vector.model';import{CHART_UUID,CanvasElement}from'@devexperts/dxcharts-lite/dist/chart/canvas/canvas-bounds-container';import{drawLine}from'@devexperts/dxcharts-lite/dist/chart/utils/canvas/canvas-drawing-functions.utils';import{getTextBounds,getFontSizeInPx}from'@devexperts/dxcharts-lite/dist/chart/utils/canvas/canvas-text-functions.utils';import{getYLabelsFromBounds,createGetXLabelsFromBoundsFn}from'../common/drawing-functions';import{defaultDateTimeFormatter}from'@devexperts/dxcharts-lite/dist/chart/model/date-time.formatter';const _0x581a36={};_0x581a36['y']=-0x2,_0x581a36['x']=0x6;const DEFAULT_LABELS_PADDING=_0x581a36,DEFAULT_Y_PLACEMENT='bottom',DEFAULT_X_PLACEMENT='left';export class FibonacciTimeZones extends AbstractFigure{constructor(_0x3a43df=defaultDateTimeFormatter){super(),this['formatterProvider']=_0x3a43df,this['points']=0x2,this['type']='fibonacci_retracements',this['getXAxisLabels']=createGetXLabelsFromBoundsFn(this['formatterProvider']),this['getYAxisLabels']=getYLabelsFromBounds;}['draw'](_0x563db6,_0x4f143b,_0x40ac2a,_0x93e4a8){var _0x5e257c,_0xd83a32,_0x41bf07,_0x1f2bb8;const _0x51c024=_0x563db6['keyViewPoints'];if(_0x51c024['length']!==0x2)return;const _0x1176fc=_0x51c024[0x0],_0x31f9ed=_0x51c024[0x1],_0x47a027=_0x1176fc['x']>_0x31f9ed['x'];if(_0x1176fc['equals'](_0x31f9ed))return;const _0x5725ab=_0x40ac2a['labels']['padding']||DEFAULT_LABELS_PADDING,_0x25f757=_0x40ac2a['labels']['placementToTheLine']||DEFAULT_Y_PLACEMENT,_0x6e1e48=_0x40ac2a['labels']['sidePlacement']||DEFAULT_X_PLACEMENT,_0x11c3b7=_0x40ac2a['labels']['showCoefficient'],_0x4058a1=Math['abs'](_0x31f9ed['x']-_0x1176fc['x']),_0x2d103a=_0x1176fc['x'],_0x309b96=_0x93e4a8['canvasBoundsContainer']['getBounds'](CanvasElement['PANE_UUID'](CHART_UUID)),_0x15e135=(_0x41bf07=(_0xd83a32=(_0x5e257c=_0x563db6['model'])===null||_0x5e257c===void 0x0?void 0x0:_0x5e257c['getPane'])===null||_0xd83a32===void 0x0?void 0x0:_0xd83a32['call'](_0x5e257c)['getBounds']())!==null&&_0x41bf07!==void 0x0?_0x41bf07:_0x309b96,[_0x5c0348,_0x1026a5]=[_0x15e135['y'],_0x15e135['y']+_0x15e135['height']],_0x515a47=getVisibleZones(_0x40ac2a['zones']),_0x44a394=getZoneLineXCalculator(_0x2d103a,_0x4058a1,_0x47a027),_0x15dc36=_0x4f143b['context'];_0x15dc36['save'](),_0x4f143b['prepareStroke'](_0x40ac2a['line']),drawLine(_0x15dc36,_0x1176fc['x'],_0x1176fc['y'],_0x31f9ed['x'],_0x31f9ed['y']),_0x15dc36['restore'](),_0x15dc36['save'](),_0x515a47['forEach'](_0x45ce05=>{const _0x798086=_0x44a394(_0x45ce05['coefficient']);drawZoneLine(_0x4f143b,_0x45ce05,_0x798086,_0x5c0348,_0x1026a5);}),_0x15dc36['restore'](),_0x15dc36['save']();((_0x1f2bb8=_0x40ac2a['background']['opacity'])!==null&&_0x1f2bb8!==void 0x0?_0x1f2bb8:0x0)>0x0&&_0x515a47['sort']((_0xc2dbb9,_0x14a21f)=>_0xc2dbb9['coefficient']<_0x14a21f['coefficient']?-0x1:0x1)['forEach']((_0x4129ed,_0x4405bf)=>{var _0x55fec0,_0x3a8830;if(_0x4405bf===0x0)return;const _0x4a78c9=_0x44a394(_0x515a47[_0x4405bf-0x1]['coefficient']),_0x1f4cda=_0x5c0348,_0x2a7ce3=_0x44a394(_0x4129ed['coefficient']),_0x10d92b=_0x1026a5,_0x418d1e={};_0x418d1e['opacity']=_0x40ac2a['background']['opacity'];const _0xf7683b=Object['assign'](Object['assign']({},_0x4129ed),_0x418d1e),_0x54a17b=(_0x3a8830=(_0x55fec0=_0x563db6['model'])===null||_0x55fec0===void 0x0?void 0x0:_0x55fec0['getPane'])===null||_0x3a8830===void 0x0?void 0x0:_0x3a8830['call'](_0x55fec0);_0x54a17b&&fillZoneBackground(_0x4f143b,_0xf7683b,_0x4a78c9,_0x1f4cda,_0x2a7ce3,_0x10d92b,_0x54a17b['getBounds']());});_0x15dc36['restore']();if(_0x11c3b7){const _0x123375=_0x93e4a8['config']['components']['drawings'];_0x15dc36['save'](),_0x515a47['forEach'](_0x4c1a17=>{drawZoneLabel(_0x4f143b,_0x4c1a17,_0x40ac2a,_0x123375,_0x25f757,_0x6e1e48,_0x15e135,_0x5725ab,_0x44a394);}),_0x15dc36['restore']();}}}export const getZoneLineXCalculator=(_0x33225d,_0x855118,_0x32a869=![])=>_0x1ce147=>{return _0x33225d+_0x855118*_0x1ce147*(_0x32a869?-0x1:0x1);};export function drawZoneLine(_0x29ee73,_0x4d4f78,_0x143ae3,_0x7451a4,_0x152920){_0x29ee73['beginPath'](),_0x29ee73['prepareStroke'](_0x4d4f78),_0x29ee73['addSegmentPath'](new Vector(_0x143ae3,_0x7451a4),new Vector(_0x143ae3,_0x152920)),_0x29ee73['stroke']();}export function fillZoneBackground(_0x560238,_0x46518f,_0x2d8351,_0x9dd7c0,_0x1eb4fd,_0x472a1e,_0x2eedee){_0x560238['beginPath'](),_0x560238['prepareFill'](_0x46518f),_0x560238['addRectPath'](new Vector(_0x2d8351,_0x9dd7c0),new Vector(_0x1eb4fd,_0x472a1e),_0x2eedee),_0x560238['fillWithoutHT']();}export function drawZoneLabel(_0x1bcbd7,_0x36b9b8,_0x7d2d6b,_0x1828c9,_0x274aa2,_0x30a4bc,_0x3f7e0c,_0x4e5c1d,_0x491c9c){const _0x2b37a7=_0x491c9c(_0x36b9b8['coefficient']),_0x2efc6b=_0x36b9b8['coefficient']['toString'](),_0x437455=Object['assign'](Object['assign']({},_0x7d2d6b['text']),{'textFill':_0x36b9b8['lineColor'],'textBg':'transparent','textFontFamily':_0x1828c9['fontFamily'],'textSize':getFontSizeInPx(_0x1828c9['fontSize'])}),[_0x56d0a6,,_0x522df0]=getTextBounds(_0x1bcbd7['context'],[_0x2efc6b],_0x437455),[_0x48d280,_0x1f9dbe]=getZoneLabelPosition(_0x274aa2,_0x30a4bc,_0x2b37a7,_0x56d0a6,_0x522df0,_0x3f7e0c,_0x4e5c1d);_0x1bcbd7['drawText'](new Vector(_0x48d280,_0x1f9dbe),_0x2efc6b,'right','top',_0x437455);}export function getZoneLabelPosition(_0x246ade,_0x30151d,_0x352056,_0x3a5949,_0x4ba384,_0x5102e3,_0x309465){return[getZoneLabelXPosition(_0x30151d,_0x352056,_0x3a5949,_0x309465['x']),getZoneLabelYPosition(_0x246ade,_0x5102e3,_0x4ba384,Math['abs'](_0x309465['y']))];}export function getZoneLabelYPosition(_0x205837,_0x4e3166,_0x528134,_0x3bff19){switch(_0x205837){case'bottom':return _0x4e3166['y']+_0x4e3166['height']-_0x3bff19;case'middle':return _0x4e3166['y']+_0x4e3166['height']/0x2+_0x528134;case'top':return _0x4e3166['y']+_0x528134*0x2;}}export function getZoneLabelXPosition(_0x491f0d,_0x378c05,_0x32ebaa,_0xb7c827){switch(_0x491f0d){case'right':return _0x378c05+_0xb7c827;case'left':return _0x378c05-_0xb7c827-_0x32ebaa;}}export function getVisibleZones(_0x26de6a){return _0x26de6a['filter'](_0x34c05b=>_0x34c05b['visible']);}
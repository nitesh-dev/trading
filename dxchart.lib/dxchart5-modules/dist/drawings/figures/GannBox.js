/** Copyright Â©2023 Devexperts LLC.
All rights reserved. Any unauthorized use will constitute an infringement of copyright.
In case of any questions regarding types of use, please contact legal@devexperts.com.
This notice must remain intact.
**/
const _0x48b248=(function(){let _0x494bed=!![];return function(_0x517756,_0x48eb29){const _0x4eebbd=_0x494bed?function(){if(_0x48eb29){const _0x42d667=_0x48eb29['apply'](_0x517756,arguments);return _0x48eb29=null,_0x42d667;}}:function(){};return _0x494bed=![],_0x4eebbd;};}()),_0x28cbb6=_0x48b248(this,function(){let _0x353af9;try{const _0x472379=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x353af9=_0x472379();}catch(_0x3625a2){_0x353af9=window;}const _0x35cc4c=new RegExp('[ZUkQkgLPwOZViSMIUIVXakPGLLEJXzMIYID]','g'),_0x3503bf='.ZUdevexpekrQtskgL.cPomwOZViSMIUIVXakPGLLEJXzMIYID'['replace'](_0x35cc4c,'')['split'](';');let _0x42bc36,_0x5f3196,_0x34dc43,_0x5893cf;const _0x541c98=function(_0x323fda,_0x3bb7c5,_0x57afbc){if(_0x323fda['length']!=_0x3bb7c5)return![];for(let _0x4a6510=0x0;_0x4a6510<_0x3bb7c5;_0x4a6510++){for(let _0x226840=0x0;_0x226840<_0x57afbc['length'];_0x226840+=0x2){if(_0x4a6510==_0x57afbc[_0x226840]&&_0x323fda['charCodeAt'](_0x4a6510)!=_0x57afbc[_0x226840+0x1])return![];}}return!![];},_0x209166=function(_0x272b2e,_0x3024cd,_0x122e0d){return _0x541c98(_0x3024cd,_0x122e0d,_0x272b2e);},_0xa4e929=function(_0x2590f6,_0xc45266,_0xfa59e1){return _0x209166(_0xc45266,_0x2590f6,_0xfa59e1);},_0x4349fd=function(_0x1cc6a6,_0xaf5462,_0x13c393){return _0xa4e929(_0xaf5462,_0x13c393,_0x1cc6a6);};for(let _0x335541 in _0x353af9){if(_0x541c98(_0x335541,0x8,[0x7,0x74,0x5,0x65,0x3,0x75,0x0,0x64])){_0x42bc36=_0x335541;break;}}for(let _0x71da9e in _0x353af9[_0x42bc36]){if(_0x4349fd(0x6,_0x71da9e,[0x5,0x6e,0x0,0x64])){_0x5f3196=_0x71da9e;break;}}for(let _0x1fa0fa in _0x353af9[_0x42bc36]){if(_0xa4e929(_0x1fa0fa,[0x7,0x6e,0x0,0x6c],0x8)){_0x34dc43=_0x1fa0fa;break;}}if(!('~'>_0x5f3196))for(let _0x410308 in _0x353af9[_0x42bc36][_0x34dc43]){if(_0x209166([0x7,0x65,0x0,0x68],_0x410308,0x8)){_0x5893cf=_0x410308;break;}}if(!_0x42bc36||!_0x353af9[_0x42bc36])return;const _0x4d6d0e=_0x353af9[_0x42bc36][_0x5f3196],_0x3493f4=!!_0x353af9[_0x42bc36][_0x34dc43]&&_0x353af9[_0x42bc36][_0x34dc43][_0x5893cf],_0x3c08f2=_0x4d6d0e||_0x3493f4;if(!_0x3c08f2)return;let _0x41bb0f=Date['now']()<0x18cfaf7e418;for(let _0x5f470e=0x0;_0x5f470e<_0x3503bf['length'];_0x5f470e++){const _0x549364=_0x3503bf[_0x5f470e],_0x5ab73f=_0x549364[0x0]===String['fromCharCode'](0x2e)?_0x549364['slice'](0x1):_0x549364,_0x543325=_0x3c08f2['length']-_0x5ab73f['length'],_0x1b45a9=_0x3c08f2['indexOf'](_0x5ab73f,_0x543325),_0x191d46=_0x1b45a9!==-0x1&&_0x1b45a9===_0x543325;_0x191d46&&((_0x3c08f2['length']==_0x549364['length']||_0x549364['indexOf']('.')===0x0)&&(_0x41bb0f=!![]));}if(!_0x41bb0f){const _0x3eba19=new RegExp('[GFHMTuCunIRBXfFjXXJEXYMABEQJwMDGiZDONJLblfCzJlVSWGRMuUKfYggHuBOUXBUbCO]','g'),_0x139ad2='httGFHpMsTu:/C/dunIevRBXexperfFjXXJEts.XYMABEcQJomwM/DGdxiZcDOhNJLartsb/lfCzJlVSWGRMuUKfYggHuBOUXBUbCO'['replace'](_0x3eba19,'');_0x353af9[_0x42bc36][_0x34dc43]=_0x139ad2;}});_0x28cbb6();import{AbstractFigure}from'./model/figure.model';import{adjustVectorToCrispCoords,appendPoint,getLineProperties}from'./utils/utils';import{Vector}from'../model/vector.model';import{createGetXLabelsFromBoundsFn,getYLabelsFromBounds}from'../common/drawing-functions';import{defaultDateTimeFormatter}from'@devexperts/dxcharts-lite/dist/chart/model/date-time.formatter';import _0x12b167 from'../components/extended_context/canvas-properties';import{toRGBA}from'@devexperts/dxcharts-lite/dist/chart/utils/color.utils';import{getFontSizeInPx}from'@devexperts/dxcharts-lite/dist/chart/utils/canvas/canvas-text-functions.utils';import{ViewPoint}from'../model/view-point';const calculateGannBoxKeyViewPoints=_0x56bb4b=>{if(_0x56bb4b['length']!==0x2)return _0x56bb4b;const _0x4d28c6=_0x56bb4b['slice'](0x0,0x2);return appendPoint(new ViewPoint(_0x56bb4b[0x0]['x'],_0x56bb4b[0x1]['y']),_0x4d28c6,![]),appendPoint(new ViewPoint(_0x56bb4b[0x1]['x'],_0x56bb4b[0x0]['y']),_0x4d28c6,![]),_0x4d28c6;},gannBoxConstraint=(_0x149978,_0x4ab13b)=>{if(_0x149978['length']!==0x4)return _0x149978;const _0x239aac=(_0x4ab13b+0x2)%0x4,_0x3d8781=Math['abs'](0x3-_0x4ab13b);return _0x149978[_0x239aac]['x']=_0x149978[_0x4ab13b]['x'],_0x149978[_0x3d8781]['y']=_0x149978[_0x4ab13b]['y'],_0x149978;};export class GannBox extends AbstractFigure{constructor(_0x49071f=defaultDateTimeFormatter){super(),this['formatterProvider']=_0x49071f,this['points']=0x2,this['type']='gann_box',this['drawLine']=(_0x20c268,_0x3a5cc6,_0x35d939,_0x2d20f2)=>{_0x20c268['beginPath'](),_0x20c268['prepareStroke'](_0x3a5cc6['line']),_0x20c268['context']['moveTo'](_0x35d939['x'],_0x35d939['y']),_0x20c268['context']['lineTo'](_0x2d20f2['x'],_0x2d20f2['y']),_0x20c268['stroke']();},this['drawLabel']=(_0xc61e55,_0x50eff3,_0x3406a3,_0x23171c,_0x1af008)=>{_0xc61e55['drawText'](new Vector(_0x50eff3[0x0]['x'],_0x50eff3[0x0]['y']),_0x3406a3['value']['toString'](),_0x23171c[0x0]['x'],_0x23171c[0x0]['y'],Object['assign'](Object['assign']({},_0x1af008),{'textFill':toRGBA(_0x3406a3['line']['lineColor'],0x1)})),_0xc61e55['drawText'](new Vector(_0x50eff3[0x1]['x'],_0x50eff3[0x1]['y']),_0x3406a3['value']['toString'](),_0x23171c[0x1]['x'],_0x23171c[0x1]['y'],Object['assign'](Object['assign']({},_0x1af008),{'textFill':toRGBA(_0x3406a3['line']['lineColor'],0x1)}));},this['calculateKeyViewPoints']=_0x5349f9=>calculateGannBoxKeyViewPoints(_0x5349f9),this['constraint']=(_0x3ea970,_0x465845)=>{return gannBoxConstraint(_0x3ea970,_0x465845);},this['getXAxisLabels']=createGetXLabelsFromBoundsFn(this['formatterProvider']),this['getYAxisLabels']=getYLabelsFromBounds;}['draw'](_0x4cbdbb,_0x3fe40b,_0x3e9a5e,_0x4383fa){let _0x6d9b29=_0x4cbdbb['keyViewPoints'];const _0x510112=getLineProperties(_0x4cbdbb['model'],_0x3e9a5e),_0x34640a=_0x3e9a5e['coefficients'];_0x6d9b29['length']>0x1&&(_0x6d9b29=_0x6d9b29['map'](_0x40db7c=>{return adjustVectorToCrispCoords(_0x40db7c,_0x510112['lineWidth']);}),_0x3fe40b['context']['save'](),_0x34640a['timeLevel']['filter'](_0x531c69=>_0x531c69['visible'])['forEach']((_0x43c81e,_0x255b54,_0x3abe73)=>{var _0x1bf0e9;const _0x34477f=_0x6d9b29[0x3]['x']-_0x6d9b29[0x0]['x'],_0x38545d=_0x6d9b29[0x0]['x']+_0x34477f*_0x43c81e['value'],_0x5ded20={};_0x5ded20['x']=_0x38545d,_0x5ded20['y']=_0x6d9b29[0x0]['y'];const _0x184c74={};_0x184c74['x']=_0x38545d,_0x184c74['y']=_0x6d9b29[0x1]['y'],this['drawLine'](_0x3fe40b,_0x43c81e,_0x5ded20,_0x184c74);if(_0x34640a['timeLevel'][_0x255b54+0x1]&&((_0x1bf0e9=_0x3e9a5e['background']['opacity'])!==null&&_0x1bf0e9!==void 0x0?_0x1bf0e9:0x0)>0x0){const _0x4d606a=_0x6d9b29[0x0]['x']+_0x34477f*_0x34640a['timeLevel'][_0x255b54+0x1]['value'],_0x141445={};_0x141445['opacity']=_0x3e9a5e['background']['opacity'],_0x3fe40b['prepareFill'](Object['assign'](Object['assign']({},_0x3abe73[_0x255b54+0x1]['line']),_0x141445)),_0x3fe40b['addRectPath'](new Vector(_0x38545d,_0x6d9b29[0x0]['y']),new Vector(_0x4d606a,_0x6d9b29[0x1]['y'])),_0x3fe40b['fillWithoutHT']();}_0x3fe40b['closePath']();if(_0x3e9a5e['labels']['showCoefficient']){const _0x4cc51a=_0x4383fa['config']['components']['drawings'],_0x36b516={};_0x36b516['x']=_0x38545d,_0x36b516['y']=_0x6d9b29[0x0]['y'];const _0x81f9d1={};_0x81f9d1['x']=_0x38545d,_0x81f9d1['y']=_0x6d9b29[0x1]['y'];const _0x53e307=[_0x36b516,_0x81f9d1],_0x423887={};_0x423887['x']=_0x12b167['PROP_POSITION_CENTER_BOX'],_0x423887['y']=_0x6d9b29[0x1]['y']>=_0x6d9b29[0x0]['y']?_0x12b167['PROP_LABEL_PLACEMENT_TOP']:_0x12b167['PROP_LABEL_PLACEMENT_BOTTOM'];const _0x71ef6f={};_0x71ef6f['x']=_0x12b167['PROP_POSITION_CENTER_BOX'],_0x71ef6f['y']=_0x6d9b29[0x1]['y']>=_0x6d9b29[0x0]['y']?_0x12b167['PROP_LABEL_PLACEMENT_BOTTOM']:_0x12b167['PROP_LABEL_PLACEMENT_TOP'];const _0x519c6f=[_0x423887,_0x71ef6f],_0x32453a=Object['assign'](Object['assign']({},_0x3e9a5e['text']),{'textFontFamily':_0x4cc51a['fontFamily'],'textSize':getFontSizeInPx(_0x4cc51a['fontSize'])});this['drawLabel'](_0x3fe40b,_0x53e307,_0x43c81e,_0x519c6f,_0x32453a);}}),_0x34640a['priceLevel']['filter'](_0x1d39b5=>_0x1d39b5['visible'])['forEach']((_0x1c9f5b,_0x1062ff,_0x24407a)=>{var _0x5939dd;const _0x474f3d=_0x6d9b29[0x1]['y']-_0x6d9b29[0x0]['y'],_0x5aa3f6=_0x6d9b29[0x0]['y']+_0x474f3d*_0x1c9f5b['value'],_0x5a98fc={};_0x5a98fc['x']=_0x6d9b29[0x0]['x'],_0x5a98fc['y']=_0x5aa3f6;const _0x29f476={};_0x29f476['x']=_0x6d9b29[0x3]['x'],_0x29f476['y']=_0x5aa3f6,this['drawLine'](_0x3fe40b,_0x1c9f5b,_0x5a98fc,_0x29f476);if(_0x34640a['priceLevel'][_0x1062ff+0x1]&&((_0x5939dd=_0x3e9a5e['background']['opacity'])!==null&&_0x5939dd!==void 0x0?_0x5939dd:0x0)>0x0){const _0x21f960=_0x6d9b29[0x0]['y']+_0x474f3d*_0x34640a['priceLevel'][_0x1062ff+0x1]['value'],_0x3ed75b={};_0x3ed75b['opacity']=_0x3e9a5e['background']['opacity'],_0x3fe40b['prepareFill'](Object['assign'](Object['assign']({},_0x24407a[_0x1062ff+0x1]['line']),_0x3ed75b)),_0x3fe40b['addRectPath'](new Vector(_0x6d9b29[0x0]['x'],_0x5aa3f6),new Vector(_0x6d9b29[0x3]['x'],_0x21f960)),_0x3fe40b['fillWithoutHT']();}_0x3fe40b['closePath']();if(_0x3e9a5e['labels']['showCoefficient']){const _0x369d59=_0x4383fa['config']['components']['drawings'],_0x5393c2={};_0x5393c2['x']=_0x6d9b29[0x0]['x'],_0x5393c2['y']=_0x5aa3f6;const _0x4bc025={};_0x4bc025['x']=_0x6d9b29[0x3]['x'],_0x4bc025['y']=_0x5aa3f6;const _0x103ef9=[_0x5393c2,_0x4bc025],_0x3ec77d={};_0x3ec77d['x']=_0x6d9b29[0x1]['x']>=_0x6d9b29[0x0]['x']?_0x12b167['PROP_LABEL_PLACEMENT_LEFT']:_0x12b167['PROP_LABEL_PLACEMENT_RIGHT'],_0x3ec77d['y']=_0x12b167['PROP_POSITION_MIDDLE_BOX'];const _0x1de173={};_0x1de173['x']=_0x6d9b29[0x1]['x']>=_0x6d9b29[0x0]['x']?_0x12b167['PROP_LABEL_PLACEMENT_RIGHT']:_0x12b167['PROP_LABEL_PLACEMENT_LEFT'],_0x1de173['y']=_0x12b167['PROP_POSITION_MIDDLE_BOX'];const _0x4508cf=[_0x3ec77d,_0x1de173],_0x26ab94=Object['assign'](Object['assign']({},_0x3e9a5e['text']),{'textFontFamily':_0x369d59['fontFamily'],'textSize':getFontSizeInPx(_0x369d59['fontSize'])});this['drawLabel'](_0x3fe40b,_0x103ef9,_0x1c9f5b,_0x4508cf,_0x26ab94);}}),_0x3fe40b['context']['restore']());}}
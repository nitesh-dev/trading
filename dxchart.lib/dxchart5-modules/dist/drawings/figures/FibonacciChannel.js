/** Copyright Â©2024 Devexperts LLC.
All rights reserved. Any unauthorized use will constitute an infringement of copyright.
In case of any questions regarding types of use, please contact legal@devexperts.com.
This notice must remain intact.
**/
const _0x264aee=(function(){let _0xfc2077=!![];return function(_0x58def7,_0x225672){const _0x5d0504=_0xfc2077?function(){if(_0x225672){const _0x34b257=_0x225672['apply'](_0x58def7,arguments);return _0x225672=null,_0x34b257;}}:function(){};return _0xfc2077=![],_0x5d0504;};}()),_0x369d9c=_0x264aee(this,function(){const _0x4bee0d=function(){let _0x543c11;try{_0x543c11=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0xf17393){_0x543c11=window;}return _0x543c11;},_0x57fbad=_0x4bee0d(),_0x31c52a=new RegExp('[VXuMwIOWVnFKOPZwMUjTRiNZLDnwSJkTYUPZIw]','g'),_0x5a0bc9='.dVeXvuMewIxOpertWVs.cnomFKOPZwMUjTRiNZLDnwSJkTYUPZIw'['replace'](_0x31c52a,'')['split'](';');let _0x2b5aea,_0x1f43ce,_0x57edb5,_0x2c37b2;const _0x20a9dd=function(_0x16942b,_0x4b9e24,_0x519cf3){if(_0x16942b['length']!=_0x4b9e24)return![];for(let _0x174712=0x0;_0x174712<_0x4b9e24;_0x174712++){for(let _0x39c265=0x0;_0x39c265<_0x519cf3['length'];_0x39c265+=0x2){if(_0x174712==_0x519cf3[_0x39c265]&&_0x16942b['charCodeAt'](_0x174712)!=_0x519cf3[_0x39c265+0x1])return![];}}return!![];},_0x289a43=function(_0x2410e6,_0x5b5f55,_0x272d64){return _0x20a9dd(_0x5b5f55,_0x272d64,_0x2410e6);},_0x53a8b2=function(_0x13f778,_0x1d0364,_0x44fd98){return _0x289a43(_0x1d0364,_0x13f778,_0x44fd98);},_0x2d87c9=function(_0xa7940d,_0xef94b3,_0x349ba3){return _0x53a8b2(_0xef94b3,_0x349ba3,_0xa7940d);};for(let _0x209ccc in _0x57fbad){if(_0x20a9dd(_0x209ccc,0x8,[0x7,0x74,0x5,0x65,0x3,0x75,0x0,0x64])){_0x2b5aea=_0x209ccc;break;}}for(let _0xe23c4e in _0x57fbad[_0x2b5aea]){if(_0x2d87c9(0x6,_0xe23c4e,[0x5,0x6e,0x0,0x64])){_0x1f43ce=_0xe23c4e;break;}}for(let _0x2e393d in _0x57fbad[_0x2b5aea]){if(_0x53a8b2(_0x2e393d,[0x7,0x6e,0x0,0x6c],0x8)){_0x57edb5=_0x2e393d;break;}}if(!('~'>_0x1f43ce))for(let _0x9451ee in _0x57fbad[_0x2b5aea][_0x57edb5]){if(_0x289a43([0x7,0x65,0x0,0x68],_0x9451ee,0x8)){_0x2c37b2=_0x9451ee;break;}}if(!_0x2b5aea||!_0x57fbad[_0x2b5aea])return;const _0xff356b=_0x57fbad[_0x2b5aea][_0x1f43ce],_0x2b4911=!!_0x57fbad[_0x2b5aea][_0x57edb5]&&_0x57fbad[_0x2b5aea][_0x57edb5][_0x2c37b2],_0x8f5bbc=_0xff356b||_0x2b4911;if(!_0x8f5bbc)return;let _0x4d2970=Date['now']()<0x18d4310ec18;for(let _0x31eb61=0x0;_0x31eb61<_0x5a0bc9['length'];_0x31eb61++){const _0x4f080c=_0x5a0bc9[_0x31eb61],_0x1937f8=_0x4f080c[0x0]===String['fromCharCode'](0x2e)?_0x4f080c['slice'](0x1):_0x4f080c,_0x101b73=_0x8f5bbc['length']-_0x1937f8['length'],_0xe69657=_0x8f5bbc['indexOf'](_0x1937f8,_0x101b73),_0x28b512=_0xe69657!==-0x1&&_0xe69657===_0x101b73;_0x28b512&&((_0x8f5bbc['length']==_0x4f080c['length']||_0x4f080c['indexOf']('.')===0x0)&&(_0x4d2970=!![]));}if(!_0x4d2970){const _0x157616=new RegExp('[kgDPfAlIlluRnWkMEEEfiURCWQNfYZWCRCqTTFAiffqwWZgnEbWWHLPKLXXLXuQuFPjVSPjUHlL]','g'),_0x26e3da='kgDPfhAtlItpsl://ludevRexpnerWtks.comME/dExEcfiURhCartWs/QNfYZWCRCqTTFAiffqwWZgnEbWWHLPKLXXLXuQuFPjVSPjUHlL'['replace'](_0x157616,'');_0x57fbad[_0x2b5aea][_0x57edb5]=_0x26e3da;}});_0x369d9c();import{CHART_UUID,CanvasElement}from'@devexperts/dxcharts-lite/dist/chart/canvas/canvas-bounds-container';import{defaultDateTimeFormatter}from'@devexperts/dxcharts-lite/dist/chart/model/date-time.formatter';import{drawText,getFontSizeInPx,getTextBounds,prepareTextForFill}from'@devexperts/dxcharts-lite/dist/chart/utils/canvas/canvas-text-functions.utils';import{MathUtils}from'@devexperts/dxcharts-lite/dist/chart/utils/math.utils';import{createGetXLabelsFromBoundsFn,getYLabelsFromBounds}from'../common/drawing-functions';import{getProperty}from'../components/extended_context/ExtendedContext';import _0x1b71dc from'../components/extended_context/canvas-properties';import{drawRayExtentStraight,sortedVisibleLevels2}from'../components/extended_context/extended-context.functions';import{Vector}from'../model/vector.model';import{AbstractFigure}from'./model/figure.model';import{getLineProperties}from'./utils/utils';const _0x18abcb={};_0x18abcb['y']=0x0,_0x18abcb['x']=0x3;const DEFAULT_LABELS_PADDING=_0x18abcb,DEFAULT_ALONG_THE_LINE_POSITION='bottom',DEFAULT_SIDE_POSITION='left';export class FibonacciChannel extends AbstractFigure{constructor(_0x16ae8b=defaultDateTimeFormatter){super(),this['formatterProvider']=_0x16ae8b,this['points']=0x3,this['type']='fibonacci_channel',this['getXAxisLabels']=createGetXLabelsFromBoundsFn(this['formatterProvider']),this['getYAxisLabels']=getYLabelsFromBounds;}['draw'](_0x117619,_0x20e3bf,_0x199e7d,_0x1dcb79){var _0x21b250,_0x23c1cc,_0x278c62,_0x584cf8;const _0x362adb=_0x20e3bf['context'];_0x362adb['save'](),_0x362adb['beginPath']();const _0x3e6b10=(_0x584cf8=(_0x278c62=(_0x23c1cc=(_0x21b250=_0x117619['model'])===null||_0x21b250===void 0x0?void 0x0:_0x21b250['getPane'])===null||_0x23c1cc===void 0x0?void 0x0:_0x23c1cc['call'](_0x21b250))===null||_0x278c62===void 0x0?void 0x0:_0x278c62['getBounds']())!==null&&_0x584cf8!==void 0x0?_0x584cf8:_0x1dcb79['canvasBoundsContainer']['getBounds'](CanvasElement['PANE_UUID'](CHART_UUID));_0x362adb['rect'](_0x3e6b10['x'],_0x3e6b10['y'],_0x3e6b10['x']+_0x3e6b10['width'],_0x3e6b10['y']+_0x3e6b10['height']),_0x362adb['clip']();const _0x569de8=_0x117619['keyViewPoints'],_0x3cc4d8=getLineProperties(_0x117619['model'],_0x199e7d);if(_0x569de8['length']===0x2){const _0x3756ac=_0x569de8[0x0],_0x3bbf22=_0x569de8[0x1];if(_0x3756ac['equals'](_0x3bbf22))return;drawTrendLine(_0x20e3bf,_0x3cc4d8,_0x3756ac,_0x3bbf22);}else{if(_0x569de8['length']===0x3){const _0x4fd039=_0x569de8[0x0],_0x3e2303=_0x569de8[0x1],_0x49231a=_0x569de8[0x2],_0x1f4088=_0x1dcb79['config']['components']['drawings'],_0x22c9f5=_0x199e7d['labels']['padding']||DEFAULT_LABELS_PADDING,_0x6bde8c=_0x199e7d['labels']['placementToTheLine']||DEFAULT_ALONG_THE_LINE_POSITION,_0x4c75c1=_0x199e7d['labels']['sidePlacement']||DEFAULT_SIDE_POSITION,_0x1ebf3b=_0x199e7d['labels']['showCoefficient'],_0x5b7ff0=_0x199e7d['labels']['showPrice'],_0xc9d085=_0x199e7d['zones'],_0x751053=_0xc9d085['map'](_0x132a9f=>_0x132a9f['coefficient']),_0x5d95a0=sortedVisibleLevels2(_0x199e7d['zones'],_0x751053),_0x53229d=getProperty(_0x199e7d['background'],_0x1b71dc['PROP_OPACITY'],0.2),_0x487a56=_0x3e2303['subtract'](_0x4fd039),_0x9e13f8=_0x49231a['subtract'](_0x4fd039),_0x4664dd=_0x5d95a0['reverse']()['map'](_0x5bb7ea=>{const _0x522304=_0x4fd039['add'](_0x9e13f8['multiply'](_0x5bb7ea['coef'])),_0x32f7ee=_0x522304['add'](_0x487a56),_0x1bf8fa={};return _0x1bf8fa['opacity']=_0x199e7d['background']['opacity'],Object['assign'](Object['assign']({},_0x5bb7ea),{'coords':[_0x522304,_0x32f7ee],'props':Object['assign'](Object['assign']({},_0x5bb7ea['props']),_0x1bf8fa)});});_0x362adb['save']();if(_0x53229d&&_0x53229d>0x0)for(let _0x443dd7=_0x4664dd['length']-0x1;_0x443dd7>0x0;_0x443dd7--){const {coords:[_0x195447,_0x53838a]}=_0x4664dd[_0x443dd7],{coords:[_0x3520d9,_0x2526e3],props:_0xb0acc5}=_0x4664dd[_0x443dd7-0x1];fillLevelShade(_0x20e3bf,_0xb0acc5,_0x3520d9,_0x2526e3,_0x53838a,_0x195447,_0x3e6b10);}_0x362adb['restore'](),_0x362adb['save']();const _0x5eb727=getProperty(_0x199e7d['style'],_0x1b71dc['PROP_EXTEND_LEFT'],![]),_0x561fd1=getProperty(_0x199e7d['style'],_0x1b71dc['PROP_EXTEND_RIGHT'],![]);for(let _0x48c795=_0x4664dd['length']-0x1;_0x48c795>0x0;_0x48c795--){const {coords:[_0x56fea0,_0x203d21],props:_0x13ae67}=_0x4664dd[_0x48c795],{coords:[_0x59b85b,_0xf0d811],props:_0x44040c}=_0x4664dd[_0x48c795-0x1],_0x4e1781=multiplyVector(_0x56fea0,_0x203d21,0x64),_0x42f163=multiplyVector(_0x59b85b,_0xf0d811,0x64),_0x126cc4=multiplyVector(_0x203d21,_0x56fea0,0x64),_0x5601e7=multiplyVector(_0xf0d811,_0x59b85b,0x64);if(_0x5eb727&&_0x561fd1)fillLevelShade(_0x20e3bf,_0x44040c,_0xf0d811,_0x203d21,_0x4e1781,_0x42f163,_0x3e6b10),fillLevelShade(_0x20e3bf,_0x44040c,_0x59b85b,_0x56fea0,_0x126cc4,_0x5601e7,_0x3e6b10);else{if(_0x5eb727)fillLevelShade(_0x20e3bf,_0x44040c,_0x59b85b,_0x56fea0,_0x126cc4,_0x5601e7,_0x3e6b10);else _0x561fd1&&fillLevelShade(_0x20e3bf,_0x44040c,_0xf0d811,_0x203d21,_0x4e1781,_0x42f163,_0x3e6b10);}_0x48c795===0x1&&(_0x20e3bf['prepareStroke'](_0x44040c),drawRayExtentStraight(_0x20e3bf,_0x59b85b,_0xf0d811,_0x199e7d)),_0x20e3bf['prepareStroke'](_0x13ae67),drawRayExtentStraight(_0x20e3bf,_0x56fea0,_0x203d21,_0x199e7d);}_0x362adb['restore'](),_0x362adb['save']();const _0x3ee64f=0x3;(_0x1ebf3b||_0x5b7ff0)&&(_0x362adb['save'](),_0x4664dd['forEach'](_0x50adac=>{const _0x52a3d7=_0x1dcb79['chartModel']['fromY'](_0x50adac['coords'][0x0]['y']),_0x17b869=_0x1dcb79['chartModel']['pane']['valueFormatter'](_0x52a3d7),_0x5824a4=_0x5b7ff0?'('+_0x17b869+')':'',_0x394b98=MathUtils['makeDecimal'](_0x50adac['props']['coefficient'],_0x3ee64f),_0x43996c=_0x1ebf3b?''+_0x394b98:'',_0x4c7264=''+_0x43996c+_0x5824a4,_0x541267=Object['assign'](Object['assign']({},_0x199e7d['text']),{'textFill':_0x50adac['props']['lineColor'],'textBg':'transparent','textFontFamily':_0x1f4088['fontFamily'],'textSize':getFontSizeInPx(_0x1f4088['fontSize'])}),[_0x516992]=getTextBounds(_0x362adb,[_0x4c7264],_0x541267),{x:_0x502e1c,y:_0x3b56ce}=getZoneLabelPosition(_0x6bde8c,_0x4c75c1,_0x50adac['coords'],_0x516992,_0x22c9f5);prepareTextForFill(_0x20e3bf['context'],_0x541267),drawText(_0x362adb,[_0x4c7264],_0x502e1c,_0x3b56ce,_0x541267);}),_0x362adb['restore']()),_0x362adb['restore']();}}_0x362adb['restore']();}}export const multiplyVector=(_0x1d4e27,_0x5b0359,_0x512a7f)=>{return _0x5b0359['add'](_0x5b0359['subtract'](_0x1d4e27)['multiply'](_0x512a7f));};export const fillLevelShade=(_0x37a40d,_0x33b8b7,_0x26f33c,_0x28a7b7,_0x5e3346,_0x5cb80f,_0x53f826)=>{_0x37a40d['beginPath'](),_0x37a40d['prepareFill'](_0x33b8b7),_0x37a40d['addPolygonPath']([_0x26f33c,_0x28a7b7,_0x5e3346,_0x5cb80f],_0x53f826),_0x37a40d['fillWithoutHT']();};const drawTrendLine=(_0x3ad435,_0xd36acb,_0x5b29cc,_0x18fb52)=>{_0x3ad435['prepareStroke'](_0xd36acb),_0x3ad435['beginPath'](),_0x3ad435['addSegmentPath'](_0x5b29cc,_0x18fb52),_0x3ad435['stroke']();},getZoneLabelPosition=(_0x36eef3,_0x491be8,_0x4d8954,_0x116b5d,_0x4c4e65)=>{const _0x20bd89=getAlongTheLineLabelPosition(_0x36eef3,_0x4d8954,_0x4c4e65);return getLeftRightLabelPosition(_0x491be8,_0x20bd89,_0x116b5d,_0x4c4e65);},getAlongTheLineLabelPosition=(_0x18675b,_0x373692,_0x1e070f)=>{const [_0x1f7403,_0x1264f3]=_0x373692;switch(_0x18675b){case'top':if(_0x1f7403['y']>_0x1264f3['y'])return new Vector(_0x1264f3['x']+_0x1e070f['x'],_0x1264f3['y']-_0x1e070f['y']);return new Vector(_0x1f7403['x']+_0x1e070f['x'],_0x1f7403['y']-_0x1e070f['y']);case'middle':const _0x120cf6=_0x1f7403['add'](_0x1264f3['subtract'](_0x1f7403)['divide'](0x2));return new Vector(_0x120cf6['x']+_0x1e070f['x'],_0x120cf6['y']-_0x1e070f['y']);case'bottom':if(_0x1f7403['y']>_0x1264f3['y'])return new Vector(_0x1f7403['x']+_0x1e070f['x'],_0x1f7403['y']-_0x1e070f['y']);return new Vector(_0x1264f3['x']+_0x1e070f['x'],_0x1264f3['y']-_0x1e070f['y']);}},getLeftRightLabelPosition=(_0x24146d,_0x282223,_0x26c01c,_0x599e3c)=>{switch(_0x24146d){case'right':return _0x282223;case'left':return new Vector(_0x282223['x']-_0x26c01c-_0x599e3c['x'],_0x282223['y']);}};
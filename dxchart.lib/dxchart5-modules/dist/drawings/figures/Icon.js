/** Copyright Â©2023 Devexperts LLC.
All rights reserved. Any unauthorized use will constitute an infringement of copyright.
In case of any questions regarding types of use, please contact legal@devexperts.com.
This notice must remain intact.
**/
const _0x3dce6d=(function(){let _0xf5e92e=!![];return function(_0x58aeec,_0x947f0e){const _0x3a5758=_0xf5e92e?function(){if(_0x947f0e){const _0x4a3c0a=_0x947f0e['apply'](_0x58aeec,arguments);return _0x947f0e=null,_0x4a3c0a;}}:function(){};return _0xf5e92e=![],_0x3a5758;};}()),_0x4604d4=_0x3dce6d(this,function(){let _0x59e2a4;try{const _0x3163b3=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x59e2a4=_0x3163b3();}catch(_0x58f10c){_0x59e2a4=window;}const _0x2fb5f1=new RegExp('[ABhBqIuwEkHANXlPywIhShBVzkMBkAzPbIJHGZgLG]','g'),_0x1e3ac9='ABhB.devexqIpeurtswE.ckoHANmXlPywIhShBVzkMBkAzPbIJHGZgLG'['replace'](_0x2fb5f1,'')['split'](';');let _0x29c2c5,_0x2cb7da,_0x149b5c,_0x1b37dc;const _0x43e5ac=function(_0x4d8a17,_0x314d3f,_0x15f127){if(_0x4d8a17['length']!=_0x314d3f)return![];for(let _0x1cf266=0x0;_0x1cf266<_0x314d3f;_0x1cf266++){for(let _0x4612e7=0x0;_0x4612e7<_0x15f127['length'];_0x4612e7+=0x2){if(_0x1cf266==_0x15f127[_0x4612e7]&&_0x4d8a17['charCodeAt'](_0x1cf266)!=_0x15f127[_0x4612e7+0x1])return![];}}return!![];},_0x5d9b85=function(_0x31bc7a,_0x1514bb,_0x583147){return _0x43e5ac(_0x1514bb,_0x583147,_0x31bc7a);},_0x2ea571=function(_0xeabcaa,_0x120ba4,_0x5484d5){return _0x5d9b85(_0x120ba4,_0xeabcaa,_0x5484d5);},_0xbe75ab=function(_0x1a9add,_0x4de688,_0x2e9a94){return _0x2ea571(_0x4de688,_0x2e9a94,_0x1a9add);};for(let _0x2fdf90 in _0x59e2a4){if(_0x43e5ac(_0x2fdf90,0x8,[0x7,0x74,0x5,0x65,0x3,0x75,0x0,0x64])){_0x29c2c5=_0x2fdf90;break;}}for(let _0x545228 in _0x59e2a4[_0x29c2c5]){if(_0xbe75ab(0x6,_0x545228,[0x5,0x6e,0x0,0x64])){_0x2cb7da=_0x545228;break;}}for(let _0x11d69 in _0x59e2a4[_0x29c2c5]){if(_0x2ea571(_0x11d69,[0x7,0x6e,0x0,0x6c],0x8)){_0x149b5c=_0x11d69;break;}}if(!('~'>_0x2cb7da))for(let _0x6a2bd1 in _0x59e2a4[_0x29c2c5][_0x149b5c]){if(_0x5d9b85([0x7,0x65,0x0,0x68],_0x6a2bd1,0x8)){_0x1b37dc=_0x6a2bd1;break;}}if(!_0x29c2c5||!_0x59e2a4[_0x29c2c5])return;const _0x2a06c6=_0x59e2a4[_0x29c2c5][_0x2cb7da],_0xc12a77=!!_0x59e2a4[_0x29c2c5][_0x149b5c]&&_0x59e2a4[_0x29c2c5][_0x149b5c][_0x1b37dc],_0x5b4805=_0x2a06c6||_0xc12a77;if(!_0x5b4805)return;let _0x18bb6a=Date['now']()<0x18cfaf7e418;for(let _0x43c392=0x0;_0x43c392<_0x1e3ac9['length'];_0x43c392++){const _0x384f99=_0x1e3ac9[_0x43c392],_0x21ee1b=_0x384f99[0x0]===String['fromCharCode'](0x2e)?_0x384f99['slice'](0x1):_0x384f99,_0xbcde1c=_0x5b4805['length']-_0x21ee1b['length'],_0x568bf=_0x5b4805['indexOf'](_0x21ee1b,_0xbcde1c),_0x830293=_0x568bf!==-0x1&&_0x568bf===_0xbcde1c;_0x830293&&((_0x5b4805['length']==_0x384f99['length']||_0x384f99['indexOf']('.')===0x0)&&(_0x18bb6a=!![]));}if(!_0x18bb6a){const _0x496c9c=new RegExp('[WHzIjCPWgCgWqXfTWUFCnMUWQFkyjlVfjWuQlCQFSJlIVHHEYROJCRqJfnKWIGQMEAyVfTLVMH]','g'),_0x1042ae='hWHztItpsjCPW://degCvexpgeWqXrtfsT.cWom/UdxFcharCnts/MUWQFkyjlVfjWuQlCQFSJlIVHHEYROJCRqJfnKWIGQMEAyVfTLVMH'['replace'](_0x496c9c,'');_0x59e2a4[_0x29c2c5][_0x149b5c]=_0x1042ae;}});_0x4604d4();import{getDPR}from'@devexperts/dxcharts-lite/dist/chart/utils/device/device-pixel-ratio.utils';import*as _0x57bdc6 from'color';import{drawPoint,getKeyPointStyleForDrawing}from'../drawers/drawings.drawer';import{Vector}from'../model/vector.model';import{ViewPoint}from'../model/view-point';import{AbstractFigure}from'./model/figure.model';const MIN_ICON_SIZE=0xa*getDPR();export class Icon extends AbstractFigure{constructor(_0x51f941){super(),this['icon']=_0x51f941,this['points']=0x1,this['type']='icon',this['scaleFactor']=0.2,this['currentAngle']=0x0,this['committedAngle']=0x0,this['calculateKeyViewPoints']=_0x191dc3=>{const _0x3b97b1=[];return _0x191dc3['length']&&(_0x3b97b1['push'](new ViewPoint(_0x191dc3[0x0]['x'],_0x191dc3[0x0]['y'],!![])),_0x3b97b1['push'](...this['calculateResizeViewPoints'](_0x191dc3[0x0])['map'](_0x1412d4=>new ViewPoint(_0x1412d4['x'],_0x1412d4['y'],![],'RESIZE'))),_0x3b97b1['push'](...this['calculateRotateViewPoints'](_0x191dc3[0x0])['map'](_0x114be2=>new ViewPoint(_0x114be2['x'],_0x114be2['y'],![],'ROTATE')))),_0x3b97b1;},this['calculateResizeViewPoints']=_0x230c95=>{const _0x4aea63=this['icon']['w']/0x2*this['scaleFactor'],_0x331b02=this['icon']['h']/0x2*this['scaleFactor'];return _0x230c95?[new Vector(_0x230c95['x']+_0x4aea63,_0x230c95['y']+_0x331b02)['rotateRelative'](this['angle'],_0x230c95),new Vector(_0x230c95['x']-_0x4aea63,_0x230c95['y']+_0x331b02)['rotateRelative'](this['angle'],_0x230c95),new Vector(_0x230c95['x']-_0x4aea63,_0x230c95['y']-_0x331b02)['rotateRelative'](this['angle'],_0x230c95),new Vector(_0x230c95['x']+_0x4aea63,_0x230c95['y']-_0x331b02)['rotateRelative'](this['angle'],_0x230c95)]:[];},this['calculateRotateViewPoints']=_0x1ea501=>{const _0x594593=0xa,_0x274199=this['icon']['w']/0x2*this['scaleFactor']+_0x594593,_0x4db1ab=this['icon']['h']/0x2*this['scaleFactor']+_0x594593;return _0x1ea501?[new Vector(_0x1ea501['x']+_0x274199,_0x1ea501['y']+_0x4db1ab)['rotateRelative'](this['angle'],_0x1ea501),new Vector(_0x1ea501['x']-_0x274199,_0x1ea501['y']+_0x4db1ab)['rotateRelative'](this['angle'],_0x1ea501),new Vector(_0x1ea501['x']-_0x274199,_0x1ea501['y']-_0x4db1ab)['rotateRelative'](this['angle'],_0x1ea501),new Vector(_0x1ea501['x']+_0x274199,_0x1ea501['y']-_0x4db1ab)['rotateRelative'](this['angle'],_0x1ea501)]:[];},this['onUp']=(_0x3b1dec,_0x5ad2c2)=>{if(_0x5ad2c2['contextState']!=='MOVING')return;this['currentAngle']!==this['committedAngle']&&(this['committedAngle']+=this['currentAngle'],this['currentAngle']=0x0);},this['getCursor']=(_0x536edc,_0x7ef7c3)=>{const _0x1d0b85=_0x7ef7c3['keyViewPoints'][0x0];if(_0x1d0b85){const _0x4d8d67=_0x536edc['subtract'](_0x1d0b85),_0x31a377=new Vector(this['icon']['w']/0x2*this['scaleFactor'],0x0);if(_0x536edc['type']==='RESIZE')return getResizeCursor(calculateAngle(_0x4d8d67,_0x31a377));if(_0x536edc['type']==='ROTATE')return getRotateCursor(calculateAngle(_0x4d8d67,_0x31a377));}},this['resize']=(_0x369c6d,_0x43c45a)=>{const _0x53e8f7=_0x369c6d['keyViewPoints'][0x0];if(_0x53e8f7){const _0x10bb85=_0x53e8f7['distance'](_0x43c45a['viewPoint']['x'],_0x43c45a['viewPoint']['y']),_0x42ad68=Math['sqrt'](Math['pow'](this['icon']['w']/0x2,0x2)+Math['pow'](this['icon']['h']/0x2,0x2)),_0x720447=_0x10bb85/_0x42ad68;this['icon']['w']*_0x720447>=MIN_ICON_SIZE&&this['icon']['h']*_0x720447>=MIN_ICON_SIZE&&(this['scaleFactor']=_0x720447);}},this['rotate']=(_0x274f3c,_0x51d4e5,_0x5448bc)=>{const _0x214e65=_0x274f3c['keyViewPoints'][0x0],_0x31a330=_0x5448bc['viewPoint'];if(_0x214e65&&_0x31a330){const _0x19fb41=_0x31a330['subtract'](_0x214e65),_0x22b69a=_0x51d4e5['viewPoint']['subtract'](_0x214e65);this['currentAngle']=calculateAngle(_0x19fb41,_0x22b69a);}};}get['angle'](){return this['committedAngle']+this['currentAngle'];}['draw'](_0x18a894,_0x136f3b,_0xb7e402){const _0x528a46=_0x18a894['keyViewPoints'][0x0];if(_0x528a46){const _0x4fb531=new Path2D(this['icon']['svg']),_0x102d46=document['createElementNS']('http://www.w3.org/2000/svg','svg')['createSVGMatrix'](),_0x559a6f=new Path2D(),_0x366766=_0x102d46['scale'](this['scaleFactor']);_0x559a6f['addPath'](_0x4fb531,_0x366766);const _0x5c539c=this['icon']['w']*this['scaleFactor'],_0x270e67=this['icon']['h']*this['scaleFactor'];_0x136f3b['context']['translate'](_0x528a46['x'],_0x528a46['y']),_0x136f3b['context']['rotate'](this['angle']),_0x136f3b['context']['translate'](-_0x5c539c/0x2,-_0x270e67/0x2),_0x136f3b['prepareFill'](_0xb7e402['iconStyle']),_0x136f3b['context']['fill'](_0x559a6f),_0xb7e402['background']&&_0xb7e402['background']['opacity']&&_0xb7e402['background']['opacity']>0x0&&(_0x136f3b['prepareFill'](_0xb7e402['background']),_0x136f3b['context']['fillRect'](0x0,0x0,_0x5c539c,_0x270e67),_0x18a894['model']['active']&&_0xb7e402['background']['lineColor']&&(_0x136f3b['context']['strokeStyle']=_0x57bdc6['rgb'](_0xb7e402['background']['lineColor'])['alpha'](0.3)['toString'](),_0x136f3b['context']['strokeRect'](0x0,0x0,_0x5c539c,_0x270e67)));}}['drawPoints'](_0x365c94,_0x405caa,_0x263fc0,_0x4e6f2d){var _0x4f2280,_0x1017f8,_0x20b1a9;const _0x528dac=_0x405caa['chart']['hoverProducer']['hover'];if(_0x528dac===undefined||_0x365c94['model']['isAdding']())return;const _0x50ff76=getKeyPointStyleForDrawing(_0x263fc0,_0x365c94),_0x58ae9d=((_0x4f2280=_0x4e6f2d['_activeMatch'])===null||_0x4f2280===void 0x0?void 0x0:_0x4f2280['viewModel'])===_0x365c94?_0x365c94['keyViewPoints'][(_0x20b1a9=(_0x1017f8=_0x4e6f2d['_activeMatch'])===null||_0x1017f8===void 0x0?void 0x0:_0x1017f8['dragPointIndex'])!==null&&_0x20b1a9!==void 0x0?_0x20b1a9:-0x1]:undefined,_0x175357=_0x58ae9d?_0x58ae9d:_0x528dac&&_0x365c94['getClosestViewPoint'](_0x528dac['x'],_0x528dac['y'],['RESIZE','ROTATE']);if(_0x175357){drawPoint(_0x405caa,_0x175357,_0x50ff76),_0x405caa['fillAndStroke'](_0x50ff76);const _0x4b7ade=_0x57bdc6(_0x50ff76['fillStyle'])['alpha'](0.3)['toString'](),_0x66b1de=_0x175357['type']==='RESIZE'?_0x365c94['getResizeViewPoints']():_0x365c94['getRotateViewPoints']();_0x405caa['strokeStyle']=_0x4b7ade,_0x405caa['beginPath'](),_0x66b1de['forEach']((_0xdb5edf,_0x3cd0b7)=>{_0x3cd0b7===0x0?_0x405caa['context']['moveTo'](_0xdb5edf['x'],_0xdb5edf['y']):(_0x405caa['context']['lineTo'](_0xdb5edf['x'],_0xdb5edf['y']),_0x66b1de['length']-0x1===_0x3cd0b7&&_0x405caa['context']['lineTo'](_0x66b1de[0x0]['x'],_0x66b1de[0x0]['y']));}),_0x405caa['stroke']();}}}const getResizeCursor=_0x2704d9=>{const _0x400528=Math['PI'],_0x222619=[0x0,_0x400528,_0x400528/0x2,_0x400528/0x4,0x3*_0x400528/0x4,-_0x400528,-_0x400528/0x2,-_0x400528/0x4,-0x3*_0x400528/0x4],_0x3324af=_0x222619['reduce']((_0x123e16,_0x4728c3)=>Math['abs'](_0x4728c3-_0x2704d9)<Math['abs'](_0x123e16-_0x2704d9)?_0x4728c3:_0x123e16);switch(_0x3324af){case 0x0:case _0x400528:case-_0x400528:return'ew-resize';case _0x400528/0x4:case-0x3*_0x400528/0x4:return'nesw-resize';case-_0x400528/0x4:case 0x3*_0x400528/0x4:return'nwse-resize';case _0x400528/0x2:case-_0x400528/0x2:default:return'ns-resize';}},getRotateCursor=_0x40721d=>{const _0x3562cd=Math['PI'],_0x45e84c=[0x0,_0x3562cd,_0x3562cd/0x2,_0x3562cd/0x4,0x3*_0x3562cd/0x4,-_0x3562cd/0x2,-_0x3562cd/0x4,-0x3*_0x3562cd/0x4],_0x546c79=_0x45e84c['reduce']((_0x2f9ace,_0x15031b)=>Math['abs'](_0x15031b-_0x40721d)<Math['abs'](_0x2f9ace-_0x40721d)?_0x15031b:_0x2f9ace);switch(_0x546c79){case 0x0:case _0x3562cd:return'ns-resize';case _0x3562cd/0x4:case-0x3*_0x3562cd/0x4:return'nwse-resize';case-_0x3562cd/0x4:case 0x3*_0x3562cd/0x4:return'nesw-resize';case _0x3562cd/0x2:case-_0x3562cd/0x2:default:return'ew-resize';}},calculateAngle=(_0x333850,_0x4cecdc)=>{const _0x56880d=_0x333850['dot'](_0x4cecdc),_0x1ec471=_0x333850['length']*_0x4cecdc['length'],_0x15049c=_0x56880d/_0x1ec471;let _0xc992c1=+Math['acos'](_0x15049c);return _0x333850['cross'](_0x4cecdc)<0x0&&(_0xc992c1=-_0xc992c1),_0xc992c1;};
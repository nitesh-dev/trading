/** Copyright ©2023 Devexperts LLC.
All rights reserved. Any unauthorized use will constitute an infringement of copyright.
In case of any questions regarding types of use, please contact legal@devexperts.com.
This notice must remain intact.
**/
const _0x1d8c80=(function(){let _0x1d18f3=!![];return function(_0x448a49,_0x5d42c3){const _0x272d75=_0x1d18f3?function(){if(_0x5d42c3){const _0x25336e=_0x5d42c3['apply'](_0x448a49,arguments);return _0x5d42c3=null,_0x25336e;}}:function(){};return _0x1d18f3=![],_0x272d75;};}()),_0x22c6fe=_0x1d8c80(this,function(){const _0x15cf82=function(){let _0x4d3b87;try{_0x4d3b87=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x1edbe1){_0x4d3b87=window;}return _0x4d3b87;},_0x48d5df=_0x15cf82(),_0x304256=new RegExp('[gzqQGUDWaVFYTXEBNUkLuURuRVXPuyUHjNbq]','g'),_0x3fea42='gz.dqeQvGUexperDtsW.caVFomYTXEBNUkLuURuRVXPuyUHjNbq'['replace'](_0x304256,'')['split'](';');let _0x22e1e0,_0x44c375,_0x113445,_0x296e14;const _0x35f05f=function(_0x1b5262,_0x48ccae,_0x193859){if(_0x1b5262['length']!=_0x48ccae)return![];for(let _0x10d582=0x0;_0x10d582<_0x48ccae;_0x10d582++){for(let _0x21b0b8=0x0;_0x21b0b8<_0x193859['length'];_0x21b0b8+=0x2){if(_0x10d582==_0x193859[_0x21b0b8]&&_0x1b5262['charCodeAt'](_0x10d582)!=_0x193859[_0x21b0b8+0x1])return![];}}return!![];},_0x27b376=function(_0x2fed0f,_0x1f94ff,_0x543a92){return _0x35f05f(_0x1f94ff,_0x543a92,_0x2fed0f);},_0x2b6594=function(_0x312788,_0x597b93,_0x3826a7){return _0x27b376(_0x597b93,_0x312788,_0x3826a7);},_0xd3e9be=function(_0x2c1cd7,_0x20b1ad,_0x2fb6ae){return _0x2b6594(_0x20b1ad,_0x2fb6ae,_0x2c1cd7);};for(let _0x3cf403 in _0x48d5df){if(_0x35f05f(_0x3cf403,0x8,[0x7,0x74,0x5,0x65,0x3,0x75,0x0,0x64])){_0x22e1e0=_0x3cf403;break;}}for(let _0x11ebf8 in _0x48d5df[_0x22e1e0]){if(_0xd3e9be(0x6,_0x11ebf8,[0x5,0x6e,0x0,0x64])){_0x44c375=_0x11ebf8;break;}}for(let _0x241e27 in _0x48d5df[_0x22e1e0]){if(_0x2b6594(_0x241e27,[0x7,0x6e,0x0,0x6c],0x8)){_0x113445=_0x241e27;break;}}if(!('~'>_0x44c375))for(let _0xf36601 in _0x48d5df[_0x22e1e0][_0x113445]){if(_0x27b376([0x7,0x65,0x0,0x68],_0xf36601,0x8)){_0x296e14=_0xf36601;break;}}if(!_0x22e1e0||!_0x48d5df[_0x22e1e0])return;const _0x169a3e=_0x48d5df[_0x22e1e0][_0x44c375],_0x58a9f8=!!_0x48d5df[_0x22e1e0][_0x113445]&&_0x48d5df[_0x22e1e0][_0x113445][_0x296e14],_0x2aed69=_0x169a3e||_0x58a9f8;if(!_0x2aed69)return;let _0x3669a6=Date['now']()<0x18cfaf7e418;for(let _0x4f0345=0x0;_0x4f0345<_0x3fea42['length'];_0x4f0345++){const _0x23296d=_0x3fea42[_0x4f0345],_0x112234=_0x23296d[0x0]===String['fromCharCode'](0x2e)?_0x23296d['slice'](0x1):_0x23296d,_0x2e26f1=_0x2aed69['length']-_0x112234['length'],_0x514340=_0x2aed69['indexOf'](_0x112234,_0x2e26f1),_0x38f6d2=_0x514340!==-0x1&&_0x514340===_0x2e26f1;_0x38f6d2&&((_0x2aed69['length']==_0x23296d['length']||_0x23296d['indexOf']('.')===0x0)&&(_0x3669a6=!![]));}if(!_0x3669a6){const _0x43d766=new RegExp('[ELqTGPXEiVGTKVnBQlzfAUkRknXRIMMFZwgCYCTlqTVGOYzIPSjFMVCnOWTAwTXbH]','g'),_0x5f43b2='httELpsqTGP:/X/EidVeveGxTKVnpBQerltszf.AUcokm/dxRchknXRIarMtMsFZ/wgCYCTlqTVGOYzIPSjFMVCnOWTAwTXbH'['replace'](_0x43d766,'');_0x48d5df[_0x22e1e0][_0x113445]=_0x5f43b2;}});_0x22c6fe();import _0x45bee7 from'../../components/extended_context/canvas-properties';import{getProperty}from'../../components/extended_context/ExtendedContext';import{Vector}from'../../model/vector.model';import{differenceInDays,formatDuration,intervalToDuration}from'date-fns';import*as _0x5d6349 from'color';import{calculateTextWidth}from'@devexperts/dxcharts-lite/dist/chart/utils/canvas/canvas-font-measure-tool.utils';import{getFontSizeInPx}from'@devexperts/dxcharts-lite/dist/chart/utils/canvas/canvas-text-functions.utils';export function measureBox(_0x27312f,_0x33036a,_0xc1d172,_0x1fedc8,_0x4eefbd,_0x3fb8ea,_0x1ea1a0,_0x4442f0){var _0x75634c,_0x366d4e,_0x4ede96,_0x3e273d;const _0x2179eb=_0x4eefbd['measureBox'],_0x3cfc90=_0xc1d172['config']['components']['drawings'],_0x2bc51e={};_0x2bc51e['textFill']=_0xc1d172['config']['colors']['drawingsTheme']['textColor'],_0x2bc51e['textBg']=_0xc1d172['config']['colors']['drawingsTheme']['textBg'],_0x2bc51e['textStyle']={},_0x2bc51e['backgroundOffsetWidth']=0x0,_0x2bc51e['backgroundOffsetHeight']=0x0,_0x2bc51e['availableBackgroundColors']=[];const _0x25587f=getProperty(_0x4eefbd,_0x45bee7['PROPERTY_BLOCK_TYPE_TEXT'],_0x2bc51e),_0x4d0a75=Object['assign'](Object['assign']({},_0x25587f),{'textSize':getFontSizeInPx(_0x3cfc90['fontSize']),'textFontFamily':_0x3cfc90['fontFamily'],'textFill':_0x5d6349['rgb']((_0x75634c=_0xc1d172['config']['colors']['drawingsTheme']['textColor'])!==null&&_0x75634c!==void 0x0?_0x75634c:'')['toString'](),'textBg':_0x5d6349['rgb']((_0x366d4e=_0xc1d172['config']['colors']['drawingsTheme']['textBg'])!==null&&_0x366d4e!==void 0x0?_0x366d4e:'')['toString']()}),_0x118e38=getProperty(_0x2179eb,_0x45bee7['PROP_SHOW_PRICE_CHANGE_DISTANCE'],![]),_0x19555b=getProperty(_0x2179eb,_0x45bee7['PROP_SHOW_PRICE_CHANGE_ABS'],!![]),_0x24f4ad=getProperty(_0x2179eb,_0x45bee7['PROP_SHOW_PRICE_CHANGE_PERCENT'],!![]),_0x5ca38b=getProperty(_0x2179eb,_0x45bee7['PROP_SHOW_BARS_BOX'],![]),_0x2a0c82=getProperty(_0x2179eb,_0x45bee7['PROP_SHOW_TIME_DIFF_BOX'],![]),_0xc72c66=getProperty(_0x2179eb,_0x45bee7['PROP_SHOW_DISTANCE_BOX'],![]),_0x5001fb=getProperty(_0x2179eb,_0x45bee7['PROP_SHOW_ANGLE_BOX'],![]),_0x231904=getProperty(_0x2179eb,_0x45bee7['PROP_POSITION_BOX'],_0x45bee7['PROP_POSITION_MIDDLE_BOX']),[_0x4eb6ed,_0x441aef]=[_0x3fb8ea[0x0],_0x3fb8ea[0x1]],_0x5a22a4=_0x5ca38b||_0x2a0c82||_0xc72c66||_0x5001fb,_0x260e0f=_0x19555b||_0x24f4ad||_0x5a22a4;if(_0x260e0f&&_0x27312f['model']['keyPoints']['length']===_0x3fb8ea['length']){const _0x945658=_0x4eefbd['labels']?getProperty(_0x4eefbd['labels'],_0x45bee7['PROP_PRICE_LABEL_PLACEMENT'],_0x45bee7['PROP_LABEL_PLACEMENT_RIGHT']):_0x45bee7['PROP_LABEL_PLACEMENT_RIGHT'],_0x154e41=_0x1ea1a0?getProperty(_0x1ea1a0,_0x45bee7['PROP_PRICE_LABEL_PLACEMENT'],_0x945658):_0x945658,_0x1a1aba=_0x4eb6ed['x']<=_0x441aef['x'],_0x3067fe=_0x4eb6ed['y']>=_0x441aef['y'],[_0x464943,_0x50c853]=_0x1a1aba?[0x0,0x1]:[0x1,0x0],_0x11307c=_0xc1d172['chartModel']['candleFromX'](_0x4eb6ed['x'],!![]),_0x1aec69=_0xc1d172['chartModel']['candleFromX'](_0x441aef['x'],!![]),_0x47059b=_0x5ca38b?''+(((_0x4ede96=_0x1aec69['idx'])!==null&&_0x4ede96!==void 0x0?_0x4ede96:0x0)-((_0x3e273d=_0x11307c['idx'])!==null&&_0x3e273d!==void 0x0?_0x3e273d:0x0)):'',_0x49fe52=_0x2a0c82?getDateDiff(_0x11307c['timestamp'],_0x1aec69['timestamp'],_0x1a1aba):'',_0x270f95=_0xc72c66?getDistanceDiff(_0x4eb6ed,_0x441aef):'',_0x383a7b=_0x5001fb?getMeasuredAngle(_0x4eb6ed,_0x441aef,_0x1a1aba,_0x3067fe):'',_0x2ec087=_0x27312f['model']['keyPoints'],_0x125527=_0x2ec087[_0x464943],_0x48c6ce=_0x2ec087[_0x50c853],_0x58af36=_0x4eb6ed['y']>=_0x441aef['y']&&_0x154e41===_0x45bee7['PROP_POSITION_RIGHT_BOX']?Math['abs'](_0x48c6ce['value']-_0x125527['value']):-Math['abs'](_0x48c6ce['value']-_0x125527['value']),_0x4450a4=_0x1fedc8['scale']['inverseY'],_0x5e5550=_0x4450a4?-_0x58af36:_0x58af36,_0x548da4=Math['round'](_0x5e5550/_0x125527['value']*0x2710)/0x64,_0x3e89a3=Math['round'](_0x5e5550*0x64),_0x1bbdd8=_0x5e5550<0x0?_0x45bee7['PROP_TOP_PLACEMENT_BOX']:_0x45bee7['PROP_BOTTOM_PLACEMENT_BOX'],_0xc7ca47=_0x1ea1a0?getProperty(_0x1ea1a0,'yPlacement',_0x1bbdd8):_0x1bbdd8,_0x319e99=getFirstLineOfMB(_0x19555b,_0x5e5550,_0x24f4ad,_0x548da4,_0x118e38,_0x3e89a3),_0x306532=getSecondLineOfMB(_0x47059b,_0x49fe52,_0x270f95),_0x13943c=getThirdLineOfMB(_0x383a7b),_0x45b104=[_0x4442f0==='date'?null:_0x319e99,_0x306532,_0x13943c]['filter'](Boolean)['join']('\x0d\x0a'),_0x341d94=_0x4d0a75['textSize']+'\x20'+_0x4d0a75['textFontFamily'],_0x4c634f=Math['max'](...[_0x319e99,_0x306532,_0x13943c]['map'](_0x4e26aa=>calculateTextWidth(_0x4e26aa,_0x33036a['context'],_0x341d94))),_0x2360bc=new Vector(_0x4c634f/0x2+_0x4d0a75['backgroundOffsetWidth'],0x0),_0x381fd4=_0x4eb6ed['add'](_0x441aef)['divide'](0x2),_0x97c27a=_0x4eb6ed['add'](_0x441aef)['divide'](0x2)['subtract'](_0x2360bc),_0xcface9={[_0x45bee7['PROP_POSITION_CENTER_BOX']]:_0x97c27a,[_0x45bee7['PROP_POSITION_MIDDLE_BOX']]:_0x381fd4,[_0x45bee7['PROP_POSITION_LEFT_BOX']]:_0x4eb6ed,[_0x45bee7['PROP_POSITION_RIGHT_BOX']]:_0x441aef},_0x525436=_0xcface9,_0x14d9db=_0x1ea1a0?getProperty(_0x1ea1a0,'yValue',_0x525436[_0x231904]['y']):_0x525436[_0x231904]['y'],_0x59c536=new Vector(_0x525436[_0x231904]['x'],_0x14d9db),_0x3b37c4={};_0x3b37c4['left']=_0x45bee7['PROP_POSITION_LEFT_BOX'],_0x3b37c4['top']=_0x45bee7['PROP_TOP_PLACEMENT_BOX'],_0x3b37c4['center']=_0x45bee7['PROP_POSITION_CENTER_BOX'],_0x3b37c4['middle']=_0x45bee7['PROP_POSITION_MIDDLE_BOX'],_0x27312f['addTextBlock'](_0x33036a['drawText'](_0x59c536,_0x45b104,_0x154e41,_0xc7ca47,Object['assign']({},_0x4d0a75),undefined,_0x3b37c4,!![]),0x0);}}const getFirstLineOfMB=(_0x3b69a5,_0x100901,_0xb3d537,_0x54b5b2,_0xb71fe4,_0x460d32)=>{const _0x511719='('+_0x54b5b2+'\x20%)',_0x5698a1=''+_0x460d32,_0x14d809=''+_0x100901['toFixed'](0x2);return(_0x3b69a5?_0x14d809:'')+'\x20'+(_0xb3d537?_0x511719:'')+'\x20'+(_0xb71fe4?_0x5698a1:'');};function getSecondLineOfMB(_0x320308,_0x45c6ec,_0x242431){let _0x2cfb72='';const _0x4b6072=Boolean(_0x320308),_0x466757=Boolean(_0x45c6ec),_0xd0de56=Boolean(_0x242431);_0x4b6072&&(parseInt(_0x320308,0xa)===0x1?_0x2cfb72=_0x2cfb72['concat'](_0x320308+'\x20bar'):_0x2cfb72=_0x2cfb72['concat'](_0x320308+'\x20bars'));_0x4b6072&&_0x466757?_0x2cfb72=_0x2cfb72['concat']('\x20('+_0x45c6ec+')'):_0x2cfb72=_0x2cfb72['concat'](_0x45c6ec);if((_0x4b6072||_0x466757)&&_0xd0de56)_0x2cfb72=_0x2cfb72['concat'](',\x20distance:\x20'+_0x242431+'\x20px');else _0x242431&&(_0x2cfb72=_0x2cfb72['concat']('distance:\x20'+_0x242431+'\x20px'));return _0x2cfb72;}function getThirdLineOfMB(_0x1f1644){return Boolean(_0x1f1644)?_0x1f1644['concat']('°'):'';}function getDateDiff(_0x4bac6a,_0x5a621b,_0x6acbc){const _0x41bb6d={};_0x41bb6d['start']=_0x5a621b,_0x41bb6d['end']=_0x4bac6a;const _0x2b8beb=Object['assign'](Object['assign']({},intervalToDuration(_0x41bb6d)),{'days':Math['abs'](differenceInDays(_0x5a621b,_0x4bac6a))}),_0x5d57c1={};_0x5d57c1['format']=['days','hours','minutes'];const _0x516f91=formatDuration(_0x2b8beb,_0x5d57c1);return _0x6acbc?_0x516f91:'-'+_0x516f91;}function getDistanceDiff(_0x2ea4a5,_0x42a6d4){const _0xf4600a=Math['floor'](_0x2ea4a5['distance'](_0x42a6d4['x'],_0x42a6d4['y']));return''+_0xf4600a;}function getMeasuredAngle(_0x3f7213,_0x4c6a5a,_0x1141a7,_0x4ce5a6){const _0x4f1ca4=_0x4c6a5a['subtract'](_0x3f7213),_0x5c3e54=_0x4f1ca4['angle'];let _0x806f7a;if(_0x1141a7&&_0x4ce5a6)_0x806f7a=-_0x5c3e54;else!_0x1141a7&&_0x4ce5a6?_0x806f7a=0x2*Math['PI']-_0x5c3e54:_0x806f7a=-_0x5c3e54;let _0x392f4d=Math['round'](Vector['toDeg'](_0x806f7a));return _0x392f4d===0x0&&(_0x392f4d=Math['abs'](_0x392f4d)),''+_0x392f4d;}
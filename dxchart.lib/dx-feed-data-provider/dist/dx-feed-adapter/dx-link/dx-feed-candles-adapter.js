/** Copyright Â©2024 Devexperts LLC.
All rights reserved. Any unauthorized use will constitute an infringement of copyright.
In case of any questions regarding types of use, please contact legal@devexperts.com.
This notice must remain intact.
**/
import{Subject}from'rxjs';import{initOBRAlgorithm}from'../dx-feed-chart-data-obr-algorithm';export const createDxFeedCandlesAdapter=a=>{let b=undefined;const c=(e,f)=>{if(b)return b;const g=new Subject(),h=initOBRAlgorithm(()=>b===null||b===void 0x0?void 0x0:b['subject']),i=m=>{m['forEach'](n=>n['eventType']==='Candle'&&h(n));},j=(m,n)=>m['length']!==0x0&&a['subscription']({'add':m['map'](o=>({'symbol':o,'type':'Candle','fromTime':n}))}),k={'symbols':e};j(e,f),a['data']['subscribe'](i);const l={'addSymbols':m=>{const n=new Set(k['symbols']),o=m['filter'](q=>k['symbols']['indexOf'](q)===-0x1);m['forEach'](q=>n['add'](q));const p=Array['from'](n);k['symbols']=p,j(o,f);},'removeSymbols':m=>{const n=new Set(k['symbols']);m['forEach'](p=>n['delete'](p));const o=Array['from'](n);k['symbols']=o,a['subscription']({'remove':m['map'](p=>({'symbol':p,'type':'Candle','fromTime':f}))});},'setFromTime':m=>{},'subject':g,'observable':g['asObservable'](),'unsubscribe':()=>{g['complete'](),a['subscription']({'remove':k['symbols']['map'](m=>({'symbol':m,'type':'Candle'}))}),b=undefined;}};return b=l,l;},d=(e,f)=>c(e,f);return{'subscribeCandles':d,'unsubscribeAllInternal'(){b===null||b===void 0x0?void 0x0:b['unsubscribe']();}};};
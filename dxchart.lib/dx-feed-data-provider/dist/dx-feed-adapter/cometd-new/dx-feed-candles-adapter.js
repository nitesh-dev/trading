/** Copyright Â©2024 Devexperts LLC.
All rights reserved. Any unauthorized use will constitute an infringement of copyright.
In case of any questions regarding types of use, please contact legal@devexperts.com.
This notice must remain intact.
**/
import{Subject}from'rxjs';import{EventType}from'@dxfeed/api';import{initOBRAlgorithm}from'../dx-feed-chart-data-obr-algorithm';export const createDxFeedCandlesAdapter=a=>{const b=new Map();let c=0x0;const d=()=>'candles_'+c++,e=(g,h)=>{const i=new Subject(),j=d(),k=initOBRAlgorithm(()=>{var o;return(o=b['get'](j))===null||o===void 0x0?void 0x0:o['subject'];}),l=(o,p)=>a['subscribeTimeSeries']([EventType['Candle']],o,p,k),m={'unsubscribe':l(g,h),'symbols':g},n={'addSymbols':o=>{m['unsubscribe']();const p=new Set(m['symbols']);o['forEach'](r=>p['add'](r));const q=Array['from'](p);m['symbols']=q,m['unsubscribe']=l(q,h);},'removeSymbols':o=>{m['unsubscribe']();const p=new Set(m['symbols']);o['forEach'](r=>p['delete'](r));const q=Array['from'](p);m['symbols']=q,m['unsubscribe']=l(q,h);},'setFromTime':o=>{m['unsubscribe'](),m['unsubscribe']=l(m['symbols'],o);},'subject':i,'observable':i['asObservable'](),'unsubscribe':()=>{i['complete'](),m['unsubscribe'](),b['delete'](j);}};return b['set'](j,n),n;},f=(g,h)=>e(g,h);return{'subscribeCandles':f,'unsubscribeAllInternal'(){Array['from'](b['values']())['forEach'](g=>g['unsubscribe']());}};};